{"ast":null,"code":"// deno-fmt-ignore-file\n// deno-lint-ignore-file\n// This code was bundled using `deno bundle` and it's not recommended to edit it manually\n\nconst Empty = new Uint8Array(0);\nconst TE = new TextEncoder();\nconst TD = new TextDecoder();\nfunction concat(...bufs) {\n  let max = 0;\n  for (let i = 0; i < bufs.length; i++) {\n    max += bufs[i].length;\n  }\n  const out = new Uint8Array(max);\n  let index = 0;\n  for (let i = 0; i < bufs.length; i++) {\n    out.set(bufs[i], index);\n    index += bufs[i].length;\n  }\n  return out;\n}\nfunction encode(...a) {\n  const bufs = [];\n  for (let i = 0; i < a.length; i++) {\n    bufs.push(TE.encode(a[i]));\n  }\n  if (bufs.length === 0) {\n    return Empty;\n  }\n  if (bufs.length === 1) {\n    return bufs[0];\n  }\n  return concat(...bufs);\n}\nfunction decode(a) {\n  if (!a || a.length === 0) {\n    return \"\";\n  }\n  return TD.decode(a);\n}\n\"use strict\";\nconst digits = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nconst base = 36;\nconst maxSeq = 3656158440062976;\nconst minInc = 33;\nconst maxInc = 333;\nconst totalLen = 12 + 10;\nfunction _getRandomValues(a) {\n  for (let i = 0; i < a.length; i++) {\n    a[i] = Math.floor(Math.random() * 255);\n  }\n}\nfunction fillRandom(a) {\n  if (globalThis?.crypto?.getRandomValues) {\n    globalThis.crypto.getRandomValues(a);\n  } else {\n    _getRandomValues(a);\n  }\n}\nclass Nuid {\n  buf;\n  seq;\n  inc;\n  inited;\n  constructor() {\n    this.buf = new Uint8Array(totalLen);\n    this.inited = false;\n  }\n  init() {\n    this.inited = true;\n    this.setPre();\n    this.initSeqAndInc();\n    this.fillSeq();\n  }\n  initSeqAndInc() {\n    this.seq = Math.floor(Math.random() * maxSeq);\n    this.inc = Math.floor(Math.random() * (maxInc - minInc) + minInc);\n  }\n  setPre() {\n    const cbuf = new Uint8Array(12);\n    fillRandom(cbuf);\n    for (let i = 0; i < 12; i++) {\n      const di = cbuf[i] % 36;\n      this.buf[i] = digits.charCodeAt(di);\n    }\n  }\n  fillSeq() {\n    let n = this.seq;\n    for (let i = totalLen - 1; i >= 12; i--) {\n      this.buf[i] = digits.charCodeAt(n % base);\n      n = Math.floor(n / base);\n    }\n  }\n  next() {\n    if (!this.inited) {\n      this.init();\n    }\n    this.seq += this.inc;\n    if (this.seq > 3656158440062976) {\n      this.setPre();\n      this.initSeqAndInc();\n    }\n    this.fillSeq();\n    return String.fromCharCode.apply(String, this.buf);\n  }\n  reset() {\n    this.init();\n  }\n}\nconst nuid = new Nuid();\nvar Events;\n(function (Events) {\n  Events[\"Disconnect\"] = \"disconnect\";\n  Events[\"Reconnect\"] = \"reconnect\";\n  Events[\"Update\"] = \"update\";\n  Events[\"LDM\"] = \"ldm\";\n  Events[\"Error\"] = \"error\";\n})(Events || (Events = {}));\nvar DebugEvents;\n(function (DebugEvents) {\n  DebugEvents[\"Reconnecting\"] = \"reconnecting\";\n  DebugEvents[\"PingTimer\"] = \"pingTimer\";\n  DebugEvents[\"StaleConnection\"] = \"staleConnection\";\n  DebugEvents[\"ClientInitiatedReconnect\"] = \"client initiated reconnect\";\n})(DebugEvents || (DebugEvents = {}));\nvar ErrorCode;\n(function (ErrorCode) {\n  ErrorCode[\"ApiError\"] = \"BAD API\";\n  ErrorCode[\"BadAuthentication\"] = \"BAD_AUTHENTICATION\";\n  ErrorCode[\"BadCreds\"] = \"BAD_CREDS\";\n  ErrorCode[\"BadHeader\"] = \"BAD_HEADER\";\n  ErrorCode[\"BadJson\"] = \"BAD_JSON\";\n  ErrorCode[\"BadPayload\"] = \"BAD_PAYLOAD\";\n  ErrorCode[\"BadSubject\"] = \"BAD_SUBJECT\";\n  ErrorCode[\"Cancelled\"] = \"CANCELLED\";\n  ErrorCode[\"ConnectionClosed\"] = \"CONNECTION_CLOSED\";\n  ErrorCode[\"ConnectionDraining\"] = \"CONNECTION_DRAINING\";\n  ErrorCode[\"ConnectionRefused\"] = \"CONNECTION_REFUSED\";\n  ErrorCode[\"ConnectionTimeout\"] = \"CONNECTION_TIMEOUT\";\n  ErrorCode[\"Disconnect\"] = \"DISCONNECT\";\n  ErrorCode[\"InvalidOption\"] = \"INVALID_OPTION\";\n  ErrorCode[\"InvalidPayload\"] = \"INVALID_PAYLOAD\";\n  ErrorCode[\"MaxPayloadExceeded\"] = \"MAX_PAYLOAD_EXCEEDED\";\n  ErrorCode[\"NoResponders\"] = \"503\";\n  ErrorCode[\"NotFunction\"] = \"NOT_FUNC\";\n  ErrorCode[\"RequestError\"] = \"REQUEST_ERROR\";\n  ErrorCode[\"ServerOptionNotAvailable\"] = \"SERVER_OPT_NA\";\n  ErrorCode[\"SubClosed\"] = \"SUB_CLOSED\";\n  ErrorCode[\"SubDraining\"] = \"SUB_DRAINING\";\n  ErrorCode[\"Timeout\"] = \"TIMEOUT\";\n  ErrorCode[\"Tls\"] = \"TLS\";\n  ErrorCode[\"Unknown\"] = \"UNKNOWN_ERROR\";\n  ErrorCode[\"WssRequired\"] = \"WSS_REQUIRED\";\n  ErrorCode[\"JetStreamInvalidAck\"] = \"JESTREAM_INVALID_ACK\";\n  ErrorCode[\"JetStream404NoMessages\"] = \"404\";\n  ErrorCode[\"JetStream408RequestTimeout\"] = \"408\";\n  ErrorCode[\"JetStream409MaxAckPendingExceeded\"] = \"409\";\n  ErrorCode[\"JetStream409\"] = \"409\";\n  ErrorCode[\"JetStreamNotEnabled\"] = \"503\";\n  ErrorCode[\"JetStreamIdleHeartBeat\"] = \"IDLE_HEARTBEAT\";\n  ErrorCode[\"AuthorizationViolation\"] = \"AUTHORIZATION_VIOLATION\";\n  ErrorCode[\"AuthenticationExpired\"] = \"AUTHENTICATION_EXPIRED\";\n  ErrorCode[\"ProtocolError\"] = \"NATS_PROTOCOL_ERR\";\n  ErrorCode[\"PermissionsViolation\"] = \"PERMISSIONS_VIOLATION\";\n  ErrorCode[\"AuthenticationTimeout\"] = \"AUTHENTICATION_TIMEOUT\";\n  ErrorCode[\"AccountExpired\"] = \"ACCOUNT_EXPIRED\";\n})(ErrorCode || (ErrorCode = {}));\nfunction isNatsError(err) {\n  return typeof err.code === \"string\";\n}\nclass Messages {\n  messages;\n  constructor() {\n    this.messages = new Map();\n    this.messages.set(ErrorCode.InvalidPayload, \"Invalid payload type - payloads can be 'binary', 'string', or 'json'\");\n    this.messages.set(ErrorCode.BadJson, \"Bad JSON\");\n    this.messages.set(ErrorCode.WssRequired, \"TLS is required, therefore a secure websocket connection is also required\");\n  }\n  static getMessage(s) {\n    return messages.getMessage(s);\n  }\n  getMessage(s) {\n    return this.messages.get(s) || s;\n  }\n}\nconst messages = new Messages();\nclass NatsError extends Error {\n  name;\n  message;\n  code;\n  permissionContext;\n  chainedError;\n  api_error;\n  constructor(message, code, chainedError) {\n    super(message);\n    this.name = \"NatsError\";\n    this.message = message;\n    this.code = code;\n    this.chainedError = chainedError;\n  }\n  static errorForCode(code, chainedError) {\n    const m = Messages.getMessage(code);\n    return new NatsError(m, code, chainedError);\n  }\n  isAuthError() {\n    return this.code === ErrorCode.AuthenticationExpired || this.code === ErrorCode.AuthorizationViolation || this.code === ErrorCode.AccountExpired;\n  }\n  isAuthTimeout() {\n    return this.code === ErrorCode.AuthenticationTimeout;\n  }\n  isPermissionError() {\n    return this.code === ErrorCode.PermissionsViolation;\n  }\n  isProtocolError() {\n    return this.code === ErrorCode.ProtocolError;\n  }\n  isJetStreamError() {\n    return this.api_error !== undefined;\n  }\n  jsError() {\n    return this.api_error ? this.api_error : null;\n  }\n}\nvar Match;\n(function (Match) {\n  Match[Match[\"Exact\"] = 0] = \"Exact\";\n  Match[Match[\"CanonicalMIME\"] = 1] = \"CanonicalMIME\";\n  Match[Match[\"IgnoreCase\"] = 2] = \"IgnoreCase\";\n})(Match || (Match = {}));\nvar RequestStrategy;\n(function (RequestStrategy) {\n  RequestStrategy[\"Timer\"] = \"timer\";\n  RequestStrategy[\"Count\"] = \"count\";\n  RequestStrategy[\"JitterTimer\"] = \"jitterTimer\";\n  RequestStrategy[\"SentinelMsg\"] = \"sentinelMsg\";\n})(RequestStrategy || (RequestStrategy = {}));\nfunction syncIterator(src) {\n  const iter = src[Symbol.asyncIterator]();\n  return {\n    async next() {\n      const m = await iter.next();\n      if (m.done) {\n        return Promise.resolve(null);\n      }\n      return Promise.resolve(m.value);\n    }\n  };\n}\nvar ServiceResponseType;\n(function (ServiceResponseType) {\n  ServiceResponseType[\"STATS\"] = \"io.nats.micro.v1.stats_response\";\n  ServiceResponseType[\"INFO\"] = \"io.nats.micro.v1.info_response\";\n  ServiceResponseType[\"PING\"] = \"io.nats.micro.v1.ping_response\";\n})(ServiceResponseType || (ServiceResponseType = {}));\nconst ServiceErrorHeader = \"Nats-Service-Error\";\nconst ServiceErrorCodeHeader = \"Nats-Service-Error-Code\";\nclass ServiceError extends Error {\n  code;\n  constructor(code, message) {\n    super(message);\n    this.code = code;\n  }\n  static isServiceError(msg) {\n    return ServiceError.toServiceError(msg) !== null;\n  }\n  static toServiceError(msg) {\n    const scode = msg?.headers?.get(ServiceErrorCodeHeader) || \"\";\n    if (scode !== \"\") {\n      const code = parseInt(scode) || 400;\n      const description = msg?.headers?.get(ServiceErrorHeader) || \"\";\n      return new ServiceError(code, description.length ? description : scode);\n    }\n    return null;\n  }\n}\nfunction createInbox(prefix = \"\") {\n  prefix = prefix || \"_INBOX\";\n  if (typeof prefix !== \"string\") {\n    throw new Error(\"prefix must be a string\");\n  }\n  prefix.split(\".\").forEach(v => {\n    if (v === \"*\" || v === \">\") {\n      throw new Error(`inbox prefixes cannot have wildcards '${prefix}'`);\n    }\n  });\n  return `${prefix}.${nuid.next()}`;\n}\nconst DEFAULT_HOST = \"127.0.0.1\";\nvar ServiceVerb;\n(function (ServiceVerb) {\n  ServiceVerb[\"PING\"] = \"PING\";\n  ServiceVerb[\"STATS\"] = \"STATS\";\n  ServiceVerb[\"INFO\"] = \"INFO\";\n})(ServiceVerb || (ServiceVerb = {}));\nfunction extend(a, ...b) {\n  for (let i = 0; i < b.length; i++) {\n    const o = b[i];\n    Object.keys(o).forEach(function (k) {\n      a[k] = o[k];\n    });\n  }\n  return a;\n}\nfunction render(frame) {\n  const cr = \"␍\";\n  const lf = \"␊\";\n  return TD.decode(frame).replace(/\\n/g, lf).replace(/\\r/g, cr);\n}\nfunction timeout(ms, asyncTraces = true) {\n  const err = asyncTraces ? NatsError.errorForCode(ErrorCode.Timeout) : null;\n  let methods;\n  let timer;\n  const p = new Promise((_resolve, reject) => {\n    const cancel = () => {\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n    methods = {\n      cancel\n    };\n    timer = setTimeout(() => {\n      if (err === null) {\n        reject(NatsError.errorForCode(ErrorCode.Timeout));\n      } else {\n        reject(err);\n      }\n    }, ms);\n  });\n  return Object.assign(p, methods);\n}\nfunction delay(ms = 0) {\n  let methods;\n  const p = new Promise(resolve => {\n    const timer = setTimeout(() => {\n      resolve();\n    }, ms);\n    const cancel = () => {\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n    methods = {\n      cancel\n    };\n  });\n  return Object.assign(p, methods);\n}\nfunction deadline(p, millis = 1000) {\n  const err = new Error(`deadline exceeded`);\n  const d = deferred();\n  const timer = setTimeout(() => d.reject(err), millis);\n  return Promise.race([p, d]).finally(() => clearTimeout(timer));\n}\nfunction deferred() {\n  let methods = {};\n  const p = new Promise((resolve, reject) => {\n    methods = {\n      resolve,\n      reject\n    };\n  });\n  return Object.assign(p, methods);\n}\nfunction shuffle(a) {\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [a[i], a[j]] = [a[j], a[i]];\n  }\n  return a;\n}\nclass Perf {\n  timers;\n  measures;\n  constructor() {\n    this.timers = new Map();\n    this.measures = new Map();\n  }\n  mark(key) {\n    this.timers.set(key, performance.now());\n  }\n  measure(key, startKey, endKey) {\n    const s = this.timers.get(startKey);\n    if (s === undefined) {\n      throw new Error(`${startKey} is not defined`);\n    }\n    const e = this.timers.get(endKey);\n    if (e === undefined) {\n      throw new Error(`${endKey} is not defined`);\n    }\n    this.measures.set(key, e - s);\n  }\n  getEntries() {\n    const values = [];\n    this.measures.forEach((v, k) => {\n      values.push({\n        name: k,\n        duration: v\n      });\n    });\n    return values;\n  }\n}\nfunction jitter(n) {\n  if (n === 0) {\n    return 0;\n  }\n  return Math.floor(n / 2 + Math.random() * n);\n}\nfunction backoff(policy = [0, 250, 250, 500, 500, 3000, 5000]) {\n  if (!Array.isArray(policy)) {\n    policy = [0, 250, 250, 500, 500, 3000, 5000];\n  }\n  const max = policy.length - 1;\n  return {\n    backoff(attempt) {\n      return jitter(attempt > max ? policy[max] : policy[attempt]);\n    }\n  };\n}\nfunction nanos(millis) {\n  return millis * 1000000;\n}\nfunction millis(ns) {\n  return Math.floor(ns / 1000000);\n}\nfunction canonicalMIMEHeaderKey(k) {\n  const dash = 45;\n  const toLower = 97 - 65;\n  let upper = true;\n  const buf = new Array(k.length);\n  for (let i = 0; i < k.length; i++) {\n    let c = k.charCodeAt(i);\n    if (c === 58 || c < 33 || c > 126) {\n      throw new NatsError(`'${k[i]}' is not a valid character for a header key`, ErrorCode.BadHeader);\n    }\n    if (upper && 97 <= c && c <= 122) {\n      c -= toLower;\n    } else if (!upper && 65 <= c && c <= 90) {\n      c += toLower;\n    }\n    buf[i] = c;\n    upper = c == dash;\n  }\n  return String.fromCharCode(...buf);\n}\nfunction headers(code = 0, description = \"\") {\n  if (code === 0 && description !== \"\" || code > 0 && description === \"\") {\n    throw new Error(\"setting status requires both code and description\");\n  }\n  return new MsgHdrsImpl(code, description);\n}\nconst HEADER = \"NATS/1.0\";\nclass MsgHdrsImpl {\n  _code;\n  headers;\n  _description;\n  constructor(code = 0, description = \"\") {\n    this._code = code;\n    this._description = description;\n    this.headers = new Map();\n  }\n  [Symbol.iterator]() {\n    return this.headers.entries();\n  }\n  size() {\n    return this.headers.size;\n  }\n  equals(mh) {\n    if (mh && this.headers.size === mh.headers.size && this._code === mh._code) {\n      for (const [k, v] of this.headers) {\n        const a = mh.values(k);\n        if (v.length !== a.length) {\n          return false;\n        }\n        const vv = [...v].sort();\n        const aa = [...a].sort();\n        for (let i = 0; i < vv.length; i++) {\n          if (vv[i] !== aa[i]) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n  static decode(a) {\n    const mh = new MsgHdrsImpl();\n    const s = TD.decode(a);\n    const lines = s.split(\"\\r\\n\");\n    const h = lines[0];\n    if (h !== HEADER) {\n      let str = h.replace(HEADER, \"\").trim();\n      if (str.length > 0) {\n        mh._code = parseInt(str, 10);\n        if (isNaN(mh._code)) {\n          mh._code = 0;\n        }\n        const scode = mh._code.toString();\n        str = str.replace(scode, \"\");\n        mh._description = str.trim();\n      }\n    }\n    if (lines.length >= 1) {\n      lines.slice(1).map(s => {\n        if (s) {\n          const idx = s.indexOf(\":\");\n          if (idx > -1) {\n            const k = s.slice(0, idx);\n            const v = s.slice(idx + 1).trim();\n            mh.append(k, v);\n          }\n        }\n      });\n    }\n    return mh;\n  }\n  toString() {\n    if (this.headers.size === 0 && this._code === 0) {\n      return \"\";\n    }\n    let s = HEADER;\n    if (this._code > 0 && this._description !== \"\") {\n      s += ` ${this._code} ${this._description}`;\n    }\n    for (const [k, v] of this.headers) {\n      for (let i = 0; i < v.length; i++) {\n        s = `${s}\\r\\n${k}: ${v[i]}`;\n      }\n    }\n    return `${s}\\r\\n\\r\\n`;\n  }\n  encode() {\n    return TE.encode(this.toString());\n  }\n  static validHeaderValue(k) {\n    const inv = /[\\r\\n]/;\n    if (inv.test(k)) {\n      throw new NatsError(\"invalid header value - \\\\r and \\\\n are not allowed.\", ErrorCode.BadHeader);\n    }\n    return k.trim();\n  }\n  keys() {\n    const keys = [];\n    for (const sk of this.headers.keys()) {\n      keys.push(sk);\n    }\n    return keys;\n  }\n  findKeys(k, match = Match.Exact) {\n    const keys = this.keys();\n    switch (match) {\n      case Match.Exact:\n        return keys.filter(v => {\n          return v === k;\n        });\n      case Match.CanonicalMIME:\n        k = canonicalMIMEHeaderKey(k);\n        return keys.filter(v => {\n          return v === k;\n        });\n      default:\n        {\n          const lci = k.toLowerCase();\n          return keys.filter(v => {\n            return lci === v.toLowerCase();\n          });\n        }\n    }\n  }\n  get(k, match = Match.Exact) {\n    const keys = this.findKeys(k, match);\n    if (keys.length) {\n      const v = this.headers.get(keys[0]);\n      if (v) {\n        return Array.isArray(v) ? v[0] : v;\n      }\n    }\n    return \"\";\n  }\n  last(k, match = Match.Exact) {\n    const keys = this.findKeys(k, match);\n    if (keys.length) {\n      const v = this.headers.get(keys[0]);\n      if (v) {\n        return Array.isArray(v) ? v[v.length - 1] : v;\n      }\n    }\n    return \"\";\n  }\n  has(k, match = Match.Exact) {\n    return this.findKeys(k, match).length > 0;\n  }\n  set(k, v, match = Match.Exact) {\n    this.delete(k, match);\n    this.append(k, v, match);\n  }\n  append(k, v, match = Match.Exact) {\n    const ck = canonicalMIMEHeaderKey(k);\n    if (match === Match.CanonicalMIME) {\n      k = ck;\n    }\n    const keys = this.findKeys(k, match);\n    k = keys.length > 0 ? keys[0] : k;\n    const value = MsgHdrsImpl.validHeaderValue(v);\n    let a = this.headers.get(k);\n    if (!a) {\n      a = [];\n      this.headers.set(k, a);\n    }\n    a.push(value);\n  }\n  values(k, match = Match.Exact) {\n    const buf = [];\n    const keys = this.findKeys(k, match);\n    keys.forEach(v => {\n      const values = this.headers.get(v);\n      if (values) {\n        buf.push(...values);\n      }\n    });\n    return buf;\n  }\n  delete(k, match = Match.Exact) {\n    const keys = this.findKeys(k, match);\n    keys.forEach(v => {\n      this.headers.delete(v);\n    });\n  }\n  get hasError() {\n    return this._code >= 300;\n  }\n  get status() {\n    return `${this._code} ${this._description}`.trim();\n  }\n  toRecord() {\n    const data = {};\n    this.keys().forEach(v => {\n      data[v] = this.values(v);\n    });\n    return data;\n  }\n  get code() {\n    return this._code;\n  }\n  get description() {\n    return this._description;\n  }\n  static fromRecord(r) {\n    const h = new MsgHdrsImpl();\n    for (const k in r) {\n      h.headers.set(k, r[k]);\n    }\n    return h;\n  }\n}\nfunction StringCodec() {\n  return {\n    encode(d) {\n      return TE.encode(d);\n    },\n    decode(a) {\n      return TD.decode(a);\n    }\n  };\n}\nfunction JSONCodec(reviver) {\n  return {\n    encode(d) {\n      try {\n        if (d === undefined) {\n          d = null;\n        }\n        return TE.encode(JSON.stringify(d));\n      } catch (err) {\n        throw NatsError.errorForCode(ErrorCode.BadJson, err);\n      }\n    },\n    decode(a) {\n      try {\n        return JSON.parse(TD.decode(a), reviver);\n      } catch (err) {\n        throw NatsError.errorForCode(ErrorCode.BadJson, err);\n      }\n    }\n  };\n}\nfunction isRequestError(msg) {\n  if (msg && msg.data.length === 0 && msg.headers?.code === 503) {\n    return NatsError.errorForCode(ErrorCode.NoResponders);\n  }\n  return null;\n}\nclass MsgImpl {\n  _headers;\n  _msg;\n  _rdata;\n  _reply;\n  _subject;\n  publisher;\n  static jc;\n  constructor(msg, data, publisher) {\n    this._msg = msg;\n    this._rdata = data;\n    this.publisher = publisher;\n  }\n  get subject() {\n    if (this._subject) {\n      return this._subject;\n    }\n    this._subject = TD.decode(this._msg.subject);\n    return this._subject;\n  }\n  get reply() {\n    if (this._reply) {\n      return this._reply;\n    }\n    this._reply = TD.decode(this._msg.reply);\n    return this._reply;\n  }\n  get sid() {\n    return this._msg.sid;\n  }\n  get headers() {\n    if (this._msg.hdr > -1 && !this._headers) {\n      const buf = this._rdata.subarray(0, this._msg.hdr);\n      this._headers = MsgHdrsImpl.decode(buf);\n    }\n    return this._headers;\n  }\n  get data() {\n    if (!this._rdata) {\n      return new Uint8Array(0);\n    }\n    return this._msg.hdr > -1 ? this._rdata.subarray(this._msg.hdr) : this._rdata;\n  }\n  respond(data = Empty, opts) {\n    if (this.reply) {\n      this.publisher.publish(this.reply, data, opts);\n      return true;\n    }\n    return false;\n  }\n  size() {\n    const subj = this._msg.subject.length;\n    const reply = this._msg.reply?.length || 0;\n    const payloadAndHeaders = this._msg.size === -1 ? 0 : this._msg.size;\n    return subj + reply + payloadAndHeaders;\n  }\n  json(reviver) {\n    return JSONCodec(reviver).decode(this.data);\n  }\n  string() {\n    return TD.decode(this.data);\n  }\n  requestInfo() {\n    const v = this.headers?.get(\"Nats-Request-Info\");\n    if (v) {\n      return JSON.parse(v, function (key, value) {\n        if ((key === \"start\" || key === \"stop\") && value !== \"\") {\n          return new Date(Date.parse(value));\n        }\n        return value;\n      });\n    }\n    return null;\n  }\n}\nfunction validateDurableName(name) {\n  return minValidation(\"durable\", name);\n}\nfunction validateStreamName(name) {\n  return minValidation(\"stream\", name);\n}\nfunction minValidation(context, name = \"\") {\n  if (name === \"\") {\n    throw Error(`${context} name required`);\n  }\n  const bad = [\".\", \"*\", \">\", \"/\", \"\\\\\", \" \", \"\\t\", \"\\n\", \"\\r\"];\n  bad.forEach(v => {\n    if (name.indexOf(v) !== -1) {\n      switch (v) {\n        case \"\\n\":\n          v = \"\\\\n\";\n          break;\n        case \"\\r\":\n          v = \"\\\\r\";\n          break;\n        case \"\\t\":\n          v = \"\\\\t\";\n          break;\n        default:\n      }\n      throw Error(`invalid ${context} name - ${context} name cannot contain '${v}'`);\n    }\n  });\n  return \"\";\n}\nfunction validateName(context, name = \"\") {\n  if (name === \"\") {\n    throw Error(`${context} name required`);\n  }\n  const m = validName(name);\n  if (m.length) {\n    throw new Error(`invalid ${context} name - ${context} name ${m}`);\n  }\n}\nfunction validName(name = \"\") {\n  if (name === \"\") {\n    throw Error(`name required`);\n  }\n  const RE = /^[-\\w]+$/g;\n  const m = name.match(RE);\n  if (m === null) {\n    for (const c of name.split(\"\")) {\n      const mm = c.match(RE);\n      if (mm === null) {\n        return `cannot contain '${c}'`;\n      }\n    }\n  }\n  return \"\";\n}\nfunction isFlowControlMsg(msg) {\n  if (msg.data.length > 0) {\n    return false;\n  }\n  const h = msg.headers;\n  if (!h) {\n    return false;\n  }\n  return h.code >= 100 && h.code < 200;\n}\nfunction isHeartbeatMsg(msg) {\n  return isFlowControlMsg(msg) && msg.headers?.description === \"Idle Heartbeat\";\n}\nfunction newJsErrorMsg(code, description, subject) {\n  const h = headers(code, description);\n  const arg = {\n    hdr: 1,\n    sid: 0,\n    size: 0\n  };\n  const msg = new MsgImpl(arg, Empty, {});\n  msg._headers = h;\n  msg._subject = subject;\n  return msg;\n}\nfunction checkJsError(msg) {\n  if (msg.data.length !== 0) {\n    return null;\n  }\n  const h = msg.headers;\n  if (!h) {\n    return null;\n  }\n  return checkJsErrorCode(h.code, h.description);\n}\nvar Js409Errors;\n(function (Js409Errors) {\n  Js409Errors[\"MaxBatchExceeded\"] = \"exceeded maxrequestbatch of\";\n  Js409Errors[\"MaxExpiresExceeded\"] = \"exceeded maxrequestexpires of\";\n  Js409Errors[\"MaxBytesExceeded\"] = \"exceeded maxrequestmaxbytes of\";\n  Js409Errors[\"MaxMessageSizeExceeded\"] = \"message size exceeds maxbytes\";\n  Js409Errors[\"PushConsumer\"] = \"consumer is push based\";\n  Js409Errors[\"MaxWaitingExceeded\"] = \"exceeded maxwaiting\";\n  Js409Errors[\"IdleHeartbeatMissed\"] = \"idle heartbeats missed\";\n  Js409Errors[\"ConsumerDeleted\"] = \"consumer deleted\";\n})(Js409Errors || (Js409Errors = {}));\nlet MAX_WAITING_FAIL = false;\nfunction isTerminal409(err) {\n  if (err.code !== ErrorCode.JetStream409) {\n    return false;\n  }\n  const fatal = [Js409Errors.MaxBatchExceeded, Js409Errors.MaxExpiresExceeded, Js409Errors.MaxBytesExceeded, Js409Errors.MaxMessageSizeExceeded, Js409Errors.PushConsumer, Js409Errors.IdleHeartbeatMissed, Js409Errors.ConsumerDeleted];\n  if (MAX_WAITING_FAIL) {\n    fatal.push(Js409Errors.MaxWaitingExceeded);\n  }\n  return fatal.find(s => {\n    return err.message.indexOf(s) !== -1;\n  }) !== undefined;\n}\nfunction checkJsErrorCode(code, description = \"\") {\n  if (code < 300) {\n    return null;\n  }\n  description = description.toLowerCase();\n  switch (code) {\n    case 404:\n      return new NatsError(description, ErrorCode.JetStream404NoMessages);\n    case 408:\n      return new NatsError(description, ErrorCode.JetStream408RequestTimeout);\n    case 409:\n      {\n        const ec = description.startsWith(Js409Errors.IdleHeartbeatMissed) ? ErrorCode.JetStreamIdleHeartBeat : ErrorCode.JetStream409;\n        return new NatsError(description, ec);\n      }\n    case 503:\n      return NatsError.errorForCode(ErrorCode.JetStreamNotEnabled, new Error(description));\n    default:\n      if (description === \"\") {\n        description = ErrorCode.Unknown;\n      }\n      return new NatsError(description, `${code}`);\n  }\n}\nclass QueuedIteratorImpl {\n  inflight;\n  processed;\n  received;\n  noIterator;\n  iterClosed;\n  done;\n  signal;\n  yields;\n  filtered;\n  pendingFiltered;\n  ingestionFilterFn;\n  protocolFilterFn;\n  dispatchedFn;\n  ctx;\n  _data;\n  err;\n  time;\n  yielding;\n  constructor() {\n    this.inflight = 0;\n    this.filtered = 0;\n    this.pendingFiltered = 0;\n    this.processed = 0;\n    this.received = 0;\n    this.noIterator = false;\n    this.done = false;\n    this.signal = deferred();\n    this.yields = [];\n    this.iterClosed = deferred();\n    this.time = 0;\n    this.yielding = false;\n  }\n  [Symbol.asyncIterator]() {\n    return this.iterate();\n  }\n  push(v) {\n    if (this.done) {\n      return;\n    }\n    if (typeof v === \"function\") {\n      this.yields.push(v);\n      this.signal.resolve();\n      return;\n    }\n    const {\n      ingest,\n      protocol\n    } = this.ingestionFilterFn ? this.ingestionFilterFn(v, this.ctx || this) : {\n      ingest: true,\n      protocol: false\n    };\n    if (ingest) {\n      if (protocol) {\n        this.filtered++;\n        this.pendingFiltered++;\n      }\n      this.yields.push(v);\n      this.signal.resolve();\n    }\n  }\n  async *iterate() {\n    if (this.noIterator) {\n      throw new NatsError(\"unsupported iterator\", ErrorCode.ApiError);\n    }\n    if (this.yielding) {\n      throw new NatsError(\"already yielding\", ErrorCode.ApiError);\n    }\n    this.yielding = true;\n    try {\n      while (true) {\n        if (this.yields.length === 0) {\n          await this.signal;\n        }\n        if (this.err) {\n          throw this.err;\n        }\n        const yields = this.yields;\n        this.inflight = yields.length;\n        this.yields = [];\n        for (let i = 0; i < yields.length; i++) {\n          if (typeof yields[i] === \"function\") {\n            const fn = yields[i];\n            try {\n              fn();\n            } catch (err) {\n              throw err;\n            }\n            if (this.err) {\n              throw this.err;\n            }\n            continue;\n          }\n          const ok = this.protocolFilterFn ? this.protocolFilterFn(yields[i]) : true;\n          if (ok) {\n            this.processed++;\n            const start = Date.now();\n            yield yields[i];\n            this.time = Date.now() - start;\n            if (this.dispatchedFn && yields[i]) {\n              this.dispatchedFn(yields[i]);\n            }\n          } else {\n            this.pendingFiltered--;\n          }\n          this.inflight--;\n        }\n        if (this.done) {\n          break;\n        } else if (this.yields.length === 0) {\n          yields.length = 0;\n          this.yields = yields;\n          this.signal = deferred();\n        }\n      }\n    } finally {\n      this.stop();\n    }\n  }\n  stop(err) {\n    if (this.done) {\n      return;\n    }\n    this.err = err;\n    this.done = true;\n    this.signal.resolve();\n    this.iterClosed.resolve(err);\n  }\n  getProcessed() {\n    return this.noIterator ? this.received : this.processed;\n  }\n  getPending() {\n    return this.yields.length + this.inflight - this.pendingFiltered;\n  }\n  getReceived() {\n    return this.received - this.filtered;\n  }\n}\nclass IdleHeartbeatMonitor {\n  interval;\n  maxOut;\n  cancelAfter;\n  timer;\n  autoCancelTimer;\n  last;\n  missed;\n  count;\n  callback;\n  constructor(interval, cb, opts = {\n    maxOut: 2\n  }) {\n    this.interval = interval;\n    this.maxOut = opts?.maxOut || 2;\n    this.cancelAfter = opts?.cancelAfter || 0;\n    this.last = Date.now();\n    this.missed = 0;\n    this.count = 0;\n    this.callback = cb;\n    this._schedule();\n  }\n  cancel() {\n    if (this.autoCancelTimer) {\n      clearTimeout(this.autoCancelTimer);\n    }\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n    this.timer = 0;\n    this.autoCancelTimer = 0;\n    this.missed = 0;\n  }\n  work() {\n    this.last = Date.now();\n    this.missed = 0;\n  }\n  _change(interval, cancelAfter = 0, maxOut = 2) {\n    this.interval = interval;\n    this.maxOut = maxOut;\n    this.cancelAfter = cancelAfter;\n    this.restart();\n  }\n  restart() {\n    this.cancel();\n    this._schedule();\n  }\n  _schedule() {\n    if (this.cancelAfter > 0) {\n      this.autoCancelTimer = setTimeout(() => {\n        this.cancel();\n      }, this.cancelAfter);\n    }\n    this.timer = setInterval(() => {\n      this.count++;\n      if (Date.now() - this.last > this.interval) {\n        this.missed++;\n      }\n      if (this.missed >= this.maxOut) {\n        try {\n          if (this.callback(this.missed) === true) {\n            this.cancel();\n          }\n        } catch (err) {\n          console.log(err);\n        }\n      }\n    }, this.interval);\n  }\n}\nvar RetentionPolicy;\n(function (RetentionPolicy) {\n  RetentionPolicy[\"Limits\"] = \"limits\";\n  RetentionPolicy[\"Interest\"] = \"interest\";\n  RetentionPolicy[\"Workqueue\"] = \"workqueue\";\n})(RetentionPolicy || (RetentionPolicy = {}));\nvar DiscardPolicy;\n(function (DiscardPolicy) {\n  DiscardPolicy[\"Old\"] = \"old\";\n  DiscardPolicy[\"New\"] = \"new\";\n})(DiscardPolicy || (DiscardPolicy = {}));\nvar StorageType;\n(function (StorageType) {\n  StorageType[\"File\"] = \"file\";\n  StorageType[\"Memory\"] = \"memory\";\n})(StorageType || (StorageType = {}));\nvar DeliverPolicy;\n(function (DeliverPolicy) {\n  DeliverPolicy[\"All\"] = \"all\";\n  DeliverPolicy[\"Last\"] = \"last\";\n  DeliverPolicy[\"New\"] = \"new\";\n  DeliverPolicy[\"StartSequence\"] = \"by_start_sequence\";\n  DeliverPolicy[\"StartTime\"] = \"by_start_time\";\n  DeliverPolicy[\"LastPerSubject\"] = \"last_per_subject\";\n})(DeliverPolicy || (DeliverPolicy = {}));\nvar AckPolicy;\n(function (AckPolicy) {\n  AckPolicy[\"None\"] = \"none\";\n  AckPolicy[\"All\"] = \"all\";\n  AckPolicy[\"Explicit\"] = \"explicit\";\n  AckPolicy[\"NotSet\"] = \"\";\n})(AckPolicy || (AckPolicy = {}));\nvar ReplayPolicy;\n(function (ReplayPolicy) {\n  ReplayPolicy[\"Instant\"] = \"instant\";\n  ReplayPolicy[\"Original\"] = \"original\";\n})(ReplayPolicy || (ReplayPolicy = {}));\nvar StoreCompression;\n(function (StoreCompression) {\n  StoreCompression[\"None\"] = \"none\";\n  StoreCompression[\"S2\"] = \"s2\";\n})(StoreCompression || (StoreCompression = {}));\nvar ConsumerApiAction;\n(function (ConsumerApiAction) {\n  ConsumerApiAction[\"CreateOrUpdate\"] = \"\";\n  ConsumerApiAction[\"Update\"] = \"update\";\n  ConsumerApiAction[\"Create\"] = \"create\";\n})(ConsumerApiAction || (ConsumerApiAction = {}));\nfunction defaultConsumer(name, opts = {}) {\n  return Object.assign({\n    name: name,\n    deliver_policy: DeliverPolicy.All,\n    ack_policy: AckPolicy.Explicit,\n    ack_wait: nanos(30 * 1000),\n    replay_policy: ReplayPolicy.Instant\n  }, opts);\n}\nvar AdvisoryKind;\n(function (AdvisoryKind) {\n  AdvisoryKind[\"API\"] = \"api_audit\";\n  AdvisoryKind[\"StreamAction\"] = \"stream_action\";\n  AdvisoryKind[\"ConsumerAction\"] = \"consumer_action\";\n  AdvisoryKind[\"SnapshotCreate\"] = \"snapshot_create\";\n  AdvisoryKind[\"SnapshotComplete\"] = \"snapshot_complete\";\n  AdvisoryKind[\"RestoreCreate\"] = \"restore_create\";\n  AdvisoryKind[\"RestoreComplete\"] = \"restore_complete\";\n  AdvisoryKind[\"MaxDeliver\"] = \"max_deliver\";\n  AdvisoryKind[\"Terminated\"] = \"terminated\";\n  AdvisoryKind[\"Ack\"] = \"consumer_ack\";\n  AdvisoryKind[\"StreamLeaderElected\"] = \"stream_leader_elected\";\n  AdvisoryKind[\"StreamQuorumLost\"] = \"stream_quorum_lost\";\n  AdvisoryKind[\"ConsumerLeaderElected\"] = \"consumer_leader_elected\";\n  AdvisoryKind[\"ConsumerQuorumLost\"] = \"consumer_quorum_lost\";\n})(AdvisoryKind || (AdvisoryKind = {}));\nvar JsHeaders;\n(function (JsHeaders) {\n  JsHeaders[\"StreamSourceHdr\"] = \"Nats-Stream-Source\";\n  JsHeaders[\"LastConsumerSeqHdr\"] = \"Nats-Last-Consumer\";\n  JsHeaders[\"LastStreamSeqHdr\"] = \"Nats-Last-Stream\";\n  JsHeaders[\"ConsumerStalledHdr\"] = \"Nats-Consumer-Stalled\";\n  JsHeaders[\"MessageSizeHdr\"] = \"Nats-Msg-Size\";\n  JsHeaders[\"RollupHdr\"] = \"Nats-Rollup\";\n  JsHeaders[\"RollupValueSubject\"] = \"sub\";\n  JsHeaders[\"RollupValueAll\"] = \"all\";\n  JsHeaders[\"PendingMessagesHdr\"] = \"Nats-Pending-Messages\";\n  JsHeaders[\"PendingBytesHdr\"] = \"Nats-Pending-Bytes\";\n})(JsHeaders || (JsHeaders = {}));\nvar KvWatchInclude;\n(function (KvWatchInclude) {\n  KvWatchInclude[\"LastValue\"] = \"\";\n  KvWatchInclude[\"AllHistory\"] = \"history\";\n  KvWatchInclude[\"UpdatesOnly\"] = \"updates\";\n})(KvWatchInclude || (KvWatchInclude = {}));\nvar DirectMsgHeaders;\n(function (DirectMsgHeaders) {\n  DirectMsgHeaders[\"Stream\"] = \"Nats-Stream\";\n  DirectMsgHeaders[\"Sequence\"] = \"Nats-Sequence\";\n  DirectMsgHeaders[\"TimeStamp\"] = \"Nats-Time-Stamp\";\n  DirectMsgHeaders[\"Subject\"] = \"Nats-Subject\";\n})(DirectMsgHeaders || (DirectMsgHeaders = {}));\nvar RepublishHeaders;\n(function (RepublishHeaders) {\n  RepublishHeaders[\"Stream\"] = \"Nats-Stream\";\n  RepublishHeaders[\"Subject\"] = \"Nats-Subject\";\n  RepublishHeaders[\"Sequence\"] = \"Nats-Sequence\";\n  RepublishHeaders[\"LastSequence\"] = \"Nats-Last-Sequence\";\n  RepublishHeaders[\"Size\"] = \"Nats-Msg-Size\";\n})(RepublishHeaders || (RepublishHeaders = {}));\nconst kvPrefix = \"KV_\";\nclass ConsumerOptsBuilderImpl {\n  config;\n  ordered;\n  mack;\n  stream;\n  callbackFn;\n  max;\n  qname;\n  isBind;\n  filters;\n  constructor(opts) {\n    this.stream = \"\";\n    this.mack = false;\n    this.ordered = false;\n    this.config = defaultConsumer(\"\", opts || {});\n  }\n  getOpts() {\n    const o = {};\n    o.config = Object.assign({}, this.config);\n    if (o.config.filter_subject) {\n      this.filterSubject(o.config.filter_subject);\n      o.config.filter_subject = undefined;\n    }\n    if (o.config.filter_subjects) {\n      o.config.filter_subjects?.forEach(v => {\n        this.filterSubject(v);\n      });\n      o.config.filter_subjects = undefined;\n    }\n    o.mack = this.mack;\n    o.stream = this.stream;\n    o.callbackFn = this.callbackFn;\n    o.max = this.max;\n    o.queue = this.qname;\n    o.ordered = this.ordered;\n    o.config.ack_policy = o.ordered ? AckPolicy.None : o.config.ack_policy;\n    o.isBind = o.isBind || false;\n    if (this.filters) {\n      switch (this.filters.length) {\n        case 0:\n          break;\n        case 1:\n          o.config.filter_subject = this.filters[0];\n          break;\n        default:\n          o.config.filter_subjects = this.filters;\n      }\n    }\n    return o;\n  }\n  description(description) {\n    this.config.description = description;\n    return this;\n  }\n  deliverTo(subject) {\n    this.config.deliver_subject = subject;\n    return this;\n  }\n  durable(name) {\n    validateDurableName(name);\n    this.config.durable_name = name;\n    return this;\n  }\n  startSequence(seq) {\n    if (seq <= 0) {\n      throw new Error(\"sequence must be greater than 0\");\n    }\n    this.config.deliver_policy = DeliverPolicy.StartSequence;\n    this.config.opt_start_seq = seq;\n    return this;\n  }\n  startTime(time) {\n    this.config.deliver_policy = DeliverPolicy.StartTime;\n    this.config.opt_start_time = time.toISOString();\n    return this;\n  }\n  deliverAll() {\n    this.config.deliver_policy = DeliverPolicy.All;\n    return this;\n  }\n  deliverLastPerSubject() {\n    this.config.deliver_policy = DeliverPolicy.LastPerSubject;\n    return this;\n  }\n  deliverLast() {\n    this.config.deliver_policy = DeliverPolicy.Last;\n    return this;\n  }\n  deliverNew() {\n    this.config.deliver_policy = DeliverPolicy.New;\n    return this;\n  }\n  startAtTimeDelta(millis) {\n    this.startTime(new Date(Date.now() - millis));\n    return this;\n  }\n  headersOnly() {\n    this.config.headers_only = true;\n    return this;\n  }\n  ackNone() {\n    this.config.ack_policy = AckPolicy.None;\n    return this;\n  }\n  ackAll() {\n    this.config.ack_policy = AckPolicy.All;\n    return this;\n  }\n  ackExplicit() {\n    this.config.ack_policy = AckPolicy.Explicit;\n    return this;\n  }\n  ackWait(millis) {\n    this.config.ack_wait = nanos(millis);\n    return this;\n  }\n  maxDeliver(max) {\n    this.config.max_deliver = max;\n    return this;\n  }\n  filterSubject(s) {\n    this.filters = this.filters || [];\n    this.filters.push(s);\n    return this;\n  }\n  replayInstantly() {\n    this.config.replay_policy = ReplayPolicy.Instant;\n    return this;\n  }\n  replayOriginal() {\n    this.config.replay_policy = ReplayPolicy.Original;\n    return this;\n  }\n  sample(n) {\n    n = Math.trunc(n);\n    if (n < 0 || n > 100) {\n      throw new Error(`value must be between 0-100`);\n    }\n    this.config.sample_freq = `${n}%`;\n    return this;\n  }\n  limit(n) {\n    this.config.rate_limit_bps = n;\n    return this;\n  }\n  maxWaiting(max) {\n    this.config.max_waiting = max;\n    return this;\n  }\n  maxAckPending(max) {\n    this.config.max_ack_pending = max;\n    return this;\n  }\n  idleHeartbeat(millis) {\n    this.config.idle_heartbeat = nanos(millis);\n    return this;\n  }\n  flowControl() {\n    this.config.flow_control = true;\n    return this;\n  }\n  deliverGroup(name) {\n    this.queue(name);\n    return this;\n  }\n  manualAck() {\n    this.mack = true;\n    return this;\n  }\n  maxMessages(max) {\n    this.max = max;\n    return this;\n  }\n  callback(fn) {\n    this.callbackFn = fn;\n    return this;\n  }\n  queue(n) {\n    this.qname = n;\n    this.config.deliver_group = n;\n    return this;\n  }\n  orderedConsumer() {\n    this.ordered = true;\n    return this;\n  }\n  bind(stream, durable) {\n    this.stream = stream;\n    this.config.durable_name = durable;\n    this.isBind = true;\n    return this;\n  }\n  bindStream(stream) {\n    this.stream = stream;\n    return this;\n  }\n  inactiveEphemeralThreshold(millis) {\n    this.config.inactive_threshold = nanos(millis);\n    return this;\n  }\n  maxPullBatch(n) {\n    this.config.max_batch = n;\n    return this;\n  }\n  maxPullRequestExpires(millis) {\n    this.config.max_expires = nanos(millis);\n    return this;\n  }\n  memory() {\n    this.config.mem_storage = true;\n    return this;\n  }\n  numReplicas(n) {\n    this.config.num_replicas = n;\n    return this;\n  }\n  consumerName(n) {\n    this.config.name = n;\n    return this;\n  }\n}\nfunction consumerOpts(opts) {\n  return new ConsumerOptsBuilderImpl(opts);\n}\nfunction isConsumerOptsBuilder(o) {\n  return typeof o.getOpts === \"function\";\n}\nclass Base64Codec {\n  static encode(bytes) {\n    if (typeof bytes === \"string\") {\n      return btoa(bytes);\n    }\n    const a = Array.from(bytes);\n    return btoa(String.fromCharCode(...a));\n  }\n  static decode(s, binary = false) {\n    const bin = atob(s);\n    if (!binary) {\n      return bin;\n    }\n    return Uint8Array.from(bin, c => c.charCodeAt(0));\n  }\n}\nclass Base64UrlPaddedCodec {\n  static encode(bytes) {\n    return Base64UrlPaddedCodec.toB64URLEncoding(Base64Codec.encode(bytes));\n  }\n  static decode(s, binary = false) {\n    return Base64UrlPaddedCodec.decode(Base64UrlPaddedCodec.fromB64URLEncoding(s), binary);\n  }\n  static toB64URLEncoding(b64str) {\n    return b64str.replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n  }\n  static fromB64URLEncoding(b64str) {\n    return b64str.replace(/_/g, \"/\").replace(/-/g, \"+\");\n  }\n}\nclass DataBuffer {\n  buffers;\n  byteLength;\n  constructor() {\n    this.buffers = [];\n    this.byteLength = 0;\n  }\n  static concat(...bufs) {\n    let max = 0;\n    for (let i = 0; i < bufs.length; i++) {\n      max += bufs[i].length;\n    }\n    const out = new Uint8Array(max);\n    let index = 0;\n    for (let i = 0; i < bufs.length; i++) {\n      out.set(bufs[i], index);\n      index += bufs[i].length;\n    }\n    return out;\n  }\n  static fromAscii(m) {\n    if (!m) {\n      m = \"\";\n    }\n    return TE.encode(m);\n  }\n  static toAscii(a) {\n    return TD.decode(a);\n  }\n  reset() {\n    this.buffers.length = 0;\n    this.byteLength = 0;\n  }\n  pack() {\n    if (this.buffers.length > 1) {\n      const v = new Uint8Array(this.byteLength);\n      let index = 0;\n      for (let i = 0; i < this.buffers.length; i++) {\n        v.set(this.buffers[i], index);\n        index += this.buffers[i].length;\n      }\n      this.buffers.length = 0;\n      this.buffers.push(v);\n    }\n  }\n  shift() {\n    if (this.buffers.length) {\n      const a = this.buffers.shift();\n      if (a) {\n        this.byteLength -= a.length;\n        return a;\n      }\n    }\n    return new Uint8Array(0);\n  }\n  drain(n) {\n    if (this.buffers.length) {\n      this.pack();\n      const v = this.buffers.pop();\n      if (v) {\n        const max = this.byteLength;\n        if (n === undefined || n > max) {\n          n = max;\n        }\n        const d = v.subarray(0, n);\n        if (max > n) {\n          this.buffers.push(v.subarray(n));\n        }\n        this.byteLength = max - n;\n        return d;\n      }\n    }\n    return new Uint8Array(0);\n  }\n  fill(a, ...bufs) {\n    if (a) {\n      this.buffers.push(a);\n      this.byteLength += a.length;\n    }\n    for (let i = 0; i < bufs.length; i++) {\n      if (bufs[i] && bufs[i].length) {\n        this.buffers.push(bufs[i]);\n        this.byteLength += bufs[i].length;\n      }\n    }\n  }\n  peek() {\n    if (this.buffers.length) {\n      this.pack();\n      return this.buffers[0];\n    }\n    return new Uint8Array(0);\n  }\n  size() {\n    return this.byteLength;\n  }\n  length() {\n    return this.buffers.length;\n  }\n}\nfunction getLengths(b64) {\n  const len = b64.length;\n  let validLen = b64.indexOf(\"=\");\n  if (validLen === -1) {\n    validLen = len;\n  }\n  const placeHoldersLen = validLen === len ? 0 : 4 - validLen % 4;\n  return [validLen, placeHoldersLen];\n}\nfunction init(lookup, revLookup, urlsafe = false) {\n  function _byteLength(validLen, placeHoldersLen) {\n    return Math.floor((validLen + placeHoldersLen) * 3 / 4 - placeHoldersLen);\n  }\n  function tripletToBase64(num) {\n    return lookup[num >> 18 & 0x3f] + lookup[num >> 12 & 0x3f] + lookup[num >> 6 & 0x3f] + lookup[num & 0x3f];\n  }\n  function encodeChunk(buf, start, end) {\n    const out = new Array((end - start) / 3);\n    for (let i = start, curTriplet = 0; i < end; i += 3) {\n      out[curTriplet++] = tripletToBase64((buf[i] << 16) + (buf[i + 1] << 8) + buf[i + 2]);\n    }\n    return out.join(\"\");\n  }\n  return {\n    byteLength(b64) {\n      return _byteLength.apply(null, getLengths(b64));\n    },\n    toUint8Array(b64) {\n      const [validLen, placeHoldersLen] = getLengths(b64);\n      const buf = new Uint8Array(_byteLength(validLen, placeHoldersLen));\n      const len = placeHoldersLen ? validLen - 4 : validLen;\n      let tmp;\n      let curByte = 0;\n      let i;\n      for (i = 0; i < len; i += 4) {\n        tmp = revLookup[b64.charCodeAt(i)] << 18 | revLookup[b64.charCodeAt(i + 1)] << 12 | revLookup[b64.charCodeAt(i + 2)] << 6 | revLookup[b64.charCodeAt(i + 3)];\n        buf[curByte++] = tmp >> 16 & 0xff;\n        buf[curByte++] = tmp >> 8 & 0xff;\n        buf[curByte++] = tmp & 0xff;\n      }\n      if (placeHoldersLen === 2) {\n        tmp = revLookup[b64.charCodeAt(i)] << 2 | revLookup[b64.charCodeAt(i + 1)] >> 4;\n        buf[curByte++] = tmp & 0xff;\n      } else if (placeHoldersLen === 1) {\n        tmp = revLookup[b64.charCodeAt(i)] << 10 | revLookup[b64.charCodeAt(i + 1)] << 4 | revLookup[b64.charCodeAt(i + 2)] >> 2;\n        buf[curByte++] = tmp >> 8 & 0xff;\n        buf[curByte++] = tmp & 0xff;\n      }\n      return buf;\n    },\n    fromUint8Array(buf) {\n      const maxChunkLength = 16383;\n      const len = buf.length;\n      const extraBytes = len % 3;\n      const len2 = len - extraBytes;\n      const parts = new Array(Math.ceil(len2 / 16383) + (extraBytes ? 1 : 0));\n      let curChunk = 0;\n      let chunkEnd;\n      for (let i = 0; i < len2; i += maxChunkLength) {\n        chunkEnd = i + maxChunkLength;\n        parts[curChunk++] = encodeChunk(buf, i, chunkEnd > len2 ? len2 : chunkEnd);\n      }\n      let tmp;\n      if (extraBytes === 1) {\n        tmp = buf[len2];\n        parts[curChunk] = lookup[tmp >> 2] + lookup[tmp << 4 & 0x3f];\n        if (!urlsafe) parts[curChunk] += \"==\";\n      } else if (extraBytes === 2) {\n        tmp = buf[len2] << 8 | buf[len2 + 1] & 0xff;\n        parts[curChunk] = lookup[tmp >> 10] + lookup[tmp >> 4 & 0x3f] + lookup[tmp << 2 & 0x3f];\n        if (!urlsafe) parts[curChunk] += \"=\";\n      }\n      return parts.join(\"\");\n    }\n  };\n}\nconst lookup = [];\nconst revLookup = [];\nconst code = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\";\nfor (let i = 0, l = code.length; i < l; ++i) {\n  lookup[i] = code[i];\n  revLookup[code.charCodeAt(i)] = i;\n}\nconst {\n  byteLength,\n  toUint8Array,\n  fromUint8Array\n} = init(lookup, revLookup, true);\nconst decoder = new TextDecoder();\nconst encoder = new TextEncoder();\nfunction toHexString(buf) {\n  return buf.reduce((hex, __byte) => `${hex}${__byte < 16 ? \"0\" : \"\"}${__byte.toString(16)}`, \"\");\n}\nfunction fromHexString(hex) {\n  const len = hex.length;\n  if (len % 2 || !/^[0-9a-fA-F]+$/.test(hex)) {\n    throw new TypeError(\"Invalid hex string.\");\n  }\n  hex = hex.toLowerCase();\n  const buf = new Uint8Array(Math.floor(len / 2));\n  const end = len / 2;\n  for (let i = 0; i < end; ++i) {\n    buf[i] = parseInt(hex.substr(i * 2, 2), 16);\n  }\n  return buf;\n}\nfunction decode1(buf, encoding = \"utf8\") {\n  if (/^utf-?8$/i.test(encoding)) {\n    return decoder.decode(buf);\n  } else if (/^base64$/i.test(encoding)) {\n    return fromUint8Array(buf);\n  } else if (/^hex(?:adecimal)?$/i.test(encoding)) {\n    return toHexString(buf);\n  } else {\n    throw new TypeError(\"Unsupported string encoding.\");\n  }\n}\nfunction encode1(str, encoding = \"utf8\") {\n  if (/^utf-?8$/i.test(encoding)) {\n    return encoder.encode(str);\n  } else if (/^base64$/i.test(encoding)) {\n    return toUint8Array(str);\n  } else if (/^hex(?:adecimal)?$/i.test(encoding)) {\n    return fromHexString(str);\n  } else {\n    throw new TypeError(\"Unsupported string encoding.\");\n  }\n}\nclass SHA256 {\n  hashSize = 32;\n  _buf;\n  _bufIdx;\n  _count;\n  _K;\n  _H;\n  _finalized;\n  constructor() {\n    this._buf = new Uint8Array(64);\n    this._K = new Uint32Array([0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2]);\n    this.init();\n  }\n  init() {\n    this._H = new Uint32Array([0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19]);\n    this._bufIdx = 0;\n    this._count = new Uint32Array(2);\n    this._buf.fill(0);\n    this._finalized = false;\n    return this;\n  }\n  update(msg, inputEncoding) {\n    if (msg === null) {\n      throw new TypeError(\"msg must be a string or Uint8Array.\");\n    } else if (typeof msg === \"string\") {\n      msg = encode1(msg, inputEncoding);\n    }\n    for (let i = 0, len = msg.length; i < len; i++) {\n      this._buf[this._bufIdx++] = msg[i];\n      if (this._bufIdx === 64) {\n        this._transform();\n        this._bufIdx = 0;\n      }\n    }\n    const c = this._count;\n    if ((c[0] += msg.length << 3) < msg.length << 3) {\n      c[1]++;\n    }\n    c[1] += msg.length >>> 29;\n    return this;\n  }\n  digest(outputEncoding) {\n    if (this._finalized) {\n      throw new Error(\"digest has already been called.\");\n    }\n    this._finalized = true;\n    const b = this._buf;\n    let idx = this._bufIdx;\n    b[idx++] = 0x80;\n    while (idx !== 56) {\n      if (idx === 64) {\n        this._transform();\n        idx = 0;\n      }\n      b[idx++] = 0;\n    }\n    const c = this._count;\n    b[56] = c[1] >>> 24 & 0xff;\n    b[57] = c[1] >>> 16 & 0xff;\n    b[58] = c[1] >>> 8 & 0xff;\n    b[59] = c[1] >>> 0 & 0xff;\n    b[60] = c[0] >>> 24 & 0xff;\n    b[61] = c[0] >>> 16 & 0xff;\n    b[62] = c[0] >>> 8 & 0xff;\n    b[63] = c[0] >>> 0 & 0xff;\n    this._transform();\n    const hash = new Uint8Array(32);\n    for (let i = 0; i < 8; i++) {\n      hash[(i << 2) + 0] = this._H[i] >>> 24 & 0xff;\n      hash[(i << 2) + 1] = this._H[i] >>> 16 & 0xff;\n      hash[(i << 2) + 2] = this._H[i] >>> 8 & 0xff;\n      hash[(i << 2) + 3] = this._H[i] >>> 0 & 0xff;\n    }\n    this.init();\n    return outputEncoding ? decode1(hash, outputEncoding) : hash;\n  }\n  _transform() {\n    const h = this._H;\n    let h0 = h[0];\n    let h1 = h[1];\n    let h2 = h[2];\n    let h3 = h[3];\n    let h4 = h[4];\n    let h5 = h[5];\n    let h6 = h[6];\n    let h7 = h[7];\n    const w = new Uint32Array(16);\n    let i;\n    for (i = 0; i < 16; i++) {\n      w[i] = this._buf[(i << 2) + 3] | this._buf[(i << 2) + 2] << 8 | this._buf[(i << 2) + 1] << 16 | this._buf[i << 2] << 24;\n    }\n    for (i = 0; i < 64; i++) {\n      let tmp;\n      if (i < 16) {\n        tmp = w[i];\n      } else {\n        let a = w[i + 1 & 15];\n        let b = w[i + 14 & 15];\n        tmp = w[i & 15] = (a >>> 7 ^ a >>> 18 ^ a >>> 3 ^ a << 25 ^ a << 14) + (b >>> 17 ^ b >>> 19 ^ b >>> 10 ^ b << 15 ^ b << 13) + w[i & 15] + w[i + 9 & 15] | 0;\n      }\n      tmp = tmp + h7 + (h4 >>> 6 ^ h4 >>> 11 ^ h4 >>> 25 ^ h4 << 26 ^ h4 << 21 ^ h4 << 7) + (h6 ^ h4 & (h5 ^ h6)) + this._K[i] | 0;\n      h7 = h6;\n      h6 = h5;\n      h5 = h4;\n      h4 = h3 + tmp;\n      h3 = h2;\n      h2 = h1;\n      h1 = h0;\n      h0 = tmp + (h1 & h2 ^ h3 & (h1 ^ h2)) + (h1 >>> 2 ^ h1 >>> 13 ^ h1 >>> 22 ^ h1 << 30 ^ h1 << 19 ^ h1 << 10) | 0;\n    }\n    h[0] = h[0] + h0 | 0;\n    h[1] = h[1] + h1 | 0;\n    h[2] = h[2] + h2 | 0;\n    h[3] = h[3] + h3 | 0;\n    h[4] = h[4] + h4 | 0;\n    h[5] = h[5] + h5 | 0;\n    h[6] = h[6] + h6 | 0;\n    h[7] = h[7] + h7 | 0;\n  }\n}\nclass BaseRequest {\n  token;\n  received;\n  ctx;\n  requestSubject;\n  mux;\n  constructor(mux, requestSubject, asyncTraces = true) {\n    this.mux = mux;\n    this.requestSubject = requestSubject;\n    this.received = 0;\n    this.token = nuid.next();\n    if (asyncTraces) {\n      this.ctx = new Error();\n    }\n  }\n}\nclass RequestMany extends BaseRequest {\n  callback;\n  done;\n  timer;\n  max;\n  opts;\n  constructor(mux, requestSubject, opts = {\n    maxWait: 1000\n  }) {\n    super(mux, requestSubject);\n    this.opts = opts;\n    if (typeof this.opts.callback !== \"function\") {\n      throw new Error(\"callback is required\");\n    }\n    this.callback = this.opts.callback;\n    this.max = typeof opts.maxMessages === \"number\" && opts.maxMessages > 0 ? opts.maxMessages : -1;\n    this.done = deferred();\n    this.done.then(() => {\n      this.callback(null, null);\n    });\n    this.timer = setTimeout(() => {\n      this.cancel();\n    }, opts.maxWait);\n  }\n  cancel(err) {\n    if (err) {\n      this.callback(err, null);\n    }\n    clearTimeout(this.timer);\n    this.mux.cancel(this);\n    this.done.resolve();\n  }\n  resolver(err, msg) {\n    if (err) {\n      if (this.ctx) {\n        err.stack += `\\n\\n${this.ctx.stack}`;\n      }\n      this.cancel(err);\n    } else {\n      this.callback(null, msg);\n      if (this.opts.strategy === RequestStrategy.Count) {\n        this.max--;\n        if (this.max === 0) {\n          this.cancel();\n        }\n      }\n      if (this.opts.strategy === RequestStrategy.JitterTimer) {\n        clearTimeout(this.timer);\n        this.timer = setTimeout(() => {\n          this.cancel();\n        }, this.opts.jitter || 300);\n      }\n      if (this.opts.strategy === RequestStrategy.SentinelMsg) {\n        if (msg && msg.data.length === 0) {\n          this.cancel();\n        }\n      }\n    }\n  }\n}\nclass RequestOne extends BaseRequest {\n  deferred;\n  timer;\n  constructor(mux, requestSubject, opts = {\n    timeout: 1000\n  }, asyncTraces = true) {\n    super(mux, requestSubject, asyncTraces);\n    this.deferred = deferred();\n    this.timer = timeout(opts.timeout, asyncTraces);\n  }\n  resolver(err, msg) {\n    if (this.timer) {\n      this.timer.cancel();\n    }\n    if (err) {\n      if (this.ctx) {\n        err.stack += `\\n\\n${this.ctx.stack}`;\n      }\n      this.deferred.reject(err);\n    } else {\n      this.deferred.resolve(msg);\n    }\n    this.cancel();\n  }\n  cancel(err) {\n    if (this.timer) {\n      this.timer.cancel();\n    }\n    this.mux.cancel(this);\n    this.deferred.reject(err ? err : NatsError.errorForCode(ErrorCode.Cancelled));\n  }\n}\nconst defaultPrefix = \"$JS.API\";\nfunction defaultJsOptions(opts) {\n  opts = opts || {};\n  if (opts.domain) {\n    opts.apiPrefix = `$JS.${opts.domain}.API`;\n    delete opts.domain;\n  }\n  return extend({\n    apiPrefix: defaultPrefix,\n    timeout: 5000\n  }, opts);\n}\nclass BaseApiClient {\n  nc;\n  opts;\n  prefix;\n  timeout;\n  jc;\n  constructor(nc, opts) {\n    this.nc = nc;\n    this.opts = defaultJsOptions(opts);\n    this._parseOpts();\n    this.prefix = this.opts.apiPrefix;\n    this.timeout = this.opts.timeout;\n    this.jc = JSONCodec();\n  }\n  getOptions() {\n    return Object.assign({}, this.opts);\n  }\n  _parseOpts() {\n    let prefix = this.opts.apiPrefix;\n    if (!prefix || prefix.length === 0) {\n      throw new Error(\"invalid empty prefix\");\n    }\n    const c = prefix[prefix.length - 1];\n    if (c === \".\") {\n      prefix = prefix.substr(0, prefix.length - 1);\n    }\n    this.opts.apiPrefix = prefix;\n  }\n  async _request(subj, data = null, opts) {\n    opts = opts || {};\n    opts.timeout = this.timeout;\n    let a = Empty;\n    if (data) {\n      a = this.jc.encode(data);\n    }\n    let {\n      retries\n    } = opts;\n    retries = retries || 1;\n    retries = retries === -1 ? Number.MAX_SAFE_INTEGER : retries;\n    const bo = backoff();\n    for (let i = 0; i < retries; i++) {\n      try {\n        const m = await this.nc.request(subj, a, opts);\n        return this.parseJsResponse(m);\n      } catch (err) {\n        const ne = err;\n        if ((ne.code === \"503\" || ne.code === ErrorCode.Timeout) && i + 1 < retries) {\n          await delay(bo.backoff(i));\n        } else {\n          throw err;\n        }\n      }\n    }\n  }\n  async findStream(subject) {\n    const q = {\n      subject\n    };\n    const r = await this._request(`${this.prefix}.STREAM.NAMES`, q);\n    const names = r;\n    if (!names.streams || names.streams.length !== 1) {\n      throw new Error(\"no stream matches subject\");\n    }\n    return names.streams[0];\n  }\n  getConnection() {\n    return this.nc;\n  }\n  parseJsResponse(m) {\n    const v = this.jc.decode(m.data);\n    const r = v;\n    if (r.error) {\n      const err = checkJsErrorCode(r.error.code, r.error.description);\n      if (err !== null) {\n        err.api_error = r.error;\n        throw err;\n      }\n    }\n    return v;\n  }\n}\nclass ListerImpl {\n  err;\n  offset;\n  pageInfo;\n  subject;\n  jsm;\n  filter;\n  payload;\n  constructor(subject, filter, jsm, payload) {\n    if (!subject) {\n      throw new Error(\"subject is required\");\n    }\n    this.subject = subject;\n    this.jsm = jsm;\n    this.offset = 0;\n    this.pageInfo = {};\n    this.filter = filter;\n    this.payload = payload || {};\n  }\n  async next() {\n    if (this.err) {\n      return [];\n    }\n    if (this.pageInfo && this.offset >= this.pageInfo.total) {\n      return [];\n    }\n    const offset = {\n      offset: this.offset\n    };\n    if (this.payload) {\n      Object.assign(offset, this.payload);\n    }\n    try {\n      const r = await this.jsm._request(this.subject, offset, {\n        timeout: this.jsm.timeout\n      });\n      this.pageInfo = r;\n      const count = this.countResponse(r);\n      if (count === 0) {\n        return [];\n      }\n      this.offset += count;\n      const a = this.filter(r);\n      return a;\n    } catch (err) {\n      this.err = err;\n      throw err;\n    }\n  }\n  countResponse(r) {\n    switch (r?.type) {\n      case \"io.nats.jetstream.api.v1.stream_names_response\":\n      case \"io.nats.jetstream.api.v1.stream_list_response\":\n        return r.streams?.length || 0;\n      case \"io.nats.jetstream.api.v1.consumer_list_response\":\n        return r.consumers?.length || 0;\n      default:\n        console.error(`jslister.ts: unknown API response for paged output: ${r?.type}`);\n        return r.streams?.length || 0;\n    }\n    return 0;\n  }\n  async *[Symbol.asyncIterator]() {\n    let page = await this.next();\n    while (page.length > 0) {\n      for (const item of page) {\n        yield item;\n      }\n      page = await this.next();\n    }\n  }\n}\nfunction parseSemVer(s = \"\") {\n  const m = s.match(/(\\d+).(\\d+).(\\d+)/);\n  if (m) {\n    return {\n      major: parseInt(m[1]),\n      minor: parseInt(m[2]),\n      micro: parseInt(m[3])\n    };\n  }\n  throw new Error(`'${s}' is not a semver value`);\n}\nfunction compare(a, b) {\n  if (a.major < b.major) return -1;\n  if (a.major > b.major) return 1;\n  if (a.minor < b.minor) return -1;\n  if (a.minor > b.minor) return 1;\n  if (a.micro < b.micro) return -1;\n  if (a.micro > b.micro) return 1;\n  return 0;\n}\nvar Feature;\n(function (Feature) {\n  Feature[\"JS_KV\"] = \"js_kv\";\n  Feature[\"JS_OBJECTSTORE\"] = \"js_objectstore\";\n  Feature[\"JS_PULL_MAX_BYTES\"] = \"js_pull_max_bytes\";\n  Feature[\"JS_NEW_CONSUMER_CREATE_API\"] = \"js_new_consumer_create\";\n  Feature[\"JS_ALLOW_DIRECT\"] = \"js_allow_direct\";\n  Feature[\"JS_MULTIPLE_CONSUMER_FILTER\"] = \"js_multiple_consumer_filter\";\n  Feature[\"JS_SIMPLIFICATION\"] = \"js_simplification\";\n  Feature[\"JS_STREAM_CONSUMER_METADATA\"] = \"js_stream_consumer_metadata\";\n  Feature[\"JS_CONSUMER_FILTER_SUBJECTS\"] = \"js_consumer_filter_subjects\";\n  Feature[\"JS_STREAM_FIRST_SEQ\"] = \"js_stream_first_seq\";\n  Feature[\"JS_STREAM_SUBJECT_TRANSFORM\"] = \"js_stream_subject_transform\";\n  Feature[\"JS_STREAM_SOURCE_SUBJECT_TRANSFORM\"] = \"js_stream_source_subject_transform\";\n  Feature[\"JS_STREAM_COMPRESSION\"] = \"js_stream_compression\";\n  Feature[\"JS_DEFAULT_CONSUMER_LIMITS\"] = \"js_default_consumer_limits\";\n  Feature[\"JS_BATCH_DIRECT_GET\"] = \"js_batch_direct_get\";\n})(Feature || (Feature = {}));\nclass Features {\n  server;\n  features;\n  disabled;\n  constructor(v) {\n    this.features = new Map();\n    this.disabled = [];\n    this.update(v);\n  }\n  resetDisabled() {\n    this.disabled.length = 0;\n    this.update(this.server);\n  }\n  disable(f) {\n    this.disabled.push(f);\n    this.update(this.server);\n  }\n  isDisabled(f) {\n    return this.disabled.indexOf(f) !== -1;\n  }\n  update(v) {\n    if (typeof v === \"string\") {\n      v = parseSemVer(v);\n    }\n    this.server = v;\n    this.set(Feature.JS_KV, \"2.6.2\");\n    this.set(Feature.JS_OBJECTSTORE, \"2.6.3\");\n    this.set(Feature.JS_PULL_MAX_BYTES, \"2.8.3\");\n    this.set(Feature.JS_NEW_CONSUMER_CREATE_API, \"2.9.0\");\n    this.set(Feature.JS_ALLOW_DIRECT, \"2.9.0\");\n    this.set(Feature.JS_MULTIPLE_CONSUMER_FILTER, \"2.10.0\");\n    this.set(Feature.JS_SIMPLIFICATION, \"2.9.4\");\n    this.set(Feature.JS_STREAM_CONSUMER_METADATA, \"2.10.0\");\n    this.set(Feature.JS_CONSUMER_FILTER_SUBJECTS, \"2.10.0\");\n    this.set(Feature.JS_STREAM_FIRST_SEQ, \"2.10.0\");\n    this.set(Feature.JS_STREAM_SUBJECT_TRANSFORM, \"2.10.0\");\n    this.set(Feature.JS_STREAM_SOURCE_SUBJECT_TRANSFORM, \"2.10.0\");\n    this.set(Feature.JS_STREAM_COMPRESSION, \"2.10.0\");\n    this.set(Feature.JS_DEFAULT_CONSUMER_LIMITS, \"2.10.0\");\n    this.set(Feature.JS_BATCH_DIRECT_GET, \"2.11.0\");\n    this.disabled.forEach(f => {\n      this.features.delete(f);\n    });\n  }\n  set(f, requires) {\n    this.features.set(f, {\n      min: requires,\n      ok: compare(this.server, parseSemVer(requires)) >= 0\n    });\n  }\n  get(f) {\n    return this.features.get(f) || {\n      min: \"unknown\",\n      ok: false\n    };\n  }\n  supports(f) {\n    return this.get(f)?.ok || false;\n  }\n  require(v) {\n    if (typeof v === \"string\") {\n      v = parseSemVer(v);\n    }\n    return compare(this.server, v) >= 0;\n  }\n}\nclass ConsumerAPIImpl extends BaseApiClient {\n  constructor(nc, opts) {\n    super(nc, opts);\n  }\n  async add(stream, cfg, action = ConsumerApiAction.Create) {\n    validateStreamName(stream);\n    if (cfg.deliver_group && cfg.flow_control) {\n      throw new Error(\"jetstream flow control is not supported with queue groups\");\n    }\n    if (cfg.deliver_group && cfg.idle_heartbeat) {\n      throw new Error(\"jetstream idle heartbeat is not supported with queue groups\");\n    }\n    const cr = {};\n    cr.config = cfg;\n    cr.stream_name = stream;\n    cr.action = action;\n    if (cr.config.durable_name) {\n      validateDurableName(cr.config.durable_name);\n    }\n    const nci = this.nc;\n    let {\n      min,\n      ok: newAPI\n    } = nci.features.get(Feature.JS_NEW_CONSUMER_CREATE_API);\n    const name = cfg.name === \"\" ? undefined : cfg.name;\n    if (name && !newAPI) {\n      throw new Error(`consumer 'name' requires server ${min}`);\n    }\n    if (name) {\n      try {\n        minValidation(\"name\", name);\n      } catch (err) {\n        const m = err.message;\n        const idx = m.indexOf(\"cannot contain\");\n        if (idx !== -1) {\n          throw new Error(`consumer 'name' ${m.substring(idx)}`);\n        }\n        throw err;\n      }\n    }\n    let subj;\n    let consumerName = \"\";\n    if (Array.isArray(cfg.filter_subjects)) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_MULTIPLE_CONSUMER_FILTER);\n      if (!ok) {\n        throw new Error(`consumer 'filter_subjects' requires server ${min}`);\n      }\n      newAPI = false;\n    }\n    if (cfg.metadata) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_STREAM_CONSUMER_METADATA);\n      if (!ok) {\n        throw new Error(`consumer 'metadata' requires server ${min}`);\n      }\n    }\n    if (newAPI) {\n      consumerName = cfg.name ?? cfg.durable_name ?? \"\";\n    }\n    if (consumerName !== \"\") {\n      let fs = cfg.filter_subject ?? undefined;\n      if (fs === \">\") {\n        fs = undefined;\n      }\n      subj = fs !== undefined ? `${this.prefix}.CONSUMER.CREATE.${stream}.${consumerName}.${fs}` : `${this.prefix}.CONSUMER.CREATE.${stream}.${consumerName}`;\n    } else {\n      subj = cfg.durable_name ? `${this.prefix}.CONSUMER.DURABLE.CREATE.${stream}.${cfg.durable_name}` : `${this.prefix}.CONSUMER.CREATE.${stream}`;\n    }\n    const r = await this._request(subj, cr);\n    return r;\n  }\n  async update(stream, durable, cfg) {\n    const ci = await this.info(stream, durable);\n    const changable = cfg;\n    return this.add(stream, Object.assign(ci.config, changable), ConsumerApiAction.Update);\n  }\n  async info(stream, name) {\n    validateStreamName(stream);\n    validateDurableName(name);\n    const r = await this._request(`${this.prefix}.CONSUMER.INFO.${stream}.${name}`);\n    return r;\n  }\n  async delete(stream, name) {\n    validateStreamName(stream);\n    validateDurableName(name);\n    const r = await this._request(`${this.prefix}.CONSUMER.DELETE.${stream}.${name}`);\n    const cr = r;\n    return cr.success;\n  }\n  list(stream) {\n    validateStreamName(stream);\n    const filter = v => {\n      const clr = v;\n      return clr.consumers;\n    };\n    const subj = `${this.prefix}.CONSUMER.LIST.${stream}`;\n    return new ListerImpl(subj, filter, this);\n  }\n  pause(stream, name, until) {\n    const subj = `${this.prefix}.CONSUMER.PAUSE.${stream}.${name}`;\n    const opts = {\n      pause_until: until.toISOString()\n    };\n    return this._request(subj, opts);\n  }\n  resume(stream, name) {\n    return this.pause(stream, name, new Date(0));\n  }\n}\nfunction checkFn(fn, name, required = false) {\n  if (required === true && !fn) {\n    throw NatsError.errorForCode(ErrorCode.ApiError, new Error(`${name} is not a function`));\n  }\n  if (fn && typeof fn !== \"function\") {\n    throw NatsError.errorForCode(ErrorCode.ApiError, new Error(`${name} is not a function`));\n  }\n}\nclass TypedSubscription extends QueuedIteratorImpl {\n  sub;\n  adapter;\n  subIterDone;\n  constructor(nc, subject, opts) {\n    super();\n    checkFn(opts.adapter, \"adapter\", true);\n    this.adapter = opts.adapter;\n    if (opts.callback) {\n      checkFn(opts.callback, \"callback\");\n    }\n    this.noIterator = typeof opts.callback === \"function\";\n    if (opts.ingestionFilterFn) {\n      checkFn(opts.ingestionFilterFn, \"ingestionFilterFn\");\n      this.ingestionFilterFn = opts.ingestionFilterFn;\n    }\n    if (opts.protocolFilterFn) {\n      checkFn(opts.protocolFilterFn, \"protocolFilterFn\");\n      this.protocolFilterFn = opts.protocolFilterFn;\n    }\n    if (opts.dispatchedFn) {\n      checkFn(opts.dispatchedFn, \"dispatchedFn\");\n      this.dispatchedFn = opts.dispatchedFn;\n    }\n    if (opts.cleanupFn) {\n      checkFn(opts.cleanupFn, \"cleanupFn\");\n    }\n    let callback = (err, msg) => {\n      this.callback(err, msg);\n    };\n    if (opts.callback) {\n      const uh = opts.callback;\n      callback = (err, msg) => {\n        const [jer, tm] = this.adapter(err, msg);\n        if (jer) {\n          uh(jer, null);\n          return;\n        }\n        const {\n          ingest\n        } = this.ingestionFilterFn ? this.ingestionFilterFn(tm, this) : {\n          ingest: true\n        };\n        if (ingest) {\n          const ok = this.protocolFilterFn ? this.protocolFilterFn(tm) : true;\n          if (ok) {\n            uh(jer, tm);\n            if (this.dispatchedFn && tm) {\n              this.dispatchedFn(tm);\n            }\n          }\n        }\n      };\n    }\n    const {\n      max,\n      queue,\n      timeout\n    } = opts;\n    const sopts = {\n      queue,\n      timeout,\n      callback\n    };\n    if (max && max > 0) {\n      sopts.max = max;\n    }\n    this.sub = nc.subscribe(subject, sopts);\n    if (opts.cleanupFn) {\n      this.sub.cleanupFn = opts.cleanupFn;\n    }\n    if (!this.noIterator) {\n      this.iterClosed.then(() => {\n        this.unsubscribe();\n      });\n    }\n    this.subIterDone = deferred();\n    Promise.all([this.sub.closed, this.iterClosed]).then(() => {\n      this.subIterDone.resolve();\n    }).catch(() => {\n      this.subIterDone.resolve();\n    });\n    (async s => {\n      await s.closed;\n      this.stop();\n    })(this.sub).then().catch();\n  }\n  unsubscribe(max) {\n    this.sub.unsubscribe(max);\n  }\n  drain() {\n    return this.sub.drain();\n  }\n  isDraining() {\n    return this.sub.isDraining();\n  }\n  isClosed() {\n    return this.sub.isClosed();\n  }\n  callback(e, msg) {\n    this.sub.cancelTimeout();\n    const [err, tm] = this.adapter(e, msg);\n    if (err) {\n      this.stop(err);\n    }\n    if (tm) {\n      this.push(tm);\n    }\n  }\n  getSubject() {\n    return this.sub.getSubject();\n  }\n  getReceived() {\n    return this.sub.getReceived();\n  }\n  getProcessed() {\n    return this.sub.getProcessed();\n  }\n  getPending() {\n    return this.sub.getPending();\n  }\n  getID() {\n    return this.sub.getID();\n  }\n  getMax() {\n    return this.sub.getMax();\n  }\n  get closed() {\n    return this.sub.closed;\n  }\n}\nlet transportConfig;\nfunction setTransportFactory(config) {\n  transportConfig = config;\n}\nfunction defaultPort() {\n  return transportConfig !== undefined && transportConfig.defaultPort !== undefined ? transportConfig.defaultPort : 4222;\n}\nfunction getUrlParseFn() {\n  return transportConfig !== undefined && transportConfig.urlParseFn ? transportConfig.urlParseFn : undefined;\n}\nfunction newTransport() {\n  if (!transportConfig || typeof transportConfig.factory !== \"function\") {\n    throw new Error(\"transport fn is not set\");\n  }\n  return transportConfig.factory();\n}\nfunction getResolveFn() {\n  return transportConfig !== undefined && transportConfig.dnsResolveFn ? transportConfig.dnsResolveFn : undefined;\n}\nconst CR_LF = \"\\r\\n\";\nCR_LF.length;\nconst CRLF = DataBuffer.fromAscii(CR_LF);\nconst CR = new Uint8Array(CRLF)[0];\nconst LF = new Uint8Array(CRLF)[1];\nfunction protoLen(ba) {\n  for (let i = 0; i < ba.length; i++) {\n    const n = i + 1;\n    if (ba.byteLength > n && ba[i] === CR && ba[n] === LF) {\n      return n + 1;\n    }\n  }\n  return 0;\n}\nfunction extractProtocolMessage(a) {\n  const len = protoLen(a);\n  if (len > 0) {\n    const ba = new Uint8Array(a);\n    const out = ba.slice(0, len);\n    return TD.decode(out);\n  }\n  return \"\";\n}\nconst IPv4LEN = 4;\nconst ASCII0 = 48;\nconst ASCIIA = 65;\nconst ASCIIa = 97;\nfunction ipV4(a, b, c, d) {\n  const ip = new Uint8Array(16);\n  const prefix = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff];\n  prefix.forEach((v, idx) => {\n    ip[idx] = v;\n  });\n  ip[12] = a;\n  ip[13] = b;\n  ip[14] = c;\n  ip[15] = d;\n  return ip;\n}\nfunction isIP(h) {\n  return parseIP(h) !== undefined;\n}\nfunction parseIP(h) {\n  for (let i = 0; i < h.length; i++) {\n    switch (h[i]) {\n      case \".\":\n        return parseIPv4(h);\n      case \":\":\n        return parseIPv6(h);\n    }\n  }\n  return;\n}\nfunction parseIPv4(s) {\n  const ip = new Uint8Array(4);\n  for (let i = 0; i < 4; i++) {\n    if (s.length === 0) {\n      return undefined;\n    }\n    if (i > 0) {\n      if (s[0] !== \".\") {\n        return undefined;\n      }\n      s = s.substring(1);\n    }\n    const {\n      n,\n      c,\n      ok\n    } = dtoi(s);\n    if (!ok || n > 0xFF) {\n      return undefined;\n    }\n    s = s.substring(c);\n    ip[i] = n;\n  }\n  return ipV4(ip[0], ip[1], ip[2], ip[3]);\n}\nfunction parseIPv6(s) {\n  const ip = new Uint8Array(16);\n  let ellipsis = -1;\n  if (s.length >= 2 && s[0] === \":\" && s[1] === \":\") {\n    ellipsis = 0;\n    s = s.substring(2);\n    if (s.length === 0) {\n      return ip;\n    }\n  }\n  let i = 0;\n  while (i < 16) {\n    const {\n      n,\n      c,\n      ok\n    } = xtoi(s);\n    if (!ok || n > 0xFFFF) {\n      return undefined;\n    }\n    if (c < s.length && s[c] === \".\") {\n      if (ellipsis < 0 && i != 16 - 4) {\n        return undefined;\n      }\n      if (i + 4 > 16) {\n        return undefined;\n      }\n      const ip4 = parseIPv4(s);\n      if (ip4 === undefined) {\n        return undefined;\n      }\n      ip[i] = ip4[12];\n      ip[i + 1] = ip4[13];\n      ip[i + 2] = ip4[14];\n      ip[i + 3] = ip4[15];\n      s = \"\";\n      i += IPv4LEN;\n      break;\n    }\n    ip[i] = n >> 8;\n    ip[i + 1] = n;\n    i += 2;\n    s = s.substring(c);\n    if (s.length === 0) {\n      break;\n    }\n    if (s[0] !== \":\" || s.length == 1) {\n      return undefined;\n    }\n    s = s.substring(1);\n    if (s[0] === \":\") {\n      if (ellipsis >= 0) {\n        return undefined;\n      }\n      ellipsis = i;\n      s = s.substring(1);\n      if (s.length === 0) {\n        break;\n      }\n    }\n  }\n  if (s.length !== 0) {\n    return undefined;\n  }\n  if (i < 16) {\n    if (ellipsis < 0) {\n      return undefined;\n    }\n    const n = 16 - i;\n    for (let j = i - 1; j >= ellipsis; j--) {\n      ip[j + n] = ip[j];\n    }\n    for (let j = ellipsis + n - 1; j >= ellipsis; j--) {\n      ip[j] = 0;\n    }\n  } else if (ellipsis >= 0) {\n    return undefined;\n  }\n  return ip;\n}\nfunction dtoi(s) {\n  let i = 0;\n  let n = 0;\n  for (i = 0; i < s.length && 48 <= s.charCodeAt(i) && s.charCodeAt(i) <= 57; i++) {\n    n = n * 10 + (s.charCodeAt(i) - ASCII0);\n    if (n >= 0xFFFFFF) {\n      return {\n        n: 0xFFFFFF,\n        c: i,\n        ok: false\n      };\n    }\n  }\n  if (i === 0) {\n    return {\n      n: 0,\n      c: 0,\n      ok: false\n    };\n  }\n  return {\n    n: n,\n    c: i,\n    ok: true\n  };\n}\nfunction xtoi(s) {\n  let n = 0;\n  let i = 0;\n  for (i = 0; i < s.length; i++) {\n    if (48 <= s.charCodeAt(i) && s.charCodeAt(i) <= 57) {\n      n *= 16;\n      n += s.charCodeAt(i) - ASCII0;\n    } else if (97 <= s.charCodeAt(i) && s.charCodeAt(i) <= 102) {\n      n *= 16;\n      n += s.charCodeAt(i) - ASCIIa + 10;\n    } else if (65 <= s.charCodeAt(i) && s.charCodeAt(i) <= 70) {\n      n *= 16;\n      n += s.charCodeAt(i) - ASCIIA + 10;\n    } else {\n      break;\n    }\n    if (n >= 0xFFFFFF) {\n      return {\n        n: 0,\n        c: i,\n        ok: false\n      };\n    }\n  }\n  if (i === 0) {\n    return {\n      n: 0,\n      c: i,\n      ok: false\n    };\n  }\n  return {\n    n: n,\n    c: i,\n    ok: true\n  };\n}\nfunction isIPV4OrHostname(hp) {\n  if (hp.indexOf(\"[\") !== -1 || hp.indexOf(\"::\") !== -1) {\n    return false;\n  }\n  if (hp.indexOf(\".\") !== -1) {\n    return true;\n  }\n  if (hp.split(\":\").length <= 2) {\n    return true;\n  }\n  return false;\n}\nfunction isIPV6(hp) {\n  return !isIPV4OrHostname(hp);\n}\nfunction filterIpv6MappedToIpv4(hp) {\n  const prefix = \"::FFFF:\";\n  const idx = hp.toUpperCase().indexOf(prefix);\n  if (idx !== -1 && hp.indexOf(\".\") !== -1) {\n    let ip = hp.substring(idx + prefix.length);\n    ip = ip.replace(\"[\", \"\");\n    return ip.replace(\"]\", \"\");\n  }\n  return hp;\n}\nfunction hostPort(u) {\n  u = u.trim();\n  if (u.match(/^(.*:\\/\\/)(.*)/m)) {\n    u = u.replace(/^(.*:\\/\\/)(.*)/gm, \"$2\");\n  }\n  u = filterIpv6MappedToIpv4(u);\n  if (isIPV6(u) && u.indexOf(\"[\") === -1) {\n    u = `[${u}]`;\n  }\n  const op = isIPV6(u) ? u.match(/(]:)(\\d+)/) : u.match(/(:)(\\d+)/);\n  const port = op && op.length === 3 && op[1] && op[2] ? parseInt(op[2]) : 4222;\n  const protocol = port === 80 ? \"https\" : \"http\";\n  const url = new URL(`${protocol}://${u}`);\n  url.port = `${port}`;\n  let hostname = url.hostname;\n  if (hostname.charAt(0) === \"[\") {\n    hostname = hostname.substring(1, hostname.length - 1);\n  }\n  const listen = url.host;\n  return {\n    listen,\n    hostname,\n    port\n  };\n}\nclass ServerImpl {\n  src;\n  listen;\n  hostname;\n  port;\n  didConnect;\n  reconnects;\n  lastConnect;\n  gossiped;\n  tlsName;\n  resolves;\n  constructor(u, gossiped = false) {\n    this.src = u;\n    this.tlsName = \"\";\n    const v = hostPort(u);\n    this.listen = v.listen;\n    this.hostname = v.hostname;\n    this.port = v.port;\n    this.didConnect = false;\n    this.reconnects = 0;\n    this.lastConnect = 0;\n    this.gossiped = gossiped;\n  }\n  toString() {\n    return this.listen;\n  }\n  async resolve(opts) {\n    if (!opts.fn || opts.resolve === false) {\n      return [this];\n    }\n    const buf = [];\n    if (isIP(this.hostname)) {\n      return [this];\n    } else {\n      const ips = await opts.fn(this.hostname);\n      if (opts.debug) {\n        console.log(`resolve ${this.hostname} = ${ips.join(\",\")}`);\n      }\n      for (const ip of ips) {\n        const proto = this.port === 80 ? \"https\" : \"http\";\n        const url = new URL(`${proto}://${isIPV6(ip) ? \"[\" + ip + \"]\" : ip}`);\n        url.port = `${this.port}`;\n        const ss = new ServerImpl(url.host, false);\n        ss.tlsName = this.hostname;\n        buf.push(ss);\n      }\n    }\n    if (opts.randomize) {\n      shuffle(buf);\n    }\n    this.resolves = buf;\n    return buf;\n  }\n}\nclass Servers {\n  firstSelect;\n  servers;\n  currentServer;\n  tlsName;\n  randomize;\n  constructor(listens = [], opts = {}) {\n    this.firstSelect = true;\n    this.servers = [];\n    this.tlsName = \"\";\n    this.randomize = opts.randomize || false;\n    const urlParseFn = getUrlParseFn();\n    if (listens) {\n      listens.forEach(hp => {\n        hp = urlParseFn ? urlParseFn(hp) : hp;\n        this.servers.push(new ServerImpl(hp));\n      });\n      if (this.randomize) {\n        this.servers = shuffle(this.servers);\n      }\n    }\n    if (this.servers.length === 0) {\n      this.addServer(`${DEFAULT_HOST}:${defaultPort()}`, false);\n    }\n    this.currentServer = this.servers[0];\n  }\n  clear() {\n    this.servers.length = 0;\n  }\n  updateTLSName() {\n    const cs = this.getCurrentServer();\n    if (!isIP(cs.hostname)) {\n      this.tlsName = cs.hostname;\n      this.servers.forEach(s => {\n        if (s.gossiped) {\n          s.tlsName = this.tlsName;\n        }\n      });\n    }\n  }\n  getCurrentServer() {\n    return this.currentServer;\n  }\n  addServer(u, implicit = false) {\n    const urlParseFn = getUrlParseFn();\n    u = urlParseFn ? urlParseFn(u) : u;\n    const s = new ServerImpl(u, implicit);\n    if (isIP(s.hostname)) {\n      s.tlsName = this.tlsName;\n    }\n    this.servers.push(s);\n  }\n  selectServer() {\n    if (this.firstSelect) {\n      this.firstSelect = false;\n      return this.currentServer;\n    }\n    const t = this.servers.shift();\n    if (t) {\n      this.servers.push(t);\n      this.currentServer = t;\n    }\n    return t;\n  }\n  removeCurrentServer() {\n    this.removeServer(this.currentServer);\n  }\n  removeServer(server) {\n    if (server) {\n      const index = this.servers.indexOf(server);\n      this.servers.splice(index, 1);\n    }\n  }\n  length() {\n    return this.servers.length;\n  }\n  next() {\n    return this.servers.length ? this.servers[0] : undefined;\n  }\n  getServers() {\n    return this.servers;\n  }\n  update(info, encrypted) {\n    const added = [];\n    let deleted = [];\n    const urlParseFn = getUrlParseFn();\n    const discovered = new Map();\n    if (info.connect_urls && info.connect_urls.length > 0) {\n      info.connect_urls.forEach(hp => {\n        hp = urlParseFn ? urlParseFn(hp, encrypted) : hp;\n        const s = new ServerImpl(hp, true);\n        discovered.set(hp, s);\n      });\n    }\n    const toDelete = [];\n    this.servers.forEach((s, index) => {\n      const u = s.listen;\n      if (s.gossiped && this.currentServer.listen !== u && discovered.get(u) === undefined) {\n        toDelete.push(index);\n      }\n      discovered.delete(u);\n    });\n    toDelete.reverse();\n    toDelete.forEach(index => {\n      const removed = this.servers.splice(index, 1);\n      deleted = deleted.concat(removed[0].listen);\n    });\n    discovered.forEach((v, k) => {\n      this.servers.push(v);\n      added.push(k);\n    });\n    return {\n      added,\n      deleted\n    };\n  }\n}\nclass MuxSubscription {\n  baseInbox;\n  reqs;\n  constructor() {\n    this.reqs = new Map();\n  }\n  size() {\n    return this.reqs.size;\n  }\n  init(prefix) {\n    this.baseInbox = `${createInbox(prefix)}.`;\n    return this.baseInbox;\n  }\n  add(r) {\n    if (!isNaN(r.received)) {\n      r.received = 0;\n    }\n    this.reqs.set(r.token, r);\n  }\n  get(token) {\n    return this.reqs.get(token);\n  }\n  cancel(r) {\n    this.reqs.delete(r.token);\n  }\n  getToken(m) {\n    const s = m.subject || \"\";\n    if (s.indexOf(this.baseInbox) === 0) {\n      return s.substring(this.baseInbox.length);\n    }\n    return null;\n  }\n  all() {\n    return Array.from(this.reqs.values());\n  }\n  handleError(isMuxPermissionError, err) {\n    if (err && err.permissionContext) {\n      if (isMuxPermissionError) {\n        this.all().forEach(r => {\n          r.resolver(err, {});\n        });\n        return true;\n      }\n      const ctx = err.permissionContext;\n      if (ctx.operation === \"publish\") {\n        const req = this.all().find(s => {\n          return s.requestSubject === ctx.subject;\n        });\n        if (req) {\n          req.resolver(err, {});\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  dispatcher() {\n    return (err, m) => {\n      const token = this.getToken(m);\n      if (token) {\n        const r = this.get(token);\n        if (r) {\n          if (err === null && m.headers) {\n            err = isRequestError(m);\n          }\n          r.resolver(err, m);\n        }\n      }\n    };\n  }\n  close() {\n    const err = NatsError.errorForCode(ErrorCode.Timeout);\n    this.reqs.forEach(req => {\n      req.resolver(err, {});\n    });\n  }\n}\nclass Heartbeat {\n  ph;\n  interval;\n  maxOut;\n  timer;\n  pendings;\n  constructor(ph, interval, maxOut) {\n    this.ph = ph;\n    this.interval = interval;\n    this.maxOut = maxOut;\n    this.pendings = [];\n  }\n  start() {\n    this.cancel();\n    this._schedule();\n  }\n  cancel(stale) {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = undefined;\n    }\n    this._reset();\n    if (stale) {\n      this.ph.disconnect();\n    }\n  }\n  _schedule() {\n    this.timer = setTimeout(() => {\n      this.ph.dispatchStatus({\n        type: DebugEvents.PingTimer,\n        data: `${this.pendings.length + 1}`\n      });\n      if (this.pendings.length === this.maxOut) {\n        this.cancel(true);\n        return;\n      }\n      const ping = deferred();\n      this.ph.flush(ping).then(() => {\n        this._reset();\n      }).catch(() => {\n        this.cancel();\n      });\n      this.pendings.push(ping);\n      this._schedule();\n    }, this.interval);\n  }\n  _reset() {\n    this.pendings = this.pendings.filter(p => {\n      const d = p;\n      d.resolve();\n      return false;\n    });\n  }\n}\nclass AssertionError extends Error {\n  constructor(msg) {\n    super(msg);\n    this.name = \"AssertionError\";\n  }\n}\nfunction assert(cond, msg = \"Assertion failed.\") {\n  if (!cond) {\n    throw new AssertionError(msg);\n  }\n}\nconst MIN_READ = 32 * 1024;\nconst MAX_SIZE = 2 ** 32 - 2;\nfunction copy(src, dst, off = 0) {\n  const r = dst.byteLength - off;\n  if (src.byteLength > r) {\n    src = src.subarray(0, r);\n  }\n  dst.set(src, off);\n  return src.byteLength;\n}\nclass DenoBuffer {\n  _buf;\n  _off;\n  constructor(ab) {\n    this._off = 0;\n    if (ab == null) {\n      this._buf = new Uint8Array(0);\n      return;\n    }\n    this._buf = new Uint8Array(ab);\n  }\n  bytes(options = {\n    copy: true\n  }) {\n    if (options.copy === false) return this._buf.subarray(this._off);\n    return this._buf.slice(this._off);\n  }\n  empty() {\n    return this._buf.byteLength <= this._off;\n  }\n  get length() {\n    return this._buf.byteLength - this._off;\n  }\n  get capacity() {\n    return this._buf.buffer.byteLength;\n  }\n  truncate(n) {\n    if (n === 0) {\n      this.reset();\n      return;\n    }\n    if (n < 0 || n > this.length) {\n      throw Error(\"bytes.Buffer: truncation out of range\");\n    }\n    this._reslice(this._off + n);\n  }\n  reset() {\n    this._reslice(0);\n    this._off = 0;\n  }\n  _tryGrowByReslice(n) {\n    const l = this._buf.byteLength;\n    if (n <= this.capacity - l) {\n      this._reslice(l + n);\n      return l;\n    }\n    return -1;\n  }\n  _reslice(len) {\n    assert(len <= this._buf.buffer.byteLength);\n    this._buf = new Uint8Array(this._buf.buffer, 0, len);\n  }\n  readByte() {\n    const a = new Uint8Array(1);\n    if (this.read(a)) {\n      return a[0];\n    }\n    return null;\n  }\n  read(p) {\n    if (this.empty()) {\n      this.reset();\n      if (p.byteLength === 0) {\n        return 0;\n      }\n      return null;\n    }\n    const nread = copy(this._buf.subarray(this._off), p);\n    this._off += nread;\n    return nread;\n  }\n  writeByte(n) {\n    return this.write(Uint8Array.of(n));\n  }\n  writeString(s) {\n    return this.write(TE.encode(s));\n  }\n  write(p) {\n    const m = this._grow(p.byteLength);\n    return copy(p, this._buf, m);\n  }\n  _grow(n) {\n    const m = this.length;\n    if (m === 0 && this._off !== 0) {\n      this.reset();\n    }\n    const i = this._tryGrowByReslice(n);\n    if (i >= 0) {\n      return i;\n    }\n    const c = this.capacity;\n    if (n <= Math.floor(c / 2) - m) {\n      copy(this._buf.subarray(this._off), this._buf);\n    } else if (c + n > MAX_SIZE) {\n      throw new Error(\"The buffer cannot be grown beyond the maximum size.\");\n    } else {\n      const buf = new Uint8Array(Math.min(2 * c + n, MAX_SIZE));\n      copy(this._buf.subarray(this._off), buf);\n      this._buf = buf;\n    }\n    this._off = 0;\n    this._reslice(Math.min(m + n, MAX_SIZE));\n    return m;\n  }\n  grow(n) {\n    if (n < 0) {\n      throw Error(\"Buffer._grow: negative count\");\n    }\n    const m = this._grow(n);\n    this._reslice(m);\n  }\n  readFrom(r) {\n    let n = 0;\n    const tmp = new Uint8Array(MIN_READ);\n    while (true) {\n      const shouldGrow = this.capacity - this.length < MIN_READ;\n      const buf = shouldGrow ? tmp : new Uint8Array(this._buf.buffer, this.length);\n      const nread = r.read(buf);\n      if (nread === null) {\n        return n;\n      }\n      if (shouldGrow) this.write(buf.subarray(0, nread));else this._reslice(this.length + nread);\n      n += nread;\n    }\n  }\n}\nvar Kind;\n(function (Kind) {\n  Kind[Kind[\"OK\"] = 0] = \"OK\";\n  Kind[Kind[\"ERR\"] = 1] = \"ERR\";\n  Kind[Kind[\"MSG\"] = 2] = \"MSG\";\n  Kind[Kind[\"INFO\"] = 3] = \"INFO\";\n  Kind[Kind[\"PING\"] = 4] = \"PING\";\n  Kind[Kind[\"PONG\"] = 5] = \"PONG\";\n})(Kind || (Kind = {}));\nfunction newMsgArg() {\n  const ma = {};\n  ma.sid = -1;\n  ma.hdr = -1;\n  ma.size = -1;\n  return ma;\n}\nconst ASCII_0 = 48;\nclass Parser {\n  dispatcher;\n  state;\n  as;\n  drop;\n  hdr;\n  ma;\n  argBuf;\n  msgBuf;\n  constructor(dispatcher) {\n    this.dispatcher = dispatcher;\n    this.state = State.OP_START;\n    this.as = 0;\n    this.drop = 0;\n    this.hdr = 0;\n  }\n  parse(buf) {\n    let i;\n    for (i = 0; i < buf.length; i++) {\n      const b = buf[i];\n      switch (this.state) {\n        case State.OP_START:\n          switch (b) {\n            case cc.M:\n            case cc.m:\n              this.state = State.OP_M;\n              this.hdr = -1;\n              this.ma = newMsgArg();\n              break;\n            case cc.H:\n            case cc.h:\n              this.state = State.OP_H;\n              this.hdr = 0;\n              this.ma = newMsgArg();\n              break;\n            case cc.P:\n            case cc.p:\n              this.state = State.OP_P;\n              break;\n            case cc.PLUS:\n              this.state = State.OP_PLUS;\n              break;\n            case cc.MINUS:\n              this.state = State.OP_MINUS;\n              break;\n            case cc.I:\n            case cc.i:\n              this.state = State.OP_I;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_H:\n          switch (b) {\n            case cc.M:\n            case cc.m:\n              this.state = State.OP_M;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_M:\n          switch (b) {\n            case cc.S:\n            case cc.s:\n              this.state = State.OP_MS;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MS:\n          switch (b) {\n            case cc.G:\n            case cc.g:\n              this.state = State.OP_MSG;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MSG:\n          switch (b) {\n            case cc.SPACE:\n            case cc.TAB:\n              this.state = State.OP_MSG_SPC;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MSG_SPC:\n          switch (b) {\n            case cc.SPACE:\n            case cc.TAB:\n              continue;\n            default:\n              this.state = State.MSG_ARG;\n              this.as = i;\n          }\n          break;\n        case State.MSG_ARG:\n          switch (b) {\n            case cc.CR:\n              this.drop = 1;\n              break;\n            case cc.NL:\n              {\n                const arg = this.argBuf ? this.argBuf.bytes() : buf.subarray(this.as, i - this.drop);\n                this.processMsgArgs(arg);\n                this.drop = 0;\n                this.as = i + 1;\n                this.state = State.MSG_PAYLOAD;\n                i = this.as + this.ma.size - 1;\n                break;\n              }\n            default:\n              if (this.argBuf) {\n                this.argBuf.writeByte(b);\n              }\n          }\n          break;\n        case State.MSG_PAYLOAD:\n          if (this.msgBuf) {\n            if (this.msgBuf.length >= this.ma.size) {\n              const data = this.msgBuf.bytes({\n                copy: false\n              });\n              this.dispatcher.push({\n                kind: Kind.MSG,\n                msg: this.ma,\n                data: data\n              });\n              this.argBuf = undefined;\n              this.msgBuf = undefined;\n              this.state = State.MSG_END;\n            } else {\n              let toCopy = this.ma.size - this.msgBuf.length;\n              const avail = buf.length - i;\n              if (avail < toCopy) {\n                toCopy = avail;\n              }\n              if (toCopy > 0) {\n                this.msgBuf.write(buf.subarray(i, i + toCopy));\n                i = i + toCopy - 1;\n              } else {\n                this.msgBuf.writeByte(b);\n              }\n            }\n          } else if (i - this.as >= this.ma.size) {\n            this.dispatcher.push({\n              kind: Kind.MSG,\n              msg: this.ma,\n              data: buf.subarray(this.as, i)\n            });\n            this.argBuf = undefined;\n            this.msgBuf = undefined;\n            this.state = State.MSG_END;\n          }\n          break;\n        case State.MSG_END:\n          switch (b) {\n            case cc.NL:\n              this.drop = 0;\n              this.as = i + 1;\n              this.state = State.OP_START;\n              break;\n            default:\n              continue;\n          }\n          break;\n        case State.OP_PLUS:\n          switch (b) {\n            case cc.O:\n            case cc.o:\n              this.state = State.OP_PLUS_O;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PLUS_O:\n          switch (b) {\n            case cc.K:\n            case cc.k:\n              this.state = State.OP_PLUS_OK;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PLUS_OK:\n          switch (b) {\n            case cc.NL:\n              this.dispatcher.push({\n                kind: Kind.OK\n              });\n              this.drop = 0;\n              this.state = State.OP_START;\n              break;\n          }\n          break;\n        case State.OP_MINUS:\n          switch (b) {\n            case cc.E:\n            case cc.e:\n              this.state = State.OP_MINUS_E;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MINUS_E:\n          switch (b) {\n            case cc.R:\n            case cc.r:\n              this.state = State.OP_MINUS_ER;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MINUS_ER:\n          switch (b) {\n            case cc.R:\n            case cc.r:\n              this.state = State.OP_MINUS_ERR;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MINUS_ERR:\n          switch (b) {\n            case cc.SPACE:\n            case cc.TAB:\n              this.state = State.OP_MINUS_ERR_SPC;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_MINUS_ERR_SPC:\n          switch (b) {\n            case cc.SPACE:\n            case cc.TAB:\n              continue;\n            default:\n              this.state = State.MINUS_ERR_ARG;\n              this.as = i;\n          }\n          break;\n        case State.MINUS_ERR_ARG:\n          switch (b) {\n            case cc.CR:\n              this.drop = 1;\n              break;\n            case cc.NL:\n              {\n                let arg;\n                if (this.argBuf) {\n                  arg = this.argBuf.bytes();\n                  this.argBuf = undefined;\n                } else {\n                  arg = buf.subarray(this.as, i - this.drop);\n                }\n                this.dispatcher.push({\n                  kind: Kind.ERR,\n                  data: arg\n                });\n                this.drop = 0;\n                this.as = i + 1;\n                this.state = State.OP_START;\n                break;\n              }\n            default:\n              if (this.argBuf) {\n                this.argBuf.write(Uint8Array.of(b));\n              }\n          }\n          break;\n        case State.OP_P:\n          switch (b) {\n            case cc.I:\n            case cc.i:\n              this.state = State.OP_PI;\n              break;\n            case cc.O:\n            case cc.o:\n              this.state = State.OP_PO;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PO:\n          switch (b) {\n            case cc.N:\n            case cc.n:\n              this.state = State.OP_PON;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PON:\n          switch (b) {\n            case cc.G:\n            case cc.g:\n              this.state = State.OP_PONG;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PONG:\n          switch (b) {\n            case cc.NL:\n              this.dispatcher.push({\n                kind: Kind.PONG\n              });\n              this.drop = 0;\n              this.state = State.OP_START;\n              break;\n          }\n          break;\n        case State.OP_PI:\n          switch (b) {\n            case cc.N:\n            case cc.n:\n              this.state = State.OP_PIN;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PIN:\n          switch (b) {\n            case cc.G:\n            case cc.g:\n              this.state = State.OP_PING;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_PING:\n          switch (b) {\n            case cc.NL:\n              this.dispatcher.push({\n                kind: Kind.PING\n              });\n              this.drop = 0;\n              this.state = State.OP_START;\n              break;\n          }\n          break;\n        case State.OP_I:\n          switch (b) {\n            case cc.N:\n            case cc.n:\n              this.state = State.OP_IN;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_IN:\n          switch (b) {\n            case cc.F:\n            case cc.f:\n              this.state = State.OP_INF;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_INF:\n          switch (b) {\n            case cc.O:\n            case cc.o:\n              this.state = State.OP_INFO;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_INFO:\n          switch (b) {\n            case cc.SPACE:\n            case cc.TAB:\n              this.state = State.OP_INFO_SPC;\n              break;\n            default:\n              throw this.fail(buf.subarray(i));\n          }\n          break;\n        case State.OP_INFO_SPC:\n          switch (b) {\n            case cc.SPACE:\n            case cc.TAB:\n              continue;\n            default:\n              this.state = State.INFO_ARG;\n              this.as = i;\n          }\n          break;\n        case State.INFO_ARG:\n          switch (b) {\n            case cc.CR:\n              this.drop = 1;\n              break;\n            case cc.NL:\n              {\n                let arg;\n                if (this.argBuf) {\n                  arg = this.argBuf.bytes();\n                  this.argBuf = undefined;\n                } else {\n                  arg = buf.subarray(this.as, i - this.drop);\n                }\n                this.dispatcher.push({\n                  kind: Kind.INFO,\n                  data: arg\n                });\n                this.drop = 0;\n                this.as = i + 1;\n                this.state = State.OP_START;\n                break;\n              }\n            default:\n              if (this.argBuf) {\n                this.argBuf.writeByte(b);\n              }\n          }\n          break;\n        default:\n          throw this.fail(buf.subarray(i));\n      }\n    }\n    if ((this.state === State.MSG_ARG || this.state === State.MINUS_ERR_ARG || this.state === State.INFO_ARG) && !this.argBuf) {\n      this.argBuf = new DenoBuffer(buf.subarray(this.as, i - this.drop));\n    }\n    if (this.state === State.MSG_PAYLOAD && !this.msgBuf) {\n      if (!this.argBuf) {\n        this.cloneMsgArg();\n      }\n      this.msgBuf = new DenoBuffer(buf.subarray(this.as));\n    }\n  }\n  cloneMsgArg() {\n    const s = this.ma.subject.length;\n    const r = this.ma.reply ? this.ma.reply.length : 0;\n    const buf = new Uint8Array(s + r);\n    buf.set(this.ma.subject);\n    if (this.ma.reply) {\n      buf.set(this.ma.reply, s);\n    }\n    this.argBuf = new DenoBuffer(buf);\n    this.ma.subject = buf.subarray(0, s);\n    if (this.ma.reply) {\n      this.ma.reply = buf.subarray(s);\n    }\n  }\n  processMsgArgs(arg) {\n    if (this.hdr >= 0) {\n      return this.processHeaderMsgArgs(arg);\n    }\n    const args = [];\n    let start = -1;\n    for (let i = 0; i < arg.length; i++) {\n      const b = arg[i];\n      switch (b) {\n        case cc.SPACE:\n        case cc.TAB:\n        case cc.CR:\n        case cc.NL:\n          if (start >= 0) {\n            args.push(arg.subarray(start, i));\n            start = -1;\n          }\n          break;\n        default:\n          if (start < 0) {\n            start = i;\n          }\n      }\n    }\n    if (start >= 0) {\n      args.push(arg.subarray(start));\n    }\n    switch (args.length) {\n      case 3:\n        this.ma.subject = args[0];\n        this.ma.sid = this.protoParseInt(args[1]);\n        this.ma.reply = undefined;\n        this.ma.size = this.protoParseInt(args[2]);\n        break;\n      case 4:\n        this.ma.subject = args[0];\n        this.ma.sid = this.protoParseInt(args[1]);\n        this.ma.reply = args[2];\n        this.ma.size = this.protoParseInt(args[3]);\n        break;\n      default:\n        throw this.fail(arg, \"processMsgArgs Parse Error\");\n    }\n    if (this.ma.sid < 0) {\n      throw this.fail(arg, \"processMsgArgs Bad or Missing Sid Error\");\n    }\n    if (this.ma.size < 0) {\n      throw this.fail(arg, \"processMsgArgs Bad or Missing Size Error\");\n    }\n  }\n  fail(data, label = \"\") {\n    if (!label) {\n      label = `parse error [${this.state}]`;\n    } else {\n      label = `${label} [${this.state}]`;\n    }\n    return new Error(`${label}: ${TD.decode(data)}`);\n  }\n  processHeaderMsgArgs(arg) {\n    const args = [];\n    let start = -1;\n    for (let i = 0; i < arg.length; i++) {\n      const b = arg[i];\n      switch (b) {\n        case cc.SPACE:\n        case cc.TAB:\n        case cc.CR:\n        case cc.NL:\n          if (start >= 0) {\n            args.push(arg.subarray(start, i));\n            start = -1;\n          }\n          break;\n        default:\n          if (start < 0) {\n            start = i;\n          }\n      }\n    }\n    if (start >= 0) {\n      args.push(arg.subarray(start));\n    }\n    switch (args.length) {\n      case 4:\n        this.ma.subject = args[0];\n        this.ma.sid = this.protoParseInt(args[1]);\n        this.ma.reply = undefined;\n        this.ma.hdr = this.protoParseInt(args[2]);\n        this.ma.size = this.protoParseInt(args[3]);\n        break;\n      case 5:\n        this.ma.subject = args[0];\n        this.ma.sid = this.protoParseInt(args[1]);\n        this.ma.reply = args[2];\n        this.ma.hdr = this.protoParseInt(args[3]);\n        this.ma.size = this.protoParseInt(args[4]);\n        break;\n      default:\n        throw this.fail(arg, \"processHeaderMsgArgs Parse Error\");\n    }\n    if (this.ma.sid < 0) {\n      throw this.fail(arg, \"processHeaderMsgArgs Bad or Missing Sid Error\");\n    }\n    if (this.ma.hdr < 0 || this.ma.hdr > this.ma.size) {\n      throw this.fail(arg, \"processHeaderMsgArgs Bad or Missing Header Size Error\");\n    }\n    if (this.ma.size < 0) {\n      throw this.fail(arg, \"processHeaderMsgArgs Bad or Missing Size Error\");\n    }\n  }\n  protoParseInt(a) {\n    if (a.length === 0) {\n      return -1;\n    }\n    let n = 0;\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] < 48 || a[i] > 57) {\n        return -1;\n      }\n      n = n * 10 + (a[i] - ASCII_0);\n    }\n    return n;\n  }\n}\nvar State;\n(function (State) {\n  State[State[\"OP_START\"] = 0] = \"OP_START\";\n  State[State[\"OP_PLUS\"] = 1] = \"OP_PLUS\";\n  State[State[\"OP_PLUS_O\"] = 2] = \"OP_PLUS_O\";\n  State[State[\"OP_PLUS_OK\"] = 3] = \"OP_PLUS_OK\";\n  State[State[\"OP_MINUS\"] = 4] = \"OP_MINUS\";\n  State[State[\"OP_MINUS_E\"] = 5] = \"OP_MINUS_E\";\n  State[State[\"OP_MINUS_ER\"] = 6] = \"OP_MINUS_ER\";\n  State[State[\"OP_MINUS_ERR\"] = 7] = \"OP_MINUS_ERR\";\n  State[State[\"OP_MINUS_ERR_SPC\"] = 8] = \"OP_MINUS_ERR_SPC\";\n  State[State[\"MINUS_ERR_ARG\"] = 9] = \"MINUS_ERR_ARG\";\n  State[State[\"OP_M\"] = 10] = \"OP_M\";\n  State[State[\"OP_MS\"] = 11] = \"OP_MS\";\n  State[State[\"OP_MSG\"] = 12] = \"OP_MSG\";\n  State[State[\"OP_MSG_SPC\"] = 13] = \"OP_MSG_SPC\";\n  State[State[\"MSG_ARG\"] = 14] = \"MSG_ARG\";\n  State[State[\"MSG_PAYLOAD\"] = 15] = \"MSG_PAYLOAD\";\n  State[State[\"MSG_END\"] = 16] = \"MSG_END\";\n  State[State[\"OP_H\"] = 17] = \"OP_H\";\n  State[State[\"OP_P\"] = 18] = \"OP_P\";\n  State[State[\"OP_PI\"] = 19] = \"OP_PI\";\n  State[State[\"OP_PIN\"] = 20] = \"OP_PIN\";\n  State[State[\"OP_PING\"] = 21] = \"OP_PING\";\n  State[State[\"OP_PO\"] = 22] = \"OP_PO\";\n  State[State[\"OP_PON\"] = 23] = \"OP_PON\";\n  State[State[\"OP_PONG\"] = 24] = \"OP_PONG\";\n  State[State[\"OP_I\"] = 25] = \"OP_I\";\n  State[State[\"OP_IN\"] = 26] = \"OP_IN\";\n  State[State[\"OP_INF\"] = 27] = \"OP_INF\";\n  State[State[\"OP_INFO\"] = 28] = \"OP_INFO\";\n  State[State[\"OP_INFO_SPC\"] = 29] = \"OP_INFO_SPC\";\n  State[State[\"INFO_ARG\"] = 30] = \"INFO_ARG\";\n})(State || (State = {}));\nvar cc;\n(function (cc) {\n  cc[cc[\"CR\"] = \"\\r\".charCodeAt(0)] = \"CR\";\n  cc[cc[\"E\"] = \"E\".charCodeAt(0)] = \"E\";\n  cc[cc[\"e\"] = \"e\".charCodeAt(0)] = \"e\";\n  cc[cc[\"F\"] = \"F\".charCodeAt(0)] = \"F\";\n  cc[cc[\"f\"] = \"f\".charCodeAt(0)] = \"f\";\n  cc[cc[\"G\"] = \"G\".charCodeAt(0)] = \"G\";\n  cc[cc[\"g\"] = \"g\".charCodeAt(0)] = \"g\";\n  cc[cc[\"H\"] = \"H\".charCodeAt(0)] = \"H\";\n  cc[cc[\"h\"] = \"h\".charCodeAt(0)] = \"h\";\n  cc[cc[\"I\"] = \"I\".charCodeAt(0)] = \"I\";\n  cc[cc[\"i\"] = \"i\".charCodeAt(0)] = \"i\";\n  cc[cc[\"K\"] = \"K\".charCodeAt(0)] = \"K\";\n  cc[cc[\"k\"] = \"k\".charCodeAt(0)] = \"k\";\n  cc[cc[\"M\"] = \"M\".charCodeAt(0)] = \"M\";\n  cc[cc[\"m\"] = \"m\".charCodeAt(0)] = \"m\";\n  cc[cc[\"MINUS\"] = \"-\".charCodeAt(0)] = \"MINUS\";\n  cc[cc[\"N\"] = \"N\".charCodeAt(0)] = \"N\";\n  cc[cc[\"n\"] = \"n\".charCodeAt(0)] = \"n\";\n  cc[cc[\"NL\"] = \"\\n\".charCodeAt(0)] = \"NL\";\n  cc[cc[\"O\"] = \"O\".charCodeAt(0)] = \"O\";\n  cc[cc[\"o\"] = \"o\".charCodeAt(0)] = \"o\";\n  cc[cc[\"P\"] = \"P\".charCodeAt(0)] = \"P\";\n  cc[cc[\"p\"] = \"p\".charCodeAt(0)] = \"p\";\n  cc[cc[\"PLUS\"] = \"+\".charCodeAt(0)] = \"PLUS\";\n  cc[cc[\"R\"] = \"R\".charCodeAt(0)] = \"R\";\n  cc[cc[\"r\"] = \"r\".charCodeAt(0)] = \"r\";\n  cc[cc[\"S\"] = \"S\".charCodeAt(0)] = \"S\";\n  cc[cc[\"s\"] = \"s\".charCodeAt(0)] = \"s\";\n  cc[cc[\"SPACE\"] = \" \".charCodeAt(0)] = \"SPACE\";\n  cc[cc[\"TAB\"] = \"\\t\".charCodeAt(0)] = \"TAB\";\n})(cc || (cc = {}));\n(function (nacl) {\n  'use strict';\n\n  var u64 = function (h, l) {\n    this.hi = h | 0 >>> 0;\n    this.lo = l | 0 >>> 0;\n  };\n  var gf = function (init) {\n    var i,\n      r = new Float64Array(16);\n    if (init) for (i = 0; i < init.length; i++) r[i] = init[i];\n    return r;\n  };\n  var randombytes = function () {\n    throw new Error('no PRNG');\n  };\n  var _0 = new Uint8Array(16);\n  var _9 = new Uint8Array(32);\n  _9[0] = 9;\n  var gf0 = gf(),\n    gf1 = gf([1]),\n    _121665 = gf([0xdb41, 1]),\n    D = gf([0x78a3, 0x1359, 0x4dca, 0x75eb, 0xd8ab, 0x4141, 0x0a4d, 0x0070, 0xe898, 0x7779, 0x4079, 0x8cc7, 0xfe73, 0x2b6f, 0x6cee, 0x5203]),\n    D2 = gf([0xf159, 0x26b2, 0x9b94, 0xebd6, 0xb156, 0x8283, 0x149a, 0x00e0, 0xd130, 0xeef3, 0x80f2, 0x198e, 0xfce7, 0x56df, 0xd9dc, 0x2406]),\n    X = gf([0xd51a, 0x8f25, 0x2d60, 0xc956, 0xa7b2, 0x9525, 0xc760, 0x692c, 0xdc5c, 0xfdd6, 0xe231, 0xc0a4, 0x53fe, 0xcd6e, 0x36d3, 0x2169]),\n    Y = gf([0x6658, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666]),\n    I = gf([0xa0b0, 0x4a0e, 0x1b27, 0xc4ee, 0xe478, 0xad2f, 0x1806, 0x2f43, 0xd7a7, 0x3dfb, 0x0099, 0x2b4d, 0xdf0b, 0x4fc1, 0x2480, 0x2b83]);\n  function L32(x, c) {\n    return x << c | x >>> 32 - c;\n  }\n  function ld32(x, i) {\n    var u = x[i + 3] & 0xff;\n    u = u << 8 | x[i + 2] & 0xff;\n    u = u << 8 | x[i + 1] & 0xff;\n    return u << 8 | x[i + 0] & 0xff;\n  }\n  function dl64(x, i) {\n    var h = x[i] << 24 | x[i + 1] << 16 | x[i + 2] << 8 | x[i + 3];\n    var l = x[i + 4] << 24 | x[i + 5] << 16 | x[i + 6] << 8 | x[i + 7];\n    return new u64(h, l);\n  }\n  function st32(x, j, u) {\n    var i;\n    for (i = 0; i < 4; i++) {\n      x[j + i] = u & 255;\n      u >>>= 8;\n    }\n  }\n  function ts64(x, i, u) {\n    x[i] = u.hi >> 24 & 0xff;\n    x[i + 1] = u.hi >> 16 & 0xff;\n    x[i + 2] = u.hi >> 8 & 0xff;\n    x[i + 3] = u.hi & 0xff;\n    x[i + 4] = u.lo >> 24 & 0xff;\n    x[i + 5] = u.lo >> 16 & 0xff;\n    x[i + 6] = u.lo >> 8 & 0xff;\n    x[i + 7] = u.lo & 0xff;\n  }\n  function vn(x, xi, y, yi, n) {\n    var i,\n      d = 0;\n    for (i = 0; i < n; i++) d |= x[xi + i] ^ y[yi + i];\n    return (1 & d - 1 >>> 8) - 1;\n  }\n  function crypto_verify_16(x, xi, y, yi) {\n    return vn(x, xi, y, yi, 16);\n  }\n  function crypto_verify_32(x, xi, y, yi) {\n    return vn(x, xi, y, yi, 32);\n  }\n  function core(out, inp, k, c, h) {\n    var w = new Uint32Array(16),\n      x = new Uint32Array(16),\n      y = new Uint32Array(16),\n      t = new Uint32Array(4);\n    var i, j, m;\n    for (i = 0; i < 4; i++) {\n      x[5 * i] = ld32(c, 4 * i);\n      x[1 + i] = ld32(k, 4 * i);\n      x[6 + i] = ld32(inp, 4 * i);\n      x[11 + i] = ld32(k, 16 + 4 * i);\n    }\n    for (i = 0; i < 16; i++) y[i] = x[i];\n    for (i = 0; i < 20; i++) {\n      for (j = 0; j < 4; j++) {\n        for (m = 0; m < 4; m++) t[m] = x[(5 * j + 4 * m) % 16];\n        t[1] ^= L32(t[0] + t[3] | 0, 7);\n        t[2] ^= L32(t[1] + t[0] | 0, 9);\n        t[3] ^= L32(t[2] + t[1] | 0, 13);\n        t[0] ^= L32(t[3] + t[2] | 0, 18);\n        for (m = 0; m < 4; m++) w[4 * j + (j + m) % 4] = t[m];\n      }\n      for (m = 0; m < 16; m++) x[m] = w[m];\n    }\n    if (h) {\n      for (i = 0; i < 16; i++) x[i] = x[i] + y[i] | 0;\n      for (i = 0; i < 4; i++) {\n        x[5 * i] = x[5 * i] - ld32(c, 4 * i) | 0;\n        x[6 + i] = x[6 + i] - ld32(inp, 4 * i) | 0;\n      }\n      for (i = 0; i < 4; i++) {\n        st32(out, 4 * i, x[5 * i]);\n        st32(out, 16 + 4 * i, x[6 + i]);\n      }\n    } else {\n      for (i = 0; i < 16; i++) st32(out, 4 * i, x[i] + y[i] | 0);\n    }\n  }\n  function crypto_core_salsa20(out, inp, k, c) {\n    core(out, inp, k, c, false);\n    return 0;\n  }\n  function crypto_core_hsalsa20(out, inp, k, c) {\n    core(out, inp, k, c, true);\n    return 0;\n  }\n  var sigma = new Uint8Array([101, 120, 112, 97, 110, 100, 32, 51, 50, 45, 98, 121, 116, 101, 32, 107]);\n  function crypto_stream_salsa20_xor(c, cpos, m, mpos, b, n, k) {\n    var z = new Uint8Array(16),\n      x = new Uint8Array(64);\n    var u, i;\n    if (!b) return 0;\n    for (i = 0; i < 16; i++) z[i] = 0;\n    for (i = 0; i < 8; i++) z[i] = n[i];\n    while (b >= 64) {\n      crypto_core_salsa20(x, z, k, sigma);\n      for (i = 0; i < 64; i++) c[cpos + i] = (m ? m[mpos + i] : 0) ^ x[i];\n      u = 1;\n      for (i = 8; i < 16; i++) {\n        u = u + (z[i] & 0xff) | 0;\n        z[i] = u & 0xff;\n        u >>>= 8;\n      }\n      b -= 64;\n      cpos += 64;\n      if (m) mpos += 64;\n    }\n    if (b > 0) {\n      crypto_core_salsa20(x, z, k, sigma);\n      for (i = 0; i < b; i++) c[cpos + i] = (m ? m[mpos + i] : 0) ^ x[i];\n    }\n    return 0;\n  }\n  function crypto_stream_salsa20(c, cpos, d, n, k) {\n    return crypto_stream_salsa20_xor(c, cpos, null, 0, d, n, k);\n  }\n  function crypto_stream(c, cpos, d, n, k) {\n    var s = new Uint8Array(32);\n    crypto_core_hsalsa20(s, n, k, sigma);\n    return crypto_stream_salsa20(c, cpos, d, n.subarray(16), s);\n  }\n  function crypto_stream_xor(c, cpos, m, mpos, d, n, k) {\n    var s = new Uint8Array(32);\n    crypto_core_hsalsa20(s, n, k, sigma);\n    return crypto_stream_salsa20_xor(c, cpos, m, mpos, d, n.subarray(16), s);\n  }\n  function add1305(h, c) {\n    var j,\n      u = 0;\n    for (j = 0; j < 17; j++) {\n      u = u + (h[j] + c[j] | 0) | 0;\n      h[j] = u & 255;\n      u >>>= 8;\n    }\n  }\n  var minusp = new Uint32Array([5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 252]);\n  function crypto_onetimeauth(out, outpos, m, mpos, n, k) {\n    var s, i, j, u;\n    var x = new Uint32Array(17),\n      r = new Uint32Array(17),\n      h = new Uint32Array(17),\n      c = new Uint32Array(17),\n      g = new Uint32Array(17);\n    for (j = 0; j < 17; j++) r[j] = h[j] = 0;\n    for (j = 0; j < 16; j++) r[j] = k[j];\n    r[3] &= 15;\n    r[4] &= 252;\n    r[7] &= 15;\n    r[8] &= 252;\n    r[11] &= 15;\n    r[12] &= 252;\n    r[15] &= 15;\n    while (n > 0) {\n      for (j = 0; j < 17; j++) c[j] = 0;\n      for (j = 0; j < 16 && j < n; ++j) c[j] = m[mpos + j];\n      c[j] = 1;\n      mpos += j;\n      n -= j;\n      add1305(h, c);\n      for (i = 0; i < 17; i++) {\n        x[i] = 0;\n        for (j = 0; j < 17; j++) x[i] = x[i] + h[j] * (j <= i ? r[i - j] : 320 * r[i + 17 - j] | 0) | 0 | 0;\n      }\n      for (i = 0; i < 17; i++) h[i] = x[i];\n      u = 0;\n      for (j = 0; j < 16; j++) {\n        u = u + h[j] | 0;\n        h[j] = u & 255;\n        u >>>= 8;\n      }\n      u = u + h[16] | 0;\n      h[16] = u & 3;\n      u = 5 * (u >>> 2) | 0;\n      for (j = 0; j < 16; j++) {\n        u = u + h[j] | 0;\n        h[j] = u & 255;\n        u >>>= 8;\n      }\n      u = u + h[16] | 0;\n      h[16] = u;\n    }\n    for (j = 0; j < 17; j++) g[j] = h[j];\n    add1305(h, minusp);\n    s = -(h[16] >>> 7) | 0;\n    for (j = 0; j < 17; j++) h[j] ^= s & (g[j] ^ h[j]);\n    for (j = 0; j < 16; j++) c[j] = k[j + 16];\n    c[16] = 0;\n    add1305(h, c);\n    for (j = 0; j < 16; j++) out[outpos + j] = h[j];\n    return 0;\n  }\n  function crypto_onetimeauth_verify(h, hpos, m, mpos, n, k) {\n    var x = new Uint8Array(16);\n    crypto_onetimeauth(x, 0, m, mpos, n, k);\n    return crypto_verify_16(h, hpos, x, 0);\n  }\n  function crypto_secretbox(c, m, d, n, k) {\n    var i;\n    if (d < 32) return -1;\n    crypto_stream_xor(c, 0, m, 0, d, n, k);\n    crypto_onetimeauth(c, 16, c, 32, d - 32, c);\n    for (i = 0; i < 16; i++) c[i] = 0;\n    return 0;\n  }\n  function crypto_secretbox_open(m, c, d, n, k) {\n    var i;\n    var x = new Uint8Array(32);\n    if (d < 32) return -1;\n    crypto_stream(x, 0, 32, n, k);\n    if (crypto_onetimeauth_verify(c, 16, c, 32, d - 32, x) !== 0) return -1;\n    crypto_stream_xor(m, 0, c, 0, d, n, k);\n    for (i = 0; i < 32; i++) m[i] = 0;\n    return 0;\n  }\n  function set25519(r, a) {\n    var i;\n    for (i = 0; i < 16; i++) r[i] = a[i] | 0;\n  }\n  function car25519(o) {\n    var c;\n    var i;\n    for (i = 0; i < 16; i++) {\n      o[i] += 65536;\n      c = Math.floor(o[i] / 65536);\n      o[(i + 1) * (i < 15 ? 1 : 0)] += c - 1 + 37 * (c - 1) * (i === 15 ? 1 : 0);\n      o[i] -= c * 65536;\n    }\n  }\n  function sel25519(p, q, b) {\n    var t,\n      c = ~(b - 1);\n    for (var i = 0; i < 16; i++) {\n      t = c & (p[i] ^ q[i]);\n      p[i] ^= t;\n      q[i] ^= t;\n    }\n  }\n  function pack25519(o, n) {\n    var i, j, b;\n    var m = gf(),\n      t = gf();\n    for (i = 0; i < 16; i++) t[i] = n[i];\n    car25519(t);\n    car25519(t);\n    car25519(t);\n    for (j = 0; j < 2; j++) {\n      m[0] = t[0] - 0xffed;\n      for (i = 1; i < 15; i++) {\n        m[i] = t[i] - 0xffff - (m[i - 1] >> 16 & 1);\n        m[i - 1] &= 0xffff;\n      }\n      m[15] = t[15] - 0x7fff - (m[14] >> 16 & 1);\n      b = m[15] >> 16 & 1;\n      m[14] &= 0xffff;\n      sel25519(t, m, 1 - b);\n    }\n    for (i = 0; i < 16; i++) {\n      o[2 * i] = t[i] & 0xff;\n      o[2 * i + 1] = t[i] >> 8;\n    }\n  }\n  function neq25519(a, b) {\n    var c = new Uint8Array(32),\n      d = new Uint8Array(32);\n    pack25519(c, a);\n    pack25519(d, b);\n    return crypto_verify_32(c, 0, d, 0);\n  }\n  function par25519(a) {\n    var d = new Uint8Array(32);\n    pack25519(d, a);\n    return d[0] & 1;\n  }\n  function unpack25519(o, n) {\n    var i;\n    for (i = 0; i < 16; i++) o[i] = n[2 * i] + (n[2 * i + 1] << 8);\n    o[15] &= 0x7fff;\n  }\n  function A(o, a, b) {\n    var i;\n    for (i = 0; i < 16; i++) o[i] = a[i] + b[i] | 0;\n  }\n  function Z(o, a, b) {\n    var i;\n    for (i = 0; i < 16; i++) o[i] = a[i] - b[i] | 0;\n  }\n  function M(o, a, b) {\n    var i,\n      j,\n      t = new Float64Array(31);\n    for (i = 0; i < 31; i++) t[i] = 0;\n    for (i = 0; i < 16; i++) {\n      for (j = 0; j < 16; j++) {\n        t[i + j] += a[i] * b[j];\n      }\n    }\n    for (i = 0; i < 15; i++) {\n      t[i] += 38 * t[i + 16];\n    }\n    for (i = 0; i < 16; i++) o[i] = t[i];\n    car25519(o);\n    car25519(o);\n  }\n  function S(o, a) {\n    M(o, a, a);\n  }\n  function inv25519(o, i) {\n    var c = gf();\n    var a;\n    for (a = 0; a < 16; a++) c[a] = i[a];\n    for (a = 253; a >= 0; a--) {\n      S(c, c);\n      if (a !== 2 && a !== 4) M(c, c, i);\n    }\n    for (a = 0; a < 16; a++) o[a] = c[a];\n  }\n  function pow2523(o, i) {\n    var c = gf();\n    var a;\n    for (a = 0; a < 16; a++) c[a] = i[a];\n    for (a = 250; a >= 0; a--) {\n      S(c, c);\n      if (a !== 1) M(c, c, i);\n    }\n    for (a = 0; a < 16; a++) o[a] = c[a];\n  }\n  function crypto_scalarmult(q, n, p) {\n    var z = new Uint8Array(32);\n    var x = new Float64Array(80),\n      r,\n      i;\n    var a = gf(),\n      b = gf(),\n      c = gf(),\n      d = gf(),\n      e = gf(),\n      f = gf();\n    for (i = 0; i < 31; i++) z[i] = n[i];\n    z[31] = n[31] & 127 | 64;\n    z[0] &= 248;\n    unpack25519(x, p);\n    for (i = 0; i < 16; i++) {\n      b[i] = x[i];\n      d[i] = a[i] = c[i] = 0;\n    }\n    a[0] = d[0] = 1;\n    for (i = 254; i >= 0; --i) {\n      r = z[i >>> 3] >>> (i & 7) & 1;\n      sel25519(a, b, r);\n      sel25519(c, d, r);\n      A(e, a, c);\n      Z(a, a, c);\n      A(c, b, d);\n      Z(b, b, d);\n      S(d, e);\n      S(f, a);\n      M(a, c, a);\n      M(c, b, e);\n      A(e, a, c);\n      Z(a, a, c);\n      S(b, a);\n      Z(c, d, f);\n      M(a, c, _121665);\n      A(a, a, d);\n      M(c, c, a);\n      M(a, d, f);\n      M(d, b, x);\n      S(b, e);\n      sel25519(a, b, r);\n      sel25519(c, d, r);\n    }\n    for (i = 0; i < 16; i++) {\n      x[i + 16] = a[i];\n      x[i + 32] = c[i];\n      x[i + 48] = b[i];\n      x[i + 64] = d[i];\n    }\n    var x32 = x.subarray(32);\n    var x16 = x.subarray(16);\n    inv25519(x32, x32);\n    M(x16, x16, x32);\n    pack25519(q, x16);\n    return 0;\n  }\n  function crypto_scalarmult_base(q, n) {\n    return crypto_scalarmult(q, n, _9);\n  }\n  function crypto_box_keypair(y, x) {\n    randombytes(x, 32);\n    return crypto_scalarmult_base(y, x);\n  }\n  function crypto_box_beforenm(k, y, x) {\n    var s = new Uint8Array(32);\n    crypto_scalarmult(s, x, y);\n    return crypto_core_hsalsa20(k, _0, s, sigma);\n  }\n  var crypto_box_afternm = crypto_secretbox;\n  var crypto_box_open_afternm = crypto_secretbox_open;\n  function crypto_box(c, m, d, n, y, x) {\n    var k = new Uint8Array(32);\n    crypto_box_beforenm(k, y, x);\n    return crypto_box_afternm(c, m, d, n, k);\n  }\n  function crypto_box_open(m, c, d, n, y, x) {\n    var k = new Uint8Array(32);\n    crypto_box_beforenm(k, y, x);\n    return crypto_box_open_afternm(m, c, d, n, k);\n  }\n  function add64() {\n    var a = 0,\n      b = 0,\n      c = 0,\n      d = 0,\n      m16 = 65535,\n      l,\n      h,\n      i;\n    for (i = 0; i < arguments.length; i++) {\n      l = arguments[i].lo;\n      h = arguments[i].hi;\n      a += l & m16;\n      b += l >>> 16;\n      c += h & m16;\n      d += h >>> 16;\n    }\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n    return new u64(c & m16 | d << 16, a & m16 | b << 16);\n  }\n  function shr64(x, c) {\n    return new u64(x.hi >>> c, x.lo >>> c | x.hi << 32 - c);\n  }\n  function xor64() {\n    var l = 0,\n      h = 0,\n      i;\n    for (i = 0; i < arguments.length; i++) {\n      l ^= arguments[i].lo;\n      h ^= arguments[i].hi;\n    }\n    return new u64(h, l);\n  }\n  function R(x, c) {\n    var h,\n      l,\n      c1 = 32 - c;\n    if (c < 32) {\n      h = x.hi >>> c | x.lo << c1;\n      l = x.lo >>> c | x.hi << c1;\n    } else if (c < 64) {\n      h = x.lo >>> c | x.hi << c1;\n      l = x.hi >>> c | x.lo << c1;\n    }\n    return new u64(h, l);\n  }\n  function Ch(x, y, z) {\n    var h = x.hi & y.hi ^ ~x.hi & z.hi,\n      l = x.lo & y.lo ^ ~x.lo & z.lo;\n    return new u64(h, l);\n  }\n  function Maj(x, y, z) {\n    var h = x.hi & y.hi ^ x.hi & z.hi ^ y.hi & z.hi,\n      l = x.lo & y.lo ^ x.lo & z.lo ^ y.lo & z.lo;\n    return new u64(h, l);\n  }\n  function Sigma0(x) {\n    return xor64(R(x, 28), R(x, 34), R(x, 39));\n  }\n  function Sigma1(x) {\n    return xor64(R(x, 14), R(x, 18), R(x, 41));\n  }\n  function sigma0(x) {\n    return xor64(R(x, 1), R(x, 8), shr64(x, 7));\n  }\n  function sigma1(x) {\n    return xor64(R(x, 19), R(x, 61), shr64(x, 6));\n  }\n  var K = [new u64(0x428a2f98, 0xd728ae22), new u64(0x71374491, 0x23ef65cd), new u64(0xb5c0fbcf, 0xec4d3b2f), new u64(0xe9b5dba5, 0x8189dbbc), new u64(0x3956c25b, 0xf348b538), new u64(0x59f111f1, 0xb605d019), new u64(0x923f82a4, 0xaf194f9b), new u64(0xab1c5ed5, 0xda6d8118), new u64(0xd807aa98, 0xa3030242), new u64(0x12835b01, 0x45706fbe), new u64(0x243185be, 0x4ee4b28c), new u64(0x550c7dc3, 0xd5ffb4e2), new u64(0x72be5d74, 0xf27b896f), new u64(0x80deb1fe, 0x3b1696b1), new u64(0x9bdc06a7, 0x25c71235), new u64(0xc19bf174, 0xcf692694), new u64(0xe49b69c1, 0x9ef14ad2), new u64(0xefbe4786, 0x384f25e3), new u64(0x0fc19dc6, 0x8b8cd5b5), new u64(0x240ca1cc, 0x77ac9c65), new u64(0x2de92c6f, 0x592b0275), new u64(0x4a7484aa, 0x6ea6e483), new u64(0x5cb0a9dc, 0xbd41fbd4), new u64(0x76f988da, 0x831153b5), new u64(0x983e5152, 0xee66dfab), new u64(0xa831c66d, 0x2db43210), new u64(0xb00327c8, 0x98fb213f), new u64(0xbf597fc7, 0xbeef0ee4), new u64(0xc6e00bf3, 0x3da88fc2), new u64(0xd5a79147, 0x930aa725), new u64(0x06ca6351, 0xe003826f), new u64(0x14292967, 0x0a0e6e70), new u64(0x27b70a85, 0x46d22ffc), new u64(0x2e1b2138, 0x5c26c926), new u64(0x4d2c6dfc, 0x5ac42aed), new u64(0x53380d13, 0x9d95b3df), new u64(0x650a7354, 0x8baf63de), new u64(0x766a0abb, 0x3c77b2a8), new u64(0x81c2c92e, 0x47edaee6), new u64(0x92722c85, 0x1482353b), new u64(0xa2bfe8a1, 0x4cf10364), new u64(0xa81a664b, 0xbc423001), new u64(0xc24b8b70, 0xd0f89791), new u64(0xc76c51a3, 0x0654be30), new u64(0xd192e819, 0xd6ef5218), new u64(0xd6990624, 0x5565a910), new u64(0xf40e3585, 0x5771202a), new u64(0x106aa070, 0x32bbd1b8), new u64(0x19a4c116, 0xb8d2d0c8), new u64(0x1e376c08, 0x5141ab53), new u64(0x2748774c, 0xdf8eeb99), new u64(0x34b0bcb5, 0xe19b48a8), new u64(0x391c0cb3, 0xc5c95a63), new u64(0x4ed8aa4a, 0xe3418acb), new u64(0x5b9cca4f, 0x7763e373), new u64(0x682e6ff3, 0xd6b2b8a3), new u64(0x748f82ee, 0x5defb2fc), new u64(0x78a5636f, 0x43172f60), new u64(0x84c87814, 0xa1f0ab72), new u64(0x8cc70208, 0x1a6439ec), new u64(0x90befffa, 0x23631e28), new u64(0xa4506ceb, 0xde82bde9), new u64(0xbef9a3f7, 0xb2c67915), new u64(0xc67178f2, 0xe372532b), new u64(0xca273ece, 0xea26619c), new u64(0xd186b8c7, 0x21c0c207), new u64(0xeada7dd6, 0xcde0eb1e), new u64(0xf57d4f7f, 0xee6ed178), new u64(0x06f067aa, 0x72176fba), new u64(0x0a637dc5, 0xa2c898a6), new u64(0x113f9804, 0xbef90dae), new u64(0x1b710b35, 0x131c471b), new u64(0x28db77f5, 0x23047d84), new u64(0x32caab7b, 0x40c72493), new u64(0x3c9ebe0a, 0x15c9bebc), new u64(0x431d67c4, 0x9c100d4c), new u64(0x4cc5d4be, 0xcb3e42b6), new u64(0x597f299c, 0xfc657e2a), new u64(0x5fcb6fab, 0x3ad6faec), new u64(0x6c44198c, 0x4a475817)];\n  function crypto_hashblocks(x, m, n) {\n    var z = [],\n      b = [],\n      a = [],\n      w = [],\n      t,\n      i,\n      j;\n    for (i = 0; i < 8; i++) z[i] = a[i] = dl64(x, 8 * i);\n    var pos = 0;\n    while (n >= 128) {\n      for (i = 0; i < 16; i++) w[i] = dl64(m, 8 * i + pos);\n      for (i = 0; i < 80; i++) {\n        for (j = 0; j < 8; j++) b[j] = a[j];\n        t = add64(a[7], Sigma1(a[4]), Ch(a[4], a[5], a[6]), K[i], w[i % 16]);\n        b[7] = add64(t, Sigma0(a[0]), Maj(a[0], a[1], a[2]));\n        b[3] = add64(b[3], t);\n        for (j = 0; j < 8; j++) a[(j + 1) % 8] = b[j];\n        if (i % 16 === 15) {\n          for (j = 0; j < 16; j++) {\n            w[j] = add64(w[j], w[(j + 9) % 16], sigma0(w[(j + 1) % 16]), sigma1(w[(j + 14) % 16]));\n          }\n        }\n      }\n      for (i = 0; i < 8; i++) {\n        a[i] = add64(a[i], z[i]);\n        z[i] = a[i];\n      }\n      pos += 128;\n      n -= 128;\n    }\n    for (i = 0; i < 8; i++) ts64(x, 8 * i, z[i]);\n    return n;\n  }\n  var iv = new Uint8Array([0x6a, 0x09, 0xe6, 0x67, 0xf3, 0xbc, 0xc9, 0x08, 0xbb, 0x67, 0xae, 0x85, 0x84, 0xca, 0xa7, 0x3b, 0x3c, 0x6e, 0xf3, 0x72, 0xfe, 0x94, 0xf8, 0x2b, 0xa5, 0x4f, 0xf5, 0x3a, 0x5f, 0x1d, 0x36, 0xf1, 0x51, 0x0e, 0x52, 0x7f, 0xad, 0xe6, 0x82, 0xd1, 0x9b, 0x05, 0x68, 0x8c, 0x2b, 0x3e, 0x6c, 0x1f, 0x1f, 0x83, 0xd9, 0xab, 0xfb, 0x41, 0xbd, 0x6b, 0x5b, 0xe0, 0xcd, 0x19, 0x13, 0x7e, 0x21, 0x79]);\n  function crypto_hash(out, m, n) {\n    var h = new Uint8Array(64),\n      x = new Uint8Array(256);\n    var i,\n      b = n;\n    for (i = 0; i < 64; i++) h[i] = iv[i];\n    crypto_hashblocks(h, m, n);\n    n %= 128;\n    for (i = 0; i < 256; i++) x[i] = 0;\n    for (i = 0; i < n; i++) x[i] = m[b - n + i];\n    x[n] = 128;\n    n = 256 - 128 * (n < 112 ? 1 : 0);\n    x[n - 9] = 0;\n    ts64(x, n - 8, new u64(b / 0x20000000 | 0, b << 3));\n    crypto_hashblocks(h, x, n);\n    for (i = 0; i < 64; i++) out[i] = h[i];\n    return 0;\n  }\n  function add(p, q) {\n    var a = gf(),\n      b = gf(),\n      c = gf(),\n      d = gf(),\n      e = gf(),\n      f = gf(),\n      g = gf(),\n      h = gf(),\n      t = gf();\n    Z(a, p[1], p[0]);\n    Z(t, q[1], q[0]);\n    M(a, a, t);\n    A(b, p[0], p[1]);\n    A(t, q[0], q[1]);\n    M(b, b, t);\n    M(c, p[3], q[3]);\n    M(c, c, D2);\n    M(d, p[2], q[2]);\n    A(d, d, d);\n    Z(e, b, a);\n    Z(f, d, c);\n    A(g, d, c);\n    A(h, b, a);\n    M(p[0], e, f);\n    M(p[1], h, g);\n    M(p[2], g, f);\n    M(p[3], e, h);\n  }\n  function cswap(p, q, b) {\n    var i;\n    for (i = 0; i < 4; i++) {\n      sel25519(p[i], q[i], b);\n    }\n  }\n  function pack(r, p) {\n    var tx = gf(),\n      ty = gf(),\n      zi = gf();\n    inv25519(zi, p[2]);\n    M(tx, p[0], zi);\n    M(ty, p[1], zi);\n    pack25519(r, ty);\n    r[31] ^= par25519(tx) << 7;\n  }\n  function scalarmult(p, q, s) {\n    var b, i;\n    set25519(p[0], gf0);\n    set25519(p[1], gf1);\n    set25519(p[2], gf1);\n    set25519(p[3], gf0);\n    for (i = 255; i >= 0; --i) {\n      b = s[i / 8 | 0] >> (i & 7) & 1;\n      cswap(p, q, b);\n      add(q, p);\n      add(p, p);\n      cswap(p, q, b);\n    }\n  }\n  function scalarbase(p, s) {\n    var q = [gf(), gf(), gf(), gf()];\n    set25519(q[0], X);\n    set25519(q[1], Y);\n    set25519(q[2], gf1);\n    M(q[3], X, Y);\n    scalarmult(p, q, s);\n  }\n  function crypto_sign_keypair(pk, sk, seeded) {\n    var d = new Uint8Array(64);\n    var p = [gf(), gf(), gf(), gf()];\n    var i;\n    if (!seeded) randombytes(sk, 32);\n    crypto_hash(d, sk, 32);\n    d[0] &= 248;\n    d[31] &= 127;\n    d[31] |= 64;\n    scalarbase(p, d);\n    pack(pk, p);\n    for (i = 0; i < 32; i++) sk[i + 32] = pk[i];\n    return 0;\n  }\n  var L = new Float64Array([0xed, 0xd3, 0xf5, 0x5c, 0x1a, 0x63, 0x12, 0x58, 0xd6, 0x9c, 0xf7, 0xa2, 0xde, 0xf9, 0xde, 0x14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x10]);\n  function modL(r, x) {\n    var carry, i, j, k;\n    for (i = 63; i >= 32; --i) {\n      carry = 0;\n      for (j = i - 32, k = i - 12; j < k; ++j) {\n        x[j] += carry - 16 * x[i] * L[j - (i - 32)];\n        carry = Math.floor((x[j] + 128) / 256);\n        x[j] -= carry * 256;\n      }\n      x[j] += carry;\n      x[i] = 0;\n    }\n    carry = 0;\n    for (j = 0; j < 32; j++) {\n      x[j] += carry - (x[31] >> 4) * L[j];\n      carry = x[j] >> 8;\n      x[j] &= 255;\n    }\n    for (j = 0; j < 32; j++) x[j] -= carry * L[j];\n    for (i = 0; i < 32; i++) {\n      x[i + 1] += x[i] >> 8;\n      r[i] = x[i] & 255;\n    }\n  }\n  function reduce(r) {\n    var x = new Float64Array(64),\n      i;\n    for (i = 0; i < 64; i++) x[i] = r[i];\n    for (i = 0; i < 64; i++) r[i] = 0;\n    modL(r, x);\n  }\n  function crypto_sign(sm, m, n, sk) {\n    var d = new Uint8Array(64),\n      h = new Uint8Array(64),\n      r = new Uint8Array(64);\n    var i,\n      j,\n      x = new Float64Array(64);\n    var p = [gf(), gf(), gf(), gf()];\n    crypto_hash(d, sk, 32);\n    d[0] &= 248;\n    d[31] &= 127;\n    d[31] |= 64;\n    var smlen = n + 64;\n    for (i = 0; i < n; i++) sm[64 + i] = m[i];\n    for (i = 0; i < 32; i++) sm[32 + i] = d[32 + i];\n    crypto_hash(r, sm.subarray(32), n + 32);\n    reduce(r);\n    scalarbase(p, r);\n    pack(sm, p);\n    for (i = 32; i < 64; i++) sm[i] = sk[i];\n    crypto_hash(h, sm, n + 64);\n    reduce(h);\n    for (i = 0; i < 64; i++) x[i] = 0;\n    for (i = 0; i < 32; i++) x[i] = r[i];\n    for (i = 0; i < 32; i++) {\n      for (j = 0; j < 32; j++) {\n        x[i + j] += h[i] * d[j];\n      }\n    }\n    modL(sm.subarray(32), x);\n    return smlen;\n  }\n  function unpackneg(r, p) {\n    var t = gf(),\n      chk = gf(),\n      num = gf(),\n      den = gf(),\n      den2 = gf(),\n      den4 = gf(),\n      den6 = gf();\n    set25519(r[2], gf1);\n    unpack25519(r[1], p);\n    S(num, r[1]);\n    M(den, num, D);\n    Z(num, num, r[2]);\n    A(den, r[2], den);\n    S(den2, den);\n    S(den4, den2);\n    M(den6, den4, den2);\n    M(t, den6, num);\n    M(t, t, den);\n    pow2523(t, t);\n    M(t, t, num);\n    M(t, t, den);\n    M(t, t, den);\n    M(r[0], t, den);\n    S(chk, r[0]);\n    M(chk, chk, den);\n    if (neq25519(chk, num)) M(r[0], r[0], I);\n    S(chk, r[0]);\n    M(chk, chk, den);\n    if (neq25519(chk, num)) return -1;\n    if (par25519(r[0]) === p[31] >> 7) Z(r[0], gf0, r[0]);\n    M(r[3], r[0], r[1]);\n    return 0;\n  }\n  function crypto_sign_open(m, sm, n, pk) {\n    var i;\n    var t = new Uint8Array(32),\n      h = new Uint8Array(64);\n    var p = [gf(), gf(), gf(), gf()],\n      q = [gf(), gf(), gf(), gf()];\n    if (n < 64) return -1;\n    if (unpackneg(q, pk)) return -1;\n    for (i = 0; i < n; i++) m[i] = sm[i];\n    for (i = 0; i < 32; i++) m[i + 32] = pk[i];\n    crypto_hash(h, m, n);\n    reduce(h);\n    scalarmult(p, q, h);\n    scalarbase(q, sm.subarray(32));\n    add(p, q);\n    pack(t, p);\n    n -= 64;\n    if (crypto_verify_32(sm, 0, t, 0)) {\n      for (i = 0; i < n; i++) m[i] = 0;\n      return -1;\n    }\n    for (i = 0; i < n; i++) m[i] = sm[i + 64];\n    return n;\n  }\n  var crypto_secretbox_KEYBYTES = 32,\n    crypto_secretbox_NONCEBYTES = 24,\n    crypto_secretbox_ZEROBYTES = 32,\n    crypto_secretbox_BOXZEROBYTES = 16,\n    crypto_scalarmult_BYTES = 32,\n    crypto_scalarmult_SCALARBYTES = 32,\n    crypto_box_PUBLICKEYBYTES = 32,\n    crypto_box_SECRETKEYBYTES = 32,\n    crypto_box_BEFORENMBYTES = 32,\n    crypto_box_NONCEBYTES = crypto_secretbox_NONCEBYTES,\n    crypto_box_ZEROBYTES = crypto_secretbox_ZEROBYTES,\n    crypto_box_BOXZEROBYTES = crypto_secretbox_BOXZEROBYTES,\n    crypto_sign_BYTES = 64,\n    crypto_sign_PUBLICKEYBYTES = 32,\n    crypto_sign_SECRETKEYBYTES = 64,\n    crypto_sign_SEEDBYTES = 32,\n    crypto_hash_BYTES = 64;\n  nacl.lowlevel = {\n    crypto_core_hsalsa20: crypto_core_hsalsa20,\n    crypto_stream_xor: crypto_stream_xor,\n    crypto_stream: crypto_stream,\n    crypto_stream_salsa20_xor: crypto_stream_salsa20_xor,\n    crypto_stream_salsa20: crypto_stream_salsa20,\n    crypto_onetimeauth: crypto_onetimeauth,\n    crypto_onetimeauth_verify: crypto_onetimeauth_verify,\n    crypto_verify_16: crypto_verify_16,\n    crypto_verify_32: crypto_verify_32,\n    crypto_secretbox: crypto_secretbox,\n    crypto_secretbox_open: crypto_secretbox_open,\n    crypto_scalarmult: crypto_scalarmult,\n    crypto_scalarmult_base: crypto_scalarmult_base,\n    crypto_box_beforenm: crypto_box_beforenm,\n    crypto_box_afternm: crypto_box_afternm,\n    crypto_box: crypto_box,\n    crypto_box_open: crypto_box_open,\n    crypto_box_keypair: crypto_box_keypair,\n    crypto_hash: crypto_hash,\n    crypto_sign: crypto_sign,\n    crypto_sign_keypair: crypto_sign_keypair,\n    crypto_sign_open: crypto_sign_open,\n    crypto_secretbox_KEYBYTES: crypto_secretbox_KEYBYTES,\n    crypto_secretbox_NONCEBYTES: crypto_secretbox_NONCEBYTES,\n    crypto_secretbox_ZEROBYTES: crypto_secretbox_ZEROBYTES,\n    crypto_secretbox_BOXZEROBYTES: crypto_secretbox_BOXZEROBYTES,\n    crypto_scalarmult_BYTES: crypto_scalarmult_BYTES,\n    crypto_scalarmult_SCALARBYTES: crypto_scalarmult_SCALARBYTES,\n    crypto_box_PUBLICKEYBYTES: crypto_box_PUBLICKEYBYTES,\n    crypto_box_SECRETKEYBYTES: crypto_box_SECRETKEYBYTES,\n    crypto_box_BEFORENMBYTES: crypto_box_BEFORENMBYTES,\n    crypto_box_NONCEBYTES: crypto_box_NONCEBYTES,\n    crypto_box_ZEROBYTES: crypto_box_ZEROBYTES,\n    crypto_box_BOXZEROBYTES: crypto_box_BOXZEROBYTES,\n    crypto_sign_BYTES: crypto_sign_BYTES,\n    crypto_sign_PUBLICKEYBYTES: crypto_sign_PUBLICKEYBYTES,\n    crypto_sign_SECRETKEYBYTES: crypto_sign_SECRETKEYBYTES,\n    crypto_sign_SEEDBYTES: crypto_sign_SEEDBYTES,\n    crypto_hash_BYTES: crypto_hash_BYTES,\n    gf: gf,\n    D: D,\n    L: L,\n    pack25519: pack25519,\n    unpack25519: unpack25519,\n    M: M,\n    A: A,\n    S: S,\n    Z: Z,\n    pow2523: pow2523,\n    add: add,\n    set25519: set25519,\n    modL: modL,\n    scalarmult: scalarmult,\n    scalarbase: scalarbase\n  };\n  function checkLengths(k, n) {\n    if (k.length !== crypto_secretbox_KEYBYTES) throw new Error('bad key size');\n    if (n.length !== crypto_secretbox_NONCEBYTES) throw new Error('bad nonce size');\n  }\n  function checkBoxLengths(pk, sk) {\n    if (pk.length !== crypto_box_PUBLICKEYBYTES) throw new Error('bad public key size');\n    if (sk.length !== crypto_box_SECRETKEYBYTES) throw new Error('bad secret key size');\n  }\n  function checkArrayTypes() {\n    for (var i = 0; i < arguments.length; i++) {\n      if (!(arguments[i] instanceof Uint8Array)) throw new TypeError('unexpected type, use Uint8Array');\n    }\n  }\n  function cleanup(arr) {\n    for (var i = 0; i < arr.length; i++) arr[i] = 0;\n  }\n  nacl.randomBytes = function (n) {\n    var b = new Uint8Array(n);\n    randombytes(b, n);\n    return b;\n  };\n  nacl.secretbox = function (msg, nonce, key) {\n    checkArrayTypes(msg, nonce, key);\n    checkLengths(key, nonce);\n    var m = new Uint8Array(crypto_secretbox_ZEROBYTES + msg.length);\n    var c = new Uint8Array(m.length);\n    for (var i = 0; i < msg.length; i++) m[i + crypto_secretbox_ZEROBYTES] = msg[i];\n    crypto_secretbox(c, m, m.length, nonce, key);\n    return c.subarray(crypto_secretbox_BOXZEROBYTES);\n  };\n  nacl.secretbox.open = function (box, nonce, key) {\n    checkArrayTypes(box, nonce, key);\n    checkLengths(key, nonce);\n    var c = new Uint8Array(crypto_secretbox_BOXZEROBYTES + box.length);\n    var m = new Uint8Array(c.length);\n    for (var i = 0; i < box.length; i++) c[i + crypto_secretbox_BOXZEROBYTES] = box[i];\n    if (c.length < 32) return null;\n    if (crypto_secretbox_open(m, c, c.length, nonce, key) !== 0) return null;\n    return m.subarray(crypto_secretbox_ZEROBYTES);\n  };\n  nacl.secretbox.keyLength = crypto_secretbox_KEYBYTES;\n  nacl.secretbox.nonceLength = crypto_secretbox_NONCEBYTES;\n  nacl.secretbox.overheadLength = crypto_secretbox_BOXZEROBYTES;\n  nacl.scalarMult = function (n, p) {\n    checkArrayTypes(n, p);\n    if (n.length !== crypto_scalarmult_SCALARBYTES) throw new Error('bad n size');\n    if (p.length !== crypto_scalarmult_BYTES) throw new Error('bad p size');\n    var q = new Uint8Array(crypto_scalarmult_BYTES);\n    crypto_scalarmult(q, n, p);\n    return q;\n  };\n  nacl.scalarMult.base = function (n) {\n    checkArrayTypes(n);\n    if (n.length !== crypto_scalarmult_SCALARBYTES) throw new Error('bad n size');\n    var q = new Uint8Array(crypto_scalarmult_BYTES);\n    crypto_scalarmult_base(q, n);\n    return q;\n  };\n  nacl.scalarMult.scalarLength = crypto_scalarmult_SCALARBYTES;\n  nacl.scalarMult.groupElementLength = crypto_scalarmult_BYTES;\n  nacl.box = function (msg, nonce, publicKey, secretKey) {\n    var k = nacl.box.before(publicKey, secretKey);\n    return nacl.secretbox(msg, nonce, k);\n  };\n  nacl.box.before = function (publicKey, secretKey) {\n    checkArrayTypes(publicKey, secretKey);\n    checkBoxLengths(publicKey, secretKey);\n    var k = new Uint8Array(crypto_box_BEFORENMBYTES);\n    crypto_box_beforenm(k, publicKey, secretKey);\n    return k;\n  };\n  nacl.box.after = nacl.secretbox;\n  nacl.box.open = function (msg, nonce, publicKey, secretKey) {\n    var k = nacl.box.before(publicKey, secretKey);\n    return nacl.secretbox.open(msg, nonce, k);\n  };\n  nacl.box.open.after = nacl.secretbox.open;\n  nacl.box.keyPair = function () {\n    var pk = new Uint8Array(crypto_box_PUBLICKEYBYTES);\n    var sk = new Uint8Array(crypto_box_SECRETKEYBYTES);\n    crypto_box_keypair(pk, sk);\n    return {\n      publicKey: pk,\n      secretKey: sk\n    };\n  };\n  nacl.box.keyPair.fromSecretKey = function (secretKey) {\n    checkArrayTypes(secretKey);\n    if (secretKey.length !== crypto_box_SECRETKEYBYTES) throw new Error('bad secret key size');\n    var pk = new Uint8Array(crypto_box_PUBLICKEYBYTES);\n    crypto_scalarmult_base(pk, secretKey);\n    return {\n      publicKey: pk,\n      secretKey: new Uint8Array(secretKey)\n    };\n  };\n  nacl.box.publicKeyLength = crypto_box_PUBLICKEYBYTES;\n  nacl.box.secretKeyLength = crypto_box_SECRETKEYBYTES;\n  nacl.box.sharedKeyLength = crypto_box_BEFORENMBYTES;\n  nacl.box.nonceLength = crypto_box_NONCEBYTES;\n  nacl.box.overheadLength = nacl.secretbox.overheadLength;\n  nacl.sign = function (msg, secretKey) {\n    checkArrayTypes(msg, secretKey);\n    if (secretKey.length !== crypto_sign_SECRETKEYBYTES) throw new Error('bad secret key size');\n    var signedMsg = new Uint8Array(crypto_sign_BYTES + msg.length);\n    crypto_sign(signedMsg, msg, msg.length, secretKey);\n    return signedMsg;\n  };\n  nacl.sign.open = function (signedMsg, publicKey) {\n    checkArrayTypes(signedMsg, publicKey);\n    if (publicKey.length !== crypto_sign_PUBLICKEYBYTES) throw new Error('bad public key size');\n    var tmp = new Uint8Array(signedMsg.length);\n    var mlen = crypto_sign_open(tmp, signedMsg, signedMsg.length, publicKey);\n    if (mlen < 0) return null;\n    var m = new Uint8Array(mlen);\n    for (var i = 0; i < m.length; i++) m[i] = tmp[i];\n    return m;\n  };\n  nacl.sign.detached = function (msg, secretKey) {\n    var signedMsg = nacl.sign(msg, secretKey);\n    var sig = new Uint8Array(crypto_sign_BYTES);\n    for (var i = 0; i < sig.length; i++) sig[i] = signedMsg[i];\n    return sig;\n  };\n  nacl.sign.detached.verify = function (msg, sig, publicKey) {\n    checkArrayTypes(msg, sig, publicKey);\n    if (sig.length !== crypto_sign_BYTES) throw new Error('bad signature size');\n    if (publicKey.length !== crypto_sign_PUBLICKEYBYTES) throw new Error('bad public key size');\n    var sm = new Uint8Array(crypto_sign_BYTES + msg.length);\n    var m = new Uint8Array(crypto_sign_BYTES + msg.length);\n    var i;\n    for (i = 0; i < crypto_sign_BYTES; i++) sm[i] = sig[i];\n    for (i = 0; i < msg.length; i++) sm[i + crypto_sign_BYTES] = msg[i];\n    return crypto_sign_open(m, sm, sm.length, publicKey) >= 0;\n  };\n  nacl.sign.keyPair = function () {\n    var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n    var sk = new Uint8Array(crypto_sign_SECRETKEYBYTES);\n    crypto_sign_keypair(pk, sk);\n    return {\n      publicKey: pk,\n      secretKey: sk\n    };\n  };\n  nacl.sign.keyPair.fromSecretKey = function (secretKey) {\n    checkArrayTypes(secretKey);\n    if (secretKey.length !== crypto_sign_SECRETKEYBYTES) throw new Error('bad secret key size');\n    var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n    for (var i = 0; i < pk.length; i++) pk[i] = secretKey[32 + i];\n    return {\n      publicKey: pk,\n      secretKey: new Uint8Array(secretKey)\n    };\n  };\n  nacl.sign.keyPair.fromSeed = function (seed) {\n    checkArrayTypes(seed);\n    if (seed.length !== crypto_sign_SEEDBYTES) throw new Error('bad seed size');\n    var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n    var sk = new Uint8Array(crypto_sign_SECRETKEYBYTES);\n    for (var i = 0; i < 32; i++) sk[i] = seed[i];\n    crypto_sign_keypair(pk, sk, true);\n    return {\n      publicKey: pk,\n      secretKey: sk\n    };\n  };\n  nacl.sign.publicKeyLength = crypto_sign_PUBLICKEYBYTES;\n  nacl.sign.secretKeyLength = crypto_sign_SECRETKEYBYTES;\n  nacl.sign.seedLength = crypto_sign_SEEDBYTES;\n  nacl.sign.signatureLength = crypto_sign_BYTES;\n  nacl.hash = function (msg) {\n    checkArrayTypes(msg);\n    var h = new Uint8Array(crypto_hash_BYTES);\n    crypto_hash(h, msg, msg.length);\n    return h;\n  };\n  nacl.hash.hashLength = crypto_hash_BYTES;\n  nacl.verify = function (x, y) {\n    checkArrayTypes(x, y);\n    if (x.length === 0 || y.length === 0) return false;\n    if (x.length !== y.length) return false;\n    return vn(x, 0, y, 0, x.length) === 0 ? true : false;\n  };\n  nacl.setPRNG = function (fn) {\n    randombytes = fn;\n  };\n  (function () {\n    var crypto1 = typeof globalThis !== 'undefined' ? globalThis.crypto || globalThis.msCrypto : null;\n    if (crypto1 && crypto1.getRandomValues) {\n      var QUOTA = 65536;\n      nacl.setPRNG(function (x, n) {\n        var i,\n          v = new Uint8Array(n);\n        for (i = 0; i < n; i += QUOTA) {\n          crypto1.getRandomValues(v.subarray(i, i + Math.min(n - i, QUOTA)));\n        }\n        for (i = 0; i < n; i++) x[i] = v[i];\n        cleanup(v);\n      });\n    } else if (typeof require !== 'undefined') {\n      crypto1 = require('crypto');\n      if (crypto1 && crypto1.randomBytes) {\n        nacl.setPRNG(function (x, n) {\n          var i,\n            v = crypto1.randomBytes(n);\n          for (i = 0; i < n; i++) x[i] = v[i];\n          cleanup(v);\n        });\n      }\n    }\n  })();\n})(typeof module !== 'undefined' && module.exports ? module.exports : globalThis.nacl = globalThis.nacl || {});\nconst nacl = typeof module !== 'undefined' && module.exports ? module.exports : globalThis.nacl;\nconst denoHelper = {\n  fromSeed: nacl.sign.keyPair.fromSeed,\n  sign: nacl.sign.detached,\n  verify: nacl.sign.detached.verify,\n  randomBytes: nacl.randomBytes\n};\nlet helper;\nfunction setEd25519Helper(lib) {\n  helper = lib;\n}\nfunction getEd25519Helper() {\n  return helper;\n}\nconst crc16tab = new Uint16Array([0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7, 0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef, 0x1231, 0x0210, 0x3273, 0x2252, 0x52b5, 0x4294, 0x72f7, 0x62d6, 0x9339, 0x8318, 0xb37b, 0xa35a, 0xd3bd, 0xc39c, 0xf3ff, 0xe3de, 0x2462, 0x3443, 0x0420, 0x1401, 0x64e6, 0x74c7, 0x44a4, 0x5485, 0xa56a, 0xb54b, 0x8528, 0x9509, 0xe5ee, 0xf5cf, 0xc5ac, 0xd58d, 0x3653, 0x2672, 0x1611, 0x0630, 0x76d7, 0x66f6, 0x5695, 0x46b4, 0xb75b, 0xa77a, 0x9719, 0x8738, 0xf7df, 0xe7fe, 0xd79d, 0xc7bc, 0x48c4, 0x58e5, 0x6886, 0x78a7, 0x0840, 0x1861, 0x2802, 0x3823, 0xc9cc, 0xd9ed, 0xe98e, 0xf9af, 0x8948, 0x9969, 0xa90a, 0xb92b, 0x5af5, 0x4ad4, 0x7ab7, 0x6a96, 0x1a71, 0x0a50, 0x3a33, 0x2a12, 0xdbfd, 0xcbdc, 0xfbbf, 0xeb9e, 0x9b79, 0x8b58, 0xbb3b, 0xab1a, 0x6ca6, 0x7c87, 0x4ce4, 0x5cc5, 0x2c22, 0x3c03, 0x0c60, 0x1c41, 0xedae, 0xfd8f, 0xcdec, 0xddcd, 0xad2a, 0xbd0b, 0x8d68, 0x9d49, 0x7e97, 0x6eb6, 0x5ed5, 0x4ef4, 0x3e13, 0x2e32, 0x1e51, 0x0e70, 0xff9f, 0xefbe, 0xdfdd, 0xcffc, 0xbf1b, 0xaf3a, 0x9f59, 0x8f78, 0x9188, 0x81a9, 0xb1ca, 0xa1eb, 0xd10c, 0xc12d, 0xf14e, 0xe16f, 0x1080, 0x00a1, 0x30c2, 0x20e3, 0x5004, 0x4025, 0x7046, 0x6067, 0x83b9, 0x9398, 0xa3fb, 0xb3da, 0xc33d, 0xd31c, 0xe37f, 0xf35e, 0x02b1, 0x1290, 0x22f3, 0x32d2, 0x4235, 0x5214, 0x6277, 0x7256, 0xb5ea, 0xa5cb, 0x95a8, 0x8589, 0xf56e, 0xe54f, 0xd52c, 0xc50d, 0x34e2, 0x24c3, 0x14a0, 0x0481, 0x7466, 0x6447, 0x5424, 0x4405, 0xa7db, 0xb7fa, 0x8799, 0x97b8, 0xe75f, 0xf77e, 0xc71d, 0xd73c, 0x26d3, 0x36f2, 0x0691, 0x16b0, 0x6657, 0x7676, 0x4615, 0x5634, 0xd94c, 0xc96d, 0xf90e, 0xe92f, 0x99c8, 0x89e9, 0xb98a, 0xa9ab, 0x5844, 0x4865, 0x7806, 0x6827, 0x18c0, 0x08e1, 0x3882, 0x28a3, 0xcb7d, 0xdb5c, 0xeb3f, 0xfb1e, 0x8bf9, 0x9bd8, 0xabbb, 0xbb9a, 0x4a75, 0x5a54, 0x6a37, 0x7a16, 0x0af1, 0x1ad0, 0x2ab3, 0x3a92, 0xfd2e, 0xed0f, 0xdd6c, 0xcd4d, 0xbdaa, 0xad8b, 0x9de8, 0x8dc9, 0x7c26, 0x6c07, 0x5c64, 0x4c45, 0x3ca2, 0x2c83, 0x1ce0, 0x0cc1, 0xef1f, 0xff3e, 0xcf5d, 0xdf7c, 0xaf9b, 0xbfba, 0x8fd9, 0x9ff8, 0x6e17, 0x7e36, 0x4e55, 0x5e74, 0x2e93, 0x3eb2, 0x0ed1, 0x1ef0]);\nclass crc16 {\n  static checksum(data) {\n    let crc = 0;\n    for (let i = 0; i < data.byteLength; i++) {\n      let b = data[i];\n      crc = crc << 8 & 0xffff ^ crc16tab[(crc >> 8 ^ b) & 0x00FF];\n    }\n    return crc;\n  }\n  static validate(data, expected) {\n    let ba = crc16.checksum(data);\n    return ba == expected;\n  }\n}\nconst b32Alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567\";\nclass base32 {\n  static encode(src) {\n    let bits = 0;\n    let value = 0;\n    let a = new Uint8Array(src);\n    let buf = new Uint8Array(src.byteLength * 2);\n    let j = 0;\n    for (let i = 0; i < a.byteLength; i++) {\n      value = value << 8 | a[i];\n      bits += 8;\n      while (bits >= 5) {\n        let index = value >>> bits - 5 & 31;\n        buf[j++] = b32Alphabet.charAt(index).charCodeAt(0);\n        bits -= 5;\n      }\n    }\n    if (bits > 0) {\n      let index = value << 5 - bits & 31;\n      buf[j++] = b32Alphabet.charAt(index).charCodeAt(0);\n    }\n    return buf.slice(0, j);\n  }\n  static decode(src) {\n    let bits = 0;\n    let __byte = 0;\n    let j = 0;\n    let a = new Uint8Array(src);\n    let out = new Uint8Array(a.byteLength * 5 / 8 | 0);\n    for (let i = 0; i < a.byteLength; i++) {\n      let v = String.fromCharCode(a[i]);\n      let vv = b32Alphabet.indexOf(v);\n      if (vv === -1) {\n        throw new Error(\"Illegal Base32 character: \" + a[i]);\n      }\n      __byte = __byte << 5 | vv;\n      bits += 5;\n      if (bits >= 8) {\n        out[j++] = __byte >>> bits - 8 & 255;\n        bits -= 8;\n      }\n    }\n    return out.slice(0, j);\n  }\n}\nclass NKeysError extends Error {\n  name;\n  code;\n  chainedError;\n  constructor(code, chainedError) {\n    super(code);\n    this.name = \"NKeysError\";\n    this.code = code;\n    this.chainedError = chainedError;\n  }\n}\nfunction createOperator() {\n  return createPair(Prefix.Operator);\n}\nfunction createAccount() {\n  return createPair(Prefix.Account);\n}\nfunction createUser() {\n  return createPair(Prefix.User);\n}\nvar NKeysErrorCode;\n(function (NKeysErrorCode) {\n  NKeysErrorCode[\"InvalidPrefixByte\"] = \"nkeys: invalid prefix byte\";\n  NKeysErrorCode[\"InvalidKey\"] = \"nkeys: invalid key\";\n  NKeysErrorCode[\"InvalidPublicKey\"] = \"nkeys: invalid public key\";\n  NKeysErrorCode[\"InvalidSeedLen\"] = \"nkeys: invalid seed length\";\n  NKeysErrorCode[\"InvalidSeed\"] = \"nkeys: invalid seed\";\n  NKeysErrorCode[\"InvalidEncoding\"] = \"nkeys: invalid encoded key\";\n  NKeysErrorCode[\"InvalidSignature\"] = \"nkeys: signature verification failed\";\n  NKeysErrorCode[\"CannotSign\"] = \"nkeys: cannot sign, no private key available\";\n  NKeysErrorCode[\"PublicKeyOnly\"] = \"nkeys: no seed or private key available\";\n  NKeysErrorCode[\"InvalidChecksum\"] = \"nkeys: invalid checksum\";\n  NKeysErrorCode[\"SerializationError\"] = \"nkeys: serialization error\";\n  NKeysErrorCode[\"ApiError\"] = \"nkeys: api error\";\n  NKeysErrorCode[\"ClearedPair\"] = \"nkeys: pair is cleared\";\n})(NKeysErrorCode || (NKeysErrorCode = {}));\nvar Prefix;\n(function (Prefix) {\n  Prefix[Prefix[\"Seed\"] = 144] = \"Seed\";\n  Prefix[Prefix[\"Private\"] = 120] = \"Private\";\n  Prefix[Prefix[\"Operator\"] = 112] = \"Operator\";\n  Prefix[Prefix[\"Server\"] = 104] = \"Server\";\n  Prefix[Prefix[\"Cluster\"] = 16] = \"Cluster\";\n  Prefix[Prefix[\"Account\"] = 0] = \"Account\";\n  Prefix[Prefix[\"User\"] = 160] = \"User\";\n})(Prefix || (Prefix = {}));\nclass Prefixes {\n  static isValidPublicPrefix(prefix) {\n    return prefix == Prefix.Server || prefix == Prefix.Operator || prefix == Prefix.Cluster || prefix == Prefix.Account || prefix == Prefix.User;\n  }\n  static startsWithValidPrefix(s) {\n    let c = s[0];\n    return c == \"S\" || c == \"P\" || c == \"O\" || c == \"N\" || c == \"C\" || c == \"A\" || c == \"U\";\n  }\n  static isValidPrefix(prefix) {\n    let v = this.parsePrefix(prefix);\n    return v != -1;\n  }\n  static parsePrefix(v) {\n    switch (v) {\n      case Prefix.Seed:\n        return Prefix.Seed;\n      case Prefix.Private:\n        return Prefix.Private;\n      case Prefix.Operator:\n        return Prefix.Operator;\n      case Prefix.Server:\n        return Prefix.Server;\n      case Prefix.Cluster:\n        return Prefix.Cluster;\n      case Prefix.Account:\n        return Prefix.Account;\n      case Prefix.User:\n        return Prefix.User;\n      default:\n        return -1;\n    }\n  }\n}\nclass Codec {\n  static encode(prefix, src) {\n    if (!src || !(src instanceof Uint8Array)) {\n      throw new NKeysError(NKeysErrorCode.SerializationError);\n    }\n    if (!Prefixes.isValidPrefix(prefix)) {\n      throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n    }\n    return Codec._encode(false, prefix, src);\n  }\n  static encodeSeed(role, src) {\n    if (!src) {\n      throw new NKeysError(NKeysErrorCode.ApiError);\n    }\n    if (!Prefixes.isValidPublicPrefix(role)) {\n      throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n    }\n    if (src.byteLength !== 32) {\n      throw new NKeysError(NKeysErrorCode.InvalidSeedLen);\n    }\n    return Codec._encode(true, role, src);\n  }\n  static decode(expected, src) {\n    if (!Prefixes.isValidPrefix(expected)) {\n      throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n    }\n    const raw = Codec._decode(src);\n    if (raw[0] !== expected) {\n      throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n    }\n    return raw.slice(1);\n  }\n  static decodeSeed(src) {\n    const raw = Codec._decode(src);\n    const prefix = Codec._decodePrefix(raw);\n    if (prefix[0] != Prefix.Seed) {\n      throw new NKeysError(NKeysErrorCode.InvalidSeed);\n    }\n    if (!Prefixes.isValidPublicPrefix(prefix[1])) {\n      throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n    }\n    return {\n      buf: raw.slice(2),\n      prefix: prefix[1]\n    };\n  }\n  static _encode(seed, role, payload) {\n    const payloadOffset = seed ? 2 : 1;\n    const payloadLen = payload.byteLength;\n    const cap = payloadOffset + payloadLen + 2;\n    const checkOffset = payloadOffset + payloadLen;\n    const raw = new Uint8Array(cap);\n    if (seed) {\n      const encodedPrefix = Codec._encodePrefix(Prefix.Seed, role);\n      raw.set(encodedPrefix);\n    } else {\n      raw[0] = role;\n    }\n    raw.set(payload, payloadOffset);\n    const checksum = crc16.checksum(raw.slice(0, checkOffset));\n    const dv = new DataView(raw.buffer);\n    dv.setUint16(checkOffset, checksum, true);\n    return base32.encode(raw);\n  }\n  static _decode(src) {\n    if (src.byteLength < 4) {\n      throw new NKeysError(NKeysErrorCode.InvalidEncoding);\n    }\n    let raw;\n    try {\n      raw = base32.decode(src);\n    } catch (ex) {\n      throw new NKeysError(NKeysErrorCode.InvalidEncoding, ex);\n    }\n    const checkOffset = raw.byteLength - 2;\n    const dv = new DataView(raw.buffer);\n    const checksum = dv.getUint16(checkOffset, true);\n    const payload = raw.slice(0, checkOffset);\n    if (!crc16.validate(payload, checksum)) {\n      throw new NKeysError(NKeysErrorCode.InvalidChecksum);\n    }\n    return payload;\n  }\n  static _encodePrefix(kind, role) {\n    const b1 = kind | role >> 5;\n    const b2 = (role & 31) << 3;\n    return new Uint8Array([b1, b2]);\n  }\n  static _decodePrefix(raw) {\n    const b1 = raw[0] & 248;\n    const b2 = (raw[0] & 7) << 5 | (raw[1] & 248) >> 3;\n    return new Uint8Array([b1, b2]);\n  }\n}\nclass KP {\n  seed;\n  constructor(seed) {\n    this.seed = seed;\n  }\n  getRawSeed() {\n    if (!this.seed) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    let sd = Codec.decodeSeed(this.seed);\n    return sd.buf;\n  }\n  getSeed() {\n    if (!this.seed) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    return this.seed;\n  }\n  getPublicKey() {\n    if (!this.seed) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    const sd = Codec.decodeSeed(this.seed);\n    const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n    const buf = Codec.encode(sd.prefix, kp.publicKey);\n    return new TextDecoder().decode(buf);\n  }\n  getPrivateKey() {\n    if (!this.seed) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n    return Codec.encode(Prefix.Private, kp.secretKey);\n  }\n  sign(input) {\n    if (!this.seed) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n    return getEd25519Helper().sign(input, kp.secretKey);\n  }\n  verify(input, sig) {\n    if (!this.seed) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n    return getEd25519Helper().verify(input, sig, kp.publicKey);\n  }\n  clear() {\n    if (!this.seed) {\n      return;\n    }\n    this.seed.fill(0);\n    this.seed = undefined;\n  }\n}\nfunction createPair(prefix) {\n  const rawSeed = getEd25519Helper().randomBytes(32);\n  let str = Codec.encodeSeed(prefix, new Uint8Array(rawSeed));\n  return new KP(str);\n}\nclass PublicKey {\n  publicKey;\n  constructor(publicKey) {\n    this.publicKey = publicKey;\n  }\n  getPublicKey() {\n    if (!this.publicKey) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    return new TextDecoder().decode(this.publicKey);\n  }\n  getPrivateKey() {\n    if (!this.publicKey) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    throw new NKeysError(NKeysErrorCode.PublicKeyOnly);\n  }\n  getSeed() {\n    if (!this.publicKey) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    throw new NKeysError(NKeysErrorCode.PublicKeyOnly);\n  }\n  sign(_) {\n    if (!this.publicKey) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    throw new NKeysError(NKeysErrorCode.CannotSign);\n  }\n  verify(input, sig) {\n    if (!this.publicKey) {\n      throw new NKeysError(NKeysErrorCode.ClearedPair);\n    }\n    let buf = Codec._decode(this.publicKey);\n    return getEd25519Helper().verify(input, sig, buf.slice(1));\n  }\n  clear() {\n    if (!this.publicKey) {\n      return;\n    }\n    this.publicKey.fill(0);\n    this.publicKey = undefined;\n  }\n}\nfunction fromPublic(src) {\n  const ba = new TextEncoder().encode(src);\n  const raw = Codec._decode(ba);\n  const prefix = Prefixes.parsePrefix(raw[0]);\n  if (Prefixes.isValidPublicPrefix(prefix)) {\n    return new PublicKey(ba);\n  }\n  throw new NKeysError(NKeysErrorCode.InvalidPublicKey);\n}\nfunction fromSeed(src) {\n  Codec.decodeSeed(src);\n  return new KP(src);\n}\nfunction encode2(bytes) {\n  return btoa(String.fromCharCode(...bytes));\n}\nfunction decode2(b64str) {\n  const bin = atob(b64str);\n  const bytes = new Uint8Array(bin.length);\n  for (let i = 0; i < bin.length; i++) {\n    bytes[i] = bin.charCodeAt(i);\n  }\n  return bytes;\n}\nsetEd25519Helper(denoHelper);\nconst mod = {\n  createAccount,\n  createOperator,\n  createPair,\n  createUser,\n  fromPublic,\n  fromSeed,\n  NKeysError,\n  NKeysErrorCode,\n  Prefix,\n  decode: decode2,\n  encode: encode2\n};\nfunction multiAuthenticator(authenticators) {\n  return nonce => {\n    let auth = {};\n    authenticators.forEach(a => {\n      const args = a(nonce) || {};\n      auth = Object.assign(auth, args);\n    });\n    return auth;\n  };\n}\nfunction noAuthFn() {\n  return () => {\n    return;\n  };\n}\nfunction usernamePasswordAuthenticator(user, pass) {\n  return () => {\n    const u = typeof user === \"function\" ? user() : user;\n    const p = typeof pass === \"function\" ? pass() : pass;\n    return {\n      user: u,\n      pass: p\n    };\n  };\n}\nfunction tokenAuthenticator(token) {\n  return () => {\n    const auth_token = typeof token === \"function\" ? token() : token;\n    return {\n      auth_token\n    };\n  };\n}\nfunction nkeyAuthenticator(seed) {\n  return nonce => {\n    const s = typeof seed === \"function\" ? seed() : seed;\n    const kp = s ? mod.fromSeed(s) : undefined;\n    const nkey = kp ? kp.getPublicKey() : \"\";\n    const challenge = TE.encode(nonce || \"\");\n    const sigBytes = kp !== undefined && nonce ? kp.sign(challenge) : undefined;\n    const sig = sigBytes ? mod.encode(sigBytes) : \"\";\n    return {\n      nkey,\n      sig\n    };\n  };\n}\nfunction jwtAuthenticator(ajwt, seed) {\n  return nonce => {\n    const jwt = typeof ajwt === \"function\" ? ajwt() : ajwt;\n    const fn = nkeyAuthenticator(seed);\n    const {\n      nkey,\n      sig\n    } = fn(nonce);\n    return {\n      jwt,\n      nkey,\n      sig\n    };\n  };\n}\nfunction credsAuthenticator(creds) {\n  const fn = typeof creds !== \"function\" ? () => creds : creds;\n  const parse = () => {\n    const CREDS = /\\s*(?:(?:[-]{3,}[^\\n]*[-]{3,}\\n)(.+)(?:\\n\\s*[-]{3,}[^\\n]*[-]{3,}\\n))/ig;\n    const s = TD.decode(fn());\n    let m = CREDS.exec(s);\n    if (!m) {\n      throw NatsError.errorForCode(ErrorCode.BadCreds);\n    }\n    const jwt = m[1].trim();\n    m = CREDS.exec(s);\n    if (!m) {\n      throw NatsError.errorForCode(ErrorCode.BadCreds);\n    }\n    if (!m) {\n      throw NatsError.errorForCode(ErrorCode.BadCreds);\n    }\n    const seed = TE.encode(m[1].trim());\n    return {\n      jwt,\n      seed\n    };\n  };\n  const jwtFn = () => {\n    const {\n      jwt\n    } = parse();\n    return jwt;\n  };\n  const nkeyFn = () => {\n    const {\n      seed\n    } = parse();\n    return seed;\n  };\n  return jwtAuthenticator(jwtFn, nkeyFn);\n}\nconst DEFAULT_PING_INTERVAL = 2 * 60 * 1000;\nconst DEFAULT_MAX_PING_OUT = 2;\nconst DEFAULT_RECONNECT_TIME_WAIT = 2 * 1000;\nfunction defaultOptions() {\n  return {\n    maxPingOut: 2,\n    maxReconnectAttempts: 10,\n    noRandomize: false,\n    pedantic: false,\n    pingInterval: DEFAULT_PING_INTERVAL,\n    reconnect: true,\n    reconnectJitter: 100,\n    reconnectJitterTLS: 1000,\n    reconnectTimeWait: DEFAULT_RECONNECT_TIME_WAIT,\n    tls: undefined,\n    verbose: false,\n    waitOnFirstConnect: false,\n    ignoreAuthErrorAbort: false\n  };\n}\nfunction buildAuthenticator(opts) {\n  const buf = [];\n  if (typeof opts.authenticator === \"function\") {\n    buf.push(opts.authenticator);\n  }\n  if (Array.isArray(opts.authenticator)) {\n    buf.push(...opts.authenticator);\n  }\n  if (opts.token) {\n    buf.push(tokenAuthenticator(opts.token));\n  }\n  if (opts.user) {\n    buf.push(usernamePasswordAuthenticator(opts.user, opts.pass));\n  }\n  return buf.length === 0 ? noAuthFn() : multiAuthenticator(buf);\n}\nfunction parseOptions(opts) {\n  const dhp = `${DEFAULT_HOST}:${defaultPort()}`;\n  opts = opts || {\n    servers: [dhp]\n  };\n  opts.servers = opts.servers || [];\n  if (typeof opts.servers === \"string\") {\n    opts.servers = [opts.servers];\n  }\n  if (opts.servers.length > 0 && opts.port) {\n    throw new NatsError(\"port and servers options are mutually exclusive\", ErrorCode.InvalidOption);\n  }\n  if (opts.servers.length === 0 && opts.port) {\n    opts.servers = [`${DEFAULT_HOST}:${opts.port}`];\n  }\n  if (opts.servers && opts.servers.length === 0) {\n    opts.servers = [dhp];\n  }\n  const options = extend(defaultOptions(), opts);\n  options.authenticator = buildAuthenticator(options);\n  [\"reconnectDelayHandler\", \"authenticator\"].forEach(n => {\n    if (options[n] && typeof options[n] !== \"function\") {\n      throw new NatsError(`${n} option should be a function`, ErrorCode.NotFunction);\n    }\n  });\n  if (!options.reconnectDelayHandler) {\n    options.reconnectDelayHandler = () => {\n      let extra = options.tls ? options.reconnectJitterTLS : options.reconnectJitter;\n      if (extra) {\n        extra++;\n        extra = Math.floor(Math.random() * extra);\n      }\n      return options.reconnectTimeWait + extra;\n    };\n  }\n  if (options.inboxPrefix) {\n    try {\n      createInbox(options.inboxPrefix);\n    } catch (err) {\n      throw new NatsError(err.message, ErrorCode.ApiError);\n    }\n  }\n  if (options.resolve === undefined) {\n    options.resolve = typeof getResolveFn() === \"function\";\n  }\n  if (options.resolve) {\n    if (typeof getResolveFn() !== \"function\") {\n      throw new NatsError(`'resolve' is not supported on this client`, ErrorCode.InvalidOption);\n    }\n  }\n  return options;\n}\nfunction checkOptions(info, options) {\n  const {\n    proto,\n    tls_required: tlsRequired,\n    tls_available: tlsAvailable\n  } = info;\n  if ((proto === undefined || proto < 1) && options.noEcho) {\n    throw new NatsError(\"noEcho\", ErrorCode.ServerOptionNotAvailable);\n  }\n  const tls = tlsRequired || tlsAvailable || false;\n  if (options.tls && !tls) {\n    throw new NatsError(\"tls\", ErrorCode.ServerOptionNotAvailable);\n  }\n}\nconst FLUSH_THRESHOLD = 1024 * 32;\nconst INFO = /^INFO\\s+([^\\r\\n]+)\\r\\n/i;\nconst PONG_CMD = encode(\"PONG\\r\\n\");\nconst PING_CMD = encode(\"PING\\r\\n\");\nclass Connect {\n  echo;\n  no_responders;\n  protocol;\n  verbose;\n  pedantic;\n  jwt;\n  nkey;\n  sig;\n  user;\n  pass;\n  auth_token;\n  tls_required;\n  name;\n  lang;\n  version;\n  headers;\n  constructor(transport, opts, nonce) {\n    this.protocol = 1;\n    this.version = transport.version;\n    this.lang = transport.lang;\n    this.echo = opts.noEcho ? false : undefined;\n    this.verbose = opts.verbose;\n    this.pedantic = opts.pedantic;\n    this.tls_required = opts.tls ? true : undefined;\n    this.name = opts.name;\n    const creds = (opts && typeof opts.authenticator === \"function\" ? opts.authenticator(nonce) : {}) || {};\n    extend(this, creds);\n  }\n}\nclass SubscriptionImpl extends QueuedIteratorImpl {\n  sid;\n  queue;\n  draining;\n  max;\n  subject;\n  drained;\n  protocol;\n  timer;\n  info;\n  cleanupFn;\n  closed;\n  requestSubject;\n  constructor(protocol, subject, opts = {}) {\n    super();\n    extend(this, opts);\n    this.protocol = protocol;\n    this.subject = subject;\n    this.draining = false;\n    this.noIterator = typeof opts.callback === \"function\";\n    this.closed = deferred();\n    const asyncTraces = !(protocol.options?.noAsyncTraces || false);\n    if (opts.timeout) {\n      this.timer = timeout(opts.timeout, asyncTraces);\n      this.timer.then(() => {\n        this.timer = undefined;\n      }).catch(err => {\n        this.stop(err);\n        if (this.noIterator) {\n          this.callback(err, {});\n        }\n      });\n    }\n    if (!this.noIterator) {\n      this.iterClosed.then(() => {\n        this.closed.resolve();\n        this.unsubscribe();\n      });\n    }\n  }\n  setPrePostHandlers(opts) {\n    if (this.noIterator) {\n      const uc = this.callback;\n      const ingestion = opts.ingestionFilterFn ? opts.ingestionFilterFn : () => {\n        return {\n          ingest: true,\n          protocol: false\n        };\n      };\n      const filter = opts.protocolFilterFn ? opts.protocolFilterFn : () => {\n        return true;\n      };\n      const dispatched = opts.dispatchedFn ? opts.dispatchedFn : () => {};\n      this.callback = (err, msg) => {\n        const {\n          ingest\n        } = ingestion(msg);\n        if (!ingest) {\n          return;\n        }\n        if (filter(msg)) {\n          uc(err, msg);\n          dispatched(msg);\n        }\n      };\n    } else {\n      this.protocolFilterFn = opts.protocolFilterFn;\n      this.dispatchedFn = opts.dispatchedFn;\n    }\n  }\n  callback(err, msg) {\n    this.cancelTimeout();\n    err ? this.stop(err) : this.push(msg);\n  }\n  close() {\n    if (!this.isClosed()) {\n      this.cancelTimeout();\n      const fn = () => {\n        this.stop();\n        if (this.cleanupFn) {\n          try {\n            this.cleanupFn(this, this.info);\n          } catch (_err) {}\n        }\n        this.closed.resolve();\n      };\n      if (this.noIterator) {\n        fn();\n      } else {\n        this.push(fn);\n      }\n    }\n  }\n  unsubscribe(max) {\n    this.protocol.unsubscribe(this, max);\n  }\n  cancelTimeout() {\n    if (this.timer) {\n      this.timer.cancel();\n      this.timer = undefined;\n    }\n  }\n  drain() {\n    if (this.protocol.isClosed()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n    }\n    if (this.isClosed()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.SubClosed));\n    }\n    if (!this.drained) {\n      this.draining = true;\n      this.protocol.unsub(this);\n      this.drained = this.protocol.flush(deferred()).then(() => {\n        this.protocol.subscriptions.cancel(this);\n      }).catch(() => {\n        this.protocol.subscriptions.cancel(this);\n      });\n    }\n    return this.drained;\n  }\n  isDraining() {\n    return this.draining;\n  }\n  isClosed() {\n    return this.done;\n  }\n  getSubject() {\n    return this.subject;\n  }\n  getMax() {\n    return this.max;\n  }\n  getID() {\n    return this.sid;\n  }\n}\nclass Subscriptions {\n  mux;\n  subs;\n  sidCounter;\n  constructor() {\n    this.sidCounter = 0;\n    this.mux = null;\n    this.subs = new Map();\n  }\n  size() {\n    return this.subs.size;\n  }\n  add(s) {\n    this.sidCounter++;\n    s.sid = this.sidCounter;\n    this.subs.set(s.sid, s);\n    return s;\n  }\n  setMux(s) {\n    this.mux = s;\n    return s;\n  }\n  getMux() {\n    return this.mux;\n  }\n  get(sid) {\n    return this.subs.get(sid);\n  }\n  resub(s) {\n    this.sidCounter++;\n    this.subs.delete(s.sid);\n    s.sid = this.sidCounter;\n    this.subs.set(s.sid, s);\n    return s;\n  }\n  all() {\n    return Array.from(this.subs.values());\n  }\n  cancel(s) {\n    if (s) {\n      s.close();\n      this.subs.delete(s.sid);\n    }\n  }\n  handleError(err) {\n    if (err && err.permissionContext) {\n      const ctx = err.permissionContext;\n      const subs = this.all();\n      let sub;\n      if (ctx.operation === \"subscription\") {\n        sub = subs.find(s => {\n          return s.subject === ctx.subject && s.queue === ctx.queue;\n        });\n      }\n      if (ctx.operation === \"publish\") {\n        sub = subs.find(s => {\n          return s.requestSubject === ctx.subject;\n        });\n      }\n      if (sub) {\n        sub.callback(err, {});\n        sub.close();\n        this.subs.delete(sub.sid);\n        return sub !== this.mux;\n      }\n    }\n    return false;\n  }\n  close() {\n    this.subs.forEach(sub => {\n      sub.close();\n    });\n  }\n}\nclass ProtocolHandler {\n  connected;\n  connectedOnce;\n  infoReceived;\n  info;\n  muxSubscriptions;\n  options;\n  outbound;\n  pongs;\n  subscriptions;\n  transport;\n  noMorePublishing;\n  connectError;\n  publisher;\n  _closed;\n  closed;\n  listeners;\n  heartbeats;\n  parser;\n  outMsgs;\n  inMsgs;\n  outBytes;\n  inBytes;\n  pendingLimit;\n  lastError;\n  abortReconnect;\n  whyClosed;\n  servers;\n  server;\n  features;\n  connectPromise;\n  constructor(options, publisher) {\n    this._closed = false;\n    this.connected = false;\n    this.connectedOnce = false;\n    this.infoReceived = false;\n    this.noMorePublishing = false;\n    this.abortReconnect = false;\n    this.listeners = [];\n    this.pendingLimit = FLUSH_THRESHOLD;\n    this.outMsgs = 0;\n    this.inMsgs = 0;\n    this.outBytes = 0;\n    this.inBytes = 0;\n    this.options = options;\n    this.publisher = publisher;\n    this.subscriptions = new Subscriptions();\n    this.muxSubscriptions = new MuxSubscription();\n    this.outbound = new DataBuffer();\n    this.pongs = [];\n    this.whyClosed = \"\";\n    this.pendingLimit = options.pendingLimit || this.pendingLimit;\n    this.features = new Features({\n      major: 0,\n      minor: 0,\n      micro: 0\n    });\n    this.connectPromise = null;\n    const servers = typeof options.servers === \"string\" ? [options.servers] : options.servers;\n    this.servers = new Servers(servers, {\n      randomize: !options.noRandomize\n    });\n    this.closed = deferred();\n    this.parser = new Parser(this);\n    this.heartbeats = new Heartbeat(this, this.options.pingInterval || DEFAULT_PING_INTERVAL, this.options.maxPingOut || DEFAULT_MAX_PING_OUT);\n  }\n  resetOutbound() {\n    this.outbound.reset();\n    const pongs = this.pongs;\n    this.pongs = [];\n    const err = NatsError.errorForCode(ErrorCode.Disconnect);\n    err.stack = \"\";\n    pongs.forEach(p => {\n      p.reject(err);\n    });\n    this.parser = new Parser(this);\n    this.infoReceived = false;\n  }\n  dispatchStatus(status) {\n    this.listeners.forEach(q => {\n      q.push(status);\n    });\n  }\n  status() {\n    const iter = new QueuedIteratorImpl();\n    this.listeners.push(iter);\n    return iter;\n  }\n  prepare() {\n    if (this.transport) {\n      this.transport.discard();\n    }\n    this.info = undefined;\n    this.resetOutbound();\n    const pong = deferred();\n    pong.catch(() => {});\n    this.pongs.unshift(pong);\n    this.connectError = err => {\n      pong.reject(err);\n    };\n    this.transport = newTransport();\n    this.transport.closed().then(async _err => {\n      this.connected = false;\n      if (!this.isClosed()) {\n        await this.disconnected(this.transport.closeError || this.lastError);\n        return;\n      }\n    });\n    return pong;\n  }\n  disconnect() {\n    this.dispatchStatus({\n      type: DebugEvents.StaleConnection,\n      data: \"\"\n    });\n    this.transport.disconnect();\n  }\n  reconnect() {\n    if (this.connected) {\n      this.dispatchStatus({\n        type: DebugEvents.ClientInitiatedReconnect,\n        data: \"\"\n      });\n      this.transport.disconnect();\n    }\n    return Promise.resolve();\n  }\n  async disconnected(err) {\n    this.dispatchStatus({\n      type: Events.Disconnect,\n      data: this.servers.getCurrentServer().toString()\n    });\n    if (this.options.reconnect) {\n      await this.dialLoop().then(() => {\n        this.dispatchStatus({\n          type: Events.Reconnect,\n          data: this.servers.getCurrentServer().toString()\n        });\n        if (this.lastError?.code === ErrorCode.AuthenticationExpired) {\n          this.lastError = undefined;\n        }\n      }).catch(err => {\n        this._close(err);\n      });\n    } else {\n      await this._close(err);\n    }\n  }\n  async dial(srv) {\n    const pong = this.prepare();\n    let timer;\n    try {\n      timer = timeout(this.options.timeout || 20000);\n      const cp = this.transport.connect(srv, this.options);\n      await Promise.race([cp, timer]);\n      (async () => {\n        try {\n          for await (const b of this.transport) {\n            this.parser.parse(b);\n          }\n        } catch (err) {\n          console.log(\"reader closed\", err);\n        }\n      })().then();\n    } catch (err) {\n      pong.reject(err);\n    }\n    try {\n      await Promise.race([timer, pong]);\n      if (timer) {\n        timer.cancel();\n      }\n      this.connected = true;\n      this.connectError = undefined;\n      this.sendSubscriptions();\n      this.connectedOnce = true;\n      this.server.didConnect = true;\n      this.server.reconnects = 0;\n      this.flushPending();\n      this.heartbeats.start();\n    } catch (err) {\n      if (timer) {\n        timer.cancel();\n      }\n      await this.transport.close(err);\n      throw err;\n    }\n  }\n  async _doDial(srv) {\n    const {\n      resolve\n    } = this.options;\n    const alts = await srv.resolve({\n      fn: getResolveFn(),\n      debug: this.options.debug,\n      randomize: !this.options.noRandomize,\n      resolve\n    });\n    let lastErr = null;\n    for (const a of alts) {\n      try {\n        lastErr = null;\n        this.dispatchStatus({\n          type: DebugEvents.Reconnecting,\n          data: a.toString()\n        });\n        await this.dial(a);\n        return;\n      } catch (err) {\n        lastErr = err;\n      }\n    }\n    throw lastErr;\n  }\n  dialLoop() {\n    if (this.connectPromise === null) {\n      this.connectPromise = this.dodialLoop();\n      this.connectPromise.then(() => {}).catch(() => {}).finally(() => {\n        this.connectPromise = null;\n      });\n    }\n    return this.connectPromise;\n  }\n  async dodialLoop() {\n    let lastError;\n    while (true) {\n      if (this._closed) {\n        this.servers.clear();\n      }\n      const wait = this.options.reconnectDelayHandler ? this.options.reconnectDelayHandler() : DEFAULT_RECONNECT_TIME_WAIT;\n      let maxWait = wait;\n      const srv = this.selectServer();\n      if (!srv || this.abortReconnect) {\n        if (lastError) {\n          throw lastError;\n        } else if (this.lastError) {\n          throw this.lastError;\n        } else {\n          throw NatsError.errorForCode(ErrorCode.ConnectionRefused);\n        }\n      }\n      const now = Date.now();\n      if (srv.lastConnect === 0 || srv.lastConnect + wait <= now) {\n        srv.lastConnect = Date.now();\n        try {\n          await this._doDial(srv);\n          break;\n        } catch (err) {\n          lastError = err;\n          if (!this.connectedOnce) {\n            if (this.options.waitOnFirstConnect) {\n              continue;\n            }\n            this.servers.removeCurrentServer();\n          }\n          srv.reconnects++;\n          const mra = this.options.maxReconnectAttempts || 0;\n          if (mra !== -1 && srv.reconnects >= mra) {\n            this.servers.removeCurrentServer();\n          }\n        }\n      } else {\n        maxWait = Math.min(maxWait, srv.lastConnect + wait - now);\n        await delay(maxWait);\n      }\n    }\n  }\n  static async connect(options, publisher) {\n    const h = new ProtocolHandler(options, publisher);\n    await h.dialLoop();\n    return h;\n  }\n  static toError(s) {\n    const t = s ? s.toLowerCase() : \"\";\n    if (t.indexOf(\"permissions violation\") !== -1) {\n      const err = new NatsError(s, ErrorCode.PermissionsViolation);\n      const m = s.match(/(Publish|Subscription) to \"(\\S+)\"/);\n      if (m) {\n        err.permissionContext = {\n          operation: m[1].toLowerCase(),\n          subject: m[2],\n          queue: undefined\n        };\n        const qm = s.match(/using queue \"(\\S+)\"/);\n        if (qm) {\n          err.permissionContext.queue = qm[1];\n        }\n      }\n      return err;\n    } else if (t.indexOf(\"authorization violation\") !== -1) {\n      return new NatsError(s, ErrorCode.AuthorizationViolation);\n    } else if (t.indexOf(\"user authentication expired\") !== -1) {\n      return new NatsError(s, ErrorCode.AuthenticationExpired);\n    } else if (t.indexOf(\"account authentication expired\") != -1) {\n      return new NatsError(s, ErrorCode.AccountExpired);\n    } else if (t.indexOf(\"authentication timeout\") !== -1) {\n      return new NatsError(s, ErrorCode.AuthenticationTimeout);\n    } else {\n      return new NatsError(s, ErrorCode.ProtocolError);\n    }\n  }\n  processMsg(msg, data) {\n    this.inMsgs++;\n    this.inBytes += data.length;\n    if (!this.subscriptions.sidCounter) {\n      return;\n    }\n    const sub = this.subscriptions.get(msg.sid);\n    if (!sub) {\n      return;\n    }\n    sub.received += 1;\n    if (sub.callback) {\n      sub.callback(null, new MsgImpl(msg, data, this));\n    }\n    if (sub.max !== undefined && sub.received >= sub.max) {\n      sub.unsubscribe();\n    }\n  }\n  processError(m) {\n    const s = decode(m);\n    const err = ProtocolHandler.toError(s);\n    const status = {\n      type: Events.Error,\n      data: err.code\n    };\n    if (err.isPermissionError()) {\n      let isMuxPermissionError = false;\n      if (err.permissionContext) {\n        status.permissionContext = err.permissionContext;\n        const mux = this.subscriptions.getMux();\n        isMuxPermissionError = mux?.subject === err.permissionContext.subject;\n      }\n      this.subscriptions.handleError(err);\n      this.muxSubscriptions.handleError(isMuxPermissionError, err);\n      if (isMuxPermissionError) {\n        this.subscriptions.setMux(null);\n      }\n    }\n    this.dispatchStatus(status);\n    this.handleError(err);\n  }\n  handleError(err) {\n    if (err.isAuthError()) {\n      this.handleAuthError(err);\n    } else if (err.isProtocolError()) {\n      this.lastError = err;\n    } else if (err.isAuthTimeout()) {\n      this.lastError = err;\n    }\n    if (!err.isPermissionError()) {\n      this.lastError = err;\n    }\n  }\n  handleAuthError(err) {\n    if (this.lastError && err.code === this.lastError.code && this.options.ignoreAuthErrorAbort === false) {\n      this.abortReconnect = true;\n    }\n    if (this.connectError) {\n      this.connectError(err);\n    } else {\n      this.disconnect();\n    }\n  }\n  processPing() {\n    this.transport.send(PONG_CMD);\n  }\n  processPong() {\n    const cb = this.pongs.shift();\n    if (cb) {\n      cb.resolve();\n    }\n  }\n  processInfo(m) {\n    const info = JSON.parse(decode(m));\n    this.info = info;\n    const updates = this.options && this.options.ignoreClusterUpdates ? undefined : this.servers.update(info, this.transport.isEncrypted());\n    if (!this.infoReceived) {\n      this.features.update(parseSemVer(info.version));\n      this.infoReceived = true;\n      if (this.transport.isEncrypted()) {\n        this.servers.updateTLSName();\n      }\n      const {\n        version,\n        lang\n      } = this.transport;\n      try {\n        const c = new Connect({\n          version,\n          lang\n        }, this.options, info.nonce);\n        if (info.headers) {\n          c.headers = true;\n          c.no_responders = true;\n        }\n        const cs = JSON.stringify(c);\n        this.transport.send(encode(`CONNECT ${cs}${CR_LF}`));\n        this.transport.send(PING_CMD);\n      } catch (err) {\n        this._close(err);\n      }\n    }\n    if (updates) {\n      this.dispatchStatus({\n        type: Events.Update,\n        data: updates\n      });\n    }\n    const ldm = info.ldm !== undefined ? info.ldm : false;\n    if (ldm) {\n      this.dispatchStatus({\n        type: Events.LDM,\n        data: this.servers.getCurrentServer().toString()\n      });\n    }\n  }\n  push(e) {\n    switch (e.kind) {\n      case Kind.MSG:\n        {\n          const {\n            msg,\n            data\n          } = e;\n          this.processMsg(msg, data);\n          break;\n        }\n      case Kind.OK:\n        break;\n      case Kind.ERR:\n        this.processError(e.data);\n        break;\n      case Kind.PING:\n        this.processPing();\n        break;\n      case Kind.PONG:\n        this.processPong();\n        break;\n      case Kind.INFO:\n        this.processInfo(e.data);\n        break;\n    }\n  }\n  sendCommand(cmd, ...payloads) {\n    const len = this.outbound.length();\n    let buf;\n    if (typeof cmd === \"string\") {\n      buf = encode(cmd);\n    } else {\n      buf = cmd;\n    }\n    this.outbound.fill(buf, ...payloads);\n    if (len === 0) {\n      queueMicrotask(() => {\n        this.flushPending();\n      });\n    } else if (this.outbound.size() >= this.pendingLimit) {\n      this.flushPending();\n    }\n  }\n  publish(subject, payload = Empty, options) {\n    let data;\n    if (payload instanceof Uint8Array) {\n      data = payload;\n    } else if (typeof payload === \"string\") {\n      data = TE.encode(payload);\n    } else {\n      throw NatsError.errorForCode(ErrorCode.BadPayload);\n    }\n    let len = data.length;\n    options = options || {};\n    options.reply = options.reply || \"\";\n    let headers = Empty;\n    let hlen = 0;\n    if (options.headers) {\n      if (this.info && !this.info.headers) {\n        throw new NatsError(\"headers\", ErrorCode.ServerOptionNotAvailable);\n      }\n      const hdrs = options.headers;\n      headers = hdrs.encode();\n      hlen = headers.length;\n      len = data.length + hlen;\n    }\n    if (this.info && len > this.info.max_payload) {\n      throw NatsError.errorForCode(ErrorCode.MaxPayloadExceeded);\n    }\n    this.outBytes += len;\n    this.outMsgs++;\n    let proto;\n    if (options.headers) {\n      if (options.reply) {\n        proto = `HPUB ${subject} ${options.reply} ${hlen} ${len}\\r\\n`;\n      } else {\n        proto = `HPUB ${subject} ${hlen} ${len}\\r\\n`;\n      }\n      this.sendCommand(proto, headers, data, CRLF);\n    } else {\n      if (options.reply) {\n        proto = `PUB ${subject} ${options.reply} ${len}\\r\\n`;\n      } else {\n        proto = `PUB ${subject} ${len}\\r\\n`;\n      }\n      this.sendCommand(proto, data, CRLF);\n    }\n  }\n  request(r) {\n    this.initMux();\n    this.muxSubscriptions.add(r);\n    return r;\n  }\n  subscribe(s) {\n    this.subscriptions.add(s);\n    this._subunsub(s);\n    return s;\n  }\n  _sub(s) {\n    if (s.queue) {\n      this.sendCommand(`SUB ${s.subject} ${s.queue} ${s.sid}\\r\\n`);\n    } else {\n      this.sendCommand(`SUB ${s.subject} ${s.sid}\\r\\n`);\n    }\n  }\n  _subunsub(s) {\n    this._sub(s);\n    if (s.max) {\n      this.unsubscribe(s, s.max);\n    }\n    return s;\n  }\n  unsubscribe(s, max) {\n    this.unsub(s, max);\n    if (s.max === undefined || s.received >= s.max) {\n      this.subscriptions.cancel(s);\n    }\n  }\n  unsub(s, max) {\n    if (!s || this.isClosed()) {\n      return;\n    }\n    if (max) {\n      this.sendCommand(`UNSUB ${s.sid} ${max}\\r\\n`);\n    } else {\n      this.sendCommand(`UNSUB ${s.sid}\\r\\n`);\n    }\n    s.max = max;\n  }\n  resub(s, subject) {\n    if (!s || this.isClosed()) {\n      return;\n    }\n    this.unsub(s);\n    s.subject = subject;\n    this.subscriptions.resub(s);\n    this._sub(s);\n  }\n  flush(p) {\n    if (!p) {\n      p = deferred();\n    }\n    this.pongs.push(p);\n    this.outbound.fill(PING_CMD);\n    this.flushPending();\n    return p;\n  }\n  sendSubscriptions() {\n    const cmds = [];\n    this.subscriptions.all().forEach(s => {\n      const sub = s;\n      if (sub.queue) {\n        cmds.push(`SUB ${sub.subject} ${sub.queue} ${sub.sid}${CR_LF}`);\n      } else {\n        cmds.push(`SUB ${sub.subject} ${sub.sid}${CR_LF}`);\n      }\n    });\n    if (cmds.length) {\n      this.transport.send(encode(cmds.join(\"\")));\n    }\n  }\n  async _close(err) {\n    if (this._closed) {\n      return;\n    }\n    this.whyClosed = new Error(\"close trace\").stack || \"\";\n    this.heartbeats.cancel();\n    if (this.connectError) {\n      this.connectError(err);\n      this.connectError = undefined;\n    }\n    this.muxSubscriptions.close();\n    this.subscriptions.close();\n    this.listeners.forEach(l => {\n      l.stop();\n    });\n    this._closed = true;\n    await this.transport.close(err);\n    await this.closed.resolve(err);\n  }\n  close() {\n    return this._close();\n  }\n  isClosed() {\n    return this._closed;\n  }\n  drain() {\n    const subs = this.subscriptions.all();\n    const promises = [];\n    subs.forEach(sub => {\n      promises.push(sub.drain());\n    });\n    return Promise.all(promises).then(async () => {\n      this.noMorePublishing = true;\n      await this.flush();\n      return this.close();\n    }).catch(() => {});\n  }\n  flushPending() {\n    if (!this.infoReceived || !this.connected) {\n      return;\n    }\n    if (this.outbound.size()) {\n      const d = this.outbound.drain();\n      this.transport.send(d);\n    }\n  }\n  initMux() {\n    const mux = this.subscriptions.getMux();\n    if (!mux) {\n      const inbox = this.muxSubscriptions.init(this.options.inboxPrefix);\n      const sub = new SubscriptionImpl(this, `${inbox}*`);\n      sub.callback = this.muxSubscriptions.dispatcher();\n      this.subscriptions.setMux(sub);\n      this.subscribe(sub);\n    }\n  }\n  selectServer() {\n    const server = this.servers.selectServer();\n    if (server === undefined) {\n      return undefined;\n    }\n    this.server = server;\n    return this.server;\n  }\n  getServer() {\n    return this.server;\n  }\n}\nconst ServiceApiPrefix = \"$SRV\";\nclass ServiceMsgImpl {\n  msg;\n  constructor(msg) {\n    this.msg = msg;\n  }\n  get data() {\n    return this.msg.data;\n  }\n  get sid() {\n    return this.msg.sid;\n  }\n  get subject() {\n    return this.msg.subject;\n  }\n  get reply() {\n    return this.msg.reply || \"\";\n  }\n  get headers() {\n    return this.msg.headers;\n  }\n  respond(data, opts) {\n    return this.msg.respond(data, opts);\n  }\n  respondError(code, description, data, opts) {\n    opts = opts || {};\n    opts.headers = opts.headers || headers();\n    opts.headers?.set(ServiceErrorCodeHeader, `${code}`);\n    opts.headers?.set(ServiceErrorHeader, description);\n    return this.msg.respond(data, opts);\n  }\n  json(reviver) {\n    return this.msg.json(reviver);\n  }\n  string() {\n    return this.msg.string();\n  }\n}\nclass ServiceGroupImpl {\n  subject;\n  queue;\n  srv;\n  constructor(parent, name = \"\", queue = \"\") {\n    if (name !== \"\") {\n      validInternalToken(\"service group\", name);\n    }\n    let root = \"\";\n    if (parent instanceof ServiceImpl) {\n      this.srv = parent;\n      root = \"\";\n    } else if (parent instanceof ServiceGroupImpl) {\n      const sg = parent;\n      this.srv = sg.srv;\n      if (queue === \"\" && sg.queue !== \"\") {\n        queue = sg.queue;\n      }\n      root = sg.subject;\n    } else {\n      throw new Error(\"unknown ServiceGroup type\");\n    }\n    this.subject = this.calcSubject(root, name);\n    this.queue = queue;\n  }\n  calcSubject(root, name = \"\") {\n    if (name === \"\") {\n      return root;\n    }\n    return root !== \"\" ? `${root}.${name}` : name;\n  }\n  addEndpoint(name = \"\", opts) {\n    opts = opts || {\n      subject: name\n    };\n    const args = typeof opts === \"function\" ? {\n      handler: opts,\n      subject: name\n    } : opts;\n    validateName(\"endpoint\", name);\n    let {\n      subject,\n      handler,\n      metadata,\n      queue\n    } = args;\n    subject = subject || name;\n    queue = queue || this.queue;\n    validSubjectName(\"endpoint subject\", subject);\n    subject = this.calcSubject(this.subject, subject);\n    const ne = {\n      name,\n      subject,\n      queue,\n      handler,\n      metadata\n    };\n    return this.srv._addEndpoint(ne);\n  }\n  addGroup(name = \"\", queue = \"\") {\n    return new ServiceGroupImpl(this, name, queue);\n  }\n}\nfunction validSubjectName(context, subj) {\n  if (subj === \"\") {\n    throw new Error(`${context} cannot be empty`);\n  }\n  if (subj.indexOf(\" \") !== -1) {\n    throw new Error(`${context} cannot contain spaces: '${subj}'`);\n  }\n  const tokens = subj.split(\".\");\n  tokens.forEach((v, idx) => {\n    if (v === \">\" && idx !== tokens.length - 1) {\n      throw new Error(`${context} cannot have internal '>': '${subj}'`);\n    }\n  });\n}\nfunction validInternalToken(context, subj) {\n  if (subj.indexOf(\" \") !== -1) {\n    throw new Error(`${context} cannot contain spaces: '${subj}'`);\n  }\n  const tokens = subj.split(\".\");\n  tokens.forEach(v => {\n    if (v === \">\") {\n      throw new Error(`${context} name cannot contain internal '>': '${subj}'`);\n    }\n  });\n}\nclass ServiceImpl {\n  nc;\n  _id;\n  config;\n  handlers;\n  internal;\n  _stopped;\n  _done;\n  started;\n  static controlSubject(verb, name = \"\", id = \"\", prefix) {\n    const pre = prefix ?? ServiceApiPrefix;\n    if (name === \"\" && id === \"\") {\n      return `${pre}.${verb}`;\n    }\n    validateName(\"control subject name\", name);\n    if (id !== \"\") {\n      validateName(\"control subject id\", id);\n      return `${pre}.${verb}.${name}.${id}`;\n    }\n    return `${pre}.${verb}.${name}`;\n  }\n  constructor(nc, config = {\n    name: \"\",\n    version: \"\"\n  }) {\n    this.nc = nc;\n    this.config = Object.assign({}, config);\n    if (!this.config.queue) {\n      this.config.queue = \"q\";\n    }\n    validateName(\"name\", this.config.name);\n    validateName(\"queue\", this.config.queue);\n    parseSemVer(this.config.version);\n    this._id = nuid.next();\n    this.internal = [];\n    this._done = deferred();\n    this._stopped = false;\n    this.handlers = [];\n    this.started = new Date().toISOString();\n    this.reset();\n    this.nc.closed().then(() => {\n      this.close().catch();\n    }).catch(err => {\n      this.close(err).catch();\n    });\n  }\n  get subjects() {\n    return this.handlers.filter(s => {\n      return s.internal === false;\n    }).map(s => {\n      return s.subject;\n    });\n  }\n  get id() {\n    return this._id;\n  }\n  get name() {\n    return this.config.name;\n  }\n  get description() {\n    return this.config.description ?? \"\";\n  }\n  get version() {\n    return this.config.version;\n  }\n  get metadata() {\n    return this.config.metadata;\n  }\n  errorToHeader(err) {\n    const h = headers();\n    if (err instanceof ServiceError) {\n      const se = err;\n      h.set(ServiceErrorHeader, se.message);\n      h.set(ServiceErrorCodeHeader, `${se.code}`);\n    } else {\n      h.set(ServiceErrorHeader, err.message);\n      h.set(ServiceErrorCodeHeader, \"500\");\n    }\n    return h;\n  }\n  setupHandler(h, internal = false) {\n    const queue = internal ? \"\" : h.queue ? h.queue : this.config.queue;\n    const {\n      name,\n      subject,\n      handler\n    } = h;\n    const sv = h;\n    sv.internal = internal;\n    if (internal) {\n      this.internal.push(sv);\n    }\n    sv.stats = new NamedEndpointStatsImpl(name, subject, queue);\n    sv.queue = queue;\n    const callback = handler ? (err, msg) => {\n      if (err) {\n        this.close(err);\n        return;\n      }\n      const start = Date.now();\n      try {\n        handler(err, new ServiceMsgImpl(msg));\n      } catch (err) {\n        sv.stats.countError(err);\n        msg?.respond(Empty, {\n          headers: this.errorToHeader(err)\n        });\n      } finally {\n        sv.stats.countLatency(start);\n      }\n    } : undefined;\n    sv.sub = this.nc.subscribe(subject, {\n      callback,\n      queue\n    });\n    sv.sub.closed.then(() => {\n      if (!this._stopped) {\n        this.close(new Error(`required subscription ${h.subject} stopped`)).catch();\n      }\n    }).catch(err => {\n      if (!this._stopped) {\n        const ne = new Error(`required subscription ${h.subject} errored: ${err.message}`);\n        ne.stack = err.stack;\n        this.close(ne).catch();\n      }\n    });\n    return sv;\n  }\n  info() {\n    return {\n      type: ServiceResponseType.INFO,\n      name: this.name,\n      id: this.id,\n      version: this.version,\n      description: this.description,\n      metadata: this.metadata,\n      endpoints: this.endpoints()\n    };\n  }\n  endpoints() {\n    return this.handlers.map(v => {\n      const {\n        subject,\n        metadata,\n        name,\n        queue\n      } = v;\n      return {\n        subject,\n        metadata,\n        name,\n        queue_group: queue\n      };\n    });\n  }\n  async stats() {\n    const endpoints = [];\n    for (const h of this.handlers) {\n      if (typeof this.config.statsHandler === \"function\") {\n        try {\n          h.stats.data = await this.config.statsHandler(h);\n        } catch (err) {\n          h.stats.countError(err);\n        }\n      }\n      endpoints.push(h.stats.stats(h.qi));\n    }\n    return {\n      type: ServiceResponseType.STATS,\n      name: this.name,\n      id: this.id,\n      version: this.version,\n      started: this.started,\n      metadata: this.metadata,\n      endpoints\n    };\n  }\n  addInternalHandler(verb, handler) {\n    const v = `${verb}`.toUpperCase();\n    this._doAddInternalHandler(`${v}-all`, verb, handler);\n    this._doAddInternalHandler(`${v}-kind`, verb, handler, this.name);\n    this._doAddInternalHandler(`${v}`, verb, handler, this.name, this.id);\n  }\n  _doAddInternalHandler(name, verb, handler, kind = \"\", id = \"\") {\n    const endpoint = {};\n    endpoint.name = name;\n    endpoint.subject = ServiceImpl.controlSubject(verb, kind, id);\n    endpoint.handler = handler;\n    this.setupHandler(endpoint, true);\n  }\n  start() {\n    const jc = JSONCodec();\n    const statsHandler = (err, msg) => {\n      if (err) {\n        this.close(err);\n        return Promise.reject(err);\n      }\n      return this.stats().then(s => {\n        msg?.respond(jc.encode(s));\n        return Promise.resolve();\n      });\n    };\n    const infoHandler = (err, msg) => {\n      if (err) {\n        this.close(err);\n        return Promise.reject(err);\n      }\n      msg?.respond(jc.encode(this.info()));\n      return Promise.resolve();\n    };\n    const ping = jc.encode(this.ping());\n    const pingHandler = (err, msg) => {\n      if (err) {\n        this.close(err).then().catch();\n        return Promise.reject(err);\n      }\n      msg.respond(ping);\n      return Promise.resolve();\n    };\n    this.addInternalHandler(ServiceVerb.PING, pingHandler);\n    this.addInternalHandler(ServiceVerb.STATS, statsHandler);\n    this.addInternalHandler(ServiceVerb.INFO, infoHandler);\n    this.handlers.forEach(h => {\n      const {\n        subject\n      } = h;\n      if (typeof subject !== \"string\") {\n        return;\n      }\n      if (h.handler === null) {\n        return;\n      }\n      this.setupHandler(h);\n    });\n    return Promise.resolve(this);\n  }\n  close(err) {\n    if (this._stopped) {\n      return this._done;\n    }\n    this._stopped = true;\n    let buf = [];\n    if (!this.nc.isClosed()) {\n      buf = this.handlers.concat(this.internal).map(h => {\n        return h.sub.drain();\n      });\n    }\n    Promise.allSettled(buf).then(() => {\n      this._done.resolve(err ? err : null);\n    });\n    return this._done;\n  }\n  get stopped() {\n    return this._done;\n  }\n  get isStopped() {\n    return this._stopped;\n  }\n  stop(err) {\n    return this.close(err);\n  }\n  ping() {\n    return {\n      type: ServiceResponseType.PING,\n      name: this.name,\n      id: this.id,\n      version: this.version,\n      metadata: this.metadata\n    };\n  }\n  reset() {\n    this.started = new Date().toISOString();\n    if (this.handlers) {\n      for (const h of this.handlers) {\n        h.stats.reset(h.qi);\n      }\n    }\n  }\n  addGroup(name, queue) {\n    return new ServiceGroupImpl(this, name, queue);\n  }\n  addEndpoint(name, handler) {\n    const sg = new ServiceGroupImpl(this);\n    return sg.addEndpoint(name, handler);\n  }\n  _addEndpoint(e) {\n    const qi = new QueuedIteratorImpl();\n    qi.noIterator = typeof e.handler === \"function\";\n    if (!qi.noIterator) {\n      e.handler = (err, msg) => {\n        err ? this.stop(err).catch() : qi.push(new ServiceMsgImpl(msg));\n      };\n      qi.iterClosed.then(() => {\n        this.close().catch();\n      });\n    }\n    const ss = this.setupHandler(e, false);\n    ss.qi = qi;\n    this.handlers.push(ss);\n    return qi;\n  }\n}\nclass NamedEndpointStatsImpl {\n  name;\n  subject;\n  average_processing_time;\n  num_requests;\n  processing_time;\n  num_errors;\n  last_error;\n  data;\n  metadata;\n  queue;\n  constructor(name, subject, queue = \"\") {\n    this.name = name;\n    this.subject = subject;\n    this.average_processing_time = 0;\n    this.num_errors = 0;\n    this.num_requests = 0;\n    this.processing_time = 0;\n    this.queue = queue;\n  }\n  reset(qi) {\n    this.num_requests = 0;\n    this.processing_time = 0;\n    this.average_processing_time = 0;\n    this.num_errors = 0;\n    this.last_error = undefined;\n    this.data = undefined;\n    const qii = qi;\n    if (qii) {\n      qii.time = 0;\n      qii.processed = 0;\n    }\n  }\n  countLatency(start) {\n    this.num_requests++;\n    this.processing_time += nanos(Date.now() - start);\n    this.average_processing_time = Math.round(this.processing_time / this.num_requests);\n  }\n  countError(err) {\n    this.num_errors++;\n    this.last_error = err.message;\n  }\n  _stats() {\n    const {\n      name,\n      subject,\n      average_processing_time,\n      num_errors,\n      num_requests,\n      processing_time,\n      last_error,\n      data,\n      queue\n    } = this;\n    return {\n      name,\n      subject,\n      average_processing_time,\n      num_errors,\n      num_requests,\n      processing_time,\n      last_error,\n      data,\n      queue_group: queue\n    };\n  }\n  stats(qi) {\n    const qii = qi;\n    if (qii?.noIterator === false) {\n      this.processing_time = nanos(qii.time);\n      this.num_requests = qii.processed;\n      this.average_processing_time = this.processing_time > 0 && this.num_requests > 0 ? this.processing_time / this.num_requests : 0;\n    }\n    return this._stats();\n  }\n}\nclass ServiceClientImpl {\n  nc;\n  prefix;\n  opts;\n  constructor(nc, opts = {\n    strategy: RequestStrategy.JitterTimer,\n    maxWait: 2000\n  }, prefix) {\n    this.nc = nc;\n    this.prefix = prefix;\n    this.opts = opts;\n  }\n  ping(name = \"\", id = \"\") {\n    return this.q(ServiceVerb.PING, name, id);\n  }\n  stats(name = \"\", id = \"\") {\n    return this.q(ServiceVerb.STATS, name, id);\n  }\n  info(name = \"\", id = \"\") {\n    return this.q(ServiceVerb.INFO, name, id);\n  }\n  async q(v, name = \"\", id = \"\") {\n    const iter = new QueuedIteratorImpl();\n    const jc = JSONCodec();\n    const subj = ServiceImpl.controlSubject(v, name, id, this.prefix);\n    const responses = await this.nc.requestMany(subj, Empty, this.opts);\n    (async () => {\n      for await (const m of responses) {\n        try {\n          const s = jc.decode(m.data);\n          iter.push(s);\n        } catch (err) {\n          iter.push(() => {\n            iter.stop(err);\n          });\n        }\n      }\n      iter.push(() => {\n        iter.stop();\n      });\n    })().catch(err => {\n      iter.stop(err);\n    });\n    return iter;\n  }\n}\nclass Metric {\n  name;\n  duration;\n  date;\n  payload;\n  msgs;\n  lang;\n  version;\n  bytes;\n  asyncRequests;\n  min;\n  max;\n  constructor(name, duration) {\n    this.name = name;\n    this.duration = duration;\n    this.date = Date.now();\n    this.payload = 0;\n    this.msgs = 0;\n    this.bytes = 0;\n  }\n  toString() {\n    const sec = this.duration / 1000;\n    const mps = Math.round(this.msgs / sec);\n    const label = this.asyncRequests ? \"asyncRequests\" : \"\";\n    let minmax = \"\";\n    if (this.max) {\n      minmax = `${this.min}/${this.max}`;\n    }\n    return `${this.name}${label ? \" [asyncRequests]\" : \"\"} ${humanizeNumber(mps)} msgs/sec - [${sec.toFixed(2)} secs] ~ ${throughput(this.bytes, sec)} ${minmax}`;\n  }\n  toCsv() {\n    return `\"${this.name}\",${new Date(this.date).toISOString()},${this.lang},${this.version},${this.msgs},${this.payload},${this.bytes},${this.duration},${this.asyncRequests ? this.asyncRequests : false}\\n`;\n  }\n  static header() {\n    return `Test,Date,Lang,Version,Count,MsgPayload,Bytes,Millis,Async\\n`;\n  }\n}\nclass Bench {\n  nc;\n  callbacks;\n  msgs;\n  size;\n  subject;\n  asyncRequests;\n  pub;\n  sub;\n  req;\n  rep;\n  perf;\n  payload;\n  constructor(nc, opts = {\n    msgs: 100000,\n    size: 128,\n    subject: \"\",\n    asyncRequests: false,\n    pub: false,\n    sub: false,\n    req: false,\n    rep: false\n  }) {\n    this.nc = nc;\n    this.callbacks = opts.callbacks || false;\n    this.msgs = opts.msgs || 0;\n    this.size = opts.size || 0;\n    this.subject = opts.subject || nuid.next();\n    this.asyncRequests = opts.asyncRequests || false;\n    this.pub = opts.pub || false;\n    this.sub = opts.sub || false;\n    this.req = opts.req || false;\n    this.rep = opts.rep || false;\n    this.perf = new Perf();\n    this.payload = this.size ? new Uint8Array(this.size) : Empty;\n    if (!this.pub && !this.sub && !this.req && !this.rep) {\n      throw new Error(\"no bench option selected\");\n    }\n  }\n  async run() {\n    this.nc.closed().then(err => {\n      if (err) {\n        throw new NatsError(`bench closed with an error: ${err.message}`, ErrorCode.Unknown, err);\n      }\n    });\n    if (this.callbacks) {\n      await this.runCallbacks();\n    } else {\n      await this.runAsync();\n    }\n    return this.processMetrics();\n  }\n  processMetrics() {\n    const nc = this.nc;\n    const {\n      lang,\n      version\n    } = nc.protocol.transport;\n    if (this.pub && this.sub) {\n      this.perf.measure(\"pubsub\", \"pubStart\", \"subStop\");\n    }\n    if (this.req && this.rep) {\n      this.perf.measure(\"reqrep\", \"reqStart\", \"reqStop\");\n    }\n    const measures = this.perf.getEntries();\n    const pubsub = measures.find(m => m.name === \"pubsub\");\n    const reqrep = measures.find(m => m.name === \"reqrep\");\n    const req = measures.find(m => m.name === \"req\");\n    const rep = measures.find(m => m.name === \"rep\");\n    const pub = measures.find(m => m.name === \"pub\");\n    const sub = measures.find(m => m.name === \"sub\");\n    const stats = this.nc.stats();\n    const metrics = [];\n    if (pubsub) {\n      const {\n        name,\n        duration\n      } = pubsub;\n      const m = new Metric(name, duration);\n      m.msgs = this.msgs * 2;\n      m.bytes = stats.inBytes + stats.outBytes;\n      m.lang = lang;\n      m.version = version;\n      m.payload = this.payload.length;\n      metrics.push(m);\n    }\n    if (reqrep) {\n      const {\n        name,\n        duration\n      } = reqrep;\n      const m = new Metric(name, duration);\n      m.msgs = this.msgs * 2;\n      m.bytes = stats.inBytes + stats.outBytes;\n      m.lang = lang;\n      m.version = version;\n      m.payload = this.payload.length;\n      metrics.push(m);\n    }\n    if (pub) {\n      const {\n        name,\n        duration\n      } = pub;\n      const m = new Metric(name, duration);\n      m.msgs = this.msgs;\n      m.bytes = stats.outBytes;\n      m.lang = lang;\n      m.version = version;\n      m.payload = this.payload.length;\n      metrics.push(m);\n    }\n    if (sub) {\n      const {\n        name,\n        duration\n      } = sub;\n      const m = new Metric(name, duration);\n      m.msgs = this.msgs;\n      m.bytes = stats.inBytes;\n      m.lang = lang;\n      m.version = version;\n      m.payload = this.payload.length;\n      metrics.push(m);\n    }\n    if (rep) {\n      const {\n        name,\n        duration\n      } = rep;\n      const m = new Metric(name, duration);\n      m.msgs = this.msgs;\n      m.bytes = stats.inBytes + stats.outBytes;\n      m.lang = lang;\n      m.version = version;\n      m.payload = this.payload.length;\n      metrics.push(m);\n    }\n    if (req) {\n      const {\n        name,\n        duration\n      } = req;\n      const m = new Metric(name, duration);\n      m.msgs = this.msgs;\n      m.bytes = stats.inBytes + stats.outBytes;\n      m.lang = lang;\n      m.version = version;\n      m.payload = this.payload.length;\n      metrics.push(m);\n    }\n    return metrics;\n  }\n  async runCallbacks() {\n    const jobs = [];\n    if (this.sub) {\n      const d = deferred();\n      jobs.push(d);\n      let i = 0;\n      this.nc.subscribe(this.subject, {\n        max: this.msgs,\n        callback: () => {\n          i++;\n          if (i === 1) {\n            this.perf.mark(\"subStart\");\n          }\n          if (i === this.msgs) {\n            this.perf.mark(\"subStop\");\n            this.perf.measure(\"sub\", \"subStart\", \"subStop\");\n            d.resolve();\n          }\n        }\n      });\n    }\n    if (this.rep) {\n      const d = deferred();\n      jobs.push(d);\n      let i = 0;\n      this.nc.subscribe(this.subject, {\n        max: this.msgs,\n        callback: (_, m) => {\n          m.respond(this.payload);\n          i++;\n          if (i === 1) {\n            this.perf.mark(\"repStart\");\n          }\n          if (i === this.msgs) {\n            this.perf.mark(\"repStop\");\n            this.perf.measure(\"rep\", \"repStart\", \"repStop\");\n            d.resolve();\n          }\n        }\n      });\n    }\n    if (this.pub) {\n      const job = (async () => {\n        this.perf.mark(\"pubStart\");\n        for (let i = 0; i < this.msgs; i++) {\n          this.nc.publish(this.subject, this.payload);\n        }\n        await this.nc.flush();\n        this.perf.mark(\"pubStop\");\n        this.perf.measure(\"pub\", \"pubStart\", \"pubStop\");\n      })();\n      jobs.push(job);\n    }\n    if (this.req) {\n      const job = (async () => {\n        if (this.asyncRequests) {\n          this.perf.mark(\"reqStart\");\n          const a = [];\n          for (let i = 0; i < this.msgs; i++) {\n            a.push(this.nc.request(this.subject, this.payload, {\n              timeout: 20000\n            }));\n          }\n          await Promise.all(a);\n          this.perf.mark(\"reqStop\");\n          this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n        } else {\n          this.perf.mark(\"reqStart\");\n          for (let i = 0; i < this.msgs; i++) {\n            await this.nc.request(this.subject);\n          }\n          this.perf.mark(\"reqStop\");\n          this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n        }\n      })();\n      jobs.push(job);\n    }\n    await Promise.all(jobs);\n  }\n  async runAsync() {\n    const jobs = [];\n    if (this.rep) {\n      let first = false;\n      const sub = this.nc.subscribe(this.subject, {\n        max: this.msgs\n      });\n      const job = (async () => {\n        for await (const m of sub) {\n          if (!first) {\n            this.perf.mark(\"repStart\");\n            first = true;\n          }\n          m.respond(this.payload);\n        }\n        await this.nc.flush();\n        this.perf.mark(\"repStop\");\n        this.perf.measure(\"rep\", \"repStart\", \"repStop\");\n      })();\n      jobs.push(job);\n    }\n    if (this.sub) {\n      let first = false;\n      const sub = this.nc.subscribe(this.subject, {\n        max: this.msgs\n      });\n      const job = (async () => {\n        for await (const _m of sub) {\n          if (!first) {\n            this.perf.mark(\"subStart\");\n            first = true;\n          }\n        }\n        this.perf.mark(\"subStop\");\n        this.perf.measure(\"sub\", \"subStart\", \"subStop\");\n      })();\n      jobs.push(job);\n    }\n    if (this.pub) {\n      const job = (async () => {\n        this.perf.mark(\"pubStart\");\n        for (let i = 0; i < this.msgs; i++) {\n          this.nc.publish(this.subject, this.payload);\n        }\n        await this.nc.flush();\n        this.perf.mark(\"pubStop\");\n        this.perf.measure(\"pub\", \"pubStart\", \"pubStop\");\n      })();\n      jobs.push(job);\n    }\n    if (this.req) {\n      const job = (async () => {\n        if (this.asyncRequests) {\n          this.perf.mark(\"reqStart\");\n          const a = [];\n          for (let i = 0; i < this.msgs; i++) {\n            a.push(this.nc.request(this.subject, this.payload, {\n              timeout: 20000\n            }));\n          }\n          await Promise.all(a);\n          this.perf.mark(\"reqStop\");\n          this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n        } else {\n          this.perf.mark(\"reqStart\");\n          for (let i = 0; i < this.msgs; i++) {\n            await this.nc.request(this.subject);\n          }\n          this.perf.mark(\"reqStop\");\n          this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n        }\n      })();\n      jobs.push(job);\n    }\n    await Promise.all(jobs);\n  }\n}\nfunction throughput(bytes, seconds) {\n  return `${humanizeBytes(bytes / seconds)}/sec`;\n}\nfunction humanizeBytes(bytes, si = false) {\n  const base = si ? 1000 : 1024;\n  const pre = si ? [\"k\", \"M\", \"G\", \"T\", \"P\", \"E\"] : [\"K\", \"M\", \"G\", \"T\", \"P\", \"E\"];\n  const post = si ? \"iB\" : \"B\";\n  if (bytes < base) {\n    return `${bytes.toFixed(2)} ${post}`;\n  }\n  const exp = parseInt(Math.log(bytes) / Math.log(base) + \"\");\n  const index = parseInt(exp - 1 + \"\");\n  return `${(bytes / Math.pow(base, exp)).toFixed(2)} ${pre[index]}${post}`;\n}\nfunction humanizeNumber(n) {\n  return n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\nexport { backoff, Bench, buildAuthenticator, canonicalMIMEHeaderKey, createInbox, credsAuthenticator, deadline, DebugEvents, deferred, delay, Empty, ErrorCode, Events, headers, JSONCodec, jwtAuthenticator, Match, Metric, millis, MsgHdrsImpl, nanos, NatsError, nkeyAuthenticator, mod as nkeys, Nuid, nuid, RequestStrategy, ServiceError, ServiceErrorCodeHeader, ServiceErrorHeader, ServiceResponseType, ServiceVerb, StringCodec, syncIterator, tokenAuthenticator, usernamePasswordAuthenticator };\nfunction NoopKvCodecs() {\n  return {\n    key: {\n      encode(k) {\n        return k;\n      },\n      decode(k) {\n        return k;\n      }\n    },\n    value: {\n      encode(v) {\n        return v;\n      },\n      decode(v) {\n        return v;\n      }\n    }\n  };\n}\nfunction defaultBucketOpts() {\n  return {\n    replicas: 1,\n    history: 1,\n    timeout: 2000,\n    max_bytes: -1,\n    maxValueSize: -1,\n    codec: NoopKvCodecs(),\n    storage: StorageType.File\n  };\n}\nconst kvOperationHdr = \"KV-Operation\";\nconst kvSubjectPrefix = \"$KV\";\nconst validKeyRe = /^[-/=.\\w]+$/;\nconst validSearchKey = /^[-/=.>*\\w]+$/;\nconst validBucketRe = /^[-\\w]+$/;\nfunction validateKey(k) {\n  if (k.startsWith(\".\") || k.endsWith(\".\") || !validKeyRe.test(k)) {\n    throw new Error(`invalid key: ${k}`);\n  }\n}\nfunction validateSearchKey(k) {\n  if (k.startsWith(\".\") || k.endsWith(\".\") || !validSearchKey.test(k)) {\n    throw new Error(`invalid key: ${k}`);\n  }\n}\nfunction hasWildcards(k) {\n  if (k.startsWith(\".\") || k.endsWith(\".\")) {\n    throw new Error(`invalid key: ${k}`);\n  }\n  const chunks = k.split(\".\");\n  let hasWildcards = false;\n  for (let i = 0; i < chunks.length; i++) {\n    switch (chunks[i]) {\n      case \"*\":\n        hasWildcards = true;\n        break;\n      case \">\":\n        if (i !== chunks.length - 1) {\n          throw new Error(`invalid key: ${k}`);\n        }\n        hasWildcards = true;\n        break;\n      default:\n    }\n  }\n  return hasWildcards;\n}\nfunction validateBucket(name) {\n  if (!validBucketRe.test(name)) {\n    throw new Error(`invalid bucket name: ${name}`);\n  }\n}\nvar PubHeaders;\n(function (PubHeaders) {\n  PubHeaders[\"MsgIdHdr\"] = \"Nats-Msg-Id\";\n  PubHeaders[\"ExpectedStreamHdr\"] = \"Nats-Expected-Stream\";\n  PubHeaders[\"ExpectedLastSeqHdr\"] = \"Nats-Expected-Last-Sequence\";\n  PubHeaders[\"ExpectedLastMsgIdHdr\"] = \"Nats-Expected-Last-Msg-Id\";\n  PubHeaders[\"ExpectedLastSubjectSequenceHdr\"] = \"Nats-Expected-Last-Subject-Sequence\";\n})(PubHeaders || (PubHeaders = {}));\nclass Bucket {\n  js;\n  jsm;\n  stream;\n  bucket;\n  direct;\n  codec;\n  prefix;\n  editPrefix;\n  useJsPrefix;\n  _prefixLen;\n  constructor(bucket, js, jsm) {\n    validateBucket(bucket);\n    this.js = js;\n    this.jsm = jsm;\n    this.bucket = bucket;\n    this.prefix = kvSubjectPrefix;\n    this.editPrefix = \"\";\n    this.useJsPrefix = false;\n    this._prefixLen = 0;\n  }\n  static async create(js, name, opts = {}) {\n    validateBucket(name);\n    const jsm = await js.jetstreamManager();\n    const bucket = new Bucket(name, js, jsm);\n    await bucket.init(opts);\n    return bucket;\n  }\n  static async bind(js, name, opts = {}) {\n    const jsm = await js.jetstreamManager();\n    const info = {\n      config: {\n        allow_direct: opts.allow_direct\n      }\n    };\n    validateBucket(name);\n    const bucket = new Bucket(name, js, jsm);\n    info.config.name = opts.streamName ?? bucket.bucketName();\n    Object.assign(bucket, info);\n    bucket.stream = info.config.name;\n    bucket.codec = opts.codec || NoopKvCodecs();\n    bucket.direct = info.config.allow_direct ?? false;\n    bucket.initializePrefixes(info);\n    return bucket;\n  }\n  async init(opts = {}) {\n    const bo = Object.assign(defaultBucketOpts(), opts);\n    this.codec = bo.codec;\n    const sc = {};\n    this.stream = sc.name = opts.streamName ?? this.bucketName();\n    sc.retention = RetentionPolicy.Limits;\n    sc.max_msgs_per_subject = bo.history;\n    if (bo.maxBucketSize) {\n      bo.max_bytes = bo.maxBucketSize;\n    }\n    if (bo.max_bytes) {\n      sc.max_bytes = bo.max_bytes;\n    }\n    sc.max_msg_size = bo.maxValueSize;\n    sc.storage = bo.storage;\n    const location = opts.placementCluster ?? \"\";\n    if (location) {\n      opts.placement = {};\n      opts.placement.cluster = location;\n      opts.placement.tags = [];\n    }\n    if (opts.placement) {\n      sc.placement = opts.placement;\n    }\n    if (opts.republish) {\n      sc.republish = opts.republish;\n    }\n    if (opts.description) {\n      sc.description = opts.description;\n    }\n    if (opts.mirror) {\n      const mirror = Object.assign({}, opts.mirror);\n      if (!mirror.name.startsWith(kvPrefix)) {\n        mirror.name = `${kvPrefix}${mirror.name}`;\n      }\n      sc.mirror = mirror;\n      sc.mirror_direct = true;\n    } else if (opts.sources) {\n      const sources = opts.sources.map(s => {\n        const c = Object.assign({}, s);\n        const srcBucketName = c.name.startsWith(kvPrefix) ? c.name.substring(kvPrefix.length) : c.name;\n        if (!c.name.startsWith(kvPrefix)) {\n          c.name = `${kvPrefix}${c.name}`;\n        }\n        if (!s.external && srcBucketName !== this.bucket) {\n          c.subject_transforms = [{\n            src: `$KV.${srcBucketName}.>`,\n            dest: `$KV.${this.bucket}.>`\n          }];\n        }\n        return c;\n      });\n      sc.sources = sources;\n      sc.subjects = [this.subjectForBucket()];\n    } else {\n      sc.subjects = [this.subjectForBucket()];\n    }\n    if (opts.metadata) {\n      sc.metadata = opts.metadata;\n    }\n    if (typeof opts.compression === \"boolean\") {\n      sc.compression = opts.compression ? StoreCompression.S2 : StoreCompression.None;\n    }\n    const nci = this.js.nc;\n    const have = nci.getServerVersion();\n    const discardNew = have ? compare(have, parseSemVer(\"2.7.2\")) >= 0 : false;\n    sc.discard = discardNew ? DiscardPolicy.New : DiscardPolicy.Old;\n    const {\n      ok: direct,\n      min\n    } = nci.features.get(Feature.JS_ALLOW_DIRECT);\n    if (!direct && opts.allow_direct === true) {\n      const v = have ? `${have.major}.${have.minor}.${have.micro}` : \"unknown\";\n      return Promise.reject(new Error(`allow_direct is not available on server version ${v} - requires ${min}`));\n    }\n    opts.allow_direct = typeof opts.allow_direct === \"boolean\" ? opts.allow_direct : direct;\n    sc.allow_direct = opts.allow_direct;\n    this.direct = sc.allow_direct;\n    sc.num_replicas = bo.replicas;\n    if (bo.ttl) {\n      sc.max_age = nanos(bo.ttl);\n    }\n    sc.allow_rollup_hdrs = true;\n    let info;\n    try {\n      info = await this.jsm.streams.info(sc.name);\n      if (!info.config.allow_direct && this.direct === true) {\n        this.direct = false;\n      }\n    } catch (err) {\n      if (err.message === \"stream not found\") {\n        info = await this.jsm.streams.add(sc);\n      } else {\n        throw err;\n      }\n    }\n    this.initializePrefixes(info);\n  }\n  initializePrefixes(info) {\n    this._prefixLen = 0;\n    this.prefix = `$KV.${this.bucket}`;\n    this.useJsPrefix = this.js.apiPrefix !== \"$JS.API\";\n    const {\n      mirror\n    } = info.config;\n    if (mirror) {\n      let n = mirror.name;\n      if (n.startsWith(kvPrefix)) {\n        n = n.substring(kvPrefix.length);\n      }\n      if (mirror.external && mirror.external.api !== \"\") {\n        const mb = mirror.name.substring(kvPrefix.length);\n        this.useJsPrefix = false;\n        this.prefix = `$KV.${mb}`;\n        this.editPrefix = `${mirror.external.api}.$KV.${n}`;\n      } else {\n        this.editPrefix = this.prefix;\n      }\n    }\n  }\n  bucketName() {\n    return this.stream ?? `${kvPrefix}${this.bucket}`;\n  }\n  subjectForBucket() {\n    return `${this.prefix}.${this.bucket}.>`;\n  }\n  subjectForKey(k, edit = false) {\n    const builder = [];\n    if (edit) {\n      if (this.useJsPrefix) {\n        builder.push(this.js.apiPrefix);\n      }\n      if (this.editPrefix !== \"\") {\n        builder.push(this.editPrefix);\n      } else {\n        builder.push(this.prefix);\n      }\n    } else {\n      if (this.prefix) {\n        builder.push(this.prefix);\n      }\n    }\n    builder.push(k);\n    return builder.join(\".\");\n  }\n  fullKeyName(k) {\n    if (this.prefix !== \"\") {\n      return `${this.prefix}.${k}`;\n    }\n    return `${kvSubjectPrefix}.${this.bucket}.${k}`;\n  }\n  get prefixLen() {\n    if (this._prefixLen === 0) {\n      this._prefixLen = this.prefix.length + 1;\n    }\n    return this._prefixLen;\n  }\n  encodeKey(key) {\n    const chunks = [];\n    for (const t of key.split(\".\")) {\n      switch (t) {\n        case \">\":\n        case \"*\":\n          chunks.push(t);\n          break;\n        default:\n          chunks.push(this.codec.key.encode(t));\n          break;\n      }\n    }\n    return chunks.join(\".\");\n  }\n  decodeKey(ekey) {\n    const chunks = [];\n    for (const t of ekey.split(\".\")) {\n      switch (t) {\n        case \">\":\n        case \"*\":\n          chunks.push(t);\n          break;\n        default:\n          chunks.push(this.codec.key.decode(t));\n          break;\n      }\n    }\n    return chunks.join(\".\");\n  }\n  validateKey = validateKey;\n  validateSearchKey = validateSearchKey;\n  hasWildcards = hasWildcards;\n  close() {\n    return Promise.resolve();\n  }\n  dataLen(data, h) {\n    const slen = h ? h.get(JsHeaders.MessageSizeHdr) || \"\" : \"\";\n    if (slen !== \"\") {\n      return parseInt(slen, 10);\n    }\n    return data.length;\n  }\n  smToEntry(sm) {\n    return new KvStoredEntryImpl(this.bucket, this.prefixLen, sm);\n  }\n  jmToEntry(jm) {\n    const key = this.decodeKey(jm.subject.substring(this.prefixLen));\n    return new KvJsMsgEntryImpl(this.bucket, key, jm);\n  }\n  async create(k, data) {\n    let firstErr;\n    try {\n      const n = await this.put(k, data, {\n        previousSeq: 0\n      });\n      return Promise.resolve(n);\n    } catch (err) {\n      firstErr = err;\n      if (err?.api_error?.err_code !== 10071) {\n        return Promise.reject(err);\n      }\n    }\n    let rev = 0;\n    try {\n      const e = await this.get(k);\n      if (e?.operation === \"DEL\" || e?.operation === \"PURGE\") {\n        rev = e !== null ? e.revision : 0;\n        return this.update(k, data, rev);\n      } else {\n        return Promise.reject(firstErr);\n      }\n    } catch (err) {\n      return Promise.reject(err);\n    }\n  }\n  update(k, data, version) {\n    if (version <= 0) {\n      throw new Error(\"version must be greater than 0\");\n    }\n    return this.put(k, data, {\n      previousSeq: version\n    });\n  }\n  async put(k, data, opts = {}) {\n    const ek = this.encodeKey(k);\n    this.validateKey(ek);\n    const o = {};\n    if (opts.previousSeq !== undefined) {\n      const h = headers();\n      o.headers = h;\n      h.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${opts.previousSeq}`);\n    }\n    try {\n      const pa = await this.js.publish(this.subjectForKey(ek, true), data, o);\n      return pa.seq;\n    } catch (err) {\n      const ne = err;\n      if (ne.isJetStreamError()) {\n        ne.message = ne.api_error?.description;\n        ne.code = `${ne.api_error?.code}`;\n        return Promise.reject(ne);\n      }\n      return Promise.reject(err);\n    }\n  }\n  async get(k, opts) {\n    const ek = this.encodeKey(k);\n    this.validateKey(ek);\n    let arg = {\n      last_by_subj: this.subjectForKey(ek)\n    };\n    if (opts && opts.revision > 0) {\n      arg = {\n        seq: opts.revision\n      };\n    }\n    let sm;\n    try {\n      if (this.direct) {\n        const direct = this.jsm.direct;\n        sm = await direct.getMessage(this.bucketName(), arg);\n      } else {\n        sm = await this.jsm.streams.getMessage(this.bucketName(), arg);\n      }\n      const ke = this.smToEntry(sm);\n      if (ke.key !== ek) {\n        return null;\n      }\n      return ke;\n    } catch (err) {\n      if (err.code === ErrorCode.JetStream404NoMessages) {\n        return null;\n      }\n      throw err;\n    }\n  }\n  purge(k, opts) {\n    return this._deleteOrPurge(k, \"PURGE\", opts);\n  }\n  delete(k, opts) {\n    return this._deleteOrPurge(k, \"DEL\", opts);\n  }\n  async purgeDeletes(olderMillis = 30 * 60 * 1000) {\n    const done = deferred();\n    const buf = [];\n    const i = await this.watch({\n      key: \">\",\n      initializedFn: () => {\n        done.resolve();\n      }\n    });\n    (async () => {\n      for await (const e of i) {\n        if (e.operation === \"DEL\" || e.operation === \"PURGE\") {\n          buf.push(e);\n        }\n      }\n    })().then();\n    await done;\n    i.stop();\n    const min = Date.now() - olderMillis;\n    const proms = buf.map(e => {\n      const subj = this.subjectForKey(e.key);\n      if (e.created.getTime() >= min) {\n        return this.jsm.streams.purge(this.stream, {\n          filter: subj,\n          keep: 1\n        });\n      } else {\n        return this.jsm.streams.purge(this.stream, {\n          filter: subj,\n          keep: 0\n        });\n      }\n    });\n    const purged = await Promise.all(proms);\n    purged.unshift({\n      success: true,\n      purged: 0\n    });\n    return purged.reduce((pv, cv) => {\n      pv.purged += cv.purged;\n      return pv;\n    });\n  }\n  async _deleteOrPurge(k, op, opts) {\n    if (!this.hasWildcards(k)) {\n      return this._doDeleteOrPurge(k, op, opts);\n    }\n    const iter = await this.keys(k);\n    const buf = [];\n    for await (const k of iter) {\n      buf.push(this._doDeleteOrPurge(k, op));\n      if (buf.length === 100) {\n        await Promise.all(buf);\n        buf.length = 0;\n      }\n    }\n    if (buf.length > 0) {\n      await Promise.all(buf);\n    }\n  }\n  async _doDeleteOrPurge(k, op, opts) {\n    const ek = this.encodeKey(k);\n    this.validateKey(ek);\n    const h = headers();\n    h.set(kvOperationHdr, op);\n    if (op === \"PURGE\") {\n      h.set(JsHeaders.RollupHdr, JsHeaders.RollupValueSubject);\n    }\n    if (opts?.previousSeq) {\n      h.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${opts.previousSeq}`);\n    }\n    await this.js.publish(this.subjectForKey(ek, true), Empty, {\n      headers: h\n    });\n  }\n  _buildCC(k, content, opts = {}) {\n    const a = !Array.isArray(k) ? [k] : k;\n    let filter_subjects = a.map(k => {\n      const ek = this.encodeKey(k);\n      this.validateSearchKey(k);\n      return this.fullKeyName(ek);\n    });\n    let deliver_policy = DeliverPolicy.LastPerSubject;\n    if (content === KvWatchInclude.AllHistory) {\n      deliver_policy = DeliverPolicy.All;\n    }\n    if (content === KvWatchInclude.UpdatesOnly) {\n      deliver_policy = DeliverPolicy.New;\n    }\n    let filter_subject = undefined;\n    if (filter_subjects.length === 1) {\n      filter_subject = filter_subjects[0];\n      filter_subjects = undefined;\n    }\n    return Object.assign({\n      deliver_policy,\n      \"ack_policy\": AckPolicy.None,\n      filter_subjects,\n      filter_subject,\n      \"flow_control\": true,\n      \"idle_heartbeat\": nanos(5 * 1000)\n    }, opts);\n  }\n  remove(k) {\n    return this.purge(k);\n  }\n  async history(opts = {}) {\n    const k = opts.key ?? \">\";\n    const qi = new QueuedIteratorImpl();\n    const co = {};\n    co.headers_only = opts.headers_only || false;\n    let fn;\n    fn = () => {\n      qi.stop();\n    };\n    let count = 0;\n    const cc = this._buildCC(k, KvWatchInclude.AllHistory, co);\n    const subj = cc.filter_subject;\n    const copts = consumerOpts(cc);\n    copts.bindStream(this.stream);\n    copts.orderedConsumer();\n    copts.callback((err, jm) => {\n      if (err) {\n        qi.stop(err);\n        return;\n      }\n      if (jm) {\n        const e = this.jmToEntry(jm);\n        qi.push(e);\n        qi.received++;\n        if (fn && count > 0 && qi.received >= count || jm.info.pending === 0) {\n          qi.push(fn);\n          fn = undefined;\n        }\n      }\n    });\n    const sub = await this.js.subscribe(subj, copts);\n    if (fn) {\n      const {\n        info: {\n          last\n        }\n      } = sub;\n      const expect = last.num_pending + last.delivered.consumer_seq;\n      if (expect === 0 || qi.received >= expect) {\n        try {\n          fn();\n        } catch (err) {\n          qi.stop(err);\n        } finally {\n          fn = undefined;\n        }\n      } else {\n        count = expect;\n      }\n    }\n    qi._data = sub;\n    qi.iterClosed.then(() => {\n      sub.unsubscribe();\n    });\n    sub.closed.then(() => {\n      qi.stop();\n    }).catch(err => {\n      qi.stop(err);\n    });\n    return qi;\n  }\n  canSetWatcherName() {\n    const jsi = this.js;\n    const nci = jsi.nc;\n    const {\n      ok\n    } = nci.features.get(Feature.JS_NEW_CONSUMER_CREATE_API);\n    return ok;\n  }\n  async watch(opts = {}) {\n    const k = opts.key ?? \">\";\n    const qi = new QueuedIteratorImpl();\n    const co = {};\n    co.headers_only = opts.headers_only || false;\n    let content = KvWatchInclude.LastValue;\n    if (opts.include === KvWatchInclude.AllHistory) {\n      content = KvWatchInclude.AllHistory;\n    } else if (opts.include === KvWatchInclude.UpdatesOnly) {\n      content = KvWatchInclude.UpdatesOnly;\n    }\n    const ignoreDeletes = opts.ignoreDeletes === true;\n    let fn = opts.initializedFn;\n    let count = 0;\n    const cc = this._buildCC(k, content, co);\n    const subj = cc.filter_subject;\n    const copts = consumerOpts(cc);\n    if (this.canSetWatcherName()) {\n      copts.consumerName(nuid.next());\n    }\n    copts.bindStream(this.stream);\n    if (opts.resumeFromRevision && opts.resumeFromRevision > 0) {\n      copts.startSequence(opts.resumeFromRevision);\n    }\n    copts.orderedConsumer();\n    copts.callback((err, jm) => {\n      if (err) {\n        qi.stop(err);\n        return;\n      }\n      if (jm) {\n        const e = this.jmToEntry(jm);\n        if (ignoreDeletes && e.operation === \"DEL\") {\n          return;\n        }\n        qi.push(e);\n        qi.received++;\n        if (fn && (count > 0 && qi.received >= count || jm.info.pending === 0)) {\n          qi.push(fn);\n          fn = undefined;\n        }\n      }\n    });\n    const sub = await this.js.subscribe(subj, copts);\n    if (fn) {\n      const {\n        info: {\n          last\n        }\n      } = sub;\n      const expect = last.num_pending + last.delivered.consumer_seq;\n      if (expect === 0 || qi.received >= expect) {\n        try {\n          fn();\n        } catch (err) {\n          qi.stop(err);\n        } finally {\n          fn = undefined;\n        }\n      } else {\n        count = expect;\n      }\n    }\n    qi._data = sub;\n    qi.iterClosed.then(() => {\n      sub.unsubscribe();\n    });\n    sub.closed.then(() => {\n      qi.stop();\n    }).catch(err => {\n      qi.stop(err);\n    });\n    return qi;\n  }\n  async keys(k = \">\") {\n    const keys = new QueuedIteratorImpl();\n    const cc = this._buildCC(k, KvWatchInclude.LastValue, {\n      headers_only: true\n    });\n    const subj = Array.isArray(k) ? \">\" : cc.filter_subject;\n    const copts = consumerOpts(cc);\n    copts.bindStream(this.stream);\n    copts.orderedConsumer();\n    const sub = await this.js.subscribe(subj, copts);\n    (async () => {\n      for await (const jm of sub) {\n        const op = jm.headers?.get(kvOperationHdr);\n        if (op !== \"DEL\" && op !== \"PURGE\") {\n          const key = this.decodeKey(jm.subject.substring(this.prefixLen));\n          keys.push(key);\n        }\n        if (jm.info.pending === 0) {\n          sub.unsubscribe();\n        }\n      }\n    })().then(() => {\n      keys.stop();\n    }).catch(err => {\n      keys.stop(err);\n    });\n    const si = sub;\n    if (si.info.last.num_pending === 0) {\n      sub.unsubscribe();\n    }\n    return keys;\n  }\n  purgeBucket(opts) {\n    return this.jsm.streams.purge(this.bucketName(), opts);\n  }\n  destroy() {\n    return this.jsm.streams.delete(this.bucketName());\n  }\n  async status() {\n    const nc = this.js.nc;\n    const cluster = nc.info?.cluster ?? \"\";\n    const bn = this.bucketName();\n    const si = await this.jsm.streams.info(bn);\n    return new KvStatusImpl(si, cluster);\n  }\n}\nclass KvStatusImpl {\n  si;\n  cluster;\n  constructor(si, cluster = \"\") {\n    this.si = si;\n    this.cluster = cluster;\n  }\n  get bucket() {\n    return this.si.config.name.startsWith(kvPrefix) ? this.si.config.name.substring(kvPrefix.length) : this.si.config.name;\n  }\n  get values() {\n    return this.si.state.messages;\n  }\n  get history() {\n    return this.si.config.max_msgs_per_subject;\n  }\n  get ttl() {\n    return millis(this.si.config.max_age);\n  }\n  get bucket_location() {\n    return this.cluster;\n  }\n  get backingStore() {\n    return this.si.config.storage;\n  }\n  get storage() {\n    return this.si.config.storage;\n  }\n  get replicas() {\n    return this.si.config.num_replicas;\n  }\n  get description() {\n    return this.si.config.description ?? \"\";\n  }\n  get maxBucketSize() {\n    return this.si.config.max_bytes;\n  }\n  get maxValueSize() {\n    return this.si.config.max_msg_size;\n  }\n  get max_bytes() {\n    return this.si.config.max_bytes;\n  }\n  get placement() {\n    return this.si.config.placement || {\n      cluster: \"\",\n      tags: []\n    };\n  }\n  get placementCluster() {\n    return this.si.config.placement?.cluster ?? \"\";\n  }\n  get republish() {\n    return this.si.config.republish ?? {\n      src: \"\",\n      dest: \"\"\n    };\n  }\n  get streamInfo() {\n    return this.si;\n  }\n  get size() {\n    return this.si.state.bytes;\n  }\n  get metadata() {\n    return this.si.config.metadata ?? {};\n  }\n  get compression() {\n    if (this.si.config.compression) {\n      return this.si.config.compression !== StoreCompression.None;\n    }\n    return false;\n  }\n}\nconst osPrefix = \"OBJ_\";\nconst digestType = \"SHA-256=\";\nfunction objectStoreStreamName(bucket) {\n  validateBucket(bucket);\n  return `${osPrefix}${bucket}`;\n}\nfunction objectStoreBucketName(stream) {\n  if (stream.startsWith(osPrefix)) {\n    return stream.substring(4);\n  }\n  return stream;\n}\nclass ObjectStoreStatusImpl {\n  si;\n  backingStore;\n  constructor(si) {\n    this.si = si;\n    this.backingStore = \"JetStream\";\n  }\n  get bucket() {\n    return objectStoreBucketName(this.si.config.name);\n  }\n  get description() {\n    return this.si.config.description ?? \"\";\n  }\n  get ttl() {\n    return this.si.config.max_age;\n  }\n  get storage() {\n    return this.si.config.storage;\n  }\n  get replicas() {\n    return this.si.config.num_replicas;\n  }\n  get sealed() {\n    return this.si.config.sealed;\n  }\n  get size() {\n    return this.si.state.bytes;\n  }\n  get streamInfo() {\n    return this.si;\n  }\n  get metadata() {\n    return this.si.config.metadata;\n  }\n  get compression() {\n    if (this.si.config.compression) {\n      return this.si.config.compression !== StoreCompression.None;\n    }\n    return false;\n  }\n}\nfunction convertStreamSourceDomain(s) {\n  if (s === undefined) {\n    return undefined;\n  }\n  const {\n    domain\n  } = s;\n  if (domain === undefined) {\n    return s;\n  }\n  const copy = Object.assign({}, s);\n  delete copy.domain;\n  if (domain === \"\") {\n    return copy;\n  }\n  if (copy.external) {\n    throw new Error(\"domain and external are both set\");\n  }\n  copy.external = {\n    api: `$JS.${domain}.API`\n  };\n  return copy;\n}\nvar PullConsumerType;\n(function (PullConsumerType) {\n  PullConsumerType[PullConsumerType[\"Unset\"] = -1] = \"Unset\";\n  PullConsumerType[PullConsumerType[\"Consume\"] = 0] = \"Consume\";\n  PullConsumerType[PullConsumerType[\"Fetch\"] = 1] = \"Fetch\";\n})(PullConsumerType || (PullConsumerType = {}));\nvar ConsumerEvents;\n(function (ConsumerEvents) {\n  ConsumerEvents[\"HeartbeatsMissed\"] = \"heartbeats_missed\";\n  ConsumerEvents[\"ConsumerNotFound\"] = \"consumer_not_found\";\n  ConsumerEvents[\"StreamNotFound\"] = \"stream_not_found\";\n  ConsumerEvents[\"ConsumerDeleted\"] = \"consumer_deleted\";\n  ConsumerEvents[\"OrderedConsumerRecreated\"] = \"ordered_consumer_recreated\";\n})(ConsumerEvents || (ConsumerEvents = {}));\nvar ConsumerDebugEvents;\n(function (ConsumerDebugEvents) {\n  ConsumerDebugEvents[\"DebugEvent\"] = \"debug\";\n  ConsumerDebugEvents[\"Discard\"] = \"discard\";\n  ConsumerDebugEvents[\"Reset\"] = \"reset\";\n  ConsumerDebugEvents[\"Next\"] = \"next\";\n})(ConsumerDebugEvents || (ConsumerDebugEvents = {}));\nconst ACK = Uint8Array.of(43, 65, 67, 75);\nconst NAK = Uint8Array.of(45, 78, 65, 75);\nconst WPI = Uint8Array.of(43, 87, 80, 73);\nconst NXT = Uint8Array.of(43, 78, 88, 84);\nconst TERM = Uint8Array.of(43, 84, 69, 82, 77);\nconst SPACE = Uint8Array.of(32);\nfunction toJsMsg(m, ackTimeout = 5000) {\n  return new JsMsgImpl(m, ackTimeout);\n}\nclass PullConsumerMessagesImpl extends QueuedIteratorImpl {\n  consumer;\n  opts;\n  sub;\n  monitor;\n  pending;\n  inbox;\n  refilling;\n  pong;\n  callback;\n  timeout;\n  cleanupHandler;\n  listeners;\n  statusIterator;\n  forOrderedConsumer;\n  resetHandler;\n  abortOnMissingResource;\n  bind;\n  constructor(c, opts, refilling = false) {\n    super();\n    this.consumer = c;\n    const copts = opts;\n    this.opts = this.parseOptions(opts, refilling);\n    this.callback = copts.callback || null;\n    this.noIterator = typeof this.callback === \"function\";\n    this.monitor = null;\n    this.pong = null;\n    this.pending = {\n      msgs: 0,\n      bytes: 0,\n      requests: 0\n    };\n    this.refilling = refilling;\n    this.timeout = null;\n    this.inbox = createInbox(c.api.nc.options.inboxPrefix);\n    this.listeners = [];\n    this.forOrderedConsumer = false;\n    this.abortOnMissingResource = copts.abort_on_missing_resource === true;\n    this.bind = copts.bind === true;\n    this.start();\n  }\n  start() {\n    const {\n      max_messages,\n      max_bytes,\n      idle_heartbeat,\n      threshold_bytes,\n      threshold_messages\n    } = this.opts;\n    this.closed().then(err => {\n      if (this.cleanupHandler) {\n        try {\n          this.cleanupHandler(err);\n        } catch (_err) {}\n      }\n    });\n    const {\n      sub\n    } = this;\n    if (sub) {\n      sub.unsubscribe();\n    }\n    this.sub = this.consumer.api.nc.subscribe(this.inbox, {\n      callback: (err, msg) => {\n        if (err) {\n          this.stop(err);\n          return;\n        }\n        this.monitor?.work();\n        const isProtocol = msg.subject === this.inbox;\n        if (isProtocol) {\n          if (isHeartbeatMsg(msg)) {\n            return;\n          }\n          const code = msg.headers?.code;\n          const description = msg.headers?.description?.toLowerCase() || \"unknown\";\n          const {\n            msgsLeft,\n            bytesLeft\n          } = this.parseDiscard(msg.headers);\n          if (msgsLeft > 0 || bytesLeft > 0) {\n            this.pending.msgs -= msgsLeft;\n            this.pending.bytes -= bytesLeft;\n            this.pending.requests--;\n            this.notify(ConsumerDebugEvents.Discard, {\n              msgsLeft,\n              bytesLeft\n            });\n          } else {\n            if (code === 400) {\n              this.stop(new NatsError(description, `${code}`));\n              return;\n            } else if (code === 409 && description === \"consumer deleted\") {\n              this.notify(ConsumerEvents.ConsumerDeleted, `${code} ${description}`);\n              if (!this.refilling || this.abortOnMissingResource) {\n                const error = new NatsError(description, `${code}`);\n                this.stop(error);\n                return;\n              }\n            } else {\n              this.notify(ConsumerDebugEvents.DebugEvent, `${code} ${description}`);\n            }\n          }\n        } else {\n          this._push(toJsMsg(msg, this.consumer.api.timeout));\n          this.received++;\n          if (this.pending.msgs) {\n            this.pending.msgs--;\n          }\n          if (this.pending.bytes) {\n            this.pending.bytes -= msg.size();\n          }\n        }\n        if (this.pending.msgs === 0 && this.pending.bytes === 0) {\n          this.pending.requests = 0;\n        }\n        if (this.refilling) {\n          if (max_messages && this.pending.msgs <= threshold_messages || max_bytes && this.pending.bytes <= threshold_bytes) {\n            const batch = this.pullOptions();\n            this.pull(batch);\n          }\n        } else if (this.pending.requests === 0) {\n          this._push(() => {\n            this.stop();\n          });\n        }\n      }\n    });\n    this.sub.closed.then(() => {\n      if (this.sub.draining) {\n        this._push(() => {\n          this.stop();\n        });\n      }\n    });\n    if (idle_heartbeat) {\n      this.monitor = new IdleHeartbeatMonitor(idle_heartbeat, data => {\n        this.notify(ConsumerEvents.HeartbeatsMissed, data);\n        this.resetPending().then(() => {}).catch(() => {});\n        return false;\n      }, {\n        maxOut: 2\n      });\n    }\n    (async () => {\n      const status = this.consumer.api.nc.status();\n      this.statusIterator = status;\n      for await (const s of status) {\n        switch (s.type) {\n          case Events.Disconnect:\n            this.monitor?.cancel();\n            break;\n          case Events.Reconnect:\n            this.resetPending().then(ok => {\n              if (ok) {\n                this.monitor?.restart();\n              }\n            }).catch(() => {});\n            break;\n          default:\n        }\n      }\n    })();\n    this.pull(this.pullOptions());\n  }\n  _push(r) {\n    if (!this.callback) {\n      super.push(r);\n    } else {\n      const fn = typeof r === \"function\" ? r : null;\n      try {\n        if (!fn) {\n          this.callback(r);\n        } else {\n          fn();\n        }\n      } catch (err) {\n        this.stop(err);\n      }\n    }\n  }\n  notify(type, data) {\n    if (this.listeners.length > 0) {\n      (() => {\n        this.listeners.forEach(l => {\n          if (!l.done) {\n            l.push({\n              type,\n              data\n            });\n          }\n        });\n      })();\n    }\n  }\n  resetPending() {\n    return this.bind ? this.resetPendingNoInfo() : this.resetPendingWithInfo();\n  }\n  resetPendingNoInfo() {\n    this.pending.msgs = 0;\n    this.pending.bytes = 0;\n    this.pending.requests = 0;\n    this.pull(this.pullOptions());\n    return Promise.resolve(true);\n  }\n  async resetPendingWithInfo() {\n    let notFound = 0;\n    let streamNotFound = 0;\n    const bo = backoff();\n    let attempt = 0;\n    while (true) {\n      if (this.done) {\n        return false;\n      }\n      if (this.consumer.api.nc.isClosed()) {\n        console.error(\"aborting resetPending - connection is closed\");\n        return false;\n      }\n      try {\n        await this.consumer.info();\n        notFound = 0;\n        this.pending.msgs = 0;\n        this.pending.bytes = 0;\n        this.pending.requests = 0;\n        this.pull(this.pullOptions());\n        return true;\n      } catch (err) {\n        if (err.message === \"stream not found\") {\n          streamNotFound++;\n          this.notify(ConsumerEvents.StreamNotFound, streamNotFound);\n          if (!this.refilling || this.abortOnMissingResource) {\n            this.stop(err);\n            return false;\n          }\n        } else if (err.message === \"consumer not found\") {\n          notFound++;\n          this.notify(ConsumerEvents.ConsumerNotFound, notFound);\n          if (this.resetHandler) {\n            try {\n              this.resetHandler();\n            } catch (_) {}\n          }\n          if (!this.refilling || this.abortOnMissingResource) {\n            this.stop(err);\n            return false;\n          }\n          if (this.forOrderedConsumer) {\n            return false;\n          }\n        } else {\n          notFound = 0;\n          streamNotFound = 0;\n        }\n        const to = bo.backoff(attempt);\n        const de = delay(to);\n        await Promise.race([de, this.consumer.api.nc.closed()]);\n        de.cancel();\n        attempt++;\n      }\n    }\n  }\n  pull(opts) {\n    this.pending.bytes += opts.max_bytes ?? 0;\n    this.pending.msgs += opts.batch ?? 0;\n    this.pending.requests++;\n    const nc = this.consumer.api.nc;\n    this._push(() => {\n      nc.publish(`${this.consumer.api.prefix}.CONSUMER.MSG.NEXT.${this.consumer.stream}.${this.consumer.name}`, this.consumer.api.jc.encode(opts), {\n        reply: this.inbox\n      });\n      this.notify(ConsumerDebugEvents.Next, opts);\n    });\n  }\n  pullOptions() {\n    const batch = this.opts.max_messages - this.pending.msgs;\n    const max_bytes = this.opts.max_bytes - this.pending.bytes;\n    const idle_heartbeat = nanos(this.opts.idle_heartbeat);\n    const expires = nanos(this.opts.expires);\n    return {\n      batch,\n      max_bytes,\n      idle_heartbeat,\n      expires\n    };\n  }\n  parseDiscard(headers) {\n    const discard = {\n      msgsLeft: 0,\n      bytesLeft: 0\n    };\n    const msgsLeft = headers?.get(JsHeaders.PendingMessagesHdr);\n    if (msgsLeft) {\n      discard.msgsLeft = parseInt(msgsLeft);\n    }\n    const bytesLeft = headers?.get(JsHeaders.PendingBytesHdr);\n    if (bytesLeft) {\n      discard.bytesLeft = parseInt(bytesLeft);\n    }\n    return discard;\n  }\n  trackTimeout(t) {\n    this.timeout = t;\n  }\n  close() {\n    this.stop();\n    return this.iterClosed;\n  }\n  closed() {\n    return this.iterClosed;\n  }\n  clearTimers() {\n    this.monitor?.cancel();\n    this.monitor = null;\n    this.timeout?.cancel();\n    this.timeout = null;\n  }\n  setCleanupHandler(fn) {\n    this.cleanupHandler = fn;\n  }\n  stop(err) {\n    if (this.done) {\n      return;\n    }\n    this.sub?.unsubscribe();\n    this.clearTimers();\n    this.statusIterator?.stop();\n    this._push(() => {\n      super.stop(err);\n      this.listeners.forEach(n => {\n        n.stop();\n      });\n    });\n  }\n  parseOptions(opts, refilling = false) {\n    const args = opts || {};\n    args.max_messages = args.max_messages || 0;\n    args.max_bytes = args.max_bytes || 0;\n    if (args.max_messages !== 0 && args.max_bytes !== 0) {\n      throw new Error(`only specify one of max_messages or max_bytes`);\n    }\n    if (args.max_messages === 0) {\n      args.max_messages = 100;\n    }\n    args.expires = args.expires || 30_000;\n    if (args.expires < 1000) {\n      throw new Error(\"expires should be at least 1000ms\");\n    }\n    args.idle_heartbeat = args.idle_heartbeat || args.expires / 2;\n    args.idle_heartbeat = args.idle_heartbeat > 30_000 ? 30_000 : args.idle_heartbeat;\n    if (refilling) {\n      const minMsgs = Math.round(args.max_messages * .75) || 1;\n      args.threshold_messages = args.threshold_messages || minMsgs;\n      const minBytes = Math.round(args.max_bytes * .75) || 1;\n      args.threshold_bytes = args.threshold_bytes || minBytes;\n    }\n    return args;\n  }\n  status() {\n    const iter = new QueuedIteratorImpl();\n    this.listeners.push(iter);\n    return Promise.resolve(iter);\n  }\n}\nclass OrderedConsumerMessages extends QueuedIteratorImpl {\n  src;\n  listeners;\n  constructor() {\n    super();\n    this.listeners = [];\n  }\n  setSource(src) {\n    if (this.src) {\n      this.src.resetHandler = undefined;\n      this.src.setCleanupHandler();\n      this.src.stop();\n    }\n    this.src = src;\n    this.src.setCleanupHandler(err => {\n      this.stop(err || undefined);\n    });\n    (async () => {\n      const status = await this.src.status();\n      for await (const s of status) {\n        this.notify(s.type, s.data);\n      }\n    })().catch(() => {});\n  }\n  notify(type, data) {\n    if (this.listeners.length > 0) {\n      (() => {\n        this.listeners.forEach(l => {\n          if (!l.done) {\n            l.push({\n              type,\n              data\n            });\n          }\n        });\n      })();\n    }\n  }\n  stop(err) {\n    if (this.done) {\n      return;\n    }\n    this.src?.stop(err);\n    super.stop(err);\n    this.listeners.forEach(n => {\n      n.stop();\n    });\n  }\n  close() {\n    this.stop();\n    return this.iterClosed;\n  }\n  closed() {\n    return this.iterClosed;\n  }\n  status() {\n    const iter = new QueuedIteratorImpl();\n    this.listeners.push(iter);\n    return Promise.resolve(iter);\n  }\n}\nclass PullConsumerImpl {\n  api;\n  _info;\n  stream;\n  name;\n  constructor(api, info) {\n    this.api = api;\n    this._info = info;\n    this.stream = info.stream_name;\n    this.name = info.name;\n  }\n  consume(opts = {\n    max_messages: 100,\n    expires: 30_000\n  }) {\n    return Promise.resolve(new PullConsumerMessagesImpl(this, opts, true));\n  }\n  fetch(opts = {\n    max_messages: 100,\n    expires: 30_000\n  }) {\n    const m = new PullConsumerMessagesImpl(this, opts, false);\n    const to = Math.round(m.opts.expires * 1.05);\n    const timer = timeout(to);\n    m.closed().catch(() => {}).finally(() => {\n      timer.cancel();\n    });\n    timer.catch(() => {\n      m.close().catch();\n    });\n    m.trackTimeout(timer);\n    return Promise.resolve(m);\n  }\n  next(opts = {\n    expires: 30_000\n  }) {\n    const d = deferred();\n    const fopts = opts;\n    fopts.max_messages = 1;\n    const iter = new PullConsumerMessagesImpl(this, fopts, false);\n    const to = Math.round(iter.opts.expires * 1.05);\n    if (to >= 60_000) {\n      (async () => {\n        for await (const s of await iter.status()) {\n          if (s.type === ConsumerEvents.HeartbeatsMissed && s.data >= 2) {\n            d.reject(new Error(\"consumer missed heartbeats\"));\n            break;\n          }\n        }\n      })().catch();\n    }\n    (async () => {\n      for await (const m of iter) {\n        d.resolve(m);\n        break;\n      }\n    })().catch(() => {});\n    const timer = timeout(to);\n    iter.closed().then(err => {\n      err ? d.reject(err) : d.resolve(null);\n    }).catch(err => {\n      d.reject(err);\n    }).finally(() => {\n      timer.cancel();\n    });\n    timer.catch(_err => {\n      d.resolve(null);\n      iter.close().catch();\n    });\n    iter.trackTimeout(timer);\n    return d;\n  }\n  delete() {\n    const {\n      stream_name,\n      name\n    } = this._info;\n    return this.api.delete(stream_name, name);\n  }\n  info(cached = false) {\n    if (cached) {\n      return Promise.resolve(this._info);\n    }\n    const {\n      stream_name,\n      name\n    } = this._info;\n    return this.api.info(stream_name, name).then(ci => {\n      this._info = ci;\n      return this._info;\n    });\n  }\n}\nclass OrderedPullConsumerImpl {\n  api;\n  consumerOpts;\n  consumer;\n  opts;\n  cursor;\n  stream;\n  namePrefix;\n  serial;\n  currentConsumer;\n  userCallback;\n  iter;\n  type;\n  startSeq;\n  maxInitialReset;\n  constructor(api, stream, opts = {}) {\n    this.api = api;\n    this.stream = stream;\n    this.cursor = {\n      stream_seq: 1,\n      deliver_seq: 0\n    };\n    this.namePrefix = nuid.next();\n    if (typeof opts.name_prefix === \"string\") {\n      minValidation(\"name_prefix\", opts.name_prefix);\n      this.namePrefix = opts.name_prefix + this.namePrefix;\n    }\n    this.serial = 0;\n    this.currentConsumer = null;\n    this.userCallback = null;\n    this.iter = null;\n    this.type = PullConsumerType.Unset;\n    this.consumerOpts = opts;\n    this.maxInitialReset = 30;\n    this.startSeq = this.consumerOpts.opt_start_seq || 0;\n    this.cursor.stream_seq = this.startSeq > 0 ? this.startSeq - 1 : 0;\n  }\n  getConsumerOpts(seq) {\n    this.serial++;\n    const name = `${this.namePrefix}_${this.serial}`;\n    seq = seq === 0 ? 1 : seq;\n    const config = {\n      name,\n      deliver_policy: DeliverPolicy.StartSequence,\n      opt_start_seq: seq,\n      ack_policy: AckPolicy.None,\n      inactive_threshold: nanos(5 * 60 * 1000),\n      num_replicas: 1\n    };\n    if (this.consumerOpts.headers_only === true) {\n      config.headers_only = true;\n    }\n    if (Array.isArray(this.consumerOpts.filterSubjects)) {\n      config.filter_subjects = this.consumerOpts.filterSubjects;\n    }\n    if (typeof this.consumerOpts.filterSubjects === \"string\") {\n      config.filter_subject = this.consumerOpts.filterSubjects;\n    }\n    if (this.consumerOpts.replay_policy) {\n      config.replay_policy = this.consumerOpts.replay_policy;\n    }\n    if (seq === this.startSeq + 1) {\n      config.deliver_policy = this.consumerOpts.deliver_policy || DeliverPolicy.StartSequence;\n      if (this.consumerOpts.deliver_policy === DeliverPolicy.LastPerSubject || this.consumerOpts.deliver_policy === DeliverPolicy.New || this.consumerOpts.deliver_policy === DeliverPolicy.Last) {\n        delete config.opt_start_seq;\n        config.deliver_policy = this.consumerOpts.deliver_policy;\n      }\n      if (config.deliver_policy === DeliverPolicy.LastPerSubject) {\n        if (typeof config.filter_subjects === \"undefined\" && typeof config.filter_subject === \"undefined\") {\n          config.filter_subject = \">\";\n        }\n      }\n      if (this.consumerOpts.opt_start_time) {\n        delete config.opt_start_seq;\n        config.deliver_policy = DeliverPolicy.StartTime;\n        config.opt_start_time = this.consumerOpts.opt_start_time;\n      }\n      if (this.consumerOpts.inactive_threshold) {\n        config.inactive_threshold = nanos(this.consumerOpts.inactive_threshold);\n      }\n    }\n    return config;\n  }\n  async resetConsumer(seq = 0) {\n    const isNew = this.serial === 0;\n    this.consumer?.delete().catch(() => {});\n    seq = seq === 0 ? 1 : seq;\n    this.cursor.deliver_seq = 0;\n    const config = this.getConsumerOpts(seq);\n    config.max_deliver = 1;\n    config.mem_storage = true;\n    const bo = backoff();\n    let ci;\n    for (let i = 0;; i++) {\n      try {\n        ci = await this.api.add(this.stream, config);\n        this.iter?.notify(ConsumerEvents.OrderedConsumerRecreated, ci.name);\n        break;\n      } catch (err) {\n        if (err.message === \"stream not found\") {\n          this.iter?.notify(ConsumerEvents.StreamNotFound, i);\n          if (this.type === PullConsumerType.Fetch || this.opts.abort_on_missing_resource === true) {\n            this.iter?.stop(err);\n            return Promise.reject(err);\n          }\n        }\n        if (isNew && i >= this.maxInitialReset) {\n          throw err;\n        } else {\n          await delay(bo.backoff(i + 1));\n        }\n      }\n    }\n    return ci;\n  }\n  internalHandler(serial) {\n    return m => {\n      if (this.serial !== serial) {\n        return;\n      }\n      const dseq = m.info.deliverySequence;\n      if (dseq !== this.cursor.deliver_seq + 1) {\n        this.notifyOrderedResetAndReset();\n        return;\n      }\n      this.cursor.deliver_seq = dseq;\n      this.cursor.stream_seq = m.info.streamSequence;\n      if (this.userCallback) {\n        this.userCallback(m);\n      } else {\n        this.iter?.push(m);\n      }\n    };\n  }\n  async reset(opts = {\n    max_messages: 100,\n    expires: 30_000\n  }, info) {\n    info = info || {};\n    const fromFetch = info.fromFetch || false;\n    const orderedReset = info.orderedReset || false;\n    if (this.type === PullConsumerType.Fetch && orderedReset) {\n      this.iter?.src.stop();\n      await this.iter?.closed();\n      this.currentConsumer = null;\n      return;\n    }\n    if (this.currentConsumer === null || orderedReset) {\n      this.currentConsumer = await this.resetConsumer(this.cursor.stream_seq + 1);\n    }\n    if (this.iter === null || fromFetch) {\n      this.iter = new OrderedConsumerMessages();\n    }\n    this.consumer = new PullConsumerImpl(this.api, this.currentConsumer);\n    const copts = opts;\n    copts.callback = this.internalHandler(this.serial);\n    let msgs = null;\n    if (this.type === PullConsumerType.Fetch && fromFetch) {\n      msgs = await this.consumer.fetch(opts);\n    } else if (this.type === PullConsumerType.Consume) {\n      msgs = await this.consumer.consume(opts);\n    }\n    const msgsImpl = msgs;\n    msgsImpl.forOrderedConsumer = true;\n    msgsImpl.resetHandler = () => {\n      this.notifyOrderedResetAndReset();\n    };\n    this.iter.setSource(msgsImpl);\n  }\n  notifyOrderedResetAndReset() {\n    this.iter?.notify(ConsumerDebugEvents.Reset, \"\");\n    this.reset(this.opts, {\n      orderedReset: true\n    });\n  }\n  async consume(opts = {\n    max_messages: 100,\n    expires: 30_000\n  }) {\n    const copts = opts;\n    if (copts.bind) {\n      return Promise.reject(new Error(\"bind is not supported\"));\n    }\n    if (this.type === PullConsumerType.Fetch) {\n      return Promise.reject(new Error(\"ordered consumer initialized as fetch\"));\n    }\n    if (this.type === PullConsumerType.Consume) {\n      return Promise.reject(new Error(\"ordered consumer doesn't support concurrent consume\"));\n    }\n    const {\n      callback\n    } = opts;\n    if (callback) {\n      this.userCallback = callback;\n    }\n    this.type = PullConsumerType.Consume;\n    this.opts = opts;\n    await this.reset(opts);\n    return this.iter;\n  }\n  async fetch(opts = {\n    max_messages: 100,\n    expires: 30_000\n  }) {\n    const copts = opts;\n    if (copts.bind) {\n      return Promise.reject(new Error(\"bind is not supported\"));\n    }\n    if (this.type === PullConsumerType.Consume) {\n      return Promise.reject(new Error(\"ordered consumer already initialized as consume\"));\n    }\n    if (this.iter?.done === false) {\n      return Promise.reject(new Error(\"ordered consumer doesn't support concurrent fetch\"));\n    }\n    const {\n      callback\n    } = opts;\n    if (callback) {\n      this.userCallback = callback;\n    }\n    this.type = PullConsumerType.Fetch;\n    this.opts = opts;\n    await this.reset(opts, {\n      fromFetch: true\n    });\n    return this.iter;\n  }\n  async next(opts = {\n    expires: 30_000\n  }) {\n    const copts = opts;\n    if (copts.bind) {\n      return Promise.reject(new Error(\"bind is not supported\"));\n    }\n    copts.max_messages = 1;\n    const d = deferred();\n    copts.callback = m => {\n      this.userCallback = null;\n      d.resolve(m);\n    };\n    const iter = await this.fetch(copts);\n    iter.iterClosed.then(err => {\n      if (err) {\n        d.reject(err);\n      }\n      d.resolve(null);\n    }).catch(err => {\n      d.reject(err);\n    });\n    return d;\n  }\n  delete() {\n    if (!this.currentConsumer) {\n      return Promise.resolve(false);\n    }\n    return this.api.delete(this.stream, this.currentConsumer.name).then(tf => {\n      return Promise.resolve(tf);\n    }).catch(err => {\n      return Promise.reject(err);\n    }).finally(() => {\n      this.currentConsumer = null;\n    });\n  }\n  async info(cached) {\n    if (this.currentConsumer == null) {\n      this.currentConsumer = await this.resetConsumer(this.startSeq);\n      return Promise.resolve(this.currentConsumer);\n    }\n    if (cached && this.currentConsumer) {\n      return Promise.resolve(this.currentConsumer);\n    }\n    return this.api.info(this.stream, this.currentConsumer.name);\n  }\n}\nclass ConsumersImpl {\n  api;\n  notified;\n  constructor(api) {\n    this.api = api;\n    this.notified = false;\n  }\n  checkVersion() {\n    const fv = this.api.nc.features.get(Feature.JS_SIMPLIFICATION);\n    if (!fv.ok) {\n      return Promise.reject(new Error(`consumers framework is only supported on servers ${fv.min} or better`));\n    }\n    return Promise.resolve();\n  }\n  getPullConsumerFor(ci) {\n    if (ci.config.deliver_subject !== undefined) {\n      throw new Error(\"push consumer not supported\");\n    }\n    return new PullConsumerImpl(this.api, ci);\n  }\n  async get(stream, name = {}) {\n    if (typeof name === \"object\") {\n      return this.ordered(stream, name);\n    }\n    await this.checkVersion();\n    return this.api.info(stream, name).then(ci => {\n      if (ci.config.deliver_subject !== undefined) {\n        return Promise.reject(new Error(\"push consumer not supported\"));\n      }\n      return new PullConsumerImpl(this.api, ci);\n    }).catch(err => {\n      return Promise.reject(err);\n    });\n  }\n  async ordered(stream, opts) {\n    await this.checkVersion();\n    const impl = this.api;\n    const sapi = new StreamAPIImpl(impl.nc, impl.opts);\n    return sapi.info(stream).then(_si => {\n      return Promise.resolve(new OrderedPullConsumerImpl(this.api, stream, opts));\n    }).catch(err => {\n      return Promise.reject(err);\n    });\n  }\n}\nclass StreamImpl {\n  api;\n  _info;\n  constructor(api, info) {\n    this.api = api;\n    this._info = info;\n  }\n  get name() {\n    return this._info.config.name;\n  }\n  alternates() {\n    return this.info().then(si => {\n      return si.alternates ? si.alternates : [];\n    });\n  }\n  async best() {\n    await this.info();\n    if (this._info.alternates) {\n      const asi = await this.api.info(this._info.alternates[0].name);\n      return new StreamImpl(this.api, asi);\n    } else {\n      return this;\n    }\n  }\n  info(cached = false, opts) {\n    if (cached) {\n      return Promise.resolve(this._info);\n    }\n    return this.api.info(this.name, opts).then(si => {\n      this._info = si;\n      return this._info;\n    });\n  }\n  getConsumerFromInfo(ci) {\n    return new ConsumersImpl(new ConsumerAPIImpl(this.api.nc, this.api.opts)).getPullConsumerFor(ci);\n  }\n  getConsumer(name) {\n    return new ConsumersImpl(new ConsumerAPIImpl(this.api.nc, this.api.opts)).get(this.name, name);\n  }\n  getMessage(query) {\n    return this.api.getMessage(this.name, query);\n  }\n  deleteMessage(seq, erase) {\n    return this.api.deleteMessage(this.name, seq, erase);\n  }\n}\nclass StreamAPIImpl extends BaseApiClient {\n  constructor(nc, opts) {\n    super(nc, opts);\n  }\n  checkStreamConfigVersions(cfg) {\n    const nci = this.nc;\n    if (cfg.metadata) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_STREAM_CONSUMER_METADATA);\n      if (!ok) {\n        throw new Error(`stream 'metadata' requires server ${min}`);\n      }\n    }\n    if (cfg.first_seq) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_STREAM_FIRST_SEQ);\n      if (!ok) {\n        throw new Error(`stream 'first_seq' requires server ${min}`);\n      }\n    }\n    if (cfg.subject_transform) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_STREAM_SUBJECT_TRANSFORM);\n      if (!ok) {\n        throw new Error(`stream 'subject_transform' requires server ${min}`);\n      }\n    }\n    if (cfg.compression) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_STREAM_COMPRESSION);\n      if (!ok) {\n        throw new Error(`stream 'compression' requires server ${min}`);\n      }\n    }\n    if (cfg.consumer_limits) {\n      const {\n        min,\n        ok\n      } = nci.features.get(Feature.JS_DEFAULT_CONSUMER_LIMITS);\n      if (!ok) {\n        throw new Error(`stream 'consumer_limits' requires server ${min}`);\n      }\n    }\n    function validateStreamSource(context, src) {\n      const count = src?.subject_transforms?.length || 0;\n      if (count > 0) {\n        const {\n          min,\n          ok\n        } = nci.features.get(Feature.JS_STREAM_SOURCE_SUBJECT_TRANSFORM);\n        if (!ok) {\n          throw new Error(`${context} 'subject_transforms' requires server ${min}`);\n        }\n      }\n    }\n    if (cfg.sources) {\n      cfg.sources.forEach(src => {\n        validateStreamSource(\"stream sources\", src);\n      });\n    }\n    if (cfg.mirror) {\n      validateStreamSource(\"stream mirror\", cfg.mirror);\n    }\n  }\n  async add(cfg = {}) {\n    this.checkStreamConfigVersions(cfg);\n    validateStreamName(cfg.name);\n    cfg.mirror = convertStreamSourceDomain(cfg.mirror);\n    cfg.sources = cfg.sources?.map(convertStreamSourceDomain);\n    const r = await this._request(`${this.prefix}.STREAM.CREATE.${cfg.name}`, cfg);\n    const si = r;\n    this._fixInfo(si);\n    return si;\n  }\n  async delete(stream) {\n    validateStreamName(stream);\n    const r = await this._request(`${this.prefix}.STREAM.DELETE.${stream}`);\n    const cr = r;\n    return cr.success;\n  }\n  async update(name, cfg = {}) {\n    if (typeof name === \"object\") {\n      const sc = name;\n      name = sc.name;\n      cfg = sc;\n      console.trace(`\\u001B[33m >> streams.update(config: StreamConfig) api changed to streams.update(name: string, config: StreamUpdateConfig) - this shim will be removed - update your code.  \\u001B[0m`);\n    }\n    this.checkStreamConfigVersions(cfg);\n    validateStreamName(name);\n    const old = await this.info(name);\n    const update = Object.assign(old.config, cfg);\n    update.mirror = convertStreamSourceDomain(update.mirror);\n    update.sources = update.sources?.map(convertStreamSourceDomain);\n    const r = await this._request(`${this.prefix}.STREAM.UPDATE.${name}`, update);\n    const si = r;\n    this._fixInfo(si);\n    return si;\n  }\n  async info(name, data) {\n    validateStreamName(name);\n    const subj = `${this.prefix}.STREAM.INFO.${name}`;\n    const r = await this._request(subj, data);\n    let si = r;\n    let {\n      total,\n      limit\n    } = si;\n    let have = si.state.subjects ? Object.getOwnPropertyNames(si.state.subjects).length : 1;\n    if (total && total > have) {\n      const infos = [si];\n      const paged = data || {};\n      let i = 0;\n      while (total > have) {\n        i++;\n        paged.offset = limit * i;\n        const r = await this._request(subj, paged);\n        total = r.total;\n        infos.push(r);\n        const count = Object.getOwnPropertyNames(r.state.subjects).length;\n        have += count;\n        if (count < limit) {\n          break;\n        }\n      }\n      let subjects = {};\n      for (let i = 0; i < infos.length; i++) {\n        si = infos[i];\n        if (si.state.subjects) {\n          subjects = Object.assign(subjects, si.state.subjects);\n        }\n      }\n      si.offset = 0;\n      si.total = 0;\n      si.limit = 0;\n      si.state.subjects = subjects;\n    }\n    this._fixInfo(si);\n    return si;\n  }\n  list(subject = \"\") {\n    const payload = subject?.length ? {\n      subject\n    } : {};\n    const listerFilter = v => {\n      const slr = v;\n      slr.streams.forEach(si => {\n        this._fixInfo(si);\n      });\n      return slr.streams;\n    };\n    const subj = `${this.prefix}.STREAM.LIST`;\n    return new ListerImpl(subj, listerFilter, this, payload);\n  }\n  _fixInfo(si) {\n    si.config.sealed = si.config.sealed || false;\n    si.config.deny_delete = si.config.deny_delete || false;\n    si.config.deny_purge = si.config.deny_purge || false;\n    si.config.allow_rollup_hdrs = si.config.allow_rollup_hdrs || false;\n  }\n  async purge(name, opts) {\n    if (opts) {\n      const {\n        keep,\n        seq\n      } = opts;\n      if (typeof keep === \"number\" && typeof seq === \"number\") {\n        throw new Error(\"can specify one of keep or seq\");\n      }\n    }\n    validateStreamName(name);\n    const v = await this._request(`${this.prefix}.STREAM.PURGE.${name}`, opts);\n    return v;\n  }\n  async deleteMessage(stream, seq, erase = true) {\n    validateStreamName(stream);\n    const dr = {\n      seq\n    };\n    if (!erase) {\n      dr.no_erase = true;\n    }\n    const r = await this._request(`${this.prefix}.STREAM.MSG.DELETE.${stream}`, dr);\n    const cr = r;\n    return cr.success;\n  }\n  async getMessage(stream, query) {\n    validateStreamName(stream);\n    const r = await this._request(`${this.prefix}.STREAM.MSG.GET.${stream}`, query);\n    const sm = r;\n    return new StoredMsgImpl(sm);\n  }\n  find(subject) {\n    return this.findStream(subject);\n  }\n  listKvs() {\n    const filter = v => {\n      const slr = v;\n      const kvStreams = slr.streams.filter(v => {\n        return v.config.name.startsWith(kvPrefix);\n      });\n      kvStreams.forEach(si => {\n        this._fixInfo(si);\n      });\n      let cluster = \"\";\n      if (kvStreams.length) {\n        cluster = this.nc.info?.cluster ?? \"\";\n      }\n      const status = kvStreams.map(si => {\n        return new KvStatusImpl(si, cluster);\n      });\n      return status;\n    };\n    const subj = `${this.prefix}.STREAM.LIST`;\n    return new ListerImpl(subj, filter, this);\n  }\n  listObjectStores() {\n    const filter = v => {\n      const slr = v;\n      const objStreams = slr.streams.filter(v => {\n        return v.config.name.startsWith(osPrefix);\n      });\n      objStreams.forEach(si => {\n        this._fixInfo(si);\n      });\n      const status = objStreams.map(si => {\n        return new ObjectStoreStatusImpl(si);\n      });\n      return status;\n    };\n    const subj = `${this.prefix}.STREAM.LIST`;\n    return new ListerImpl(subj, filter, this);\n  }\n  names(subject = \"\") {\n    const payload = subject?.length ? {\n      subject\n    } : {};\n    const listerFilter = v => {\n      const sr = v;\n      return sr.streams;\n    };\n    const subj = `${this.prefix}.STREAM.NAMES`;\n    return new ListerImpl(subj, listerFilter, this, payload);\n  }\n  async get(name) {\n    const si = await this.info(name);\n    return Promise.resolve(new StreamImpl(this, si));\n  }\n}\nclass DirectStreamAPIImpl extends BaseApiClient {\n  constructor(nc, opts) {\n    super(nc, opts);\n  }\n  async getMessage(stream, query) {\n    validateStreamName(stream);\n    let qq = query;\n    const {\n      last_by_subj\n    } = qq;\n    if (last_by_subj) {\n      qq = null;\n    }\n    const payload = qq ? this.jc.encode(qq) : Empty;\n    const pre = this.opts.apiPrefix || \"$JS.API\";\n    const subj = last_by_subj ? `${pre}.DIRECT.GET.${stream}.${last_by_subj}` : `${pre}.DIRECT.GET.${stream}`;\n    const r = await this.nc.request(subj, payload);\n    const err = checkJsError(r);\n    if (err) {\n      return Promise.reject(err);\n    }\n    const dm = new DirectMsgImpl(r);\n    return Promise.resolve(dm);\n  }\n  async getBatch(stream, opts) {\n    validateStreamName(stream);\n    const pre = this.opts.apiPrefix || \"$JS.API\";\n    const subj = `${pre}.DIRECT.GET.${stream}`;\n    if (!Array.isArray(opts.multi_last) || opts.multi_last.length === 0) {\n      return Promise.reject(\"multi_last is required\");\n    }\n    const payload = JSON.stringify(opts, (key, value) => {\n      if (key === \"up_to_time\" && value instanceof Date) {\n        return value.toISOString();\n      }\n      return value;\n    });\n    const iter = new QueuedIteratorImpl();\n    const raw = await this.nc.requestMany(subj, payload, {\n      strategy: RequestStrategy.SentinelMsg\n    });\n    (async () => {\n      let gotFirst = false;\n      let badServer = false;\n      let badRequest;\n      for await (const m of raw) {\n        if (!gotFirst) {\n          gotFirst = true;\n          const code = m.headers?.code || 0;\n          if (code !== 0 && code < 200 || code > 299) {\n            badRequest = m.headers?.description.toLowerCase();\n            break;\n          }\n          const v = m.headers?.get(\"Nats-Num-Pending\");\n          if (v === \"\") {\n            badServer = true;\n            break;\n          }\n        }\n        if (m.data.length === 0) {\n          break;\n        }\n        iter.push(new DirectMsgImpl(m));\n      }\n      iter.push(() => {\n        if (badServer) {\n          throw new Error(\"batch direct get not supported by the server\");\n        }\n        if (badRequest) {\n          throw new Error(`bad request: ${badRequest}`);\n        }\n        iter.stop();\n      });\n    })();\n    return Promise.resolve(iter);\n  }\n}\nclass DirectMsgImpl {\n  data;\n  header;\n  static jc;\n  constructor(m) {\n    if (!m.headers) {\n      throw new Error(\"headers expected\");\n    }\n    this.data = m.data;\n    this.header = m.headers;\n  }\n  get subject() {\n    return this.header.last(DirectMsgHeaders.Subject);\n  }\n  get seq() {\n    const v = this.header.last(DirectMsgHeaders.Sequence);\n    return typeof v === \"string\" ? parseInt(v) : 0;\n  }\n  get time() {\n    return new Date(Date.parse(this.timestamp));\n  }\n  get timestamp() {\n    return this.header.last(DirectMsgHeaders.TimeStamp);\n  }\n  get stream() {\n    return this.header.last(DirectMsgHeaders.Stream);\n  }\n  json(reviver) {\n    return JSONCodec(reviver).decode(this.data);\n  }\n  string() {\n    return TD.decode(this.data);\n  }\n}\nclass JetStreamManagerImpl extends BaseApiClient {\n  streams;\n  consumers;\n  direct;\n  constructor(nc, opts) {\n    super(nc, opts);\n    this.streams = new StreamAPIImpl(nc, opts);\n    this.consumers = new ConsumerAPIImpl(nc, opts);\n    this.direct = new DirectStreamAPIImpl(nc, opts);\n  }\n  async getAccountInfo() {\n    const r = await this._request(`${this.prefix}.INFO`);\n    return r;\n  }\n  jetstream() {\n    return this.nc.jetstream(this.getOptions());\n  }\n  advisories() {\n    const iter = new QueuedIteratorImpl();\n    this.nc.subscribe(`$JS.EVENT.ADVISORY.>`, {\n      callback: (err, msg) => {\n        if (err) {\n          throw err;\n        }\n        try {\n          const d = this.parseJsResponse(msg);\n          const chunks = d.type.split(\".\");\n          const kind = chunks[chunks.length - 1];\n          iter.push({\n            kind: kind,\n            data: d\n          });\n        } catch (err) {\n          iter.stop(err);\n        }\n      }\n    });\n    return iter;\n  }\n}\nclass StoredMsgImpl {\n  _header;\n  smr;\n  static jc;\n  constructor(smr) {\n    this.smr = smr;\n  }\n  get subject() {\n    return this.smr.message.subject;\n  }\n  get seq() {\n    return this.smr.message.seq;\n  }\n  get timestamp() {\n    return this.smr.message.time;\n  }\n  get time() {\n    return new Date(Date.parse(this.timestamp));\n  }\n  get data() {\n    return this.smr.message.data ? this._parse(this.smr.message.data) : Empty;\n  }\n  get header() {\n    if (!this._header) {\n      if (this.smr.message.hdrs) {\n        const hd = this._parse(this.smr.message.hdrs);\n        this._header = MsgHdrsImpl.decode(hd);\n      } else {\n        this._header = headers();\n      }\n    }\n    return this._header;\n  }\n  _parse(s) {\n    const bs = atob(s);\n    const len = bs.length;\n    const bytes = new Uint8Array(len);\n    for (let i = 0; i < len; i++) {\n      bytes[i] = bs.charCodeAt(i);\n    }\n    return bytes;\n  }\n  json(reviver) {\n    return JSONCodec(reviver).decode(this.data);\n  }\n  string() {\n    return TD.decode(this.data);\n  }\n}\nclass StreamsImpl {\n  api;\n  constructor(api) {\n    this.api = api;\n  }\n  get(stream) {\n    return this.api.info(stream).then(si => {\n      return new StreamImpl(this.api, si);\n    });\n  }\n}\nclass ObjectInfoImpl {\n  info;\n  hdrs;\n  constructor(oi) {\n    this.info = oi;\n  }\n  get name() {\n    return this.info.name;\n  }\n  get description() {\n    return this.info.description ?? \"\";\n  }\n  get headers() {\n    if (!this.hdrs) {\n      this.hdrs = MsgHdrsImpl.fromRecord(this.info.headers || {});\n    }\n    return this.hdrs;\n  }\n  get options() {\n    return this.info.options;\n  }\n  get bucket() {\n    return this.info.bucket;\n  }\n  get chunks() {\n    return this.info.chunks;\n  }\n  get deleted() {\n    return this.info.deleted ?? false;\n  }\n  get digest() {\n    return this.info.digest;\n  }\n  get mtime() {\n    return this.info.mtime;\n  }\n  get nuid() {\n    return this.info.nuid;\n  }\n  get size() {\n    return this.info.size;\n  }\n  get revision() {\n    return this.info.revision;\n  }\n  get metadata() {\n    return this.info.metadata || {};\n  }\n  isLink() {\n    return this.info.options?.link !== undefined && this.info.options?.link !== null;\n  }\n}\nfunction toServerObjectStoreMeta(meta) {\n  const v = {\n    name: meta.name,\n    description: meta.description ?? \"\",\n    options: meta.options,\n    metadata: meta.metadata\n  };\n  if (meta.headers) {\n    const mhi = meta.headers;\n    v.headers = mhi.toRecord();\n  }\n  return v;\n}\nfunction emptyReadableStream() {\n  return new ReadableStream({\n    pull(c) {\n      c.enqueue(new Uint8Array(0));\n      c.close();\n    }\n  });\n}\nclass ObjectStoreImpl {\n  jsm;\n  js;\n  stream;\n  name;\n  constructor(name, jsm, js) {\n    this.name = name;\n    this.jsm = jsm;\n    this.js = js;\n  }\n  _checkNotEmpty(name) {\n    if (!name || name.length === 0) {\n      return {\n        name,\n        error: new Error(\"name cannot be empty\")\n      };\n    }\n    return {\n      name\n    };\n  }\n  async info(name) {\n    const info = await this.rawInfo(name);\n    return info ? new ObjectInfoImpl(info) : null;\n  }\n  async list() {\n    const buf = [];\n    const iter = await this.watch({\n      ignoreDeletes: true,\n      includeHistory: true\n    });\n    for await (const info of iter) {\n      if (info === null) {\n        break;\n      }\n      buf.push(info);\n    }\n    return Promise.resolve(buf);\n  }\n  async rawInfo(name) {\n    const {\n      name: obj,\n      error\n    } = this._checkNotEmpty(name);\n    if (error) {\n      return Promise.reject(error);\n    }\n    const meta = this._metaSubject(obj);\n    try {\n      const m = await this.jsm.streams.getMessage(this.stream, {\n        last_by_subj: meta\n      });\n      const jc = JSONCodec();\n      const soi = jc.decode(m.data);\n      soi.revision = m.seq;\n      return soi;\n    } catch (err) {\n      if (err.code === \"404\") {\n        return null;\n      }\n      return Promise.reject(err);\n    }\n  }\n  async _si(opts) {\n    try {\n      return await this.jsm.streams.info(this.stream, opts);\n    } catch (err) {\n      const nerr = err;\n      if (nerr.code === \"404\") {\n        return null;\n      }\n      return Promise.reject(err);\n    }\n  }\n  async seal() {\n    let info = await this._si();\n    if (info === null) {\n      return Promise.reject(new Error(\"object store not found\"));\n    }\n    info.config.sealed = true;\n    info = await this.jsm.streams.update(this.stream, info.config);\n    return Promise.resolve(new ObjectStoreStatusImpl(info));\n  }\n  async status(opts) {\n    const info = await this._si(opts);\n    if (info === null) {\n      return Promise.reject(new Error(\"object store not found\"));\n    }\n    return Promise.resolve(new ObjectStoreStatusImpl(info));\n  }\n  destroy() {\n    return this.jsm.streams.delete(this.stream);\n  }\n  async _put(meta, rs, opts) {\n    const jsopts = this.js.getOptions();\n    opts = opts || {\n      timeout: jsopts.timeout\n    };\n    opts.timeout = opts.timeout || jsopts.timeout;\n    opts.previousRevision = opts.previousRevision ?? undefined;\n    const {\n      timeout,\n      previousRevision\n    } = opts;\n    const si = this.js.nc.info;\n    const maxPayload = si?.max_payload || 1024;\n    meta = meta || {};\n    meta.options = meta.options || {};\n    let maxChunk = meta.options?.max_chunk_size || 128 * 1024;\n    maxChunk = maxChunk > maxPayload ? maxPayload : maxChunk;\n    meta.options.max_chunk_size = maxChunk;\n    const old = await this.info(meta.name);\n    const {\n      name: n,\n      error\n    } = this._checkNotEmpty(meta.name);\n    if (error) {\n      return Promise.reject(error);\n    }\n    const id = nuid.next();\n    const chunkSubj = this._chunkSubject(id);\n    const metaSubj = this._metaSubject(n);\n    const info = Object.assign({\n      bucket: this.name,\n      nuid: id,\n      size: 0,\n      chunks: 0\n    }, toServerObjectStoreMeta(meta));\n    const d = deferred();\n    const proms = [];\n    const db = new DataBuffer();\n    try {\n      const reader = rs ? rs.getReader() : null;\n      const sha = new SHA256();\n      while (true) {\n        const {\n          done,\n          value\n        } = reader ? await reader.read() : {\n          done: true,\n          value: undefined\n        };\n        if (done) {\n          if (db.size() > 0) {\n            const payload = db.drain();\n            sha.update(payload);\n            info.chunks++;\n            info.size += payload.length;\n            proms.push(this.js.publish(chunkSubj, payload, {\n              timeout\n            }));\n          }\n          await Promise.all(proms);\n          proms.length = 0;\n          info.mtime = new Date().toISOString();\n          const digest = sha.digest(\"base64\");\n          const pad = digest.length % 3;\n          const padding = pad > 0 ? \"=\".repeat(pad) : \"\";\n          info.digest = `${digestType}${digest}${padding}`;\n          info.deleted = false;\n          const h = headers();\n          if (typeof previousRevision === \"number\") {\n            h.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${previousRevision}`);\n          }\n          h.set(JsHeaders.RollupHdr, JsHeaders.RollupValueSubject);\n          const pa = await this.js.publish(metaSubj, JSONCodec().encode(info), {\n            headers: h,\n            timeout\n          });\n          info.revision = pa.seq;\n          if (old) {\n            try {\n              await this.jsm.streams.purge(this.stream, {\n                filter: `$O.${this.name}.C.${old.nuid}`\n              });\n            } catch (_err) {}\n          }\n          d.resolve(new ObjectInfoImpl(info));\n          break;\n        }\n        if (value) {\n          db.fill(value);\n          while (db.size() > maxChunk) {\n            info.chunks++;\n            info.size += maxChunk;\n            const payload = db.drain(meta.options.max_chunk_size);\n            sha.update(payload);\n            proms.push(this.js.publish(chunkSubj, payload, {\n              timeout\n            }));\n          }\n        }\n      }\n    } catch (err) {\n      await this.jsm.streams.purge(this.stream, {\n        filter: chunkSubj\n      });\n      d.reject(err);\n    }\n    return d;\n  }\n  putBlob(meta, data, opts) {\n    function readableStreamFrom(data) {\n      return new ReadableStream({\n        pull(controller) {\n          controller.enqueue(data);\n          controller.close();\n        }\n      });\n    }\n    if (data === null) {\n      data = new Uint8Array(0);\n    }\n    return this.put(meta, readableStreamFrom(data), opts);\n  }\n  put(meta, rs, opts) {\n    if (meta?.options?.link) {\n      return Promise.reject(new Error(\"link cannot be set when putting the object in bucket\"));\n    }\n    return this._put(meta, rs, opts);\n  }\n  async getBlob(name) {\n    async function fromReadableStream(rs) {\n      const buf = new DataBuffer();\n      const reader = rs.getReader();\n      while (true) {\n        const {\n          done,\n          value\n        } = await reader.read();\n        if (done) {\n          return buf.drain();\n        }\n        if (value && value.length) {\n          buf.fill(value);\n        }\n      }\n    }\n    const r = await this.get(name);\n    if (r === null) {\n      return Promise.resolve(null);\n    }\n    const vs = await Promise.all([r.error, fromReadableStream(r.data)]);\n    if (vs[0]) {\n      return Promise.reject(vs[0]);\n    } else {\n      return Promise.resolve(vs[1]);\n    }\n  }\n  async get(name) {\n    const info = await this.rawInfo(name);\n    if (info === null) {\n      return Promise.resolve(null);\n    }\n    if (info.deleted) {\n      return Promise.resolve(null);\n    }\n    if (info.options && info.options.link) {\n      const ln = info.options.link.name || \"\";\n      if (ln === \"\") {\n        throw new Error(\"link is a bucket\");\n      }\n      const os = info.options.link.bucket !== this.name ? await ObjectStoreImpl.create(this.js, info.options.link.bucket) : this;\n      return os.get(ln);\n    }\n    const d = deferred();\n    const r = {\n      info: new ObjectInfoImpl(info),\n      error: d\n    };\n    if (info.size === 0) {\n      r.data = emptyReadableStream();\n      d.resolve(null);\n      return Promise.resolve(r);\n    }\n    let controller;\n    const oc = consumerOpts();\n    oc.orderedConsumer();\n    const sha = new SHA256();\n    const subj = `$O.${this.name}.C.${info.nuid}`;\n    const sub = await this.js.subscribe(subj, oc);\n    (async () => {\n      for await (const jm of sub) {\n        if (jm.data.length > 0) {\n          sha.update(jm.data);\n          controller.enqueue(jm.data);\n        }\n        if (jm.info.pending === 0) {\n          const hash = sha.digest(\"base64\");\n          const pad = hash.length % 3;\n          const padding = pad > 0 ? \"=\".repeat(pad) : \"\";\n          const digest = `${digestType}${hash}${padding}`;\n          if (digest !== info.digest) {\n            controller.error(new Error(`received a corrupt object, digests do not match received: ${info.digest} calculated ${digest}`));\n          } else {\n            controller.close();\n          }\n          sub.unsubscribe();\n        }\n      }\n    })().then(() => {\n      d.resolve();\n    }).catch(err => {\n      controller.error(err);\n      d.reject(err);\n    });\n    r.data = new ReadableStream({\n      start(c) {\n        controller = c;\n      },\n      cancel() {\n        sub.unsubscribe();\n      }\n    });\n    return r;\n  }\n  linkStore(name, bucket) {\n    if (!(bucket instanceof ObjectStoreImpl)) {\n      return Promise.reject(\"bucket required\");\n    }\n    const osi = bucket;\n    const {\n      name: n,\n      error\n    } = this._checkNotEmpty(name);\n    if (error) {\n      return Promise.reject(error);\n    }\n    const meta = {\n      name: n,\n      options: {\n        link: {\n          bucket: osi.name\n        }\n      }\n    };\n    return this._put(meta, null);\n  }\n  async link(name, info) {\n    const {\n      name: n,\n      error\n    } = this._checkNotEmpty(name);\n    if (error) {\n      return Promise.reject(error);\n    }\n    if (info.deleted) {\n      return Promise.reject(new Error(\"src object is deleted\"));\n    }\n    if (info.isLink()) {\n      return Promise.reject(new Error(\"src object is a link\"));\n    }\n    const dest = await this.rawInfo(name);\n    if (dest !== null && !dest.deleted) {\n      return Promise.reject(new Error(\"an object already exists with that name\"));\n    }\n    const link = {\n      bucket: info.bucket,\n      name: info.name\n    };\n    const mm = {\n      name: n,\n      bucket: info.bucket,\n      options: {\n        link: link\n      }\n    };\n    await this.js.publish(this._metaSubject(name), JSON.stringify(mm));\n    const i = await this.info(name);\n    return Promise.resolve(i);\n  }\n  async delete(name) {\n    const info = await this.rawInfo(name);\n    if (info === null) {\n      return Promise.resolve({\n        purged: 0,\n        success: false\n      });\n    }\n    info.deleted = true;\n    info.size = 0;\n    info.chunks = 0;\n    info.digest = \"\";\n    const jc = JSONCodec();\n    const h = headers();\n    h.set(JsHeaders.RollupHdr, JsHeaders.RollupValueSubject);\n    await this.js.publish(this._metaSubject(info.name), jc.encode(info), {\n      headers: h\n    });\n    return this.jsm.streams.purge(this.stream, {\n      filter: this._chunkSubject(info.nuid)\n    });\n  }\n  async update(name, meta = {}) {\n    const info = await this.rawInfo(name);\n    if (info === null) {\n      return Promise.reject(new Error(\"object not found\"));\n    }\n    if (info.deleted) {\n      return Promise.reject(new Error(\"cannot update meta for a deleted object\"));\n    }\n    meta.name = meta.name ?? info.name;\n    const {\n      name: n,\n      error\n    } = this._checkNotEmpty(meta.name);\n    if (error) {\n      return Promise.reject(error);\n    }\n    if (name !== meta.name) {\n      const i = await this.info(meta.name);\n      if (i && !i.deleted) {\n        return Promise.reject(new Error(\"an object already exists with that name\"));\n      }\n    }\n    meta.name = n;\n    const ii = Object.assign({}, info, toServerObjectStoreMeta(meta));\n    const ack = await this.js.publish(this._metaSubject(ii.name), JSON.stringify(ii));\n    if (name !== meta.name) {\n      await this.jsm.streams.purge(this.stream, {\n        filter: this._metaSubject(name)\n      });\n    }\n    return Promise.resolve(ack);\n  }\n  async watch(opts = {}) {\n    opts.includeHistory = opts.includeHistory ?? false;\n    opts.ignoreDeletes = opts.ignoreDeletes ?? false;\n    let initialized = false;\n    const qi = new QueuedIteratorImpl();\n    const subj = this._metaSubjectAll();\n    try {\n      await this.jsm.streams.getMessage(this.stream, {\n        last_by_subj: subj\n      });\n    } catch (err) {\n      if (err.code === \"404\") {\n        qi.push(null);\n        initialized = true;\n      } else {\n        qi.stop(err);\n      }\n    }\n    const jc = JSONCodec();\n    const copts = consumerOpts();\n    copts.orderedConsumer();\n    if (opts.includeHistory) {\n      copts.deliverLastPerSubject();\n    } else {\n      initialized = true;\n      copts.deliverNew();\n    }\n    copts.callback((err, jm) => {\n      if (err) {\n        qi.stop(err);\n        return;\n      }\n      if (jm !== null) {\n        const oi = jc.decode(jm.data);\n        if (oi.deleted && opts.ignoreDeletes === true) {} else {\n          qi.push(oi);\n        }\n        if (jm.info?.pending === 0 && !initialized) {\n          initialized = true;\n          qi.push(null);\n        }\n      }\n    });\n    const sub = await this.js.subscribe(subj, copts);\n    qi._data = sub;\n    qi.iterClosed.then(() => {\n      sub.unsubscribe();\n    });\n    sub.closed.then(() => {\n      qi.stop();\n    }).catch(err => {\n      qi.stop(err);\n    });\n    return qi;\n  }\n  _chunkSubject(id) {\n    return `$O.${this.name}.C.${id}`;\n  }\n  _metaSubject(n) {\n    return `$O.${this.name}.M.${Base64UrlPaddedCodec.encode(n)}`;\n  }\n  _metaSubjectAll() {\n    return `$O.${this.name}.M.>`;\n  }\n  async init(opts = {}) {\n    try {\n      this.stream = objectStoreStreamName(this.name);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n    const max_age = opts?.ttl || 0;\n    delete opts.ttl;\n    const sc = Object.assign({\n      max_age\n    }, opts);\n    sc.name = this.stream;\n    sc.num_replicas = opts.replicas ?? 1;\n    sc.allow_direct = true;\n    sc.allow_rollup_hdrs = true;\n    sc.discard = DiscardPolicy.New;\n    sc.subjects = [`$O.${this.name}.C.>`, `$O.${this.name}.M.>`];\n    if (opts.placement) {\n      sc.placement = opts.placement;\n    }\n    if (opts.metadata) {\n      sc.metadata = opts.metadata;\n    }\n    if (typeof opts.compression === \"boolean\") {\n      sc.compression = opts.compression ? StoreCompression.S2 : StoreCompression.None;\n    }\n    try {\n      await this.jsm.streams.info(sc.name);\n    } catch (err) {\n      if (err.message === \"stream not found\") {\n        await this.jsm.streams.add(sc);\n      }\n    }\n  }\n  static async create(js, name, opts = {}) {\n    const jsm = await js.jetstreamManager();\n    const os = new ObjectStoreImpl(name, jsm, js);\n    await os.init(opts);\n    return Promise.resolve(os);\n  }\n}\nclass ViewsImpl {\n  js;\n  constructor(js) {\n    this.js = js;\n  }\n  kv(name, opts = {}) {\n    const jsi = this.js;\n    const {\n      ok,\n      min\n    } = jsi.nc.features.get(Feature.JS_KV);\n    if (!ok) {\n      return Promise.reject(new Error(`kv is only supported on servers ${min} or better`));\n    }\n    if (opts.bindOnly) {\n      return Bucket.bind(this.js, name, opts);\n    }\n    return Bucket.create(this.js, name, opts);\n  }\n  os(name, opts = {}) {\n    if (typeof crypto?.subtle?.digest !== \"function\") {\n      return Promise.reject(new Error(\"objectstore: unable to calculate hashes - crypto.subtle.digest with sha256 support is required\"));\n    }\n    const jsi = this.js;\n    const {\n      ok,\n      min\n    } = jsi.nc.features.get(Feature.JS_OBJECTSTORE);\n    if (!ok) {\n      return Promise.reject(new Error(`objectstore is only supported on servers ${min} or better`));\n    }\n    return ObjectStoreImpl.create(this.js, name, opts);\n  }\n}\nclass JetStreamClientImpl extends BaseApiClient {\n  consumers;\n  streams;\n  consumerAPI;\n  streamAPI;\n  constructor(nc, opts) {\n    super(nc, opts);\n    this.consumerAPI = new ConsumerAPIImpl(nc, opts);\n    this.streamAPI = new StreamAPIImpl(nc, opts);\n    this.consumers = new ConsumersImpl(this.consumerAPI);\n    this.streams = new StreamsImpl(this.streamAPI);\n  }\n  jetstreamManager(checkAPI) {\n    if (checkAPI === undefined) {\n      checkAPI = this.opts.checkAPI;\n    }\n    const opts = Object.assign({}, this.opts, {\n      checkAPI\n    });\n    return this.nc.jetstreamManager(opts);\n  }\n  get apiPrefix() {\n    return this.prefix;\n  }\n  get views() {\n    return new ViewsImpl(this);\n  }\n  async publish(subj, data = Empty, opts) {\n    opts = opts || {};\n    opts.expect = opts.expect || {};\n    const mh = opts?.headers || headers();\n    if (opts) {\n      if (opts.msgID) {\n        mh.set(PubHeaders.MsgIdHdr, opts.msgID);\n      }\n      if (opts.expect.lastMsgID) {\n        mh.set(PubHeaders.ExpectedLastMsgIdHdr, opts.expect.lastMsgID);\n      }\n      if (opts.expect.streamName) {\n        mh.set(PubHeaders.ExpectedStreamHdr, opts.expect.streamName);\n      }\n      if (typeof opts.expect.lastSequence === \"number\") {\n        mh.set(PubHeaders.ExpectedLastSeqHdr, `${opts.expect.lastSequence}`);\n      }\n      if (typeof opts.expect.lastSubjectSequence === \"number\") {\n        mh.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${opts.expect.lastSubjectSequence}`);\n      }\n    }\n    const to = opts.timeout || this.timeout;\n    const ro = {};\n    if (to) {\n      ro.timeout = to;\n    }\n    if (opts) {\n      ro.headers = mh;\n    }\n    let {\n      retries,\n      retry_delay\n    } = opts;\n    retries = retries || 1;\n    retry_delay = retry_delay || 250;\n    let r;\n    for (let i = 0; i < retries; i++) {\n      try {\n        r = await this.nc.request(subj, data, ro);\n        break;\n      } catch (err) {\n        const ne = err;\n        if (ne.code === \"503\" && i + 1 < retries) {\n          await delay(retry_delay);\n        } else {\n          throw err;\n        }\n      }\n    }\n    const pa = this.parseJsResponse(r);\n    if (pa.stream === \"\") {\n      throw NatsError.errorForCode(ErrorCode.JetStreamInvalidAck);\n    }\n    pa.duplicate = pa.duplicate ? pa.duplicate : false;\n    return pa;\n  }\n  async pull(stream, durable, expires = 0) {\n    validateStreamName(stream);\n    validateDurableName(durable);\n    let timeout = this.timeout;\n    if (expires > timeout) {\n      timeout = expires;\n    }\n    expires = expires < 0 ? 0 : nanos(expires);\n    const pullOpts = {\n      batch: 1,\n      no_wait: expires === 0,\n      expires\n    };\n    const msg = await this.nc.request(`${this.prefix}.CONSUMER.MSG.NEXT.${stream}.${durable}`, this.jc.encode(pullOpts), {\n      noMux: true,\n      timeout\n    });\n    const err = checkJsError(msg);\n    if (err) {\n      throw err;\n    }\n    return toJsMsg(msg, this.timeout);\n  }\n  fetch(stream, durable, opts = {}) {\n    validateStreamName(stream);\n    validateDurableName(durable);\n    let timer = null;\n    const trackBytes = (opts.max_bytes ?? 0) > 0;\n    let receivedBytes = 0;\n    const max_bytes = trackBytes ? opts.max_bytes : 0;\n    let monitor = null;\n    const args = {};\n    args.batch = opts.batch || 1;\n    if (max_bytes) {\n      const fv = this.nc.features.get(Feature.JS_PULL_MAX_BYTES);\n      if (!fv.ok) {\n        throw new Error(`max_bytes is only supported on servers ${fv.min} or better`);\n      }\n      args.max_bytes = max_bytes;\n    }\n    args.no_wait = opts.no_wait || false;\n    if (args.no_wait && args.expires) {\n      args.expires = 0;\n    }\n    const expires = opts.expires || 0;\n    if (expires) {\n      args.expires = nanos(expires);\n    }\n    if (expires === 0 && args.no_wait === false) {\n      throw new Error(\"expires or no_wait is required\");\n    }\n    const hb = opts.idle_heartbeat || 0;\n    if (hb) {\n      args.idle_heartbeat = nanos(hb);\n      if (opts.delay_heartbeat === true) {\n        args.idle_heartbeat = nanos(hb * 4);\n      }\n    }\n    const qi = new QueuedIteratorImpl();\n    const wants = args.batch;\n    let received = 0;\n    qi.protocolFilterFn = (jm, _ingest = false) => {\n      const jsmi = jm;\n      if (isHeartbeatMsg(jsmi.msg)) {\n        monitor?.work();\n        return false;\n      }\n      return true;\n    };\n    qi.dispatchedFn = m => {\n      if (m) {\n        if (trackBytes) {\n          receivedBytes += m.data.length;\n        }\n        received++;\n        if (timer && m.info.pending === 0) {\n          return;\n        }\n        if (qi.getPending() === 1 && m.info.pending === 0 || wants === received || max_bytes > 0 && receivedBytes >= max_bytes) {\n          qi.stop();\n        }\n      }\n    };\n    const inbox = createInbox(this.nc.options.inboxPrefix);\n    const sub = this.nc.subscribe(inbox, {\n      max: opts.batch,\n      callback: (err, msg) => {\n        if (err === null) {\n          err = checkJsError(msg);\n        }\n        if (err !== null) {\n          if (timer) {\n            timer.cancel();\n            timer = null;\n          }\n          if (isNatsError(err)) {\n            qi.stop(hideNonTerminalJsErrors(err) === null ? undefined : err);\n          } else {\n            qi.stop(err);\n          }\n        } else {\n          monitor?.work();\n          qi.received++;\n          qi.push(toJsMsg(msg, this.timeout));\n        }\n      }\n    });\n    if (expires) {\n      timer = timeout(expires);\n      timer.catch(() => {\n        if (!sub.isClosed()) {\n          sub.drain().catch(() => {});\n          timer = null;\n        }\n        if (monitor) {\n          monitor.cancel();\n        }\n      });\n    }\n    (async () => {\n      try {\n        if (hb) {\n          monitor = new IdleHeartbeatMonitor(hb, v => {\n            qi.push(() => {\n              qi.err = new NatsError(`${Js409Errors.IdleHeartbeatMissed}: ${v}`, ErrorCode.JetStreamIdleHeartBeat);\n            });\n            return true;\n          });\n        }\n      } catch (_err) {}\n      await sub.closed;\n      if (timer !== null) {\n        timer.cancel();\n        timer = null;\n      }\n      if (monitor) {\n        monitor.cancel();\n      }\n      qi.stop();\n    })().catch();\n    this.nc.publish(`${this.prefix}.CONSUMER.MSG.NEXT.${stream}.${durable}`, this.jc.encode(args), {\n      reply: inbox\n    });\n    return qi;\n  }\n  async pullSubscribe(subject, opts = consumerOpts()) {\n    const cso = await this._processOptions(subject, opts);\n    if (cso.ordered) {\n      throw new Error(\"pull subscribers cannot be be ordered\");\n    }\n    if (cso.config.deliver_subject) {\n      throw new Error(\"consumer info specifies deliver_subject - pull consumers cannot have deliver_subject set\");\n    }\n    const ackPolicy = cso.config.ack_policy;\n    if (ackPolicy === AckPolicy.None || ackPolicy === AckPolicy.All) {\n      throw new Error(\"ack policy for pull consumers must be explicit\");\n    }\n    const so = this._buildTypedSubscriptionOpts(cso);\n    const sub = new JetStreamPullSubscriptionImpl(this, cso.deliver, so);\n    sub.info = cso;\n    try {\n      await this._maybeCreateConsumer(cso);\n    } catch (err) {\n      sub.unsubscribe();\n      throw err;\n    }\n    return sub;\n  }\n  async subscribe(subject, opts = consumerOpts()) {\n    const cso = await this._processOptions(subject, opts);\n    if (!cso.isBind && !cso.config.deliver_subject) {\n      throw new Error(\"push consumer requires deliver_subject\");\n    }\n    const so = this._buildTypedSubscriptionOpts(cso);\n    const sub = new JetStreamSubscriptionImpl(this, cso.deliver, so);\n    sub.info = cso;\n    try {\n      await this._maybeCreateConsumer(cso);\n    } catch (err) {\n      sub.unsubscribe();\n      throw err;\n    }\n    sub._maybeSetupHbMonitoring();\n    return sub;\n  }\n  async _processOptions(subject, opts = consumerOpts()) {\n    const jsi = isConsumerOptsBuilder(opts) ? opts.getOpts() : opts;\n    jsi.isBind = isConsumerOptsBuilder(opts) ? opts.isBind : false;\n    jsi.flow_control = {\n      heartbeat_count: 0,\n      fc_count: 0,\n      consumer_restarts: 0\n    };\n    if (jsi.ordered) {\n      jsi.ordered_consumer_sequence = {\n        stream_seq: 0,\n        delivery_seq: 0\n      };\n      if (jsi.config.ack_policy !== AckPolicy.NotSet && jsi.config.ack_policy !== AckPolicy.None) {\n        throw new NatsError(\"ordered consumer: ack_policy can only be set to 'none'\", ErrorCode.ApiError);\n      }\n      if (jsi.config.durable_name && jsi.config.durable_name.length > 0) {\n        throw new NatsError(\"ordered consumer: durable_name cannot be set\", ErrorCode.ApiError);\n      }\n      if (jsi.config.deliver_subject && jsi.config.deliver_subject.length > 0) {\n        throw new NatsError(\"ordered consumer: deliver_subject cannot be set\", ErrorCode.ApiError);\n      }\n      if (jsi.config.max_deliver !== undefined && jsi.config.max_deliver > 1) {\n        throw new NatsError(\"ordered consumer: max_deliver cannot be set\", ErrorCode.ApiError);\n      }\n      if (jsi.config.deliver_group && jsi.config.deliver_group.length > 0) {\n        throw new NatsError(\"ordered consumer: deliver_group cannot be set\", ErrorCode.ApiError);\n      }\n      jsi.config.deliver_subject = createInbox(this.nc.options.inboxPrefix);\n      jsi.config.ack_policy = AckPolicy.None;\n      jsi.config.max_deliver = 1;\n      jsi.config.flow_control = true;\n      jsi.config.idle_heartbeat = jsi.config.idle_heartbeat || nanos(5000);\n      jsi.config.ack_wait = nanos(22 * 60 * 60 * 1000);\n      jsi.config.mem_storage = true;\n      jsi.config.num_replicas = 1;\n    }\n    if (jsi.config.ack_policy === AckPolicy.NotSet) {\n      jsi.config.ack_policy = AckPolicy.All;\n    }\n    jsi.api = this;\n    jsi.config = jsi.config || {};\n    jsi.stream = jsi.stream ? jsi.stream : await this.findStream(subject);\n    jsi.attached = false;\n    if (jsi.config.durable_name) {\n      try {\n        const info = await this.consumerAPI.info(jsi.stream, jsi.config.durable_name);\n        if (info) {\n          if (info.config.filter_subject && info.config.filter_subject !== subject) {\n            throw new Error(\"subject does not match consumer\");\n          }\n          const qn = jsi.config.deliver_group ?? \"\";\n          if (qn === \"\" && info.push_bound === true) {\n            throw new Error(`duplicate subscription`);\n          }\n          const rqn = info.config.deliver_group ?? \"\";\n          if (qn !== rqn) {\n            if (rqn === \"\") {\n              throw new Error(`durable requires no queue group`);\n            } else {\n              throw new Error(`durable requires queue group '${rqn}'`);\n            }\n          }\n          jsi.last = info;\n          jsi.config = info.config;\n          jsi.attached = true;\n          if (!jsi.config.durable_name) {\n            jsi.name = info.name;\n          }\n        }\n      } catch (err) {\n        if (err.code !== \"404\") {\n          throw err;\n        }\n      }\n    }\n    if (!jsi.attached && jsi.config.filter_subject === undefined && jsi.config.filter_subjects === undefined) {\n      jsi.config.filter_subject = subject;\n    }\n    jsi.deliver = jsi.config.deliver_subject || createInbox(this.nc.options.inboxPrefix);\n    return jsi;\n  }\n  _buildTypedSubscriptionOpts(jsi) {\n    const so = {};\n    so.adapter = msgAdapter(jsi.callbackFn === undefined, this.timeout);\n    so.ingestionFilterFn = JetStreamClientImpl.ingestionFn(jsi.ordered);\n    so.protocolFilterFn = (jm, ingest = false) => {\n      const jsmi = jm;\n      if (isFlowControlMsg(jsmi.msg)) {\n        if (!ingest) {\n          jsmi.msg.respond();\n        }\n        return false;\n      }\n      return true;\n    };\n    if (!jsi.mack && jsi.config.ack_policy !== AckPolicy.None) {\n      so.dispatchedFn = autoAckJsMsg;\n    }\n    if (jsi.callbackFn) {\n      so.callback = jsi.callbackFn;\n    }\n    so.max = jsi.max || 0;\n    so.queue = jsi.queue;\n    return so;\n  }\n  async _maybeCreateConsumer(jsi) {\n    if (jsi.attached) {\n      return;\n    }\n    if (jsi.isBind) {\n      throw new Error(`unable to bind - durable consumer ${jsi.config.durable_name} doesn't exist in ${jsi.stream}`);\n    }\n    jsi.config = Object.assign({\n      deliver_policy: DeliverPolicy.All,\n      ack_policy: AckPolicy.Explicit,\n      ack_wait: nanos(30 * 1000),\n      replay_policy: ReplayPolicy.Instant\n    }, jsi.config);\n    const ci = await this.consumerAPI.add(jsi.stream, jsi.config);\n    if (Array.isArray(jsi.config.filter_subjects && !Array.isArray(ci.config.filter_subjects))) {\n      throw new Error(`jetstream server doesn't support consumers with multiple filter subjects`);\n    }\n    jsi.name = ci.name;\n    jsi.config = ci.config;\n    jsi.last = ci;\n  }\n  static ingestionFn(ordered) {\n    return (jm, ctx) => {\n      const jsub = ctx;\n      if (!jm) return {\n        ingest: false,\n        protocol: false\n      };\n      const jmi = jm;\n      if (!checkJsError(jmi.msg)) {\n        jsub.monitor?.work();\n      }\n      if (isHeartbeatMsg(jmi.msg)) {\n        const ingest = ordered ? jsub._checkHbOrderConsumer(jmi.msg) : true;\n        if (!ordered) {\n          jsub.info.flow_control.heartbeat_count++;\n        }\n        return {\n          ingest,\n          protocol: true\n        };\n      } else if (isFlowControlMsg(jmi.msg)) {\n        jsub.info.flow_control.fc_count++;\n        return {\n          ingest: true,\n          protocol: true\n        };\n      }\n      const ingest = ordered ? jsub._checkOrderedConsumer(jm) : true;\n      return {\n        ingest,\n        protocol: false\n      };\n    };\n  }\n}\nclass NatsConnectionImpl {\n  options;\n  protocol;\n  draining;\n  listeners;\n  _services;\n  constructor(opts) {\n    this.draining = false;\n    this.options = parseOptions(opts);\n    this.listeners = [];\n  }\n  static connect(opts = {}) {\n    return new Promise((resolve, reject) => {\n      const nc = new NatsConnectionImpl(opts);\n      ProtocolHandler.connect(nc.options, nc).then(ph => {\n        nc.protocol = ph;\n        (async function () {\n          for await (const s of ph.status()) {\n            nc.listeners.forEach(l => {\n              l.push(s);\n            });\n          }\n        })();\n        resolve(nc);\n      }).catch(err => {\n        reject(err);\n      });\n    });\n  }\n  closed() {\n    return this.protocol.closed;\n  }\n  async close() {\n    await this.protocol.close();\n  }\n  _check(subject, sub, pub) {\n    if (this.isClosed()) {\n      throw NatsError.errorForCode(ErrorCode.ConnectionClosed);\n    }\n    if (sub && this.isDraining()) {\n      throw NatsError.errorForCode(ErrorCode.ConnectionDraining);\n    }\n    if (pub && this.protocol.noMorePublishing) {\n      throw NatsError.errorForCode(ErrorCode.ConnectionDraining);\n    }\n    subject = subject || \"\";\n    if (subject.length === 0) {\n      throw NatsError.errorForCode(ErrorCode.BadSubject);\n    }\n  }\n  publish(subject, data, options) {\n    this._check(subject, false, true);\n    this.protocol.publish(subject, data, options);\n  }\n  publishMessage(msg) {\n    return this.publish(msg.subject, msg.data, {\n      reply: msg.reply,\n      headers: msg.headers\n    });\n  }\n  respondMessage(msg) {\n    if (msg.reply) {\n      this.publish(msg.reply, msg.data, {\n        reply: msg.reply,\n        headers: msg.headers\n      });\n      return true;\n    }\n    return false;\n  }\n  subscribe(subject, opts = {}) {\n    this._check(subject, true, false);\n    const sub = new SubscriptionImpl(this.protocol, subject, opts);\n    this.protocol.subscribe(sub);\n    return sub;\n  }\n  _resub(s, subject, max) {\n    this._check(subject, true, false);\n    const si = s;\n    si.max = max;\n    if (max) {\n      si.max = max + si.received;\n    }\n    this.protocol.resub(si, subject);\n  }\n  requestMany(subject, data = Empty, opts = {\n    maxWait: 1000,\n    maxMessages: -1\n  }) {\n    const asyncTraces = !(this.protocol.options.noAsyncTraces || false);\n    try {\n      this._check(subject, true, true);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n    opts.strategy = opts.strategy || RequestStrategy.Timer;\n    opts.maxWait = opts.maxWait || 1000;\n    if (opts.maxWait < 1) {\n      return Promise.reject(new NatsError(\"timeout\", ErrorCode.InvalidOption));\n    }\n    const qi = new QueuedIteratorImpl();\n    function stop(err) {\n      qi.push(() => {\n        qi.stop(err);\n      });\n    }\n    function callback(err, msg) {\n      if (err || msg === null) {\n        stop(err === null ? undefined : err);\n      } else {\n        qi.push(msg);\n      }\n    }\n    if (opts.noMux) {\n      const stack = asyncTraces ? new Error().stack : null;\n      let max = typeof opts.maxMessages === \"number\" && opts.maxMessages > 0 ? opts.maxMessages : -1;\n      const sub = this.subscribe(createInbox(this.options.inboxPrefix), {\n        callback: (err, msg) => {\n          if (msg?.data?.length === 0 && msg?.headers?.status === ErrorCode.NoResponders) {\n            err = NatsError.errorForCode(ErrorCode.NoResponders);\n          }\n          if (err) {\n            if (stack) {\n              err.stack += `\\n\\n${stack}`;\n            }\n            cancel(err);\n            return;\n          }\n          callback(null, msg);\n          if (opts.strategy === RequestStrategy.Count) {\n            max--;\n            if (max === 0) {\n              cancel();\n            }\n          }\n          if (opts.strategy === RequestStrategy.JitterTimer) {\n            clearTimers();\n            timer = setTimeout(() => {\n              cancel();\n            }, 300);\n          }\n          if (opts.strategy === RequestStrategy.SentinelMsg) {\n            if (msg && msg.data.length === 0) {\n              cancel();\n            }\n          }\n        }\n      });\n      sub.requestSubject = subject;\n      sub.closed.then(() => {\n        stop();\n      }).catch(err => {\n        qi.stop(err);\n      });\n      const cancel = err => {\n        if (err) {\n          qi.push(() => {\n            throw err;\n          });\n        }\n        clearTimers();\n        sub.drain().then(() => {\n          stop();\n        }).catch(_err => {\n          stop();\n        });\n      };\n      qi.iterClosed.then(() => {\n        clearTimers();\n        sub?.unsubscribe();\n      }).catch(_err => {\n        clearTimers();\n        sub?.unsubscribe();\n      });\n      try {\n        this.publish(subject, data, {\n          reply: sub.getSubject()\n        });\n      } catch (err) {\n        cancel(err);\n      }\n      let timer = setTimeout(() => {\n        cancel();\n      }, opts.maxWait);\n      const clearTimers = () => {\n        if (timer) {\n          clearTimeout(timer);\n        }\n      };\n    } else {\n      const rmo = opts;\n      rmo.callback = callback;\n      qi.iterClosed.then(() => {\n        r.cancel();\n      }).catch(err => {\n        r.cancel(err);\n      });\n      const r = new RequestMany(this.protocol.muxSubscriptions, subject, rmo);\n      this.protocol.request(r);\n      try {\n        this.publish(subject, data, {\n          reply: `${this.protocol.muxSubscriptions.baseInbox}${r.token}`,\n          headers: opts.headers\n        });\n      } catch (err) {\n        r.cancel(err);\n      }\n    }\n    return Promise.resolve(qi);\n  }\n  request(subject, data, opts = {\n    timeout: 1000,\n    noMux: false\n  }) {\n    try {\n      this._check(subject, true, true);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n    const asyncTraces = !(this.protocol.options.noAsyncTraces || false);\n    opts.timeout = opts.timeout || 1000;\n    if (opts.timeout < 1) {\n      return Promise.reject(new NatsError(\"timeout\", ErrorCode.InvalidOption));\n    }\n    if (!opts.noMux && opts.reply) {\n      return Promise.reject(new NatsError(\"reply can only be used with noMux\", ErrorCode.InvalidOption));\n    }\n    if (opts.noMux) {\n      const inbox = opts.reply ? opts.reply : createInbox(this.options.inboxPrefix);\n      const d = deferred();\n      const errCtx = asyncTraces ? new Error() : null;\n      const sub = this.subscribe(inbox, {\n        max: 1,\n        timeout: opts.timeout,\n        callback: (err, msg) => {\n          if (err) {\n            if (errCtx && err.code !== ErrorCode.Timeout) {\n              err.stack += `\\n\\n${errCtx.stack}`;\n            }\n            sub.unsubscribe();\n            d.reject(err);\n          } else {\n            err = isRequestError(msg);\n            if (err) {\n              if (errCtx) {\n                err.stack += `\\n\\n${errCtx.stack}`;\n              }\n              d.reject(err);\n            } else {\n              d.resolve(msg);\n            }\n          }\n        }\n      });\n      sub.requestSubject = subject;\n      this.protocol.publish(subject, data, {\n        reply: inbox,\n        headers: opts.headers\n      });\n      return d;\n    } else {\n      const r = new RequestOne(this.protocol.muxSubscriptions, subject, opts, asyncTraces);\n      this.protocol.request(r);\n      try {\n        this.publish(subject, data, {\n          reply: `${this.protocol.muxSubscriptions.baseInbox}${r.token}`,\n          headers: opts.headers\n        });\n      } catch (err) {\n        r.cancel(err);\n      }\n      const p = Promise.race([r.timer, r.deferred]);\n      p.catch(() => {\n        r.cancel();\n      });\n      return p;\n    }\n  }\n  flush() {\n    if (this.isClosed()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n    }\n    return this.protocol.flush();\n  }\n  drain() {\n    if (this.isClosed()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n    }\n    if (this.isDraining()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionDraining));\n    }\n    this.draining = true;\n    return this.protocol.drain();\n  }\n  isClosed() {\n    return this.protocol.isClosed();\n  }\n  isDraining() {\n    return this.draining;\n  }\n  getServer() {\n    const srv = this.protocol.getServer();\n    return srv ? srv.listen : \"\";\n  }\n  status() {\n    const iter = new QueuedIteratorImpl();\n    iter.iterClosed.then(() => {\n      const idx = this.listeners.indexOf(iter);\n      this.listeners.splice(idx, 1);\n    });\n    this.listeners.push(iter);\n    return iter;\n  }\n  get info() {\n    return this.protocol.isClosed() ? undefined : this.protocol.info;\n  }\n  async context() {\n    const r = await this.request(`$SYS.REQ.USER.INFO`);\n    return r.json((key, value) => {\n      if (key === \"time\") {\n        return new Date(Date.parse(value));\n      }\n      return value;\n    });\n  }\n  stats() {\n    return {\n      inBytes: this.protocol.inBytes,\n      outBytes: this.protocol.outBytes,\n      inMsgs: this.protocol.inMsgs,\n      outMsgs: this.protocol.outMsgs\n    };\n  }\n  async jetstreamManager(opts = {}) {\n    const adm = new JetStreamManagerImpl(this, opts);\n    if (opts.checkAPI !== false) {\n      try {\n        await adm.getAccountInfo();\n      } catch (err) {\n        const ne = err;\n        if (ne.code === ErrorCode.NoResponders) {\n          ne.code = ErrorCode.JetStreamNotEnabled;\n        }\n        throw ne;\n      }\n    }\n    return adm;\n  }\n  jetstream(opts = {}) {\n    return new JetStreamClientImpl(this, opts);\n  }\n  getServerVersion() {\n    const info = this.info;\n    return info ? parseSemVer(info.version) : undefined;\n  }\n  async rtt() {\n    if (!this.protocol._closed && !this.protocol.connected) {\n      throw NatsError.errorForCode(ErrorCode.Disconnect);\n    }\n    const start = Date.now();\n    await this.flush();\n    return Date.now() - start;\n  }\n  get features() {\n    return this.protocol.features;\n  }\n  get services() {\n    if (!this._services) {\n      this._services = new ServicesFactory(this);\n    }\n    return this._services;\n  }\n  reconnect() {\n    if (this.isClosed()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n    }\n    if (this.isDraining()) {\n      return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionDraining));\n    }\n    return this.protocol.reconnect();\n  }\n}\nclass ServicesFactory {\n  nc;\n  constructor(nc) {\n    this.nc = nc;\n  }\n  add(config) {\n    try {\n      const s = new ServiceImpl(this.nc, config);\n      return s.start();\n    } catch (err) {\n      return Promise.reject(err);\n    }\n  }\n  client(opts, prefix) {\n    return new ServiceClientImpl(this.nc, opts, prefix);\n  }\n}\nclass KvStoredEntryImpl {\n  bucket;\n  sm;\n  prefixLen;\n  constructor(bucket, prefixLen, sm) {\n    this.bucket = bucket;\n    this.prefixLen = prefixLen;\n    this.sm = sm;\n  }\n  get key() {\n    return this.sm.subject.substring(this.prefixLen);\n  }\n  get value() {\n    return this.sm.data;\n  }\n  get delta() {\n    return 0;\n  }\n  get created() {\n    return this.sm.time;\n  }\n  get revision() {\n    return this.sm.seq;\n  }\n  get operation() {\n    return this.sm.header.get(kvOperationHdr) || \"PUT\";\n  }\n  get length() {\n    const slen = this.sm.header.get(JsHeaders.MessageSizeHdr) || \"\";\n    if (slen !== \"\") {\n      return parseInt(slen, 10);\n    }\n    return this.sm.data.length;\n  }\n  json() {\n    return this.sm.json();\n  }\n  string() {\n    return this.sm.string();\n  }\n}\nclass KvJsMsgEntryImpl {\n  bucket;\n  key;\n  sm;\n  constructor(bucket, key, sm) {\n    this.bucket = bucket;\n    this.key = key;\n    this.sm = sm;\n  }\n  get value() {\n    return this.sm.data;\n  }\n  get created() {\n    return new Date(millis(this.sm.info.timestampNanos));\n  }\n  get revision() {\n    return this.sm.seq;\n  }\n  get operation() {\n    return this.sm.headers?.get(kvOperationHdr) || \"PUT\";\n  }\n  get delta() {\n    return this.sm.info.pending;\n  }\n  get length() {\n    const slen = this.sm.headers?.get(JsHeaders.MessageSizeHdr) || \"\";\n    if (slen !== \"\") {\n      return parseInt(slen, 10);\n    }\n    return this.sm.data.length;\n  }\n  json() {\n    return this.sm.json();\n  }\n  string() {\n    return this.sm.string();\n  }\n}\nclass JetStreamSubscriptionImpl extends TypedSubscription {\n  js;\n  monitor;\n  constructor(js, subject, opts) {\n    super(js.nc, subject, opts);\n    this.js = js;\n    this.monitor = null;\n    this.sub.closed.then(() => {\n      if (this.monitor) {\n        this.monitor.cancel();\n      }\n    });\n  }\n  set info(info) {\n    this.sub.info = info;\n  }\n  get info() {\n    return this.sub.info;\n  }\n  _resetOrderedConsumer(sseq) {\n    if (this.info === null || this.sub.isClosed()) {\n      return;\n    }\n    const newDeliver = createInbox(this.js.nc.options.inboxPrefix);\n    const nci = this.js.nc;\n    nci._resub(this.sub, newDeliver);\n    const info = this.info;\n    info.config.name = nuid.next();\n    info.ordered_consumer_sequence.delivery_seq = 0;\n    info.flow_control.heartbeat_count = 0;\n    info.flow_control.fc_count = 0;\n    info.flow_control.consumer_restarts++;\n    info.deliver = newDeliver;\n    info.config.deliver_subject = newDeliver;\n    info.config.deliver_policy = DeliverPolicy.StartSequence;\n    info.config.opt_start_seq = sseq;\n    const req = {};\n    req.stream_name = this.info.stream;\n    req.config = info.config;\n    const subj = `${info.api.prefix}.CONSUMER.CREATE.${info.stream}`;\n    this.js._request(subj, req, {\n      retries: -1\n    }).then(v => {\n      const ci = v;\n      const jinfo = this.sub.info;\n      jinfo.last = ci;\n      this.info.config = ci.config;\n      this.info.name = ci.name;\n    }).catch(err => {\n      const nerr = new NatsError(`unable to recreate ordered consumer ${info.stream} at seq ${sseq}`, ErrorCode.RequestError, err);\n      this.sub.callback(nerr, {});\n    });\n  }\n  _maybeSetupHbMonitoring() {\n    const ns = this.info?.config?.idle_heartbeat || 0;\n    if (ns) {\n      this._setupHbMonitoring(millis(ns));\n    }\n  }\n  _setupHbMonitoring(millis, cancelAfter = 0) {\n    const opts = {\n      cancelAfter: 0,\n      maxOut: 2\n    };\n    if (cancelAfter) {\n      opts.cancelAfter = cancelAfter;\n    }\n    const sub = this.sub;\n    const handler = v => {\n      const msg = newJsErrorMsg(409, `${Js409Errors.IdleHeartbeatMissed}: ${v}`, this.sub.subject);\n      const ordered = this.info?.ordered;\n      if (!ordered) {\n        this.sub.callback(null, msg);\n      } else {\n        if (!this.js.nc.protocol.connected) {\n          return false;\n        }\n        const seq = this.info?.ordered_consumer_sequence?.stream_seq || 0;\n        this._resetOrderedConsumer(seq + 1);\n        this.monitor?.restart();\n        return false;\n      }\n      return !sub.noIterator;\n    };\n    this.monitor = new IdleHeartbeatMonitor(millis, handler, opts);\n  }\n  _checkHbOrderConsumer(msg) {\n    const rm = msg.headers.get(JsHeaders.ConsumerStalledHdr);\n    if (rm !== \"\") {\n      const nci = this.js.nc;\n      nci.publish(rm);\n    }\n    const lastDelivered = parseInt(msg.headers.get(JsHeaders.LastConsumerSeqHdr), 10);\n    const ordered = this.info.ordered_consumer_sequence;\n    this.info.flow_control.heartbeat_count++;\n    if (lastDelivered !== ordered.delivery_seq) {\n      this._resetOrderedConsumer(ordered.stream_seq + 1);\n    }\n    return false;\n  }\n  _checkOrderedConsumer(jm) {\n    const ordered = this.info.ordered_consumer_sequence;\n    const sseq = jm.info.streamSequence;\n    const dseq = jm.info.deliverySequence;\n    if (dseq != ordered.delivery_seq + 1) {\n      this._resetOrderedConsumer(ordered.stream_seq + 1);\n      return false;\n    }\n    ordered.delivery_seq = dseq;\n    ordered.stream_seq = sseq;\n    return true;\n  }\n  async destroy() {\n    if (!this.isClosed()) {\n      await this.drain();\n    }\n    const jinfo = this.sub.info;\n    const name = jinfo.config.durable_name || jinfo.name;\n    const subj = `${jinfo.api.prefix}.CONSUMER.DELETE.${jinfo.stream}.${name}`;\n    await jinfo.api._request(subj);\n  }\n  async consumerInfo() {\n    const jinfo = this.sub.info;\n    const name = jinfo.config.durable_name || jinfo.name;\n    const subj = `${jinfo.api.prefix}.CONSUMER.INFO.${jinfo.stream}.${name}`;\n    const ci = await jinfo.api._request(subj);\n    jinfo.last = ci;\n    return ci;\n  }\n}\nclass JetStreamPullSubscriptionImpl extends JetStreamSubscriptionImpl {\n  constructor(js, subject, opts) {\n    super(js, subject, opts);\n  }\n  pull(opts = {\n    batch: 1\n  }) {\n    const {\n      stream,\n      config,\n      name\n    } = this.sub.info;\n    const consumer = config.durable_name ?? name;\n    const args = {};\n    args.batch = opts.batch || 1;\n    args.no_wait = opts.no_wait || false;\n    if ((opts.max_bytes ?? 0) > 0) {\n      const fv = this.js.nc.features.get(Feature.JS_PULL_MAX_BYTES);\n      if (!fv.ok) {\n        throw new Error(`max_bytes is only supported on servers ${fv.min} or better`);\n      }\n      args.max_bytes = opts.max_bytes;\n    }\n    let expires = 0;\n    if (opts.expires && opts.expires > 0) {\n      expires = opts.expires;\n      args.expires = nanos(expires);\n    }\n    let hb = 0;\n    if (opts.idle_heartbeat && opts.idle_heartbeat > 0) {\n      hb = opts.idle_heartbeat;\n      args.idle_heartbeat = nanos(hb);\n    }\n    if (hb && expires === 0) {\n      throw new Error(\"idle_heartbeat requires expires\");\n    }\n    if (hb > expires) {\n      throw new Error(\"expires must be greater than idle_heartbeat\");\n    }\n    if (this.info) {\n      if (this.monitor) {\n        this.monitor.cancel();\n      }\n      if (expires && hb) {\n        if (!this.monitor) {\n          this._setupHbMonitoring(hb, expires);\n        } else {\n          this.monitor._change(hb, expires);\n        }\n      }\n      const api = this.info.api;\n      const subj = `${api.prefix}.CONSUMER.MSG.NEXT.${stream}.${consumer}`;\n      const reply = this.sub.subject;\n      api.nc.publish(subj, api.jc.encode(args), {\n        reply: reply\n      });\n    }\n  }\n}\nfunction msgAdapter(iterator, ackTimeout) {\n  if (iterator) {\n    return iterMsgAdapter(ackTimeout);\n  } else {\n    return cbMsgAdapter(ackTimeout);\n  }\n}\nfunction cbMsgAdapter(ackTimeout) {\n  return (err, msg) => {\n    if (err) {\n      return [err, null];\n    }\n    err = checkJsError(msg);\n    if (err) {\n      return [err, null];\n    }\n    return [null, toJsMsg(msg, ackTimeout)];\n  };\n}\nfunction iterMsgAdapter(ackTimeout) {\n  return (err, msg) => {\n    if (err) {\n      return [err, null];\n    }\n    const ne = checkJsError(msg);\n    if (ne !== null) {\n      return [hideNonTerminalJsErrors(ne), null];\n    }\n    return [null, toJsMsg(msg, ackTimeout)];\n  };\n}\nfunction hideNonTerminalJsErrors(ne) {\n  if (ne !== null) {\n    switch (ne.code) {\n      case ErrorCode.JetStream404NoMessages:\n      case ErrorCode.JetStream408RequestTimeout:\n        return null;\n      case ErrorCode.JetStream409:\n        if (isTerminal409(ne)) {\n          return ne;\n        }\n        return null;\n      default:\n        return ne;\n    }\n  }\n  return null;\n}\nfunction autoAckJsMsg(data) {\n  if (data) {\n    data.ack();\n  }\n}\nfunction parseInfo(s) {\n  const tokens = s.split(\".\");\n  if (tokens.length === 9) {\n    tokens.splice(2, 0, \"_\", \"\");\n  }\n  if (tokens.length < 11 || tokens[0] !== \"$JS\" || tokens[1] !== \"ACK\") {\n    throw new Error(`not js message`);\n  }\n  const di = {};\n  di.domain = tokens[2] === \"_\" ? \"\" : tokens[2];\n  di.account_hash = tokens[3];\n  di.stream = tokens[4];\n  di.consumer = tokens[5];\n  di.deliveryCount = parseInt(tokens[6], 10);\n  di.redeliveryCount = di.deliveryCount;\n  di.redelivered = di.deliveryCount > 1;\n  di.streamSequence = parseInt(tokens[7], 10);\n  di.deliverySequence = parseInt(tokens[8], 10);\n  di.timestampNanos = parseInt(tokens[9], 10);\n  di.pending = parseInt(tokens[10], 10);\n  return di;\n}\nclass JsMsgImpl {\n  msg;\n  di;\n  didAck;\n  timeout;\n  constructor(msg, timeout) {\n    this.msg = msg;\n    this.didAck = false;\n    this.timeout = timeout;\n  }\n  get subject() {\n    return this.msg.subject;\n  }\n  get sid() {\n    return this.msg.sid;\n  }\n  get data() {\n    return this.msg.data;\n  }\n  get headers() {\n    return this.msg.headers;\n  }\n  get info() {\n    if (!this.di) {\n      this.di = parseInfo(this.reply);\n    }\n    return this.di;\n  }\n  get redelivered() {\n    return this.info.deliveryCount > 1;\n  }\n  get reply() {\n    return this.msg.reply || \"\";\n  }\n  get seq() {\n    return this.info.streamSequence;\n  }\n  doAck(payload) {\n    if (!this.didAck) {\n      this.didAck = !this.isWIP(payload);\n      this.msg.respond(payload);\n    }\n  }\n  isWIP(p) {\n    return p.length === 4 && p[0] === WPI[0] && p[1] === WPI[1] && p[2] === WPI[2] && p[3] === WPI[3];\n  }\n  async ackAck(opts) {\n    opts = opts || {};\n    opts.timeout = opts.timeout || this.timeout;\n    const d = deferred();\n    if (!this.didAck) {\n      this.didAck = true;\n      if (this.msg.reply) {\n        const mi = this.msg;\n        const proto = mi.publisher;\n        const trace = !(proto.options?.noAsyncTraces || false);\n        const r = new RequestOne(proto.muxSubscriptions, this.msg.reply, {\n          timeout: opts.timeout\n        }, trace);\n        proto.request(r);\n        try {\n          proto.publish(this.msg.reply, ACK, {\n            reply: `${proto.muxSubscriptions.baseInbox}${r.token}`\n          });\n        } catch (err) {\n          r.cancel(err);\n        }\n        try {\n          await Promise.race([r.timer, r.deferred]);\n          d.resolve(true);\n        } catch (err) {\n          r.cancel(err);\n          d.reject(err);\n        }\n      } else {\n        d.resolve(false);\n      }\n    } else {\n      d.resolve(false);\n    }\n    return d;\n  }\n  ack() {\n    this.doAck(ACK);\n  }\n  nak(millis) {\n    let payload = NAK;\n    if (millis) {\n      payload = StringCodec().encode(`-NAK ${JSON.stringify({\n        delay: nanos(millis)\n      })}`);\n    }\n    this.doAck(payload);\n  }\n  working() {\n    this.doAck(WPI);\n  }\n  next(subj, opts = {\n    batch: 1\n  }) {\n    const args = {};\n    args.batch = opts.batch || 1;\n    args.no_wait = opts.no_wait || false;\n    if (opts.expires && opts.expires > 0) {\n      args.expires = nanos(opts.expires);\n    }\n    const data = JSONCodec().encode(args);\n    const payload = DataBuffer.concat(NXT, SPACE, data);\n    const reqOpts = subj ? {\n      reply: subj\n    } : undefined;\n    this.msg.respond(payload, reqOpts);\n  }\n  term(reason = \"\") {\n    let term = TERM;\n    if (reason?.length > 0) {\n      term = StringCodec().encode(`+TERM ${reason}`);\n    }\n    this.doAck(term);\n  }\n  json() {\n    return this.msg.json();\n  }\n  string() {\n    return this.msg.string();\n  }\n}\nexport { checkJsError, isFlowControlMsg, isHeartbeatMsg };\nexport { AckPolicy, AdvisoryKind, ConsumerDebugEvents, ConsumerEvents, DeliverPolicy, DirectMsgHeaders, DiscardPolicy, JsHeaders, KvWatchInclude, ReplayPolicy, RepublishHeaders, RetentionPolicy, StorageType, StoreCompression };\nexport { consumerOpts };\nconst VERSION = \"1.30.0\";\nconst LANG = \"nats.ws\";\nclass WsTransport {\n  version;\n  lang;\n  closeError;\n  connected;\n  done;\n  socket;\n  options;\n  socketClosed;\n  encrypted;\n  peeked;\n  yields;\n  signal;\n  closedNotification;\n  constructor() {\n    this.version = VERSION;\n    this.lang = LANG;\n    this.connected = false;\n    this.done = false;\n    this.socketClosed = false;\n    this.encrypted = false;\n    this.peeked = false;\n    this.yields = [];\n    this.signal = deferred();\n    this.closedNotification = deferred();\n  }\n  async connect(server, options) {\n    const connected = false;\n    const connLock = deferred();\n    if (options.tls) {\n      connLock.reject(new NatsError(\"tls\", ErrorCode.InvalidOption));\n      return connLock;\n    }\n    this.options = options;\n    const u = server.src;\n    if (options.wsFactory) {\n      const {\n        socket,\n        encrypted\n      } = await options.wsFactory(server.src, options);\n      this.socket = socket;\n      this.encrypted = encrypted;\n    } else {\n      this.encrypted = u.indexOf(\"wss://\") === 0;\n      this.socket = new WebSocket(u);\n    }\n    this.socket.binaryType = \"arraybuffer\";\n    this.socket.onopen = () => {\n      if (this.isDiscarded()) {\n        return;\n      }\n    };\n    this.socket.onmessage = me => {\n      if (this.isDiscarded()) {\n        return;\n      }\n      this.yields.push(new Uint8Array(me.data));\n      if (this.peeked) {\n        this.signal.resolve();\n        return;\n      }\n      const t = DataBuffer.concat(...this.yields);\n      const pm = extractProtocolMessage(t);\n      if (pm !== \"\") {\n        const m = INFO.exec(pm);\n        if (!m) {\n          if (options.debug) {\n            console.error(\"!!!\", render(t));\n          }\n          connLock.reject(new Error(\"unexpected response from server\"));\n          return;\n        }\n        try {\n          const info = JSON.parse(m[1]);\n          checkOptions(info, this.options);\n          this.peeked = true;\n          this.connected = true;\n          this.signal.resolve();\n          connLock.resolve();\n        } catch (err) {\n          connLock.reject(err);\n          return;\n        }\n      }\n    };\n    this.socket.onclose = evt => {\n      if (this.isDiscarded()) {\n        return;\n      }\n      this.socketClosed = true;\n      let reason;\n      if (this.done) return;\n      if (!evt.wasClean) {\n        reason = new Error(evt.reason);\n      }\n      this._closed(reason);\n    };\n    this.socket.onerror = e => {\n      if (this.isDiscarded()) {\n        return;\n      }\n      const evt = e;\n      const err = new NatsError(evt.message, ErrorCode.Unknown, new Error(evt.error));\n      if (!connected) {\n        connLock.reject(err);\n      } else {\n        this._closed(err);\n      }\n    };\n    return connLock;\n  }\n  disconnect() {\n    this._closed(undefined, true);\n  }\n  async _closed(err, internal = true) {\n    if (this.isDiscarded()) {\n      return;\n    }\n    if (!this.connected) return;\n    if (this.done) return;\n    this.closeError = err;\n    if (!err) {\n      while (!this.socketClosed && this.socket.bufferedAmount > 0) {\n        await delay(100);\n      }\n    }\n    this.done = true;\n    try {\n      this.socket.close(err ? 1002 : 1000, err ? err.message : undefined);\n    } catch (err) {}\n    if (internal) {\n      this.closedNotification.resolve(err);\n    }\n  }\n  get isClosed() {\n    return this.done;\n  }\n  [Symbol.asyncIterator]() {\n    return this.iterate();\n  }\n  async *iterate() {\n    while (true) {\n      if (this.isDiscarded()) {\n        return;\n      }\n      if (this.yields.length === 0) {\n        await this.signal;\n      }\n      const yields = this.yields;\n      this.yields = [];\n      for (let i = 0; i < yields.length; i++) {\n        if (this.options.debug) {\n          console.info(`> ${render(yields[i])}`);\n        }\n        yield yields[i];\n      }\n      if (this.done) {\n        break;\n      } else if (this.yields.length === 0) {\n        yields.length = 0;\n        this.yields = yields;\n        this.signal = deferred();\n      }\n    }\n  }\n  isEncrypted() {\n    return this.connected && this.encrypted;\n  }\n  send(frame) {\n    if (this.isDiscarded()) {\n      return;\n    }\n    try {\n      this.socket.send(frame.buffer);\n      if (this.options.debug) {\n        console.info(`< ${render(frame)}`);\n      }\n      return;\n    } catch (err) {\n      if (this.options.debug) {\n        console.error(`!!! ${render(frame)}: ${err}`);\n      }\n    }\n  }\n  close(err) {\n    return this._closed(err, false);\n  }\n  closed() {\n    return this.closedNotification;\n  }\n  isDiscarded() {\n    if (this.done) {\n      this.discard();\n      return true;\n    }\n    return false;\n  }\n  discard() {\n    this.done = true;\n    try {\n      this.socket?.close();\n    } catch (_err) {}\n  }\n}\nfunction wsUrlParseFn(u, encrypted) {\n  const ut = /^(.*:\\/\\/)(.*)/;\n  if (!ut.test(u)) {\n    if (typeof encrypted === \"boolean\") {\n      u = `${encrypted === true ? \"https\" : \"http\"}://${u}`;\n    } else {\n      u = `https://${u}`;\n    }\n  }\n  let url = new URL(u);\n  const srcProto = url.protocol.toLowerCase();\n  if (srcProto === \"ws:\") {\n    encrypted = false;\n  }\n  if (srcProto === \"wss:\") {\n    encrypted = true;\n  }\n  if (srcProto !== \"https:\" && srcProto !== \"http\") {\n    u = u.replace(/^(.*:\\/\\/)(.*)/gm, \"$2\");\n    url = new URL(`http://${u}`);\n  }\n  let protocol;\n  let port;\n  const host = url.hostname;\n  const path = url.pathname;\n  const search = url.search || \"\";\n  switch (srcProto) {\n    case \"http:\":\n    case \"ws:\":\n    case \"nats:\":\n      port = url.port || \"80\";\n      protocol = \"ws:\";\n      break;\n    case \"https:\":\n    case \"wss:\":\n    case \"tls:\":\n      port = url.port || \"443\";\n      protocol = \"wss:\";\n      break;\n    default:\n      port = url.port || encrypted === true ? \"443\" : \"80\";\n      protocol = encrypted === true ? \"wss:\" : \"ws:\";\n      break;\n  }\n  return `${protocol}//${host}:${port}${path}${search}`;\n}\nfunction connect(opts = {}) {\n  setTransportFactory({\n    defaultPort: 443,\n    urlParseFn: wsUrlParseFn,\n    factory: () => {\n      return new WsTransport();\n    }\n  });\n  return NatsConnectionImpl.connect(opts);\n}\nexport { connect };","map":{"version":3,"names":["Empty","Uint8Array","TE","TextEncoder","TD","TextDecoder","concat","bufs","max","i","length","out","index","set","encode","a","push","decode","digits","base","maxSeq","minInc","maxInc","totalLen","_getRandomValues","Math","floor","random","fillRandom","globalThis","crypto","getRandomValues","Nuid","buf","seq","inc","inited","constructor","init","setPre","initSeqAndInc","fillSeq","cbuf","di","charCodeAt","n","next","String","fromCharCode","apply","reset","nuid","Events","DebugEvents","ErrorCode","isNatsError","err","code","Messages","messages","Map","InvalidPayload","BadJson","WssRequired","getMessage","s","get","NatsError","Error","name","message","permissionContext","chainedError","api_error","errorForCode","m","isAuthError","AuthenticationExpired","AuthorizationViolation","AccountExpired","isAuthTimeout","AuthenticationTimeout","isPermissionError","PermissionsViolation","isProtocolError","ProtocolError","isJetStreamError","undefined","jsError","Match","RequestStrategy","syncIterator","src","iter","Symbol","asyncIterator","done","Promise","resolve","value","ServiceResponseType","ServiceErrorHeader","ServiceErrorCodeHeader","ServiceError","isServiceError","msg","toServiceError","scode","headers","parseInt","description","createInbox","prefix","split","forEach","v","DEFAULT_HOST","ServiceVerb","extend","b","o","Object","keys","k","render","frame","cr","lf","replace","timeout","ms","asyncTraces","Timeout","methods","timer","p","_resolve","reject","cancel","clearTimeout","setTimeout","assign","delay","deadline","millis","d","deferred","race","finally","shuffle","j","Perf","timers","measures","mark","key","performance","now","measure","startKey","endKey","e","getEntries","values","duration","jitter","backoff","policy","Array","isArray","attempt","nanos","ns","canonicalMIMEHeaderKey","dash","toLower","upper","c","BadHeader","MsgHdrsImpl","HEADER","_code","_description","iterator","entries","size","equals","mh","vv","sort","aa","lines","h","str","trim","isNaN","toString","slice","map","idx","indexOf","append","validHeaderValue","inv","test","sk","findKeys","match","Exact","filter","CanonicalMIME","lci","toLowerCase","last","has","delete","ck","hasError","status","toRecord","data","fromRecord","r","StringCodec","JSONCodec","reviver","JSON","stringify","parse","isRequestError","NoResponders","MsgImpl","_headers","_msg","_rdata","_reply","_subject","publisher","jc","subject","reply","sid","hdr","subarray","respond","opts","publish","subj","payloadAndHeaders","json","string","requestInfo","Date","validateDurableName","minValidation","validateStreamName","context","bad","validateName","validName","RE","mm","isFlowControlMsg","isHeartbeatMsg","newJsErrorMsg","arg","checkJsError","checkJsErrorCode","Js409Errors","MAX_WAITING_FAIL","isTerminal409","JetStream409","fatal","MaxBatchExceeded","MaxExpiresExceeded","MaxBytesExceeded","MaxMessageSizeExceeded","PushConsumer","IdleHeartbeatMissed","ConsumerDeleted","MaxWaitingExceeded","find","JetStream404NoMessages","JetStream408RequestTimeout","ec","startsWith","JetStreamIdleHeartBeat","JetStreamNotEnabled","Unknown","QueuedIteratorImpl","inflight","processed","received","noIterator","iterClosed","signal","yields","filtered","pendingFiltered","ingestionFilterFn","protocolFilterFn","dispatchedFn","ctx","_data","time","yielding","iterate","ingest","protocol","ApiError","fn","ok","start","stop","getProcessed","getPending","getReceived","IdleHeartbeatMonitor","interval","maxOut","cancelAfter","autoCancelTimer","missed","count","callback","cb","_schedule","clearInterval","work","_change","restart","setInterval","console","log","RetentionPolicy","DiscardPolicy","StorageType","DeliverPolicy","AckPolicy","ReplayPolicy","StoreCompression","ConsumerApiAction","defaultConsumer","deliver_policy","All","ack_policy","Explicit","ack_wait","replay_policy","Instant","AdvisoryKind","JsHeaders","KvWatchInclude","DirectMsgHeaders","RepublishHeaders","kvPrefix","ConsumerOptsBuilderImpl","config","ordered","mack","stream","callbackFn","qname","isBind","filters","getOpts","filter_subject","filterSubject","filter_subjects","queue","None","deliverTo","deliver_subject","durable","durable_name","startSequence","StartSequence","opt_start_seq","startTime","StartTime","opt_start_time","toISOString","deliverAll","deliverLastPerSubject","LastPerSubject","deliverLast","Last","deliverNew","New","startAtTimeDelta","headersOnly","headers_only","ackNone","ackAll","ackExplicit","ackWait","maxDeliver","max_deliver","replayInstantly","replayOriginal","Original","sample","trunc","sample_freq","limit","rate_limit_bps","maxWaiting","max_waiting","maxAckPending","max_ack_pending","idleHeartbeat","idle_heartbeat","flowControl","flow_control","deliverGroup","manualAck","maxMessages","deliver_group","orderedConsumer","bind","bindStream","inactiveEphemeralThreshold","inactive_threshold","maxPullBatch","max_batch","maxPullRequestExpires","max_expires","memory","mem_storage","numReplicas","num_replicas","consumerName","consumerOpts","isConsumerOptsBuilder","Base64Codec","bytes","btoa","from","binary","bin","atob","Base64UrlPaddedCodec","toB64URLEncoding","fromB64URLEncoding","b64str","DataBuffer","buffers","byteLength","fromAscii","toAscii","pack","shift","drain","pop","fill","peek","getLengths","b64","len","validLen","placeHoldersLen","lookup","revLookup","urlsafe","_byteLength","tripletToBase64","num","encodeChunk","end","curTriplet","join","toUint8Array","tmp","curByte","fromUint8Array","maxChunkLength","extraBytes","len2","parts","ceil","curChunk","chunkEnd","l","decoder","encoder","toHexString","reduce","hex","__byte","fromHexString","TypeError","substr","decode1","encoding","encode1","SHA256","hashSize","_buf","_bufIdx","_count","_K","_H","_finalized","Uint32Array","update","inputEncoding","_transform","digest","outputEncoding","hash","h0","h1","h2","h3","h4","h5","h6","h7","w","BaseRequest","token","requestSubject","mux","RequestMany","maxWait","then","resolver","stack","strategy","Count","JitterTimer","SentinelMsg","RequestOne","Cancelled","defaultPrefix","defaultJsOptions","domain","apiPrefix","BaseApiClient","nc","_parseOpts","getOptions","_request","retries","Number","MAX_SAFE_INTEGER","bo","request","parseJsResponse","ne","findStream","q","names","streams","getConnection","error","ListerImpl","offset","pageInfo","jsm","payload","total","countResponse","type","consumers","page","item","parseSemVer","major","minor","micro","compare","Feature","Features","server","features","disabled","resetDisabled","disable","f","isDisabled","JS_KV","JS_OBJECTSTORE","JS_PULL_MAX_BYTES","JS_NEW_CONSUMER_CREATE_API","JS_ALLOW_DIRECT","JS_MULTIPLE_CONSUMER_FILTER","JS_SIMPLIFICATION","JS_STREAM_CONSUMER_METADATA","JS_CONSUMER_FILTER_SUBJECTS","JS_STREAM_FIRST_SEQ","JS_STREAM_SUBJECT_TRANSFORM","JS_STREAM_SOURCE_SUBJECT_TRANSFORM","JS_STREAM_COMPRESSION","JS_DEFAULT_CONSUMER_LIMITS","JS_BATCH_DIRECT_GET","requires","min","supports","require","ConsumerAPIImpl","add","cfg","action","Create","stream_name","nci","newAPI","substring","metadata","fs","ci","info","changable","Update","success","list","clr","pause","until","pause_until","resume","checkFn","required","TypedSubscription","sub","adapter","subIterDone","cleanupFn","uh","jer","tm","sopts","subscribe","unsubscribe","all","closed","catch","isDraining","isClosed","cancelTimeout","getSubject","getID","getMax","transportConfig","setTransportFactory","defaultPort","getUrlParseFn","urlParseFn","newTransport","factory","getResolveFn","dnsResolveFn","CR_LF","CRLF","CR","LF","protoLen","ba","extractProtocolMessage","IPv4LEN","ASCII0","ASCIIA","ASCIIa","ipV4","ip","isIP","parseIP","parseIPv4","parseIPv6","dtoi","ellipsis","xtoi","ip4","isIPV4OrHostname","hp","isIPV6","filterIpv6MappedToIpv4","toUpperCase","hostPort","u","op","port","url","URL","hostname","charAt","listen","host","ServerImpl","didConnect","reconnects","lastConnect","gossiped","tlsName","resolves","ips","debug","proto","ss","randomize","Servers","firstSelect","servers","currentServer","listens","addServer","clear","updateTLSName","cs","getCurrentServer","implicit","selectServer","t","removeCurrentServer","removeServer","splice","getServers","encrypted","added","deleted","discovered","connect_urls","toDelete","reverse","removed","MuxSubscription","baseInbox","reqs","getToken","handleError","isMuxPermissionError","operation","req","dispatcher","close","Heartbeat","ph","pendings","stale","_reset","disconnect","dispatchStatus","PingTimer","ping","flush","AssertionError","assert","cond","MIN_READ","MAX_SIZE","copy","dst","off","DenoBuffer","_off","ab","options","empty","capacity","buffer","truncate","_reslice","_tryGrowByReslice","readByte","read","nread","writeByte","write","of","writeString","_grow","grow","readFrom","shouldGrow","Kind","newMsgArg","ma","ASCII_0","Parser","state","as","drop","argBuf","msgBuf","State","OP_START","cc","M","OP_M","H","OP_H","P","OP_P","PLUS","OP_PLUS","MINUS","OP_MINUS","I","OP_I","fail","S","OP_MS","G","g","OP_MSG","SPACE","TAB","OP_MSG_SPC","MSG_ARG","NL","processMsgArgs","MSG_PAYLOAD","kind","MSG","MSG_END","toCopy","avail","O","OP_PLUS_O","K","OP_PLUS_OK","OK","E","OP_MINUS_E","R","OP_MINUS_ER","OP_MINUS_ERR","OP_MINUS_ERR_SPC","MINUS_ERR_ARG","ERR","OP_PI","OP_PO","N","OP_PON","OP_PONG","PONG","OP_PIN","OP_PING","PING","OP_IN","F","OP_INF","OP_INFO","OP_INFO_SPC","INFO_ARG","INFO","cloneMsgArg","processHeaderMsgArgs","args","protoParseInt","label","nacl","u64","hi","lo","gf","Float64Array","randombytes","_0","_9","gf0","gf1","_121665","D","D2","X","Y","L32","x","ld32","dl64","st32","ts64","vn","xi","y","yi","crypto_verify_16","crypto_verify_32","core","inp","crypto_core_salsa20","crypto_core_hsalsa20","sigma","crypto_stream_salsa20_xor","cpos","mpos","z","crypto_stream_salsa20","crypto_stream","crypto_stream_xor","add1305","minusp","crypto_onetimeauth","outpos","crypto_onetimeauth_verify","hpos","crypto_secretbox","crypto_secretbox_open","set25519","car25519","sel25519","pack25519","neq25519","par25519","unpack25519","A","Z","inv25519","pow2523","crypto_scalarmult","x32","x16","crypto_scalarmult_base","crypto_box_keypair","crypto_box_beforenm","crypto_box_afternm","crypto_box_open_afternm","crypto_box","crypto_box_open","add64","m16","arguments","shr64","xor64","c1","Ch","Maj","Sigma0","Sigma1","sigma0","sigma1","crypto_hashblocks","pos","iv","crypto_hash","cswap","tx","ty","zi","scalarmult","scalarbase","crypto_sign_keypair","pk","seeded","L","modL","carry","crypto_sign","sm","smlen","unpackneg","chk","den","den2","den4","den6","crypto_sign_open","crypto_secretbox_KEYBYTES","crypto_secretbox_NONCEBYTES","crypto_secretbox_ZEROBYTES","crypto_secretbox_BOXZEROBYTES","crypto_scalarmult_BYTES","crypto_scalarmult_SCALARBYTES","crypto_box_PUBLICKEYBYTES","crypto_box_SECRETKEYBYTES","crypto_box_BEFORENMBYTES","crypto_box_NONCEBYTES","crypto_box_ZEROBYTES","crypto_box_BOXZEROBYTES","crypto_sign_BYTES","crypto_sign_PUBLICKEYBYTES","crypto_sign_SECRETKEYBYTES","crypto_sign_SEEDBYTES","crypto_hash_BYTES","lowlevel","checkLengths","checkBoxLengths","checkArrayTypes","cleanup","arr","randomBytes","secretbox","nonce","open","box","keyLength","nonceLength","overheadLength","scalarMult","scalarLength","groupElementLength","publicKey","secretKey","before","after","keyPair","fromSecretKey","publicKeyLength","secretKeyLength","sharedKeyLength","sign","signedMsg","mlen","detached","sig","verify","fromSeed","seed","seedLength","signatureLength","hashLength","setPRNG","crypto1","msCrypto","QUOTA","module","exports","denoHelper","helper","setEd25519Helper","lib","getEd25519Helper","crc16tab","Uint16Array","crc16","checksum","crc","validate","expected","b32Alphabet","base32","bits","NKeysError","createOperator","createPair","Prefix","Operator","createAccount","Account","createUser","User","NKeysErrorCode","Prefixes","isValidPublicPrefix","Server","Cluster","startsWithValidPrefix","isValidPrefix","parsePrefix","Seed","Private","Codec","SerializationError","InvalidPrefixByte","_encode","encodeSeed","role","InvalidSeedLen","raw","_decode","decodeSeed","_decodePrefix","InvalidSeed","payloadOffset","payloadLen","cap","checkOffset","encodedPrefix","_encodePrefix","dv","DataView","setUint16","InvalidEncoding","ex","getUint16","InvalidChecksum","b1","b2","KP","getRawSeed","ClearedPair","sd","getSeed","getPublicKey","kp","getPrivateKey","input","rawSeed","PublicKey","PublicKeyOnly","_","CannotSign","fromPublic","InvalidPublicKey","encode2","decode2","mod","multiAuthenticator","authenticators","auth","noAuthFn","usernamePasswordAuthenticator","user","pass","tokenAuthenticator","auth_token","nkeyAuthenticator","nkey","challenge","sigBytes","jwtAuthenticator","ajwt","jwt","credsAuthenticator","creds","CREDS","exec","BadCreds","jwtFn","nkeyFn","DEFAULT_PING_INTERVAL","DEFAULT_MAX_PING_OUT","DEFAULT_RECONNECT_TIME_WAIT","defaultOptions","maxPingOut","maxReconnectAttempts","noRandomize","pedantic","pingInterval","reconnect","reconnectJitter","reconnectJitterTLS","reconnectTimeWait","tls","verbose","waitOnFirstConnect","ignoreAuthErrorAbort","buildAuthenticator","authenticator","parseOptions","dhp","InvalidOption","NotFunction","reconnectDelayHandler","extra","inboxPrefix","checkOptions","tls_required","tlsRequired","tls_available","tlsAvailable","noEcho","ServerOptionNotAvailable","FLUSH_THRESHOLD","PONG_CMD","PING_CMD","Connect","echo","no_responders","lang","version","transport","SubscriptionImpl","draining","drained","noAsyncTraces","setPrePostHandlers","uc","ingestion","dispatched","_err","ConnectionClosed","SubClosed","unsub","subscriptions","Subscriptions","subs","sidCounter","setMux","getMux","resub","ProtocolHandler","connected","connectedOnce","infoReceived","muxSubscriptions","outbound","pongs","noMorePublishing","connectError","_closed","listeners","heartbeats","parser","outMsgs","inMsgs","outBytes","inBytes","pendingLimit","lastError","abortReconnect","whyClosed","connectPromise","resetOutbound","Disconnect","prepare","discard","pong","unshift","disconnected","closeError","StaleConnection","ClientInitiatedReconnect","dialLoop","Reconnect","_close","dial","srv","cp","connect","sendSubscriptions","flushPending","_doDial","alts","lastErr","Reconnecting","dodialLoop","wait","ConnectionRefused","mra","toError","qm","processMsg","processError","handleAuthError","processPing","send","processPong","processInfo","updates","ignoreClusterUpdates","isEncrypted","ldm","LDM","sendCommand","cmd","payloads","queueMicrotask","BadPayload","hlen","hdrs","max_payload","MaxPayloadExceeded","initMux","_subunsub","_sub","cmds","promises","inbox","getServer","ServiceApiPrefix","ServiceMsgImpl","respondError","ServiceGroupImpl","parent","validInternalToken","root","ServiceImpl","sg","calcSubject","addEndpoint","handler","validSubjectName","_addEndpoint","addGroup","tokens","_id","handlers","internal","_stopped","_done","started","controlSubject","verb","id","pre","subjects","errorToHeader","se","setupHandler","sv","stats","NamedEndpointStatsImpl","countError","countLatency","endpoints","queue_group","statsHandler","qi","STATS","addInternalHandler","_doAddInternalHandler","endpoint","infoHandler","pingHandler","allSettled","stopped","isStopped","average_processing_time","num_requests","processing_time","num_errors","last_error","qii","round","_stats","ServiceClientImpl","responses","requestMany","Metric","date","msgs","asyncRequests","sec","mps","minmax","humanizeNumber","toFixed","throughput","toCsv","header","Bench","callbacks","pub","rep","perf","run","runCallbacks","runAsync","processMetrics","pubsub","reqrep","metrics","jobs","job","first","_m","seconds","humanizeBytes","si","post","exp","pow","nkeys","NoopKvCodecs","defaultBucketOpts","replicas","history","max_bytes","maxValueSize","codec","storage","File","kvOperationHdr","kvSubjectPrefix","validKeyRe","validSearchKey","validBucketRe","validateKey","endsWith","validateSearchKey","hasWildcards","chunks","validateBucket","PubHeaders","Bucket","js","bucket","direct","editPrefix","useJsPrefix","_prefixLen","create","jetstreamManager","allow_direct","streamName","bucketName","initializePrefixes","sc","retention","Limits","max_msgs_per_subject","maxBucketSize","max_msg_size","location","placementCluster","placement","cluster","tags","republish","mirror","mirror_direct","sources","srcBucketName","external","subject_transforms","dest","subjectForBucket","compression","S2","have","getServerVersion","discardNew","Old","ttl","max_age","allow_rollup_hdrs","api","mb","subjectForKey","edit","builder","fullKeyName","prefixLen","encodeKey","decodeKey","ekey","dataLen","slen","MessageSizeHdr","smToEntry","KvStoredEntryImpl","jmToEntry","jm","KvJsMsgEntryImpl","firstErr","put","previousSeq","err_code","rev","revision","ek","ExpectedLastSubjectSequenceHdr","pa","last_by_subj","ke","purge","_deleteOrPurge","purgeDeletes","olderMillis","watch","initializedFn","proms","created","getTime","keep","purged","pv","cv","_doDeleteOrPurge","RollupHdr","RollupValueSubject","_buildCC","content","AllHistory","UpdatesOnly","remove","co","copts","pending","expect","num_pending","delivered","consumer_seq","canSetWatcherName","jsi","LastValue","include","ignoreDeletes","resumeFromRevision","purgeBucket","destroy","bn","KvStatusImpl","bucket_location","backingStore","streamInfo","osPrefix","digestType","objectStoreStreamName","objectStoreBucketName","ObjectStoreStatusImpl","sealed","convertStreamSourceDomain","PullConsumerType","ConsumerEvents","ConsumerDebugEvents","ACK","NAK","WPI","NXT","TERM","toJsMsg","ackTimeout","JsMsgImpl","PullConsumerMessagesImpl","consumer","monitor","refilling","cleanupHandler","statusIterator","forOrderedConsumer","resetHandler","abortOnMissingResource","requests","abort_on_missing_resource","max_messages","threshold_bytes","threshold_messages","isProtocol","msgsLeft","bytesLeft","parseDiscard","notify","Discard","DebugEvent","_push","batch","pullOptions","pull","HeartbeatsMissed","resetPending","resetPendingNoInfo","resetPendingWithInfo","notFound","streamNotFound","StreamNotFound","ConsumerNotFound","to","de","Next","expires","PendingMessagesHdr","PendingBytesHdr","trackTimeout","clearTimers","setCleanupHandler","minMsgs","minBytes","OrderedConsumerMessages","setSource","PullConsumerImpl","_info","consume","fetch","fopts","cached","OrderedPullConsumerImpl","cursor","namePrefix","serial","currentConsumer","userCallback","startSeq","maxInitialReset","stream_seq","deliver_seq","name_prefix","Unset","getConsumerOpts","filterSubjects","resetConsumer","isNew","OrderedConsumerRecreated","Fetch","internalHandler","dseq","deliverySequence","notifyOrderedResetAndReset","streamSequence","fromFetch","orderedReset","Consume","msgsImpl","Reset","tf","ConsumersImpl","notified","checkVersion","fv","getPullConsumerFor","impl","sapi","StreamAPIImpl","_si","StreamImpl","alternates","best","asi","getConsumerFromInfo","getConsumer","query","deleteMessage","erase","checkStreamConfigVersions","first_seq","subject_transform","consumer_limits","validateStreamSource","_fixInfo","trace","old","getOwnPropertyNames","infos","paged","listerFilter","slr","deny_delete","deny_purge","dr","no_erase","StoredMsgImpl","listKvs","kvStreams","listObjectStores","objStreams","sr","DirectStreamAPIImpl","qq","dm","DirectMsgImpl","getBatch","multi_last","gotFirst","badServer","badRequest","Subject","Sequence","timestamp","TimeStamp","Stream","JetStreamManagerImpl","getAccountInfo","jetstream","advisories","_header","smr","_parse","hd","bs","StreamsImpl","ObjectInfoImpl","oi","mtime","isLink","link","toServerObjectStoreMeta","meta","mhi","emptyReadableStream","ReadableStream","enqueue","ObjectStoreImpl","_checkNotEmpty","rawInfo","includeHistory","obj","_metaSubject","soi","nerr","seal","_put","rs","jsopts","previousRevision","maxPayload","maxChunk","max_chunk_size","chunkSubj","_chunkSubject","metaSubj","db","reader","getReader","sha","pad","padding","repeat","putBlob","readableStreamFrom","controller","getBlob","fromReadableStream","vs","ln","os","oc","linkStore","osi","ii","ack","initialized","_metaSubjectAll","ViewsImpl","kv","bindOnly","subtle","JetStreamClientImpl","consumerAPI","streamAPI","checkAPI","views","msgID","MsgIdHdr","lastMsgID","ExpectedLastMsgIdHdr","ExpectedStreamHdr","lastSequence","ExpectedLastSeqHdr","lastSubjectSequence","ro","retry_delay","JetStreamInvalidAck","duplicate","pullOpts","no_wait","noMux","trackBytes","receivedBytes","hb","delay_heartbeat","wants","_ingest","jsmi","hideNonTerminalJsErrors","pullSubscribe","cso","_processOptions","ackPolicy","so","_buildTypedSubscriptionOpts","JetStreamPullSubscriptionImpl","deliver","_maybeCreateConsumer","JetStreamSubscriptionImpl","_maybeSetupHbMonitoring","heartbeat_count","fc_count","consumer_restarts","ordered_consumer_sequence","delivery_seq","NotSet","attached","qn","push_bound","rqn","msgAdapter","ingestionFn","autoAckJsMsg","jsub","jmi","_checkHbOrderConsumer","_checkOrderedConsumer","NatsConnectionImpl","_services","_check","ConnectionDraining","BadSubject","publishMessage","respondMessage","_resub","Timer","rmo","errCtx","adm","rtt","services","ServicesFactory","client","delta","timestampNanos","_resetOrderedConsumer","sseq","newDeliver","jinfo","RequestError","_setupHbMonitoring","rm","ConsumerStalledHdr","lastDelivered","LastConsumerSeqHdr","consumerInfo","iterMsgAdapter","cbMsgAdapter","parseInfo","account_hash","deliveryCount","redeliveryCount","redelivered","didAck","doAck","isWIP","ackAck","mi","nak","working","reqOpts","term","reason","VERSION","LANG","WsTransport","socket","socketClosed","peeked","closedNotification","connLock","wsFactory","WebSocket","binaryType","onopen","isDiscarded","onmessage","me","pm","onclose","evt","wasClean","onerror","bufferedAmount","wsUrlParseFn","ut","srcProto","path","pathname","search"],"sources":["/Users/cihat.zoroglu/playground/nats-ws/node_modules/nats.ws/esm/nats.js"],"sourcesContent":["// deno-fmt-ignore-file\n// deno-lint-ignore-file\n// This code was bundled using `deno bundle` and it's not recommended to edit it manually\n\nconst Empty = new Uint8Array(0);\nconst TE = new TextEncoder();\nconst TD = new TextDecoder();\nfunction concat(...bufs) {\n    let max = 0;\n    for(let i = 0; i < bufs.length; i++){\n        max += bufs[i].length;\n    }\n    const out = new Uint8Array(max);\n    let index = 0;\n    for(let i = 0; i < bufs.length; i++){\n        out.set(bufs[i], index);\n        index += bufs[i].length;\n    }\n    return out;\n}\nfunction encode(...a) {\n    const bufs = [];\n    for(let i = 0; i < a.length; i++){\n        bufs.push(TE.encode(a[i]));\n    }\n    if (bufs.length === 0) {\n        return Empty;\n    }\n    if (bufs.length === 1) {\n        return bufs[0];\n    }\n    return concat(...bufs);\n}\nfunction decode(a) {\n    if (!a || a.length === 0) {\n        return \"\";\n    }\n    return TD.decode(a);\n}\n\"use strict\";\nconst digits = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nconst base = 36;\nconst maxSeq = 3656158440062976;\nconst minInc = 33;\nconst maxInc = 333;\nconst totalLen = 12 + 10;\nfunction _getRandomValues(a) {\n    for(let i = 0; i < a.length; i++){\n        a[i] = Math.floor(Math.random() * 255);\n    }\n}\nfunction fillRandom(a) {\n    if (globalThis?.crypto?.getRandomValues) {\n        globalThis.crypto.getRandomValues(a);\n    } else {\n        _getRandomValues(a);\n    }\n}\nclass Nuid {\n    buf;\n    seq;\n    inc;\n    inited;\n    constructor(){\n        this.buf = new Uint8Array(totalLen);\n        this.inited = false;\n    }\n    init() {\n        this.inited = true;\n        this.setPre();\n        this.initSeqAndInc();\n        this.fillSeq();\n    }\n    initSeqAndInc() {\n        this.seq = Math.floor(Math.random() * maxSeq);\n        this.inc = Math.floor(Math.random() * (maxInc - minInc) + minInc);\n    }\n    setPre() {\n        const cbuf = new Uint8Array(12);\n        fillRandom(cbuf);\n        for(let i = 0; i < 12; i++){\n            const di = cbuf[i] % 36;\n            this.buf[i] = digits.charCodeAt(di);\n        }\n    }\n    fillSeq() {\n        let n = this.seq;\n        for(let i = totalLen - 1; i >= 12; i--){\n            this.buf[i] = digits.charCodeAt(n % base);\n            n = Math.floor(n / base);\n        }\n    }\n    next() {\n        if (!this.inited) {\n            this.init();\n        }\n        this.seq += this.inc;\n        if (this.seq > 3656158440062976) {\n            this.setPre();\n            this.initSeqAndInc();\n        }\n        this.fillSeq();\n        return String.fromCharCode.apply(String, this.buf);\n    }\n    reset() {\n        this.init();\n    }\n}\nconst nuid = new Nuid();\nvar Events;\n(function(Events) {\n    Events[\"Disconnect\"] = \"disconnect\";\n    Events[\"Reconnect\"] = \"reconnect\";\n    Events[\"Update\"] = \"update\";\n    Events[\"LDM\"] = \"ldm\";\n    Events[\"Error\"] = \"error\";\n})(Events || (Events = {}));\nvar DebugEvents;\n(function(DebugEvents) {\n    DebugEvents[\"Reconnecting\"] = \"reconnecting\";\n    DebugEvents[\"PingTimer\"] = \"pingTimer\";\n    DebugEvents[\"StaleConnection\"] = \"staleConnection\";\n    DebugEvents[\"ClientInitiatedReconnect\"] = \"client initiated reconnect\";\n})(DebugEvents || (DebugEvents = {}));\nvar ErrorCode;\n(function(ErrorCode) {\n    ErrorCode[\"ApiError\"] = \"BAD API\";\n    ErrorCode[\"BadAuthentication\"] = \"BAD_AUTHENTICATION\";\n    ErrorCode[\"BadCreds\"] = \"BAD_CREDS\";\n    ErrorCode[\"BadHeader\"] = \"BAD_HEADER\";\n    ErrorCode[\"BadJson\"] = \"BAD_JSON\";\n    ErrorCode[\"BadPayload\"] = \"BAD_PAYLOAD\";\n    ErrorCode[\"BadSubject\"] = \"BAD_SUBJECT\";\n    ErrorCode[\"Cancelled\"] = \"CANCELLED\";\n    ErrorCode[\"ConnectionClosed\"] = \"CONNECTION_CLOSED\";\n    ErrorCode[\"ConnectionDraining\"] = \"CONNECTION_DRAINING\";\n    ErrorCode[\"ConnectionRefused\"] = \"CONNECTION_REFUSED\";\n    ErrorCode[\"ConnectionTimeout\"] = \"CONNECTION_TIMEOUT\";\n    ErrorCode[\"Disconnect\"] = \"DISCONNECT\";\n    ErrorCode[\"InvalidOption\"] = \"INVALID_OPTION\";\n    ErrorCode[\"InvalidPayload\"] = \"INVALID_PAYLOAD\";\n    ErrorCode[\"MaxPayloadExceeded\"] = \"MAX_PAYLOAD_EXCEEDED\";\n    ErrorCode[\"NoResponders\"] = \"503\";\n    ErrorCode[\"NotFunction\"] = \"NOT_FUNC\";\n    ErrorCode[\"RequestError\"] = \"REQUEST_ERROR\";\n    ErrorCode[\"ServerOptionNotAvailable\"] = \"SERVER_OPT_NA\";\n    ErrorCode[\"SubClosed\"] = \"SUB_CLOSED\";\n    ErrorCode[\"SubDraining\"] = \"SUB_DRAINING\";\n    ErrorCode[\"Timeout\"] = \"TIMEOUT\";\n    ErrorCode[\"Tls\"] = \"TLS\";\n    ErrorCode[\"Unknown\"] = \"UNKNOWN_ERROR\";\n    ErrorCode[\"WssRequired\"] = \"WSS_REQUIRED\";\n    ErrorCode[\"JetStreamInvalidAck\"] = \"JESTREAM_INVALID_ACK\";\n    ErrorCode[\"JetStream404NoMessages\"] = \"404\";\n    ErrorCode[\"JetStream408RequestTimeout\"] = \"408\";\n    ErrorCode[\"JetStream409MaxAckPendingExceeded\"] = \"409\";\n    ErrorCode[\"JetStream409\"] = \"409\";\n    ErrorCode[\"JetStreamNotEnabled\"] = \"503\";\n    ErrorCode[\"JetStreamIdleHeartBeat\"] = \"IDLE_HEARTBEAT\";\n    ErrorCode[\"AuthorizationViolation\"] = \"AUTHORIZATION_VIOLATION\";\n    ErrorCode[\"AuthenticationExpired\"] = \"AUTHENTICATION_EXPIRED\";\n    ErrorCode[\"ProtocolError\"] = \"NATS_PROTOCOL_ERR\";\n    ErrorCode[\"PermissionsViolation\"] = \"PERMISSIONS_VIOLATION\";\n    ErrorCode[\"AuthenticationTimeout\"] = \"AUTHENTICATION_TIMEOUT\";\n    ErrorCode[\"AccountExpired\"] = \"ACCOUNT_EXPIRED\";\n})(ErrorCode || (ErrorCode = {}));\nfunction isNatsError(err) {\n    return typeof err.code === \"string\";\n}\nclass Messages {\n    messages;\n    constructor(){\n        this.messages = new Map();\n        this.messages.set(ErrorCode.InvalidPayload, \"Invalid payload type - payloads can be 'binary', 'string', or 'json'\");\n        this.messages.set(ErrorCode.BadJson, \"Bad JSON\");\n        this.messages.set(ErrorCode.WssRequired, \"TLS is required, therefore a secure websocket connection is also required\");\n    }\n    static getMessage(s) {\n        return messages.getMessage(s);\n    }\n    getMessage(s) {\n        return this.messages.get(s) || s;\n    }\n}\nconst messages = new Messages();\nclass NatsError extends Error {\n    name;\n    message;\n    code;\n    permissionContext;\n    chainedError;\n    api_error;\n    constructor(message, code, chainedError){\n        super(message);\n        this.name = \"NatsError\";\n        this.message = message;\n        this.code = code;\n        this.chainedError = chainedError;\n    }\n    static errorForCode(code, chainedError) {\n        const m = Messages.getMessage(code);\n        return new NatsError(m, code, chainedError);\n    }\n    isAuthError() {\n        return this.code === ErrorCode.AuthenticationExpired || this.code === ErrorCode.AuthorizationViolation || this.code === ErrorCode.AccountExpired;\n    }\n    isAuthTimeout() {\n        return this.code === ErrorCode.AuthenticationTimeout;\n    }\n    isPermissionError() {\n        return this.code === ErrorCode.PermissionsViolation;\n    }\n    isProtocolError() {\n        return this.code === ErrorCode.ProtocolError;\n    }\n    isJetStreamError() {\n        return this.api_error !== undefined;\n    }\n    jsError() {\n        return this.api_error ? this.api_error : null;\n    }\n}\nvar Match;\n(function(Match) {\n    Match[Match[\"Exact\"] = 0] = \"Exact\";\n    Match[Match[\"CanonicalMIME\"] = 1] = \"CanonicalMIME\";\n    Match[Match[\"IgnoreCase\"] = 2] = \"IgnoreCase\";\n})(Match || (Match = {}));\nvar RequestStrategy;\n(function(RequestStrategy) {\n    RequestStrategy[\"Timer\"] = \"timer\";\n    RequestStrategy[\"Count\"] = \"count\";\n    RequestStrategy[\"JitterTimer\"] = \"jitterTimer\";\n    RequestStrategy[\"SentinelMsg\"] = \"sentinelMsg\";\n})(RequestStrategy || (RequestStrategy = {}));\nfunction syncIterator(src) {\n    const iter = src[Symbol.asyncIterator]();\n    return {\n        async next () {\n            const m = await iter.next();\n            if (m.done) {\n                return Promise.resolve(null);\n            }\n            return Promise.resolve(m.value);\n        }\n    };\n}\nvar ServiceResponseType;\n(function(ServiceResponseType) {\n    ServiceResponseType[\"STATS\"] = \"io.nats.micro.v1.stats_response\";\n    ServiceResponseType[\"INFO\"] = \"io.nats.micro.v1.info_response\";\n    ServiceResponseType[\"PING\"] = \"io.nats.micro.v1.ping_response\";\n})(ServiceResponseType || (ServiceResponseType = {}));\nconst ServiceErrorHeader = \"Nats-Service-Error\";\nconst ServiceErrorCodeHeader = \"Nats-Service-Error-Code\";\nclass ServiceError extends Error {\n    code;\n    constructor(code, message){\n        super(message);\n        this.code = code;\n    }\n    static isServiceError(msg) {\n        return ServiceError.toServiceError(msg) !== null;\n    }\n    static toServiceError(msg) {\n        const scode = msg?.headers?.get(ServiceErrorCodeHeader) || \"\";\n        if (scode !== \"\") {\n            const code = parseInt(scode) || 400;\n            const description = msg?.headers?.get(ServiceErrorHeader) || \"\";\n            return new ServiceError(code, description.length ? description : scode);\n        }\n        return null;\n    }\n}\nfunction createInbox(prefix = \"\") {\n    prefix = prefix || \"_INBOX\";\n    if (typeof prefix !== \"string\") {\n        throw new Error(\"prefix must be a string\");\n    }\n    prefix.split(\".\").forEach((v)=>{\n        if (v === \"*\" || v === \">\") {\n            throw new Error(`inbox prefixes cannot have wildcards '${prefix}'`);\n        }\n    });\n    return `${prefix}.${nuid.next()}`;\n}\nconst DEFAULT_HOST = \"127.0.0.1\";\nvar ServiceVerb;\n(function(ServiceVerb) {\n    ServiceVerb[\"PING\"] = \"PING\";\n    ServiceVerb[\"STATS\"] = \"STATS\";\n    ServiceVerb[\"INFO\"] = \"INFO\";\n})(ServiceVerb || (ServiceVerb = {}));\nfunction extend(a, ...b) {\n    for(let i = 0; i < b.length; i++){\n        const o = b[i];\n        Object.keys(o).forEach(function(k) {\n            a[k] = o[k];\n        });\n    }\n    return a;\n}\nfunction render(frame) {\n    const cr = \"␍\";\n    const lf = \"␊\";\n    return TD.decode(frame).replace(/\\n/g, lf).replace(/\\r/g, cr);\n}\nfunction timeout(ms, asyncTraces = true) {\n    const err = asyncTraces ? NatsError.errorForCode(ErrorCode.Timeout) : null;\n    let methods;\n    let timer;\n    const p = new Promise((_resolve, reject)=>{\n        const cancel = ()=>{\n            if (timer) {\n                clearTimeout(timer);\n            }\n        };\n        methods = {\n            cancel\n        };\n        timer = setTimeout(()=>{\n            if (err === null) {\n                reject(NatsError.errorForCode(ErrorCode.Timeout));\n            } else {\n                reject(err);\n            }\n        }, ms);\n    });\n    return Object.assign(p, methods);\n}\nfunction delay(ms = 0) {\n    let methods;\n    const p = new Promise((resolve)=>{\n        const timer = setTimeout(()=>{\n            resolve();\n        }, ms);\n        const cancel = ()=>{\n            if (timer) {\n                clearTimeout(timer);\n            }\n        };\n        methods = {\n            cancel\n        };\n    });\n    return Object.assign(p, methods);\n}\nfunction deadline(p, millis = 1000) {\n    const err = new Error(`deadline exceeded`);\n    const d = deferred();\n    const timer = setTimeout(()=>d.reject(err), millis);\n    return Promise.race([\n        p,\n        d\n    ]).finally(()=>clearTimeout(timer));\n}\nfunction deferred() {\n    let methods = {};\n    const p = new Promise((resolve, reject)=>{\n        methods = {\n            resolve,\n            reject\n        };\n    });\n    return Object.assign(p, methods);\n}\nfunction shuffle(a) {\n    for(let i = a.length - 1; i > 0; i--){\n        const j = Math.floor(Math.random() * (i + 1));\n        [a[i], a[j]] = [\n            a[j],\n            a[i]\n        ];\n    }\n    return a;\n}\nclass Perf {\n    timers;\n    measures;\n    constructor(){\n        this.timers = new Map();\n        this.measures = new Map();\n    }\n    mark(key) {\n        this.timers.set(key, performance.now());\n    }\n    measure(key, startKey, endKey) {\n        const s = this.timers.get(startKey);\n        if (s === undefined) {\n            throw new Error(`${startKey} is not defined`);\n        }\n        const e = this.timers.get(endKey);\n        if (e === undefined) {\n            throw new Error(`${endKey} is not defined`);\n        }\n        this.measures.set(key, e - s);\n    }\n    getEntries() {\n        const values = [];\n        this.measures.forEach((v, k)=>{\n            values.push({\n                name: k,\n                duration: v\n            });\n        });\n        return values;\n    }\n}\nfunction jitter(n) {\n    if (n === 0) {\n        return 0;\n    }\n    return Math.floor(n / 2 + Math.random() * n);\n}\nfunction backoff(policy = [\n    0,\n    250,\n    250,\n    500,\n    500,\n    3000,\n    5000\n]) {\n    if (!Array.isArray(policy)) {\n        policy = [\n            0,\n            250,\n            250,\n            500,\n            500,\n            3000,\n            5000\n        ];\n    }\n    const max = policy.length - 1;\n    return {\n        backoff (attempt) {\n            return jitter(attempt > max ? policy[max] : policy[attempt]);\n        }\n    };\n}\nfunction nanos(millis) {\n    return millis * 1000000;\n}\nfunction millis(ns) {\n    return Math.floor(ns / 1000000);\n}\nfunction canonicalMIMEHeaderKey(k) {\n    const dash = 45;\n    const toLower = 97 - 65;\n    let upper = true;\n    const buf = new Array(k.length);\n    for(let i = 0; i < k.length; i++){\n        let c = k.charCodeAt(i);\n        if (c === 58 || c < 33 || c > 126) {\n            throw new NatsError(`'${k[i]}' is not a valid character for a header key`, ErrorCode.BadHeader);\n        }\n        if (upper && 97 <= c && c <= 122) {\n            c -= toLower;\n        } else if (!upper && 65 <= c && c <= 90) {\n            c += toLower;\n        }\n        buf[i] = c;\n        upper = c == dash;\n    }\n    return String.fromCharCode(...buf);\n}\nfunction headers(code = 0, description = \"\") {\n    if (code === 0 && description !== \"\" || code > 0 && description === \"\") {\n        throw new Error(\"setting status requires both code and description\");\n    }\n    return new MsgHdrsImpl(code, description);\n}\nconst HEADER = \"NATS/1.0\";\nclass MsgHdrsImpl {\n    _code;\n    headers;\n    _description;\n    constructor(code = 0, description = \"\"){\n        this._code = code;\n        this._description = description;\n        this.headers = new Map();\n    }\n    [Symbol.iterator]() {\n        return this.headers.entries();\n    }\n    size() {\n        return this.headers.size;\n    }\n    equals(mh) {\n        if (mh && this.headers.size === mh.headers.size && this._code === mh._code) {\n            for (const [k, v] of this.headers){\n                const a = mh.values(k);\n                if (v.length !== a.length) {\n                    return false;\n                }\n                const vv = [\n                    ...v\n                ].sort();\n                const aa = [\n                    ...a\n                ].sort();\n                for(let i = 0; i < vv.length; i++){\n                    if (vv[i] !== aa[i]) {\n                        return false;\n                    }\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    static decode(a) {\n        const mh = new MsgHdrsImpl();\n        const s = TD.decode(a);\n        const lines = s.split(\"\\r\\n\");\n        const h = lines[0];\n        if (h !== HEADER) {\n            let str = h.replace(HEADER, \"\").trim();\n            if (str.length > 0) {\n                mh._code = parseInt(str, 10);\n                if (isNaN(mh._code)) {\n                    mh._code = 0;\n                }\n                const scode = mh._code.toString();\n                str = str.replace(scode, \"\");\n                mh._description = str.trim();\n            }\n        }\n        if (lines.length >= 1) {\n            lines.slice(1).map((s)=>{\n                if (s) {\n                    const idx = s.indexOf(\":\");\n                    if (idx > -1) {\n                        const k = s.slice(0, idx);\n                        const v = s.slice(idx + 1).trim();\n                        mh.append(k, v);\n                    }\n                }\n            });\n        }\n        return mh;\n    }\n    toString() {\n        if (this.headers.size === 0 && this._code === 0) {\n            return \"\";\n        }\n        let s = HEADER;\n        if (this._code > 0 && this._description !== \"\") {\n            s += ` ${this._code} ${this._description}`;\n        }\n        for (const [k, v] of this.headers){\n            for(let i = 0; i < v.length; i++){\n                s = `${s}\\r\\n${k}: ${v[i]}`;\n            }\n        }\n        return `${s}\\r\\n\\r\\n`;\n    }\n    encode() {\n        return TE.encode(this.toString());\n    }\n    static validHeaderValue(k) {\n        const inv = /[\\r\\n]/;\n        if (inv.test(k)) {\n            throw new NatsError(\"invalid header value - \\\\r and \\\\n are not allowed.\", ErrorCode.BadHeader);\n        }\n        return k.trim();\n    }\n    keys() {\n        const keys = [];\n        for (const sk of this.headers.keys()){\n            keys.push(sk);\n        }\n        return keys;\n    }\n    findKeys(k, match = Match.Exact) {\n        const keys = this.keys();\n        switch(match){\n            case Match.Exact:\n                return keys.filter((v)=>{\n                    return v === k;\n                });\n            case Match.CanonicalMIME:\n                k = canonicalMIMEHeaderKey(k);\n                return keys.filter((v)=>{\n                    return v === k;\n                });\n            default:\n                {\n                    const lci = k.toLowerCase();\n                    return keys.filter((v)=>{\n                        return lci === v.toLowerCase();\n                    });\n                }\n        }\n    }\n    get(k, match = Match.Exact) {\n        const keys = this.findKeys(k, match);\n        if (keys.length) {\n            const v = this.headers.get(keys[0]);\n            if (v) {\n                return Array.isArray(v) ? v[0] : v;\n            }\n        }\n        return \"\";\n    }\n    last(k, match = Match.Exact) {\n        const keys = this.findKeys(k, match);\n        if (keys.length) {\n            const v = this.headers.get(keys[0]);\n            if (v) {\n                return Array.isArray(v) ? v[v.length - 1] : v;\n            }\n        }\n        return \"\";\n    }\n    has(k, match = Match.Exact) {\n        return this.findKeys(k, match).length > 0;\n    }\n    set(k, v, match = Match.Exact) {\n        this.delete(k, match);\n        this.append(k, v, match);\n    }\n    append(k, v, match = Match.Exact) {\n        const ck = canonicalMIMEHeaderKey(k);\n        if (match === Match.CanonicalMIME) {\n            k = ck;\n        }\n        const keys = this.findKeys(k, match);\n        k = keys.length > 0 ? keys[0] : k;\n        const value = MsgHdrsImpl.validHeaderValue(v);\n        let a = this.headers.get(k);\n        if (!a) {\n            a = [];\n            this.headers.set(k, a);\n        }\n        a.push(value);\n    }\n    values(k, match = Match.Exact) {\n        const buf = [];\n        const keys = this.findKeys(k, match);\n        keys.forEach((v)=>{\n            const values = this.headers.get(v);\n            if (values) {\n                buf.push(...values);\n            }\n        });\n        return buf;\n    }\n    delete(k, match = Match.Exact) {\n        const keys = this.findKeys(k, match);\n        keys.forEach((v)=>{\n            this.headers.delete(v);\n        });\n    }\n    get hasError() {\n        return this._code >= 300;\n    }\n    get status() {\n        return `${this._code} ${this._description}`.trim();\n    }\n    toRecord() {\n        const data = {};\n        this.keys().forEach((v)=>{\n            data[v] = this.values(v);\n        });\n        return data;\n    }\n    get code() {\n        return this._code;\n    }\n    get description() {\n        return this._description;\n    }\n    static fromRecord(r) {\n        const h = new MsgHdrsImpl();\n        for(const k in r){\n            h.headers.set(k, r[k]);\n        }\n        return h;\n    }\n}\nfunction StringCodec() {\n    return {\n        encode (d) {\n            return TE.encode(d);\n        },\n        decode (a) {\n            return TD.decode(a);\n        }\n    };\n}\nfunction JSONCodec(reviver) {\n    return {\n        encode (d) {\n            try {\n                if (d === undefined) {\n                    d = null;\n                }\n                return TE.encode(JSON.stringify(d));\n            } catch (err) {\n                throw NatsError.errorForCode(ErrorCode.BadJson, err);\n            }\n        },\n        decode (a) {\n            try {\n                return JSON.parse(TD.decode(a), reviver);\n            } catch (err) {\n                throw NatsError.errorForCode(ErrorCode.BadJson, err);\n            }\n        }\n    };\n}\nfunction isRequestError(msg) {\n    if (msg && msg.data.length === 0 && msg.headers?.code === 503) {\n        return NatsError.errorForCode(ErrorCode.NoResponders);\n    }\n    return null;\n}\nclass MsgImpl {\n    _headers;\n    _msg;\n    _rdata;\n    _reply;\n    _subject;\n    publisher;\n    static jc;\n    constructor(msg, data, publisher){\n        this._msg = msg;\n        this._rdata = data;\n        this.publisher = publisher;\n    }\n    get subject() {\n        if (this._subject) {\n            return this._subject;\n        }\n        this._subject = TD.decode(this._msg.subject);\n        return this._subject;\n    }\n    get reply() {\n        if (this._reply) {\n            return this._reply;\n        }\n        this._reply = TD.decode(this._msg.reply);\n        return this._reply;\n    }\n    get sid() {\n        return this._msg.sid;\n    }\n    get headers() {\n        if (this._msg.hdr > -1 && !this._headers) {\n            const buf = this._rdata.subarray(0, this._msg.hdr);\n            this._headers = MsgHdrsImpl.decode(buf);\n        }\n        return this._headers;\n    }\n    get data() {\n        if (!this._rdata) {\n            return new Uint8Array(0);\n        }\n        return this._msg.hdr > -1 ? this._rdata.subarray(this._msg.hdr) : this._rdata;\n    }\n    respond(data = Empty, opts) {\n        if (this.reply) {\n            this.publisher.publish(this.reply, data, opts);\n            return true;\n        }\n        return false;\n    }\n    size() {\n        const subj = this._msg.subject.length;\n        const reply = this._msg.reply?.length || 0;\n        const payloadAndHeaders = this._msg.size === -1 ? 0 : this._msg.size;\n        return subj + reply + payloadAndHeaders;\n    }\n    json(reviver) {\n        return JSONCodec(reviver).decode(this.data);\n    }\n    string() {\n        return TD.decode(this.data);\n    }\n    requestInfo() {\n        const v = this.headers?.get(\"Nats-Request-Info\");\n        if (v) {\n            return JSON.parse(v, function(key, value) {\n                if ((key === \"start\" || key === \"stop\") && value !== \"\") {\n                    return new Date(Date.parse(value));\n                }\n                return value;\n            });\n        }\n        return null;\n    }\n}\nfunction validateDurableName(name) {\n    return minValidation(\"durable\", name);\n}\nfunction validateStreamName(name) {\n    return minValidation(\"stream\", name);\n}\nfunction minValidation(context, name = \"\") {\n    if (name === \"\") {\n        throw Error(`${context} name required`);\n    }\n    const bad = [\n        \".\",\n        \"*\",\n        \">\",\n        \"/\",\n        \"\\\\\",\n        \" \",\n        \"\\t\",\n        \"\\n\",\n        \"\\r\"\n    ];\n    bad.forEach((v)=>{\n        if (name.indexOf(v) !== -1) {\n            switch(v){\n                case \"\\n\":\n                    v = \"\\\\n\";\n                    break;\n                case \"\\r\":\n                    v = \"\\\\r\";\n                    break;\n                case \"\\t\":\n                    v = \"\\\\t\";\n                    break;\n                default:\n            }\n            throw Error(`invalid ${context} name - ${context} name cannot contain '${v}'`);\n        }\n    });\n    return \"\";\n}\nfunction validateName(context, name = \"\") {\n    if (name === \"\") {\n        throw Error(`${context} name required`);\n    }\n    const m = validName(name);\n    if (m.length) {\n        throw new Error(`invalid ${context} name - ${context} name ${m}`);\n    }\n}\nfunction validName(name = \"\") {\n    if (name === \"\") {\n        throw Error(`name required`);\n    }\n    const RE = /^[-\\w]+$/g;\n    const m = name.match(RE);\n    if (m === null) {\n        for (const c of name.split(\"\")){\n            const mm = c.match(RE);\n            if (mm === null) {\n                return `cannot contain '${c}'`;\n            }\n        }\n    }\n    return \"\";\n}\nfunction isFlowControlMsg(msg) {\n    if (msg.data.length > 0) {\n        return false;\n    }\n    const h = msg.headers;\n    if (!h) {\n        return false;\n    }\n    return h.code >= 100 && h.code < 200;\n}\nfunction isHeartbeatMsg(msg) {\n    return isFlowControlMsg(msg) && msg.headers?.description === \"Idle Heartbeat\";\n}\nfunction newJsErrorMsg(code, description, subject) {\n    const h = headers(code, description);\n    const arg = {\n        hdr: 1,\n        sid: 0,\n        size: 0\n    };\n    const msg = new MsgImpl(arg, Empty, {});\n    msg._headers = h;\n    msg._subject = subject;\n    return msg;\n}\nfunction checkJsError(msg) {\n    if (msg.data.length !== 0) {\n        return null;\n    }\n    const h = msg.headers;\n    if (!h) {\n        return null;\n    }\n    return checkJsErrorCode(h.code, h.description);\n}\nvar Js409Errors;\n(function(Js409Errors) {\n    Js409Errors[\"MaxBatchExceeded\"] = \"exceeded maxrequestbatch of\";\n    Js409Errors[\"MaxExpiresExceeded\"] = \"exceeded maxrequestexpires of\";\n    Js409Errors[\"MaxBytesExceeded\"] = \"exceeded maxrequestmaxbytes of\";\n    Js409Errors[\"MaxMessageSizeExceeded\"] = \"message size exceeds maxbytes\";\n    Js409Errors[\"PushConsumer\"] = \"consumer is push based\";\n    Js409Errors[\"MaxWaitingExceeded\"] = \"exceeded maxwaiting\";\n    Js409Errors[\"IdleHeartbeatMissed\"] = \"idle heartbeats missed\";\n    Js409Errors[\"ConsumerDeleted\"] = \"consumer deleted\";\n})(Js409Errors || (Js409Errors = {}));\nlet MAX_WAITING_FAIL = false;\nfunction isTerminal409(err) {\n    if (err.code !== ErrorCode.JetStream409) {\n        return false;\n    }\n    const fatal = [\n        Js409Errors.MaxBatchExceeded,\n        Js409Errors.MaxExpiresExceeded,\n        Js409Errors.MaxBytesExceeded,\n        Js409Errors.MaxMessageSizeExceeded,\n        Js409Errors.PushConsumer,\n        Js409Errors.IdleHeartbeatMissed,\n        Js409Errors.ConsumerDeleted\n    ];\n    if (MAX_WAITING_FAIL) {\n        fatal.push(Js409Errors.MaxWaitingExceeded);\n    }\n    return fatal.find((s)=>{\n        return err.message.indexOf(s) !== -1;\n    }) !== undefined;\n}\nfunction checkJsErrorCode(code, description = \"\") {\n    if (code < 300) {\n        return null;\n    }\n    description = description.toLowerCase();\n    switch(code){\n        case 404:\n            return new NatsError(description, ErrorCode.JetStream404NoMessages);\n        case 408:\n            return new NatsError(description, ErrorCode.JetStream408RequestTimeout);\n        case 409:\n            {\n                const ec = description.startsWith(Js409Errors.IdleHeartbeatMissed) ? ErrorCode.JetStreamIdleHeartBeat : ErrorCode.JetStream409;\n                return new NatsError(description, ec);\n            }\n        case 503:\n            return NatsError.errorForCode(ErrorCode.JetStreamNotEnabled, new Error(description));\n        default:\n            if (description === \"\") {\n                description = ErrorCode.Unknown;\n            }\n            return new NatsError(description, `${code}`);\n    }\n}\nclass QueuedIteratorImpl {\n    inflight;\n    processed;\n    received;\n    noIterator;\n    iterClosed;\n    done;\n    signal;\n    yields;\n    filtered;\n    pendingFiltered;\n    ingestionFilterFn;\n    protocolFilterFn;\n    dispatchedFn;\n    ctx;\n    _data;\n    err;\n    time;\n    yielding;\n    constructor(){\n        this.inflight = 0;\n        this.filtered = 0;\n        this.pendingFiltered = 0;\n        this.processed = 0;\n        this.received = 0;\n        this.noIterator = false;\n        this.done = false;\n        this.signal = deferred();\n        this.yields = [];\n        this.iterClosed = deferred();\n        this.time = 0;\n        this.yielding = false;\n    }\n    [Symbol.asyncIterator]() {\n        return this.iterate();\n    }\n    push(v) {\n        if (this.done) {\n            return;\n        }\n        if (typeof v === \"function\") {\n            this.yields.push(v);\n            this.signal.resolve();\n            return;\n        }\n        const { ingest, protocol } = this.ingestionFilterFn ? this.ingestionFilterFn(v, this.ctx || this) : {\n            ingest: true,\n            protocol: false\n        };\n        if (ingest) {\n            if (protocol) {\n                this.filtered++;\n                this.pendingFiltered++;\n            }\n            this.yields.push(v);\n            this.signal.resolve();\n        }\n    }\n    async *iterate() {\n        if (this.noIterator) {\n            throw new NatsError(\"unsupported iterator\", ErrorCode.ApiError);\n        }\n        if (this.yielding) {\n            throw new NatsError(\"already yielding\", ErrorCode.ApiError);\n        }\n        this.yielding = true;\n        try {\n            while(true){\n                if (this.yields.length === 0) {\n                    await this.signal;\n                }\n                if (this.err) {\n                    throw this.err;\n                }\n                const yields = this.yields;\n                this.inflight = yields.length;\n                this.yields = [];\n                for(let i = 0; i < yields.length; i++){\n                    if (typeof yields[i] === \"function\") {\n                        const fn = yields[i];\n                        try {\n                            fn();\n                        } catch (err) {\n                            throw err;\n                        }\n                        if (this.err) {\n                            throw this.err;\n                        }\n                        continue;\n                    }\n                    const ok = this.protocolFilterFn ? this.protocolFilterFn(yields[i]) : true;\n                    if (ok) {\n                        this.processed++;\n                        const start = Date.now();\n                        yield yields[i];\n                        this.time = Date.now() - start;\n                        if (this.dispatchedFn && yields[i]) {\n                            this.dispatchedFn(yields[i]);\n                        }\n                    } else {\n                        this.pendingFiltered--;\n                    }\n                    this.inflight--;\n                }\n                if (this.done) {\n                    break;\n                } else if (this.yields.length === 0) {\n                    yields.length = 0;\n                    this.yields = yields;\n                    this.signal = deferred();\n                }\n            }\n        } finally{\n            this.stop();\n        }\n    }\n    stop(err) {\n        if (this.done) {\n            return;\n        }\n        this.err = err;\n        this.done = true;\n        this.signal.resolve();\n        this.iterClosed.resolve(err);\n    }\n    getProcessed() {\n        return this.noIterator ? this.received : this.processed;\n    }\n    getPending() {\n        return this.yields.length + this.inflight - this.pendingFiltered;\n    }\n    getReceived() {\n        return this.received - this.filtered;\n    }\n}\nclass IdleHeartbeatMonitor {\n    interval;\n    maxOut;\n    cancelAfter;\n    timer;\n    autoCancelTimer;\n    last;\n    missed;\n    count;\n    callback;\n    constructor(interval, cb, opts = {\n        maxOut: 2\n    }){\n        this.interval = interval;\n        this.maxOut = opts?.maxOut || 2;\n        this.cancelAfter = opts?.cancelAfter || 0;\n        this.last = Date.now();\n        this.missed = 0;\n        this.count = 0;\n        this.callback = cb;\n        this._schedule();\n    }\n    cancel() {\n        if (this.autoCancelTimer) {\n            clearTimeout(this.autoCancelTimer);\n        }\n        if (this.timer) {\n            clearInterval(this.timer);\n        }\n        this.timer = 0;\n        this.autoCancelTimer = 0;\n        this.missed = 0;\n    }\n    work() {\n        this.last = Date.now();\n        this.missed = 0;\n    }\n    _change(interval, cancelAfter = 0, maxOut = 2) {\n        this.interval = interval;\n        this.maxOut = maxOut;\n        this.cancelAfter = cancelAfter;\n        this.restart();\n    }\n    restart() {\n        this.cancel();\n        this._schedule();\n    }\n    _schedule() {\n        if (this.cancelAfter > 0) {\n            this.autoCancelTimer = setTimeout(()=>{\n                this.cancel();\n            }, this.cancelAfter);\n        }\n        this.timer = setInterval(()=>{\n            this.count++;\n            if (Date.now() - this.last > this.interval) {\n                this.missed++;\n            }\n            if (this.missed >= this.maxOut) {\n                try {\n                    if (this.callback(this.missed) === true) {\n                        this.cancel();\n                    }\n                } catch (err) {\n                    console.log(err);\n                }\n            }\n        }, this.interval);\n    }\n}\nvar RetentionPolicy;\n(function(RetentionPolicy) {\n    RetentionPolicy[\"Limits\"] = \"limits\";\n    RetentionPolicy[\"Interest\"] = \"interest\";\n    RetentionPolicy[\"Workqueue\"] = \"workqueue\";\n})(RetentionPolicy || (RetentionPolicy = {}));\nvar DiscardPolicy;\n(function(DiscardPolicy) {\n    DiscardPolicy[\"Old\"] = \"old\";\n    DiscardPolicy[\"New\"] = \"new\";\n})(DiscardPolicy || (DiscardPolicy = {}));\nvar StorageType;\n(function(StorageType) {\n    StorageType[\"File\"] = \"file\";\n    StorageType[\"Memory\"] = \"memory\";\n})(StorageType || (StorageType = {}));\nvar DeliverPolicy;\n(function(DeliverPolicy) {\n    DeliverPolicy[\"All\"] = \"all\";\n    DeliverPolicy[\"Last\"] = \"last\";\n    DeliverPolicy[\"New\"] = \"new\";\n    DeliverPolicy[\"StartSequence\"] = \"by_start_sequence\";\n    DeliverPolicy[\"StartTime\"] = \"by_start_time\";\n    DeliverPolicy[\"LastPerSubject\"] = \"last_per_subject\";\n})(DeliverPolicy || (DeliverPolicy = {}));\nvar AckPolicy;\n(function(AckPolicy) {\n    AckPolicy[\"None\"] = \"none\";\n    AckPolicy[\"All\"] = \"all\";\n    AckPolicy[\"Explicit\"] = \"explicit\";\n    AckPolicy[\"NotSet\"] = \"\";\n})(AckPolicy || (AckPolicy = {}));\nvar ReplayPolicy;\n(function(ReplayPolicy) {\n    ReplayPolicy[\"Instant\"] = \"instant\";\n    ReplayPolicy[\"Original\"] = \"original\";\n})(ReplayPolicy || (ReplayPolicy = {}));\nvar StoreCompression;\n(function(StoreCompression) {\n    StoreCompression[\"None\"] = \"none\";\n    StoreCompression[\"S2\"] = \"s2\";\n})(StoreCompression || (StoreCompression = {}));\nvar ConsumerApiAction;\n(function(ConsumerApiAction) {\n    ConsumerApiAction[\"CreateOrUpdate\"] = \"\";\n    ConsumerApiAction[\"Update\"] = \"update\";\n    ConsumerApiAction[\"Create\"] = \"create\";\n})(ConsumerApiAction || (ConsumerApiAction = {}));\nfunction defaultConsumer(name, opts = {}) {\n    return Object.assign({\n        name: name,\n        deliver_policy: DeliverPolicy.All,\n        ack_policy: AckPolicy.Explicit,\n        ack_wait: nanos(30 * 1000),\n        replay_policy: ReplayPolicy.Instant\n    }, opts);\n}\nvar AdvisoryKind;\n(function(AdvisoryKind) {\n    AdvisoryKind[\"API\"] = \"api_audit\";\n    AdvisoryKind[\"StreamAction\"] = \"stream_action\";\n    AdvisoryKind[\"ConsumerAction\"] = \"consumer_action\";\n    AdvisoryKind[\"SnapshotCreate\"] = \"snapshot_create\";\n    AdvisoryKind[\"SnapshotComplete\"] = \"snapshot_complete\";\n    AdvisoryKind[\"RestoreCreate\"] = \"restore_create\";\n    AdvisoryKind[\"RestoreComplete\"] = \"restore_complete\";\n    AdvisoryKind[\"MaxDeliver\"] = \"max_deliver\";\n    AdvisoryKind[\"Terminated\"] = \"terminated\";\n    AdvisoryKind[\"Ack\"] = \"consumer_ack\";\n    AdvisoryKind[\"StreamLeaderElected\"] = \"stream_leader_elected\";\n    AdvisoryKind[\"StreamQuorumLost\"] = \"stream_quorum_lost\";\n    AdvisoryKind[\"ConsumerLeaderElected\"] = \"consumer_leader_elected\";\n    AdvisoryKind[\"ConsumerQuorumLost\"] = \"consumer_quorum_lost\";\n})(AdvisoryKind || (AdvisoryKind = {}));\nvar JsHeaders;\n(function(JsHeaders) {\n    JsHeaders[\"StreamSourceHdr\"] = \"Nats-Stream-Source\";\n    JsHeaders[\"LastConsumerSeqHdr\"] = \"Nats-Last-Consumer\";\n    JsHeaders[\"LastStreamSeqHdr\"] = \"Nats-Last-Stream\";\n    JsHeaders[\"ConsumerStalledHdr\"] = \"Nats-Consumer-Stalled\";\n    JsHeaders[\"MessageSizeHdr\"] = \"Nats-Msg-Size\";\n    JsHeaders[\"RollupHdr\"] = \"Nats-Rollup\";\n    JsHeaders[\"RollupValueSubject\"] = \"sub\";\n    JsHeaders[\"RollupValueAll\"] = \"all\";\n    JsHeaders[\"PendingMessagesHdr\"] = \"Nats-Pending-Messages\";\n    JsHeaders[\"PendingBytesHdr\"] = \"Nats-Pending-Bytes\";\n})(JsHeaders || (JsHeaders = {}));\nvar KvWatchInclude;\n(function(KvWatchInclude) {\n    KvWatchInclude[\"LastValue\"] = \"\";\n    KvWatchInclude[\"AllHistory\"] = \"history\";\n    KvWatchInclude[\"UpdatesOnly\"] = \"updates\";\n})(KvWatchInclude || (KvWatchInclude = {}));\nvar DirectMsgHeaders;\n(function(DirectMsgHeaders) {\n    DirectMsgHeaders[\"Stream\"] = \"Nats-Stream\";\n    DirectMsgHeaders[\"Sequence\"] = \"Nats-Sequence\";\n    DirectMsgHeaders[\"TimeStamp\"] = \"Nats-Time-Stamp\";\n    DirectMsgHeaders[\"Subject\"] = \"Nats-Subject\";\n})(DirectMsgHeaders || (DirectMsgHeaders = {}));\nvar RepublishHeaders;\n(function(RepublishHeaders) {\n    RepublishHeaders[\"Stream\"] = \"Nats-Stream\";\n    RepublishHeaders[\"Subject\"] = \"Nats-Subject\";\n    RepublishHeaders[\"Sequence\"] = \"Nats-Sequence\";\n    RepublishHeaders[\"LastSequence\"] = \"Nats-Last-Sequence\";\n    RepublishHeaders[\"Size\"] = \"Nats-Msg-Size\";\n})(RepublishHeaders || (RepublishHeaders = {}));\nconst kvPrefix = \"KV_\";\nclass ConsumerOptsBuilderImpl {\n    config;\n    ordered;\n    mack;\n    stream;\n    callbackFn;\n    max;\n    qname;\n    isBind;\n    filters;\n    constructor(opts){\n        this.stream = \"\";\n        this.mack = false;\n        this.ordered = false;\n        this.config = defaultConsumer(\"\", opts || {});\n    }\n    getOpts() {\n        const o = {};\n        o.config = Object.assign({}, this.config);\n        if (o.config.filter_subject) {\n            this.filterSubject(o.config.filter_subject);\n            o.config.filter_subject = undefined;\n        }\n        if (o.config.filter_subjects) {\n            o.config.filter_subjects?.forEach((v)=>{\n                this.filterSubject(v);\n            });\n            o.config.filter_subjects = undefined;\n        }\n        o.mack = this.mack;\n        o.stream = this.stream;\n        o.callbackFn = this.callbackFn;\n        o.max = this.max;\n        o.queue = this.qname;\n        o.ordered = this.ordered;\n        o.config.ack_policy = o.ordered ? AckPolicy.None : o.config.ack_policy;\n        o.isBind = o.isBind || false;\n        if (this.filters) {\n            switch(this.filters.length){\n                case 0:\n                    break;\n                case 1:\n                    o.config.filter_subject = this.filters[0];\n                    break;\n                default:\n                    o.config.filter_subjects = this.filters;\n            }\n        }\n        return o;\n    }\n    description(description) {\n        this.config.description = description;\n        return this;\n    }\n    deliverTo(subject) {\n        this.config.deliver_subject = subject;\n        return this;\n    }\n    durable(name) {\n        validateDurableName(name);\n        this.config.durable_name = name;\n        return this;\n    }\n    startSequence(seq) {\n        if (seq <= 0) {\n            throw new Error(\"sequence must be greater than 0\");\n        }\n        this.config.deliver_policy = DeliverPolicy.StartSequence;\n        this.config.opt_start_seq = seq;\n        return this;\n    }\n    startTime(time) {\n        this.config.deliver_policy = DeliverPolicy.StartTime;\n        this.config.opt_start_time = time.toISOString();\n        return this;\n    }\n    deliverAll() {\n        this.config.deliver_policy = DeliverPolicy.All;\n        return this;\n    }\n    deliverLastPerSubject() {\n        this.config.deliver_policy = DeliverPolicy.LastPerSubject;\n        return this;\n    }\n    deliverLast() {\n        this.config.deliver_policy = DeliverPolicy.Last;\n        return this;\n    }\n    deliverNew() {\n        this.config.deliver_policy = DeliverPolicy.New;\n        return this;\n    }\n    startAtTimeDelta(millis) {\n        this.startTime(new Date(Date.now() - millis));\n        return this;\n    }\n    headersOnly() {\n        this.config.headers_only = true;\n        return this;\n    }\n    ackNone() {\n        this.config.ack_policy = AckPolicy.None;\n        return this;\n    }\n    ackAll() {\n        this.config.ack_policy = AckPolicy.All;\n        return this;\n    }\n    ackExplicit() {\n        this.config.ack_policy = AckPolicy.Explicit;\n        return this;\n    }\n    ackWait(millis) {\n        this.config.ack_wait = nanos(millis);\n        return this;\n    }\n    maxDeliver(max) {\n        this.config.max_deliver = max;\n        return this;\n    }\n    filterSubject(s) {\n        this.filters = this.filters || [];\n        this.filters.push(s);\n        return this;\n    }\n    replayInstantly() {\n        this.config.replay_policy = ReplayPolicy.Instant;\n        return this;\n    }\n    replayOriginal() {\n        this.config.replay_policy = ReplayPolicy.Original;\n        return this;\n    }\n    sample(n) {\n        n = Math.trunc(n);\n        if (n < 0 || n > 100) {\n            throw new Error(`value must be between 0-100`);\n        }\n        this.config.sample_freq = `${n}%`;\n        return this;\n    }\n    limit(n) {\n        this.config.rate_limit_bps = n;\n        return this;\n    }\n    maxWaiting(max) {\n        this.config.max_waiting = max;\n        return this;\n    }\n    maxAckPending(max) {\n        this.config.max_ack_pending = max;\n        return this;\n    }\n    idleHeartbeat(millis) {\n        this.config.idle_heartbeat = nanos(millis);\n        return this;\n    }\n    flowControl() {\n        this.config.flow_control = true;\n        return this;\n    }\n    deliverGroup(name) {\n        this.queue(name);\n        return this;\n    }\n    manualAck() {\n        this.mack = true;\n        return this;\n    }\n    maxMessages(max) {\n        this.max = max;\n        return this;\n    }\n    callback(fn) {\n        this.callbackFn = fn;\n        return this;\n    }\n    queue(n) {\n        this.qname = n;\n        this.config.deliver_group = n;\n        return this;\n    }\n    orderedConsumer() {\n        this.ordered = true;\n        return this;\n    }\n    bind(stream, durable) {\n        this.stream = stream;\n        this.config.durable_name = durable;\n        this.isBind = true;\n        return this;\n    }\n    bindStream(stream) {\n        this.stream = stream;\n        return this;\n    }\n    inactiveEphemeralThreshold(millis) {\n        this.config.inactive_threshold = nanos(millis);\n        return this;\n    }\n    maxPullBatch(n) {\n        this.config.max_batch = n;\n        return this;\n    }\n    maxPullRequestExpires(millis) {\n        this.config.max_expires = nanos(millis);\n        return this;\n    }\n    memory() {\n        this.config.mem_storage = true;\n        return this;\n    }\n    numReplicas(n) {\n        this.config.num_replicas = n;\n        return this;\n    }\n    consumerName(n) {\n        this.config.name = n;\n        return this;\n    }\n}\nfunction consumerOpts(opts) {\n    return new ConsumerOptsBuilderImpl(opts);\n}\nfunction isConsumerOptsBuilder(o) {\n    return typeof o.getOpts === \"function\";\n}\nclass Base64Codec {\n    static encode(bytes) {\n        if (typeof bytes === \"string\") {\n            return btoa(bytes);\n        }\n        const a = Array.from(bytes);\n        return btoa(String.fromCharCode(...a));\n    }\n    static decode(s, binary = false) {\n        const bin = atob(s);\n        if (!binary) {\n            return bin;\n        }\n        return Uint8Array.from(bin, (c)=>c.charCodeAt(0));\n    }\n}\nclass Base64UrlPaddedCodec {\n    static encode(bytes) {\n        return Base64UrlPaddedCodec.toB64URLEncoding(Base64Codec.encode(bytes));\n    }\n    static decode(s, binary = false) {\n        return Base64UrlPaddedCodec.decode(Base64UrlPaddedCodec.fromB64URLEncoding(s), binary);\n    }\n    static toB64URLEncoding(b64str) {\n        return b64str.replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n    }\n    static fromB64URLEncoding(b64str) {\n        return b64str.replace(/_/g, \"/\").replace(/-/g, \"+\");\n    }\n}\nclass DataBuffer {\n    buffers;\n    byteLength;\n    constructor(){\n        this.buffers = [];\n        this.byteLength = 0;\n    }\n    static concat(...bufs) {\n        let max = 0;\n        for(let i = 0; i < bufs.length; i++){\n            max += bufs[i].length;\n        }\n        const out = new Uint8Array(max);\n        let index = 0;\n        for(let i = 0; i < bufs.length; i++){\n            out.set(bufs[i], index);\n            index += bufs[i].length;\n        }\n        return out;\n    }\n    static fromAscii(m) {\n        if (!m) {\n            m = \"\";\n        }\n        return TE.encode(m);\n    }\n    static toAscii(a) {\n        return TD.decode(a);\n    }\n    reset() {\n        this.buffers.length = 0;\n        this.byteLength = 0;\n    }\n    pack() {\n        if (this.buffers.length > 1) {\n            const v = new Uint8Array(this.byteLength);\n            let index = 0;\n            for(let i = 0; i < this.buffers.length; i++){\n                v.set(this.buffers[i], index);\n                index += this.buffers[i].length;\n            }\n            this.buffers.length = 0;\n            this.buffers.push(v);\n        }\n    }\n    shift() {\n        if (this.buffers.length) {\n            const a = this.buffers.shift();\n            if (a) {\n                this.byteLength -= a.length;\n                return a;\n            }\n        }\n        return new Uint8Array(0);\n    }\n    drain(n) {\n        if (this.buffers.length) {\n            this.pack();\n            const v = this.buffers.pop();\n            if (v) {\n                const max = this.byteLength;\n                if (n === undefined || n > max) {\n                    n = max;\n                }\n                const d = v.subarray(0, n);\n                if (max > n) {\n                    this.buffers.push(v.subarray(n));\n                }\n                this.byteLength = max - n;\n                return d;\n            }\n        }\n        return new Uint8Array(0);\n    }\n    fill(a, ...bufs) {\n        if (a) {\n            this.buffers.push(a);\n            this.byteLength += a.length;\n        }\n        for(let i = 0; i < bufs.length; i++){\n            if (bufs[i] && bufs[i].length) {\n                this.buffers.push(bufs[i]);\n                this.byteLength += bufs[i].length;\n            }\n        }\n    }\n    peek() {\n        if (this.buffers.length) {\n            this.pack();\n            return this.buffers[0];\n        }\n        return new Uint8Array(0);\n    }\n    size() {\n        return this.byteLength;\n    }\n    length() {\n        return this.buffers.length;\n    }\n}\nfunction getLengths(b64) {\n    const len = b64.length;\n    let validLen = b64.indexOf(\"=\");\n    if (validLen === -1) {\n        validLen = len;\n    }\n    const placeHoldersLen = validLen === len ? 0 : 4 - validLen % 4;\n    return [\n        validLen,\n        placeHoldersLen\n    ];\n}\nfunction init(lookup, revLookup, urlsafe = false) {\n    function _byteLength(validLen, placeHoldersLen) {\n        return Math.floor((validLen + placeHoldersLen) * 3 / 4 - placeHoldersLen);\n    }\n    function tripletToBase64(num) {\n        return lookup[num >> 18 & 0x3f] + lookup[num >> 12 & 0x3f] + lookup[num >> 6 & 0x3f] + lookup[num & 0x3f];\n    }\n    function encodeChunk(buf, start, end) {\n        const out = new Array((end - start) / 3);\n        for(let i = start, curTriplet = 0; i < end; i += 3){\n            out[curTriplet++] = tripletToBase64((buf[i] << 16) + (buf[i + 1] << 8) + buf[i + 2]);\n        }\n        return out.join(\"\");\n    }\n    return {\n        byteLength (b64) {\n            return _byteLength.apply(null, getLengths(b64));\n        },\n        toUint8Array (b64) {\n            const [validLen, placeHoldersLen] = getLengths(b64);\n            const buf = new Uint8Array(_byteLength(validLen, placeHoldersLen));\n            const len = placeHoldersLen ? validLen - 4 : validLen;\n            let tmp;\n            let curByte = 0;\n            let i;\n            for(i = 0; i < len; i += 4){\n                tmp = revLookup[b64.charCodeAt(i)] << 18 | revLookup[b64.charCodeAt(i + 1)] << 12 | revLookup[b64.charCodeAt(i + 2)] << 6 | revLookup[b64.charCodeAt(i + 3)];\n                buf[curByte++] = tmp >> 16 & 0xff;\n                buf[curByte++] = tmp >> 8 & 0xff;\n                buf[curByte++] = tmp & 0xff;\n            }\n            if (placeHoldersLen === 2) {\n                tmp = revLookup[b64.charCodeAt(i)] << 2 | revLookup[b64.charCodeAt(i + 1)] >> 4;\n                buf[curByte++] = tmp & 0xff;\n            } else if (placeHoldersLen === 1) {\n                tmp = revLookup[b64.charCodeAt(i)] << 10 | revLookup[b64.charCodeAt(i + 1)] << 4 | revLookup[b64.charCodeAt(i + 2)] >> 2;\n                buf[curByte++] = tmp >> 8 & 0xff;\n                buf[curByte++] = tmp & 0xff;\n            }\n            return buf;\n        },\n        fromUint8Array (buf) {\n            const maxChunkLength = 16383;\n            const len = buf.length;\n            const extraBytes = len % 3;\n            const len2 = len - extraBytes;\n            const parts = new Array(Math.ceil(len2 / 16383) + (extraBytes ? 1 : 0));\n            let curChunk = 0;\n            let chunkEnd;\n            for(let i = 0; i < len2; i += maxChunkLength){\n                chunkEnd = i + maxChunkLength;\n                parts[curChunk++] = encodeChunk(buf, i, chunkEnd > len2 ? len2 : chunkEnd);\n            }\n            let tmp;\n            if (extraBytes === 1) {\n                tmp = buf[len2];\n                parts[curChunk] = lookup[tmp >> 2] + lookup[tmp << 4 & 0x3f];\n                if (!urlsafe) parts[curChunk] += \"==\";\n            } else if (extraBytes === 2) {\n                tmp = buf[len2] << 8 | buf[len2 + 1] & 0xff;\n                parts[curChunk] = lookup[tmp >> 10] + lookup[tmp >> 4 & 0x3f] + lookup[tmp << 2 & 0x3f];\n                if (!urlsafe) parts[curChunk] += \"=\";\n            }\n            return parts.join(\"\");\n        }\n    };\n}\nconst lookup = [];\nconst revLookup = [];\nconst code = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\";\nfor(let i = 0, l = code.length; i < l; ++i){\n    lookup[i] = code[i];\n    revLookup[code.charCodeAt(i)] = i;\n}\nconst { byteLength, toUint8Array, fromUint8Array } = init(lookup, revLookup, true);\nconst decoder = new TextDecoder();\nconst encoder = new TextEncoder();\nfunction toHexString(buf) {\n    return buf.reduce((hex, __byte)=>`${hex}${__byte < 16 ? \"0\" : \"\"}${__byte.toString(16)}`, \"\");\n}\nfunction fromHexString(hex) {\n    const len = hex.length;\n    if (len % 2 || !/^[0-9a-fA-F]+$/.test(hex)) {\n        throw new TypeError(\"Invalid hex string.\");\n    }\n    hex = hex.toLowerCase();\n    const buf = new Uint8Array(Math.floor(len / 2));\n    const end = len / 2;\n    for(let i = 0; i < end; ++i){\n        buf[i] = parseInt(hex.substr(i * 2, 2), 16);\n    }\n    return buf;\n}\nfunction decode1(buf, encoding = \"utf8\") {\n    if (/^utf-?8$/i.test(encoding)) {\n        return decoder.decode(buf);\n    } else if (/^base64$/i.test(encoding)) {\n        return fromUint8Array(buf);\n    } else if (/^hex(?:adecimal)?$/i.test(encoding)) {\n        return toHexString(buf);\n    } else {\n        throw new TypeError(\"Unsupported string encoding.\");\n    }\n}\nfunction encode1(str, encoding = \"utf8\") {\n    if (/^utf-?8$/i.test(encoding)) {\n        return encoder.encode(str);\n    } else if (/^base64$/i.test(encoding)) {\n        return toUint8Array(str);\n    } else if (/^hex(?:adecimal)?$/i.test(encoding)) {\n        return fromHexString(str);\n    } else {\n        throw new TypeError(\"Unsupported string encoding.\");\n    }\n}\nclass SHA256 {\n    hashSize = 32;\n    _buf;\n    _bufIdx;\n    _count;\n    _K;\n    _H;\n    _finalized;\n    constructor(){\n        this._buf = new Uint8Array(64);\n        this._K = new Uint32Array([\n            0x428a2f98,\n            0x71374491,\n            0xb5c0fbcf,\n            0xe9b5dba5,\n            0x3956c25b,\n            0x59f111f1,\n            0x923f82a4,\n            0xab1c5ed5,\n            0xd807aa98,\n            0x12835b01,\n            0x243185be,\n            0x550c7dc3,\n            0x72be5d74,\n            0x80deb1fe,\n            0x9bdc06a7,\n            0xc19bf174,\n            0xe49b69c1,\n            0xefbe4786,\n            0x0fc19dc6,\n            0x240ca1cc,\n            0x2de92c6f,\n            0x4a7484aa,\n            0x5cb0a9dc,\n            0x76f988da,\n            0x983e5152,\n            0xa831c66d,\n            0xb00327c8,\n            0xbf597fc7,\n            0xc6e00bf3,\n            0xd5a79147,\n            0x06ca6351,\n            0x14292967,\n            0x27b70a85,\n            0x2e1b2138,\n            0x4d2c6dfc,\n            0x53380d13,\n            0x650a7354,\n            0x766a0abb,\n            0x81c2c92e,\n            0x92722c85,\n            0xa2bfe8a1,\n            0xa81a664b,\n            0xc24b8b70,\n            0xc76c51a3,\n            0xd192e819,\n            0xd6990624,\n            0xf40e3585,\n            0x106aa070,\n            0x19a4c116,\n            0x1e376c08,\n            0x2748774c,\n            0x34b0bcb5,\n            0x391c0cb3,\n            0x4ed8aa4a,\n            0x5b9cca4f,\n            0x682e6ff3,\n            0x748f82ee,\n            0x78a5636f,\n            0x84c87814,\n            0x8cc70208,\n            0x90befffa,\n            0xa4506ceb,\n            0xbef9a3f7,\n            0xc67178f2\n        ]);\n        this.init();\n    }\n    init() {\n        this._H = new Uint32Array([\n            0x6a09e667,\n            0xbb67ae85,\n            0x3c6ef372,\n            0xa54ff53a,\n            0x510e527f,\n            0x9b05688c,\n            0x1f83d9ab,\n            0x5be0cd19\n        ]);\n        this._bufIdx = 0;\n        this._count = new Uint32Array(2);\n        this._buf.fill(0);\n        this._finalized = false;\n        return this;\n    }\n    update(msg, inputEncoding) {\n        if (msg === null) {\n            throw new TypeError(\"msg must be a string or Uint8Array.\");\n        } else if (typeof msg === \"string\") {\n            msg = encode1(msg, inputEncoding);\n        }\n        for(let i = 0, len = msg.length; i < len; i++){\n            this._buf[this._bufIdx++] = msg[i];\n            if (this._bufIdx === 64) {\n                this._transform();\n                this._bufIdx = 0;\n            }\n        }\n        const c = this._count;\n        if ((c[0] += msg.length << 3) < msg.length << 3) {\n            c[1]++;\n        }\n        c[1] += msg.length >>> 29;\n        return this;\n    }\n    digest(outputEncoding) {\n        if (this._finalized) {\n            throw new Error(\"digest has already been called.\");\n        }\n        this._finalized = true;\n        const b = this._buf;\n        let idx = this._bufIdx;\n        b[idx++] = 0x80;\n        while(idx !== 56){\n            if (idx === 64) {\n                this._transform();\n                idx = 0;\n            }\n            b[idx++] = 0;\n        }\n        const c = this._count;\n        b[56] = c[1] >>> 24 & 0xff;\n        b[57] = c[1] >>> 16 & 0xff;\n        b[58] = c[1] >>> 8 & 0xff;\n        b[59] = c[1] >>> 0 & 0xff;\n        b[60] = c[0] >>> 24 & 0xff;\n        b[61] = c[0] >>> 16 & 0xff;\n        b[62] = c[0] >>> 8 & 0xff;\n        b[63] = c[0] >>> 0 & 0xff;\n        this._transform();\n        const hash = new Uint8Array(32);\n        for(let i = 0; i < 8; i++){\n            hash[(i << 2) + 0] = this._H[i] >>> 24 & 0xff;\n            hash[(i << 2) + 1] = this._H[i] >>> 16 & 0xff;\n            hash[(i << 2) + 2] = this._H[i] >>> 8 & 0xff;\n            hash[(i << 2) + 3] = this._H[i] >>> 0 & 0xff;\n        }\n        this.init();\n        return outputEncoding ? decode1(hash, outputEncoding) : hash;\n    }\n    _transform() {\n        const h = this._H;\n        let h0 = h[0];\n        let h1 = h[1];\n        let h2 = h[2];\n        let h3 = h[3];\n        let h4 = h[4];\n        let h5 = h[5];\n        let h6 = h[6];\n        let h7 = h[7];\n        const w = new Uint32Array(16);\n        let i;\n        for(i = 0; i < 16; i++){\n            w[i] = this._buf[(i << 2) + 3] | this._buf[(i << 2) + 2] << 8 | this._buf[(i << 2) + 1] << 16 | this._buf[i << 2] << 24;\n        }\n        for(i = 0; i < 64; i++){\n            let tmp;\n            if (i < 16) {\n                tmp = w[i];\n            } else {\n                let a = w[i + 1 & 15];\n                let b = w[i + 14 & 15];\n                tmp = w[i & 15] = (a >>> 7 ^ a >>> 18 ^ a >>> 3 ^ a << 25 ^ a << 14) + (b >>> 17 ^ b >>> 19 ^ b >>> 10 ^ b << 15 ^ b << 13) + w[i & 15] + w[i + 9 & 15] | 0;\n            }\n            tmp = tmp + h7 + (h4 >>> 6 ^ h4 >>> 11 ^ h4 >>> 25 ^ h4 << 26 ^ h4 << 21 ^ h4 << 7) + (h6 ^ h4 & (h5 ^ h6)) + this._K[i] | 0;\n            h7 = h6;\n            h6 = h5;\n            h5 = h4;\n            h4 = h3 + tmp;\n            h3 = h2;\n            h2 = h1;\n            h1 = h0;\n            h0 = tmp + (h1 & h2 ^ h3 & (h1 ^ h2)) + (h1 >>> 2 ^ h1 >>> 13 ^ h1 >>> 22 ^ h1 << 30 ^ h1 << 19 ^ h1 << 10) | 0;\n        }\n        h[0] = h[0] + h0 | 0;\n        h[1] = h[1] + h1 | 0;\n        h[2] = h[2] + h2 | 0;\n        h[3] = h[3] + h3 | 0;\n        h[4] = h[4] + h4 | 0;\n        h[5] = h[5] + h5 | 0;\n        h[6] = h[6] + h6 | 0;\n        h[7] = h[7] + h7 | 0;\n    }\n}\nclass BaseRequest {\n    token;\n    received;\n    ctx;\n    requestSubject;\n    mux;\n    constructor(mux, requestSubject, asyncTraces = true){\n        this.mux = mux;\n        this.requestSubject = requestSubject;\n        this.received = 0;\n        this.token = nuid.next();\n        if (asyncTraces) {\n            this.ctx = new Error();\n        }\n    }\n}\nclass RequestMany extends BaseRequest {\n    callback;\n    done;\n    timer;\n    max;\n    opts;\n    constructor(mux, requestSubject, opts = {\n        maxWait: 1000\n    }){\n        super(mux, requestSubject);\n        this.opts = opts;\n        if (typeof this.opts.callback !== \"function\") {\n            throw new Error(\"callback is required\");\n        }\n        this.callback = this.opts.callback;\n        this.max = typeof opts.maxMessages === \"number\" && opts.maxMessages > 0 ? opts.maxMessages : -1;\n        this.done = deferred();\n        this.done.then(()=>{\n            this.callback(null, null);\n        });\n        this.timer = setTimeout(()=>{\n            this.cancel();\n        }, opts.maxWait);\n    }\n    cancel(err) {\n        if (err) {\n            this.callback(err, null);\n        }\n        clearTimeout(this.timer);\n        this.mux.cancel(this);\n        this.done.resolve();\n    }\n    resolver(err, msg) {\n        if (err) {\n            if (this.ctx) {\n                err.stack += `\\n\\n${this.ctx.stack}`;\n            }\n            this.cancel(err);\n        } else {\n            this.callback(null, msg);\n            if (this.opts.strategy === RequestStrategy.Count) {\n                this.max--;\n                if (this.max === 0) {\n                    this.cancel();\n                }\n            }\n            if (this.opts.strategy === RequestStrategy.JitterTimer) {\n                clearTimeout(this.timer);\n                this.timer = setTimeout(()=>{\n                    this.cancel();\n                }, this.opts.jitter || 300);\n            }\n            if (this.opts.strategy === RequestStrategy.SentinelMsg) {\n                if (msg && msg.data.length === 0) {\n                    this.cancel();\n                }\n            }\n        }\n    }\n}\nclass RequestOne extends BaseRequest {\n    deferred;\n    timer;\n    constructor(mux, requestSubject, opts = {\n        timeout: 1000\n    }, asyncTraces = true){\n        super(mux, requestSubject, asyncTraces);\n        this.deferred = deferred();\n        this.timer = timeout(opts.timeout, asyncTraces);\n    }\n    resolver(err, msg) {\n        if (this.timer) {\n            this.timer.cancel();\n        }\n        if (err) {\n            if (this.ctx) {\n                err.stack += `\\n\\n${this.ctx.stack}`;\n            }\n            this.deferred.reject(err);\n        } else {\n            this.deferred.resolve(msg);\n        }\n        this.cancel();\n    }\n    cancel(err) {\n        if (this.timer) {\n            this.timer.cancel();\n        }\n        this.mux.cancel(this);\n        this.deferred.reject(err ? err : NatsError.errorForCode(ErrorCode.Cancelled));\n    }\n}\nconst defaultPrefix = \"$JS.API\";\nfunction defaultJsOptions(opts) {\n    opts = opts || {};\n    if (opts.domain) {\n        opts.apiPrefix = `$JS.${opts.domain}.API`;\n        delete opts.domain;\n    }\n    return extend({\n        apiPrefix: defaultPrefix,\n        timeout: 5000\n    }, opts);\n}\nclass BaseApiClient {\n    nc;\n    opts;\n    prefix;\n    timeout;\n    jc;\n    constructor(nc, opts){\n        this.nc = nc;\n        this.opts = defaultJsOptions(opts);\n        this._parseOpts();\n        this.prefix = this.opts.apiPrefix;\n        this.timeout = this.opts.timeout;\n        this.jc = JSONCodec();\n    }\n    getOptions() {\n        return Object.assign({}, this.opts);\n    }\n    _parseOpts() {\n        let prefix = this.opts.apiPrefix;\n        if (!prefix || prefix.length === 0) {\n            throw new Error(\"invalid empty prefix\");\n        }\n        const c = prefix[prefix.length - 1];\n        if (c === \".\") {\n            prefix = prefix.substr(0, prefix.length - 1);\n        }\n        this.opts.apiPrefix = prefix;\n    }\n    async _request(subj, data = null, opts) {\n        opts = opts || {};\n        opts.timeout = this.timeout;\n        let a = Empty;\n        if (data) {\n            a = this.jc.encode(data);\n        }\n        let { retries } = opts;\n        retries = retries || 1;\n        retries = retries === -1 ? Number.MAX_SAFE_INTEGER : retries;\n        const bo = backoff();\n        for(let i = 0; i < retries; i++){\n            try {\n                const m = await this.nc.request(subj, a, opts);\n                return this.parseJsResponse(m);\n            } catch (err) {\n                const ne = err;\n                if ((ne.code === \"503\" || ne.code === ErrorCode.Timeout) && i + 1 < retries) {\n                    await delay(bo.backoff(i));\n                } else {\n                    throw err;\n                }\n            }\n        }\n    }\n    async findStream(subject) {\n        const q = {\n            subject\n        };\n        const r = await this._request(`${this.prefix}.STREAM.NAMES`, q);\n        const names = r;\n        if (!names.streams || names.streams.length !== 1) {\n            throw new Error(\"no stream matches subject\");\n        }\n        return names.streams[0];\n    }\n    getConnection() {\n        return this.nc;\n    }\n    parseJsResponse(m) {\n        const v = this.jc.decode(m.data);\n        const r = v;\n        if (r.error) {\n            const err = checkJsErrorCode(r.error.code, r.error.description);\n            if (err !== null) {\n                err.api_error = r.error;\n                throw err;\n            }\n        }\n        return v;\n    }\n}\nclass ListerImpl {\n    err;\n    offset;\n    pageInfo;\n    subject;\n    jsm;\n    filter;\n    payload;\n    constructor(subject, filter, jsm, payload){\n        if (!subject) {\n            throw new Error(\"subject is required\");\n        }\n        this.subject = subject;\n        this.jsm = jsm;\n        this.offset = 0;\n        this.pageInfo = {};\n        this.filter = filter;\n        this.payload = payload || {};\n    }\n    async next() {\n        if (this.err) {\n            return [];\n        }\n        if (this.pageInfo && this.offset >= this.pageInfo.total) {\n            return [];\n        }\n        const offset = {\n            offset: this.offset\n        };\n        if (this.payload) {\n            Object.assign(offset, this.payload);\n        }\n        try {\n            const r = await this.jsm._request(this.subject, offset, {\n                timeout: this.jsm.timeout\n            });\n            this.pageInfo = r;\n            const count = this.countResponse(r);\n            if (count === 0) {\n                return [];\n            }\n            this.offset += count;\n            const a = this.filter(r);\n            return a;\n        } catch (err) {\n            this.err = err;\n            throw err;\n        }\n    }\n    countResponse(r) {\n        switch(r?.type){\n            case \"io.nats.jetstream.api.v1.stream_names_response\":\n            case \"io.nats.jetstream.api.v1.stream_list_response\":\n                return r.streams?.length || 0;\n            case \"io.nats.jetstream.api.v1.consumer_list_response\":\n                return r.consumers?.length || 0;\n            default:\n                console.error(`jslister.ts: unknown API response for paged output: ${r?.type}`);\n                return r.streams?.length || 0;\n        }\n        return 0;\n    }\n    async *[Symbol.asyncIterator]() {\n        let page = await this.next();\n        while(page.length > 0){\n            for (const item of page){\n                yield item;\n            }\n            page = await this.next();\n        }\n    }\n}\nfunction parseSemVer(s = \"\") {\n    const m = s.match(/(\\d+).(\\d+).(\\d+)/);\n    if (m) {\n        return {\n            major: parseInt(m[1]),\n            minor: parseInt(m[2]),\n            micro: parseInt(m[3])\n        };\n    }\n    throw new Error(`'${s}' is not a semver value`);\n}\nfunction compare(a, b) {\n    if (a.major < b.major) return -1;\n    if (a.major > b.major) return 1;\n    if (a.minor < b.minor) return -1;\n    if (a.minor > b.minor) return 1;\n    if (a.micro < b.micro) return -1;\n    if (a.micro > b.micro) return 1;\n    return 0;\n}\nvar Feature;\n(function(Feature) {\n    Feature[\"JS_KV\"] = \"js_kv\";\n    Feature[\"JS_OBJECTSTORE\"] = \"js_objectstore\";\n    Feature[\"JS_PULL_MAX_BYTES\"] = \"js_pull_max_bytes\";\n    Feature[\"JS_NEW_CONSUMER_CREATE_API\"] = \"js_new_consumer_create\";\n    Feature[\"JS_ALLOW_DIRECT\"] = \"js_allow_direct\";\n    Feature[\"JS_MULTIPLE_CONSUMER_FILTER\"] = \"js_multiple_consumer_filter\";\n    Feature[\"JS_SIMPLIFICATION\"] = \"js_simplification\";\n    Feature[\"JS_STREAM_CONSUMER_METADATA\"] = \"js_stream_consumer_metadata\";\n    Feature[\"JS_CONSUMER_FILTER_SUBJECTS\"] = \"js_consumer_filter_subjects\";\n    Feature[\"JS_STREAM_FIRST_SEQ\"] = \"js_stream_first_seq\";\n    Feature[\"JS_STREAM_SUBJECT_TRANSFORM\"] = \"js_stream_subject_transform\";\n    Feature[\"JS_STREAM_SOURCE_SUBJECT_TRANSFORM\"] = \"js_stream_source_subject_transform\";\n    Feature[\"JS_STREAM_COMPRESSION\"] = \"js_stream_compression\";\n    Feature[\"JS_DEFAULT_CONSUMER_LIMITS\"] = \"js_default_consumer_limits\";\n    Feature[\"JS_BATCH_DIRECT_GET\"] = \"js_batch_direct_get\";\n})(Feature || (Feature = {}));\nclass Features {\n    server;\n    features;\n    disabled;\n    constructor(v){\n        this.features = new Map();\n        this.disabled = [];\n        this.update(v);\n    }\n    resetDisabled() {\n        this.disabled.length = 0;\n        this.update(this.server);\n    }\n    disable(f) {\n        this.disabled.push(f);\n        this.update(this.server);\n    }\n    isDisabled(f) {\n        return this.disabled.indexOf(f) !== -1;\n    }\n    update(v) {\n        if (typeof v === \"string\") {\n            v = parseSemVer(v);\n        }\n        this.server = v;\n        this.set(Feature.JS_KV, \"2.6.2\");\n        this.set(Feature.JS_OBJECTSTORE, \"2.6.3\");\n        this.set(Feature.JS_PULL_MAX_BYTES, \"2.8.3\");\n        this.set(Feature.JS_NEW_CONSUMER_CREATE_API, \"2.9.0\");\n        this.set(Feature.JS_ALLOW_DIRECT, \"2.9.0\");\n        this.set(Feature.JS_MULTIPLE_CONSUMER_FILTER, \"2.10.0\");\n        this.set(Feature.JS_SIMPLIFICATION, \"2.9.4\");\n        this.set(Feature.JS_STREAM_CONSUMER_METADATA, \"2.10.0\");\n        this.set(Feature.JS_CONSUMER_FILTER_SUBJECTS, \"2.10.0\");\n        this.set(Feature.JS_STREAM_FIRST_SEQ, \"2.10.0\");\n        this.set(Feature.JS_STREAM_SUBJECT_TRANSFORM, \"2.10.0\");\n        this.set(Feature.JS_STREAM_SOURCE_SUBJECT_TRANSFORM, \"2.10.0\");\n        this.set(Feature.JS_STREAM_COMPRESSION, \"2.10.0\");\n        this.set(Feature.JS_DEFAULT_CONSUMER_LIMITS, \"2.10.0\");\n        this.set(Feature.JS_BATCH_DIRECT_GET, \"2.11.0\");\n        this.disabled.forEach((f)=>{\n            this.features.delete(f);\n        });\n    }\n    set(f, requires) {\n        this.features.set(f, {\n            min: requires,\n            ok: compare(this.server, parseSemVer(requires)) >= 0\n        });\n    }\n    get(f) {\n        return this.features.get(f) || {\n            min: \"unknown\",\n            ok: false\n        };\n    }\n    supports(f) {\n        return this.get(f)?.ok || false;\n    }\n    require(v) {\n        if (typeof v === \"string\") {\n            v = parseSemVer(v);\n        }\n        return compare(this.server, v) >= 0;\n    }\n}\nclass ConsumerAPIImpl extends BaseApiClient {\n    constructor(nc, opts){\n        super(nc, opts);\n    }\n    async add(stream, cfg, action = ConsumerApiAction.Create) {\n        validateStreamName(stream);\n        if (cfg.deliver_group && cfg.flow_control) {\n            throw new Error(\"jetstream flow control is not supported with queue groups\");\n        }\n        if (cfg.deliver_group && cfg.idle_heartbeat) {\n            throw new Error(\"jetstream idle heartbeat is not supported with queue groups\");\n        }\n        const cr = {};\n        cr.config = cfg;\n        cr.stream_name = stream;\n        cr.action = action;\n        if (cr.config.durable_name) {\n            validateDurableName(cr.config.durable_name);\n        }\n        const nci = this.nc;\n        let { min, ok: newAPI } = nci.features.get(Feature.JS_NEW_CONSUMER_CREATE_API);\n        const name = cfg.name === \"\" ? undefined : cfg.name;\n        if (name && !newAPI) {\n            throw new Error(`consumer 'name' requires server ${min}`);\n        }\n        if (name) {\n            try {\n                minValidation(\"name\", name);\n            } catch (err) {\n                const m = err.message;\n                const idx = m.indexOf(\"cannot contain\");\n                if (idx !== -1) {\n                    throw new Error(`consumer 'name' ${m.substring(idx)}`);\n                }\n                throw err;\n            }\n        }\n        let subj;\n        let consumerName = \"\";\n        if (Array.isArray(cfg.filter_subjects)) {\n            const { min, ok } = nci.features.get(Feature.JS_MULTIPLE_CONSUMER_FILTER);\n            if (!ok) {\n                throw new Error(`consumer 'filter_subjects' requires server ${min}`);\n            }\n            newAPI = false;\n        }\n        if (cfg.metadata) {\n            const { min, ok } = nci.features.get(Feature.JS_STREAM_CONSUMER_METADATA);\n            if (!ok) {\n                throw new Error(`consumer 'metadata' requires server ${min}`);\n            }\n        }\n        if (newAPI) {\n            consumerName = cfg.name ?? cfg.durable_name ?? \"\";\n        }\n        if (consumerName !== \"\") {\n            let fs = cfg.filter_subject ?? undefined;\n            if (fs === \">\") {\n                fs = undefined;\n            }\n            subj = fs !== undefined ? `${this.prefix}.CONSUMER.CREATE.${stream}.${consumerName}.${fs}` : `${this.prefix}.CONSUMER.CREATE.${stream}.${consumerName}`;\n        } else {\n            subj = cfg.durable_name ? `${this.prefix}.CONSUMER.DURABLE.CREATE.${stream}.${cfg.durable_name}` : `${this.prefix}.CONSUMER.CREATE.${stream}`;\n        }\n        const r = await this._request(subj, cr);\n        return r;\n    }\n    async update(stream, durable, cfg) {\n        const ci = await this.info(stream, durable);\n        const changable = cfg;\n        return this.add(stream, Object.assign(ci.config, changable), ConsumerApiAction.Update);\n    }\n    async info(stream, name) {\n        validateStreamName(stream);\n        validateDurableName(name);\n        const r = await this._request(`${this.prefix}.CONSUMER.INFO.${stream}.${name}`);\n        return r;\n    }\n    async delete(stream, name) {\n        validateStreamName(stream);\n        validateDurableName(name);\n        const r = await this._request(`${this.prefix}.CONSUMER.DELETE.${stream}.${name}`);\n        const cr = r;\n        return cr.success;\n    }\n    list(stream) {\n        validateStreamName(stream);\n        const filter = (v)=>{\n            const clr = v;\n            return clr.consumers;\n        };\n        const subj = `${this.prefix}.CONSUMER.LIST.${stream}`;\n        return new ListerImpl(subj, filter, this);\n    }\n    pause(stream, name, until) {\n        const subj = `${this.prefix}.CONSUMER.PAUSE.${stream}.${name}`;\n        const opts = {\n            pause_until: until.toISOString()\n        };\n        return this._request(subj, opts);\n    }\n    resume(stream, name) {\n        return this.pause(stream, name, new Date(0));\n    }\n}\nfunction checkFn(fn, name, required = false) {\n    if (required === true && !fn) {\n        throw NatsError.errorForCode(ErrorCode.ApiError, new Error(`${name} is not a function`));\n    }\n    if (fn && typeof fn !== \"function\") {\n        throw NatsError.errorForCode(ErrorCode.ApiError, new Error(`${name} is not a function`));\n    }\n}\nclass TypedSubscription extends QueuedIteratorImpl {\n    sub;\n    adapter;\n    subIterDone;\n    constructor(nc, subject, opts){\n        super();\n        checkFn(opts.adapter, \"adapter\", true);\n        this.adapter = opts.adapter;\n        if (opts.callback) {\n            checkFn(opts.callback, \"callback\");\n        }\n        this.noIterator = typeof opts.callback === \"function\";\n        if (opts.ingestionFilterFn) {\n            checkFn(opts.ingestionFilterFn, \"ingestionFilterFn\");\n            this.ingestionFilterFn = opts.ingestionFilterFn;\n        }\n        if (opts.protocolFilterFn) {\n            checkFn(opts.protocolFilterFn, \"protocolFilterFn\");\n            this.protocolFilterFn = opts.protocolFilterFn;\n        }\n        if (opts.dispatchedFn) {\n            checkFn(opts.dispatchedFn, \"dispatchedFn\");\n            this.dispatchedFn = opts.dispatchedFn;\n        }\n        if (opts.cleanupFn) {\n            checkFn(opts.cleanupFn, \"cleanupFn\");\n        }\n        let callback = (err, msg)=>{\n            this.callback(err, msg);\n        };\n        if (opts.callback) {\n            const uh = opts.callback;\n            callback = (err, msg)=>{\n                const [jer, tm] = this.adapter(err, msg);\n                if (jer) {\n                    uh(jer, null);\n                    return;\n                }\n                const { ingest } = this.ingestionFilterFn ? this.ingestionFilterFn(tm, this) : {\n                    ingest: true\n                };\n                if (ingest) {\n                    const ok = this.protocolFilterFn ? this.protocolFilterFn(tm) : true;\n                    if (ok) {\n                        uh(jer, tm);\n                        if (this.dispatchedFn && tm) {\n                            this.dispatchedFn(tm);\n                        }\n                    }\n                }\n            };\n        }\n        const { max, queue, timeout } = opts;\n        const sopts = {\n            queue,\n            timeout,\n            callback\n        };\n        if (max && max > 0) {\n            sopts.max = max;\n        }\n        this.sub = nc.subscribe(subject, sopts);\n        if (opts.cleanupFn) {\n            this.sub.cleanupFn = opts.cleanupFn;\n        }\n        if (!this.noIterator) {\n            this.iterClosed.then(()=>{\n                this.unsubscribe();\n            });\n        }\n        this.subIterDone = deferred();\n        Promise.all([\n            this.sub.closed,\n            this.iterClosed\n        ]).then(()=>{\n            this.subIterDone.resolve();\n        }).catch(()=>{\n            this.subIterDone.resolve();\n        });\n        (async (s)=>{\n            await s.closed;\n            this.stop();\n        })(this.sub).then().catch();\n    }\n    unsubscribe(max) {\n        this.sub.unsubscribe(max);\n    }\n    drain() {\n        return this.sub.drain();\n    }\n    isDraining() {\n        return this.sub.isDraining();\n    }\n    isClosed() {\n        return this.sub.isClosed();\n    }\n    callback(e, msg) {\n        this.sub.cancelTimeout();\n        const [err, tm] = this.adapter(e, msg);\n        if (err) {\n            this.stop(err);\n        }\n        if (tm) {\n            this.push(tm);\n        }\n    }\n    getSubject() {\n        return this.sub.getSubject();\n    }\n    getReceived() {\n        return this.sub.getReceived();\n    }\n    getProcessed() {\n        return this.sub.getProcessed();\n    }\n    getPending() {\n        return this.sub.getPending();\n    }\n    getID() {\n        return this.sub.getID();\n    }\n    getMax() {\n        return this.sub.getMax();\n    }\n    get closed() {\n        return this.sub.closed;\n    }\n}\nlet transportConfig;\nfunction setTransportFactory(config) {\n    transportConfig = config;\n}\nfunction defaultPort() {\n    return transportConfig !== undefined && transportConfig.defaultPort !== undefined ? transportConfig.defaultPort : 4222;\n}\nfunction getUrlParseFn() {\n    return transportConfig !== undefined && transportConfig.urlParseFn ? transportConfig.urlParseFn : undefined;\n}\nfunction newTransport() {\n    if (!transportConfig || typeof transportConfig.factory !== \"function\") {\n        throw new Error(\"transport fn is not set\");\n    }\n    return transportConfig.factory();\n}\nfunction getResolveFn() {\n    return transportConfig !== undefined && transportConfig.dnsResolveFn ? transportConfig.dnsResolveFn : undefined;\n}\nconst CR_LF = \"\\r\\n\";\nCR_LF.length;\nconst CRLF = DataBuffer.fromAscii(CR_LF);\nconst CR = new Uint8Array(CRLF)[0];\nconst LF = new Uint8Array(CRLF)[1];\nfunction protoLen(ba) {\n    for(let i = 0; i < ba.length; i++){\n        const n = i + 1;\n        if (ba.byteLength > n && ba[i] === CR && ba[n] === LF) {\n            return n + 1;\n        }\n    }\n    return 0;\n}\nfunction extractProtocolMessage(a) {\n    const len = protoLen(a);\n    if (len > 0) {\n        const ba = new Uint8Array(a);\n        const out = ba.slice(0, len);\n        return TD.decode(out);\n    }\n    return \"\";\n}\nconst IPv4LEN = 4;\nconst ASCII0 = 48;\nconst ASCIIA = 65;\nconst ASCIIa = 97;\nfunction ipV4(a, b, c, d) {\n    const ip = new Uint8Array(16);\n    const prefix = [\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0xff,\n        0xff\n    ];\n    prefix.forEach((v, idx)=>{\n        ip[idx] = v;\n    });\n    ip[12] = a;\n    ip[13] = b;\n    ip[14] = c;\n    ip[15] = d;\n    return ip;\n}\nfunction isIP(h) {\n    return parseIP(h) !== undefined;\n}\nfunction parseIP(h) {\n    for(let i = 0; i < h.length; i++){\n        switch(h[i]){\n            case \".\":\n                return parseIPv4(h);\n            case \":\":\n                return parseIPv6(h);\n        }\n    }\n    return;\n}\nfunction parseIPv4(s) {\n    const ip = new Uint8Array(4);\n    for(let i = 0; i < 4; i++){\n        if (s.length === 0) {\n            return undefined;\n        }\n        if (i > 0) {\n            if (s[0] !== \".\") {\n                return undefined;\n            }\n            s = s.substring(1);\n        }\n        const { n, c, ok } = dtoi(s);\n        if (!ok || n > 0xFF) {\n            return undefined;\n        }\n        s = s.substring(c);\n        ip[i] = n;\n    }\n    return ipV4(ip[0], ip[1], ip[2], ip[3]);\n}\nfunction parseIPv6(s) {\n    const ip = new Uint8Array(16);\n    let ellipsis = -1;\n    if (s.length >= 2 && s[0] === \":\" && s[1] === \":\") {\n        ellipsis = 0;\n        s = s.substring(2);\n        if (s.length === 0) {\n            return ip;\n        }\n    }\n    let i = 0;\n    while(i < 16){\n        const { n, c, ok } = xtoi(s);\n        if (!ok || n > 0xFFFF) {\n            return undefined;\n        }\n        if (c < s.length && s[c] === \".\") {\n            if (ellipsis < 0 && i != 16 - 4) {\n                return undefined;\n            }\n            if (i + 4 > 16) {\n                return undefined;\n            }\n            const ip4 = parseIPv4(s);\n            if (ip4 === undefined) {\n                return undefined;\n            }\n            ip[i] = ip4[12];\n            ip[i + 1] = ip4[13];\n            ip[i + 2] = ip4[14];\n            ip[i + 3] = ip4[15];\n            s = \"\";\n            i += IPv4LEN;\n            break;\n        }\n        ip[i] = n >> 8;\n        ip[i + 1] = n;\n        i += 2;\n        s = s.substring(c);\n        if (s.length === 0) {\n            break;\n        }\n        if (s[0] !== \":\" || s.length == 1) {\n            return undefined;\n        }\n        s = s.substring(1);\n        if (s[0] === \":\") {\n            if (ellipsis >= 0) {\n                return undefined;\n            }\n            ellipsis = i;\n            s = s.substring(1);\n            if (s.length === 0) {\n                break;\n            }\n        }\n    }\n    if (s.length !== 0) {\n        return undefined;\n    }\n    if (i < 16) {\n        if (ellipsis < 0) {\n            return undefined;\n        }\n        const n = 16 - i;\n        for(let j = i - 1; j >= ellipsis; j--){\n            ip[j + n] = ip[j];\n        }\n        for(let j = ellipsis + n - 1; j >= ellipsis; j--){\n            ip[j] = 0;\n        }\n    } else if (ellipsis >= 0) {\n        return undefined;\n    }\n    return ip;\n}\nfunction dtoi(s) {\n    let i = 0;\n    let n = 0;\n    for(i = 0; i < s.length && 48 <= s.charCodeAt(i) && s.charCodeAt(i) <= 57; i++){\n        n = n * 10 + (s.charCodeAt(i) - ASCII0);\n        if (n >= 0xFFFFFF) {\n            return {\n                n: 0xFFFFFF,\n                c: i,\n                ok: false\n            };\n        }\n    }\n    if (i === 0) {\n        return {\n            n: 0,\n            c: 0,\n            ok: false\n        };\n    }\n    return {\n        n: n,\n        c: i,\n        ok: true\n    };\n}\nfunction xtoi(s) {\n    let n = 0;\n    let i = 0;\n    for(i = 0; i < s.length; i++){\n        if (48 <= s.charCodeAt(i) && s.charCodeAt(i) <= 57) {\n            n *= 16;\n            n += s.charCodeAt(i) - ASCII0;\n        } else if (97 <= s.charCodeAt(i) && s.charCodeAt(i) <= 102) {\n            n *= 16;\n            n += s.charCodeAt(i) - ASCIIa + 10;\n        } else if (65 <= s.charCodeAt(i) && s.charCodeAt(i) <= 70) {\n            n *= 16;\n            n += s.charCodeAt(i) - ASCIIA + 10;\n        } else {\n            break;\n        }\n        if (n >= 0xFFFFFF) {\n            return {\n                n: 0,\n                c: i,\n                ok: false\n            };\n        }\n    }\n    if (i === 0) {\n        return {\n            n: 0,\n            c: i,\n            ok: false\n        };\n    }\n    return {\n        n: n,\n        c: i,\n        ok: true\n    };\n}\nfunction isIPV4OrHostname(hp) {\n    if (hp.indexOf(\"[\") !== -1 || hp.indexOf(\"::\") !== -1) {\n        return false;\n    }\n    if (hp.indexOf(\".\") !== -1) {\n        return true;\n    }\n    if (hp.split(\":\").length <= 2) {\n        return true;\n    }\n    return false;\n}\nfunction isIPV6(hp) {\n    return !isIPV4OrHostname(hp);\n}\nfunction filterIpv6MappedToIpv4(hp) {\n    const prefix = \"::FFFF:\";\n    const idx = hp.toUpperCase().indexOf(prefix);\n    if (idx !== -1 && hp.indexOf(\".\") !== -1) {\n        let ip = hp.substring(idx + prefix.length);\n        ip = ip.replace(\"[\", \"\");\n        return ip.replace(\"]\", \"\");\n    }\n    return hp;\n}\nfunction hostPort(u) {\n    u = u.trim();\n    if (u.match(/^(.*:\\/\\/)(.*)/m)) {\n        u = u.replace(/^(.*:\\/\\/)(.*)/gm, \"$2\");\n    }\n    u = filterIpv6MappedToIpv4(u);\n    if (isIPV6(u) && u.indexOf(\"[\") === -1) {\n        u = `[${u}]`;\n    }\n    const op = isIPV6(u) ? u.match(/(]:)(\\d+)/) : u.match(/(:)(\\d+)/);\n    const port = op && op.length === 3 && op[1] && op[2] ? parseInt(op[2]) : 4222;\n    const protocol = port === 80 ? \"https\" : \"http\";\n    const url = new URL(`${protocol}://${u}`);\n    url.port = `${port}`;\n    let hostname = url.hostname;\n    if (hostname.charAt(0) === \"[\") {\n        hostname = hostname.substring(1, hostname.length - 1);\n    }\n    const listen = url.host;\n    return {\n        listen,\n        hostname,\n        port\n    };\n}\nclass ServerImpl {\n    src;\n    listen;\n    hostname;\n    port;\n    didConnect;\n    reconnects;\n    lastConnect;\n    gossiped;\n    tlsName;\n    resolves;\n    constructor(u, gossiped = false){\n        this.src = u;\n        this.tlsName = \"\";\n        const v = hostPort(u);\n        this.listen = v.listen;\n        this.hostname = v.hostname;\n        this.port = v.port;\n        this.didConnect = false;\n        this.reconnects = 0;\n        this.lastConnect = 0;\n        this.gossiped = gossiped;\n    }\n    toString() {\n        return this.listen;\n    }\n    async resolve(opts) {\n        if (!opts.fn || opts.resolve === false) {\n            return [\n                this\n            ];\n        }\n        const buf = [];\n        if (isIP(this.hostname)) {\n            return [\n                this\n            ];\n        } else {\n            const ips = await opts.fn(this.hostname);\n            if (opts.debug) {\n                console.log(`resolve ${this.hostname} = ${ips.join(\",\")}`);\n            }\n            for (const ip of ips){\n                const proto = this.port === 80 ? \"https\" : \"http\";\n                const url = new URL(`${proto}://${isIPV6(ip) ? \"[\" + ip + \"]\" : ip}`);\n                url.port = `${this.port}`;\n                const ss = new ServerImpl(url.host, false);\n                ss.tlsName = this.hostname;\n                buf.push(ss);\n            }\n        }\n        if (opts.randomize) {\n            shuffle(buf);\n        }\n        this.resolves = buf;\n        return buf;\n    }\n}\nclass Servers {\n    firstSelect;\n    servers;\n    currentServer;\n    tlsName;\n    randomize;\n    constructor(listens = [], opts = {}){\n        this.firstSelect = true;\n        this.servers = [];\n        this.tlsName = \"\";\n        this.randomize = opts.randomize || false;\n        const urlParseFn = getUrlParseFn();\n        if (listens) {\n            listens.forEach((hp)=>{\n                hp = urlParseFn ? urlParseFn(hp) : hp;\n                this.servers.push(new ServerImpl(hp));\n            });\n            if (this.randomize) {\n                this.servers = shuffle(this.servers);\n            }\n        }\n        if (this.servers.length === 0) {\n            this.addServer(`${DEFAULT_HOST}:${defaultPort()}`, false);\n        }\n        this.currentServer = this.servers[0];\n    }\n    clear() {\n        this.servers.length = 0;\n    }\n    updateTLSName() {\n        const cs = this.getCurrentServer();\n        if (!isIP(cs.hostname)) {\n            this.tlsName = cs.hostname;\n            this.servers.forEach((s)=>{\n                if (s.gossiped) {\n                    s.tlsName = this.tlsName;\n                }\n            });\n        }\n    }\n    getCurrentServer() {\n        return this.currentServer;\n    }\n    addServer(u, implicit = false) {\n        const urlParseFn = getUrlParseFn();\n        u = urlParseFn ? urlParseFn(u) : u;\n        const s = new ServerImpl(u, implicit);\n        if (isIP(s.hostname)) {\n            s.tlsName = this.tlsName;\n        }\n        this.servers.push(s);\n    }\n    selectServer() {\n        if (this.firstSelect) {\n            this.firstSelect = false;\n            return this.currentServer;\n        }\n        const t = this.servers.shift();\n        if (t) {\n            this.servers.push(t);\n            this.currentServer = t;\n        }\n        return t;\n    }\n    removeCurrentServer() {\n        this.removeServer(this.currentServer);\n    }\n    removeServer(server) {\n        if (server) {\n            const index = this.servers.indexOf(server);\n            this.servers.splice(index, 1);\n        }\n    }\n    length() {\n        return this.servers.length;\n    }\n    next() {\n        return this.servers.length ? this.servers[0] : undefined;\n    }\n    getServers() {\n        return this.servers;\n    }\n    update(info, encrypted) {\n        const added = [];\n        let deleted = [];\n        const urlParseFn = getUrlParseFn();\n        const discovered = new Map();\n        if (info.connect_urls && info.connect_urls.length > 0) {\n            info.connect_urls.forEach((hp)=>{\n                hp = urlParseFn ? urlParseFn(hp, encrypted) : hp;\n                const s = new ServerImpl(hp, true);\n                discovered.set(hp, s);\n            });\n        }\n        const toDelete = [];\n        this.servers.forEach((s, index)=>{\n            const u = s.listen;\n            if (s.gossiped && this.currentServer.listen !== u && discovered.get(u) === undefined) {\n                toDelete.push(index);\n            }\n            discovered.delete(u);\n        });\n        toDelete.reverse();\n        toDelete.forEach((index)=>{\n            const removed = this.servers.splice(index, 1);\n            deleted = deleted.concat(removed[0].listen);\n        });\n        discovered.forEach((v, k)=>{\n            this.servers.push(v);\n            added.push(k);\n        });\n        return {\n            added,\n            deleted\n        };\n    }\n}\nclass MuxSubscription {\n    baseInbox;\n    reqs;\n    constructor(){\n        this.reqs = new Map();\n    }\n    size() {\n        return this.reqs.size;\n    }\n    init(prefix) {\n        this.baseInbox = `${createInbox(prefix)}.`;\n        return this.baseInbox;\n    }\n    add(r) {\n        if (!isNaN(r.received)) {\n            r.received = 0;\n        }\n        this.reqs.set(r.token, r);\n    }\n    get(token) {\n        return this.reqs.get(token);\n    }\n    cancel(r) {\n        this.reqs.delete(r.token);\n    }\n    getToken(m) {\n        const s = m.subject || \"\";\n        if (s.indexOf(this.baseInbox) === 0) {\n            return s.substring(this.baseInbox.length);\n        }\n        return null;\n    }\n    all() {\n        return Array.from(this.reqs.values());\n    }\n    handleError(isMuxPermissionError, err) {\n        if (err && err.permissionContext) {\n            if (isMuxPermissionError) {\n                this.all().forEach((r)=>{\n                    r.resolver(err, {});\n                });\n                return true;\n            }\n            const ctx = err.permissionContext;\n            if (ctx.operation === \"publish\") {\n                const req = this.all().find((s)=>{\n                    return s.requestSubject === ctx.subject;\n                });\n                if (req) {\n                    req.resolver(err, {});\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    dispatcher() {\n        return (err, m)=>{\n            const token = this.getToken(m);\n            if (token) {\n                const r = this.get(token);\n                if (r) {\n                    if (err === null && m.headers) {\n                        err = isRequestError(m);\n                    }\n                    r.resolver(err, m);\n                }\n            }\n        };\n    }\n    close() {\n        const err = NatsError.errorForCode(ErrorCode.Timeout);\n        this.reqs.forEach((req)=>{\n            req.resolver(err, {});\n        });\n    }\n}\nclass Heartbeat {\n    ph;\n    interval;\n    maxOut;\n    timer;\n    pendings;\n    constructor(ph, interval, maxOut){\n        this.ph = ph;\n        this.interval = interval;\n        this.maxOut = maxOut;\n        this.pendings = [];\n    }\n    start() {\n        this.cancel();\n        this._schedule();\n    }\n    cancel(stale) {\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = undefined;\n        }\n        this._reset();\n        if (stale) {\n            this.ph.disconnect();\n        }\n    }\n    _schedule() {\n        this.timer = setTimeout(()=>{\n            this.ph.dispatchStatus({\n                type: DebugEvents.PingTimer,\n                data: `${this.pendings.length + 1}`\n            });\n            if (this.pendings.length === this.maxOut) {\n                this.cancel(true);\n                return;\n            }\n            const ping = deferred();\n            this.ph.flush(ping).then(()=>{\n                this._reset();\n            }).catch(()=>{\n                this.cancel();\n            });\n            this.pendings.push(ping);\n            this._schedule();\n        }, this.interval);\n    }\n    _reset() {\n        this.pendings = this.pendings.filter((p)=>{\n            const d = p;\n            d.resolve();\n            return false;\n        });\n    }\n}\nclass AssertionError extends Error {\n    constructor(msg){\n        super(msg);\n        this.name = \"AssertionError\";\n    }\n}\nfunction assert(cond, msg = \"Assertion failed.\") {\n    if (!cond) {\n        throw new AssertionError(msg);\n    }\n}\nconst MIN_READ = 32 * 1024;\nconst MAX_SIZE = 2 ** 32 - 2;\nfunction copy(src, dst, off = 0) {\n    const r = dst.byteLength - off;\n    if (src.byteLength > r) {\n        src = src.subarray(0, r);\n    }\n    dst.set(src, off);\n    return src.byteLength;\n}\nclass DenoBuffer {\n    _buf;\n    _off;\n    constructor(ab){\n        this._off = 0;\n        if (ab == null) {\n            this._buf = new Uint8Array(0);\n            return;\n        }\n        this._buf = new Uint8Array(ab);\n    }\n    bytes(options = {\n        copy: true\n    }) {\n        if (options.copy === false) return this._buf.subarray(this._off);\n        return this._buf.slice(this._off);\n    }\n    empty() {\n        return this._buf.byteLength <= this._off;\n    }\n    get length() {\n        return this._buf.byteLength - this._off;\n    }\n    get capacity() {\n        return this._buf.buffer.byteLength;\n    }\n    truncate(n) {\n        if (n === 0) {\n            this.reset();\n            return;\n        }\n        if (n < 0 || n > this.length) {\n            throw Error(\"bytes.Buffer: truncation out of range\");\n        }\n        this._reslice(this._off + n);\n    }\n    reset() {\n        this._reslice(0);\n        this._off = 0;\n    }\n    _tryGrowByReslice(n) {\n        const l = this._buf.byteLength;\n        if (n <= this.capacity - l) {\n            this._reslice(l + n);\n            return l;\n        }\n        return -1;\n    }\n    _reslice(len) {\n        assert(len <= this._buf.buffer.byteLength);\n        this._buf = new Uint8Array(this._buf.buffer, 0, len);\n    }\n    readByte() {\n        const a = new Uint8Array(1);\n        if (this.read(a)) {\n            return a[0];\n        }\n        return null;\n    }\n    read(p) {\n        if (this.empty()) {\n            this.reset();\n            if (p.byteLength === 0) {\n                return 0;\n            }\n            return null;\n        }\n        const nread = copy(this._buf.subarray(this._off), p);\n        this._off += nread;\n        return nread;\n    }\n    writeByte(n) {\n        return this.write(Uint8Array.of(n));\n    }\n    writeString(s) {\n        return this.write(TE.encode(s));\n    }\n    write(p) {\n        const m = this._grow(p.byteLength);\n        return copy(p, this._buf, m);\n    }\n    _grow(n) {\n        const m = this.length;\n        if (m === 0 && this._off !== 0) {\n            this.reset();\n        }\n        const i = this._tryGrowByReslice(n);\n        if (i >= 0) {\n            return i;\n        }\n        const c = this.capacity;\n        if (n <= Math.floor(c / 2) - m) {\n            copy(this._buf.subarray(this._off), this._buf);\n        } else if (c + n > MAX_SIZE) {\n            throw new Error(\"The buffer cannot be grown beyond the maximum size.\");\n        } else {\n            const buf = new Uint8Array(Math.min(2 * c + n, MAX_SIZE));\n            copy(this._buf.subarray(this._off), buf);\n            this._buf = buf;\n        }\n        this._off = 0;\n        this._reslice(Math.min(m + n, MAX_SIZE));\n        return m;\n    }\n    grow(n) {\n        if (n < 0) {\n            throw Error(\"Buffer._grow: negative count\");\n        }\n        const m = this._grow(n);\n        this._reslice(m);\n    }\n    readFrom(r) {\n        let n = 0;\n        const tmp = new Uint8Array(MIN_READ);\n        while(true){\n            const shouldGrow = this.capacity - this.length < MIN_READ;\n            const buf = shouldGrow ? tmp : new Uint8Array(this._buf.buffer, this.length);\n            const nread = r.read(buf);\n            if (nread === null) {\n                return n;\n            }\n            if (shouldGrow) this.write(buf.subarray(0, nread));\n            else this._reslice(this.length + nread);\n            n += nread;\n        }\n    }\n}\nvar Kind;\n(function(Kind) {\n    Kind[Kind[\"OK\"] = 0] = \"OK\";\n    Kind[Kind[\"ERR\"] = 1] = \"ERR\";\n    Kind[Kind[\"MSG\"] = 2] = \"MSG\";\n    Kind[Kind[\"INFO\"] = 3] = \"INFO\";\n    Kind[Kind[\"PING\"] = 4] = \"PING\";\n    Kind[Kind[\"PONG\"] = 5] = \"PONG\";\n})(Kind || (Kind = {}));\nfunction newMsgArg() {\n    const ma = {};\n    ma.sid = -1;\n    ma.hdr = -1;\n    ma.size = -1;\n    return ma;\n}\nconst ASCII_0 = 48;\nclass Parser {\n    dispatcher;\n    state;\n    as;\n    drop;\n    hdr;\n    ma;\n    argBuf;\n    msgBuf;\n    constructor(dispatcher){\n        this.dispatcher = dispatcher;\n        this.state = State.OP_START;\n        this.as = 0;\n        this.drop = 0;\n        this.hdr = 0;\n    }\n    parse(buf) {\n        let i;\n        for(i = 0; i < buf.length; i++){\n            const b = buf[i];\n            switch(this.state){\n                case State.OP_START:\n                    switch(b){\n                        case cc.M:\n                        case cc.m:\n                            this.state = State.OP_M;\n                            this.hdr = -1;\n                            this.ma = newMsgArg();\n                            break;\n                        case cc.H:\n                        case cc.h:\n                            this.state = State.OP_H;\n                            this.hdr = 0;\n                            this.ma = newMsgArg();\n                            break;\n                        case cc.P:\n                        case cc.p:\n                            this.state = State.OP_P;\n                            break;\n                        case cc.PLUS:\n                            this.state = State.OP_PLUS;\n                            break;\n                        case cc.MINUS:\n                            this.state = State.OP_MINUS;\n                            break;\n                        case cc.I:\n                        case cc.i:\n                            this.state = State.OP_I;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_H:\n                    switch(b){\n                        case cc.M:\n                        case cc.m:\n                            this.state = State.OP_M;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_M:\n                    switch(b){\n                        case cc.S:\n                        case cc.s:\n                            this.state = State.OP_MS;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MS:\n                    switch(b){\n                        case cc.G:\n                        case cc.g:\n                            this.state = State.OP_MSG;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MSG:\n                    switch(b){\n                        case cc.SPACE:\n                        case cc.TAB:\n                            this.state = State.OP_MSG_SPC;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MSG_SPC:\n                    switch(b){\n                        case cc.SPACE:\n                        case cc.TAB:\n                            continue;\n                        default:\n                            this.state = State.MSG_ARG;\n                            this.as = i;\n                    }\n                    break;\n                case State.MSG_ARG:\n                    switch(b){\n                        case cc.CR:\n                            this.drop = 1;\n                            break;\n                        case cc.NL:\n                            {\n                                const arg = this.argBuf ? this.argBuf.bytes() : buf.subarray(this.as, i - this.drop);\n                                this.processMsgArgs(arg);\n                                this.drop = 0;\n                                this.as = i + 1;\n                                this.state = State.MSG_PAYLOAD;\n                                i = this.as + this.ma.size - 1;\n                                break;\n                            }\n                        default:\n                            if (this.argBuf) {\n                                this.argBuf.writeByte(b);\n                            }\n                    }\n                    break;\n                case State.MSG_PAYLOAD:\n                    if (this.msgBuf) {\n                        if (this.msgBuf.length >= this.ma.size) {\n                            const data = this.msgBuf.bytes({\n                                copy: false\n                            });\n                            this.dispatcher.push({\n                                kind: Kind.MSG,\n                                msg: this.ma,\n                                data: data\n                            });\n                            this.argBuf = undefined;\n                            this.msgBuf = undefined;\n                            this.state = State.MSG_END;\n                        } else {\n                            let toCopy = this.ma.size - this.msgBuf.length;\n                            const avail = buf.length - i;\n                            if (avail < toCopy) {\n                                toCopy = avail;\n                            }\n                            if (toCopy > 0) {\n                                this.msgBuf.write(buf.subarray(i, i + toCopy));\n                                i = i + toCopy - 1;\n                            } else {\n                                this.msgBuf.writeByte(b);\n                            }\n                        }\n                    } else if (i - this.as >= this.ma.size) {\n                        this.dispatcher.push({\n                            kind: Kind.MSG,\n                            msg: this.ma,\n                            data: buf.subarray(this.as, i)\n                        });\n                        this.argBuf = undefined;\n                        this.msgBuf = undefined;\n                        this.state = State.MSG_END;\n                    }\n                    break;\n                case State.MSG_END:\n                    switch(b){\n                        case cc.NL:\n                            this.drop = 0;\n                            this.as = i + 1;\n                            this.state = State.OP_START;\n                            break;\n                        default:\n                            continue;\n                    }\n                    break;\n                case State.OP_PLUS:\n                    switch(b){\n                        case cc.O:\n                        case cc.o:\n                            this.state = State.OP_PLUS_O;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PLUS_O:\n                    switch(b){\n                        case cc.K:\n                        case cc.k:\n                            this.state = State.OP_PLUS_OK;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PLUS_OK:\n                    switch(b){\n                        case cc.NL:\n                            this.dispatcher.push({\n                                kind: Kind.OK\n                            });\n                            this.drop = 0;\n                            this.state = State.OP_START;\n                            break;\n                    }\n                    break;\n                case State.OP_MINUS:\n                    switch(b){\n                        case cc.E:\n                        case cc.e:\n                            this.state = State.OP_MINUS_E;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MINUS_E:\n                    switch(b){\n                        case cc.R:\n                        case cc.r:\n                            this.state = State.OP_MINUS_ER;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MINUS_ER:\n                    switch(b){\n                        case cc.R:\n                        case cc.r:\n                            this.state = State.OP_MINUS_ERR;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MINUS_ERR:\n                    switch(b){\n                        case cc.SPACE:\n                        case cc.TAB:\n                            this.state = State.OP_MINUS_ERR_SPC;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_MINUS_ERR_SPC:\n                    switch(b){\n                        case cc.SPACE:\n                        case cc.TAB:\n                            continue;\n                        default:\n                            this.state = State.MINUS_ERR_ARG;\n                            this.as = i;\n                    }\n                    break;\n                case State.MINUS_ERR_ARG:\n                    switch(b){\n                        case cc.CR:\n                            this.drop = 1;\n                            break;\n                        case cc.NL:\n                            {\n                                let arg;\n                                if (this.argBuf) {\n                                    arg = this.argBuf.bytes();\n                                    this.argBuf = undefined;\n                                } else {\n                                    arg = buf.subarray(this.as, i - this.drop);\n                                }\n                                this.dispatcher.push({\n                                    kind: Kind.ERR,\n                                    data: arg\n                                });\n                                this.drop = 0;\n                                this.as = i + 1;\n                                this.state = State.OP_START;\n                                break;\n                            }\n                        default:\n                            if (this.argBuf) {\n                                this.argBuf.write(Uint8Array.of(b));\n                            }\n                    }\n                    break;\n                case State.OP_P:\n                    switch(b){\n                        case cc.I:\n                        case cc.i:\n                            this.state = State.OP_PI;\n                            break;\n                        case cc.O:\n                        case cc.o:\n                            this.state = State.OP_PO;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PO:\n                    switch(b){\n                        case cc.N:\n                        case cc.n:\n                            this.state = State.OP_PON;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PON:\n                    switch(b){\n                        case cc.G:\n                        case cc.g:\n                            this.state = State.OP_PONG;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PONG:\n                    switch(b){\n                        case cc.NL:\n                            this.dispatcher.push({\n                                kind: Kind.PONG\n                            });\n                            this.drop = 0;\n                            this.state = State.OP_START;\n                            break;\n                    }\n                    break;\n                case State.OP_PI:\n                    switch(b){\n                        case cc.N:\n                        case cc.n:\n                            this.state = State.OP_PIN;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PIN:\n                    switch(b){\n                        case cc.G:\n                        case cc.g:\n                            this.state = State.OP_PING;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_PING:\n                    switch(b){\n                        case cc.NL:\n                            this.dispatcher.push({\n                                kind: Kind.PING\n                            });\n                            this.drop = 0;\n                            this.state = State.OP_START;\n                            break;\n                    }\n                    break;\n                case State.OP_I:\n                    switch(b){\n                        case cc.N:\n                        case cc.n:\n                            this.state = State.OP_IN;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_IN:\n                    switch(b){\n                        case cc.F:\n                        case cc.f:\n                            this.state = State.OP_INF;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_INF:\n                    switch(b){\n                        case cc.O:\n                        case cc.o:\n                            this.state = State.OP_INFO;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_INFO:\n                    switch(b){\n                        case cc.SPACE:\n                        case cc.TAB:\n                            this.state = State.OP_INFO_SPC;\n                            break;\n                        default:\n                            throw this.fail(buf.subarray(i));\n                    }\n                    break;\n                case State.OP_INFO_SPC:\n                    switch(b){\n                        case cc.SPACE:\n                        case cc.TAB:\n                            continue;\n                        default:\n                            this.state = State.INFO_ARG;\n                            this.as = i;\n                    }\n                    break;\n                case State.INFO_ARG:\n                    switch(b){\n                        case cc.CR:\n                            this.drop = 1;\n                            break;\n                        case cc.NL:\n                            {\n                                let arg;\n                                if (this.argBuf) {\n                                    arg = this.argBuf.bytes();\n                                    this.argBuf = undefined;\n                                } else {\n                                    arg = buf.subarray(this.as, i - this.drop);\n                                }\n                                this.dispatcher.push({\n                                    kind: Kind.INFO,\n                                    data: arg\n                                });\n                                this.drop = 0;\n                                this.as = i + 1;\n                                this.state = State.OP_START;\n                                break;\n                            }\n                        default:\n                            if (this.argBuf) {\n                                this.argBuf.writeByte(b);\n                            }\n                    }\n                    break;\n                default:\n                    throw this.fail(buf.subarray(i));\n            }\n        }\n        if ((this.state === State.MSG_ARG || this.state === State.MINUS_ERR_ARG || this.state === State.INFO_ARG) && !this.argBuf) {\n            this.argBuf = new DenoBuffer(buf.subarray(this.as, i - this.drop));\n        }\n        if (this.state === State.MSG_PAYLOAD && !this.msgBuf) {\n            if (!this.argBuf) {\n                this.cloneMsgArg();\n            }\n            this.msgBuf = new DenoBuffer(buf.subarray(this.as));\n        }\n    }\n    cloneMsgArg() {\n        const s = this.ma.subject.length;\n        const r = this.ma.reply ? this.ma.reply.length : 0;\n        const buf = new Uint8Array(s + r);\n        buf.set(this.ma.subject);\n        if (this.ma.reply) {\n            buf.set(this.ma.reply, s);\n        }\n        this.argBuf = new DenoBuffer(buf);\n        this.ma.subject = buf.subarray(0, s);\n        if (this.ma.reply) {\n            this.ma.reply = buf.subarray(s);\n        }\n    }\n    processMsgArgs(arg) {\n        if (this.hdr >= 0) {\n            return this.processHeaderMsgArgs(arg);\n        }\n        const args = [];\n        let start = -1;\n        for(let i = 0; i < arg.length; i++){\n            const b = arg[i];\n            switch(b){\n                case cc.SPACE:\n                case cc.TAB:\n                case cc.CR:\n                case cc.NL:\n                    if (start >= 0) {\n                        args.push(arg.subarray(start, i));\n                        start = -1;\n                    }\n                    break;\n                default:\n                    if (start < 0) {\n                        start = i;\n                    }\n            }\n        }\n        if (start >= 0) {\n            args.push(arg.subarray(start));\n        }\n        switch(args.length){\n            case 3:\n                this.ma.subject = args[0];\n                this.ma.sid = this.protoParseInt(args[1]);\n                this.ma.reply = undefined;\n                this.ma.size = this.protoParseInt(args[2]);\n                break;\n            case 4:\n                this.ma.subject = args[0];\n                this.ma.sid = this.protoParseInt(args[1]);\n                this.ma.reply = args[2];\n                this.ma.size = this.protoParseInt(args[3]);\n                break;\n            default:\n                throw this.fail(arg, \"processMsgArgs Parse Error\");\n        }\n        if (this.ma.sid < 0) {\n            throw this.fail(arg, \"processMsgArgs Bad or Missing Sid Error\");\n        }\n        if (this.ma.size < 0) {\n            throw this.fail(arg, \"processMsgArgs Bad or Missing Size Error\");\n        }\n    }\n    fail(data, label = \"\") {\n        if (!label) {\n            label = `parse error [${this.state}]`;\n        } else {\n            label = `${label} [${this.state}]`;\n        }\n        return new Error(`${label}: ${TD.decode(data)}`);\n    }\n    processHeaderMsgArgs(arg) {\n        const args = [];\n        let start = -1;\n        for(let i = 0; i < arg.length; i++){\n            const b = arg[i];\n            switch(b){\n                case cc.SPACE:\n                case cc.TAB:\n                case cc.CR:\n                case cc.NL:\n                    if (start >= 0) {\n                        args.push(arg.subarray(start, i));\n                        start = -1;\n                    }\n                    break;\n                default:\n                    if (start < 0) {\n                        start = i;\n                    }\n            }\n        }\n        if (start >= 0) {\n            args.push(arg.subarray(start));\n        }\n        switch(args.length){\n            case 4:\n                this.ma.subject = args[0];\n                this.ma.sid = this.protoParseInt(args[1]);\n                this.ma.reply = undefined;\n                this.ma.hdr = this.protoParseInt(args[2]);\n                this.ma.size = this.protoParseInt(args[3]);\n                break;\n            case 5:\n                this.ma.subject = args[0];\n                this.ma.sid = this.protoParseInt(args[1]);\n                this.ma.reply = args[2];\n                this.ma.hdr = this.protoParseInt(args[3]);\n                this.ma.size = this.protoParseInt(args[4]);\n                break;\n            default:\n                throw this.fail(arg, \"processHeaderMsgArgs Parse Error\");\n        }\n        if (this.ma.sid < 0) {\n            throw this.fail(arg, \"processHeaderMsgArgs Bad or Missing Sid Error\");\n        }\n        if (this.ma.hdr < 0 || this.ma.hdr > this.ma.size) {\n            throw this.fail(arg, \"processHeaderMsgArgs Bad or Missing Header Size Error\");\n        }\n        if (this.ma.size < 0) {\n            throw this.fail(arg, \"processHeaderMsgArgs Bad or Missing Size Error\");\n        }\n    }\n    protoParseInt(a) {\n        if (a.length === 0) {\n            return -1;\n        }\n        let n = 0;\n        for(let i = 0; i < a.length; i++){\n            if (a[i] < 48 || a[i] > 57) {\n                return -1;\n            }\n            n = n * 10 + (a[i] - ASCII_0);\n        }\n        return n;\n    }\n}\nvar State;\n(function(State) {\n    State[State[\"OP_START\"] = 0] = \"OP_START\";\n    State[State[\"OP_PLUS\"] = 1] = \"OP_PLUS\";\n    State[State[\"OP_PLUS_O\"] = 2] = \"OP_PLUS_O\";\n    State[State[\"OP_PLUS_OK\"] = 3] = \"OP_PLUS_OK\";\n    State[State[\"OP_MINUS\"] = 4] = \"OP_MINUS\";\n    State[State[\"OP_MINUS_E\"] = 5] = \"OP_MINUS_E\";\n    State[State[\"OP_MINUS_ER\"] = 6] = \"OP_MINUS_ER\";\n    State[State[\"OP_MINUS_ERR\"] = 7] = \"OP_MINUS_ERR\";\n    State[State[\"OP_MINUS_ERR_SPC\"] = 8] = \"OP_MINUS_ERR_SPC\";\n    State[State[\"MINUS_ERR_ARG\"] = 9] = \"MINUS_ERR_ARG\";\n    State[State[\"OP_M\"] = 10] = \"OP_M\";\n    State[State[\"OP_MS\"] = 11] = \"OP_MS\";\n    State[State[\"OP_MSG\"] = 12] = \"OP_MSG\";\n    State[State[\"OP_MSG_SPC\"] = 13] = \"OP_MSG_SPC\";\n    State[State[\"MSG_ARG\"] = 14] = \"MSG_ARG\";\n    State[State[\"MSG_PAYLOAD\"] = 15] = \"MSG_PAYLOAD\";\n    State[State[\"MSG_END\"] = 16] = \"MSG_END\";\n    State[State[\"OP_H\"] = 17] = \"OP_H\";\n    State[State[\"OP_P\"] = 18] = \"OP_P\";\n    State[State[\"OP_PI\"] = 19] = \"OP_PI\";\n    State[State[\"OP_PIN\"] = 20] = \"OP_PIN\";\n    State[State[\"OP_PING\"] = 21] = \"OP_PING\";\n    State[State[\"OP_PO\"] = 22] = \"OP_PO\";\n    State[State[\"OP_PON\"] = 23] = \"OP_PON\";\n    State[State[\"OP_PONG\"] = 24] = \"OP_PONG\";\n    State[State[\"OP_I\"] = 25] = \"OP_I\";\n    State[State[\"OP_IN\"] = 26] = \"OP_IN\";\n    State[State[\"OP_INF\"] = 27] = \"OP_INF\";\n    State[State[\"OP_INFO\"] = 28] = \"OP_INFO\";\n    State[State[\"OP_INFO_SPC\"] = 29] = \"OP_INFO_SPC\";\n    State[State[\"INFO_ARG\"] = 30] = \"INFO_ARG\";\n})(State || (State = {}));\nvar cc;\n(function(cc) {\n    cc[cc[\"CR\"] = \"\\r\".charCodeAt(0)] = \"CR\";\n    cc[cc[\"E\"] = \"E\".charCodeAt(0)] = \"E\";\n    cc[cc[\"e\"] = \"e\".charCodeAt(0)] = \"e\";\n    cc[cc[\"F\"] = \"F\".charCodeAt(0)] = \"F\";\n    cc[cc[\"f\"] = \"f\".charCodeAt(0)] = \"f\";\n    cc[cc[\"G\"] = \"G\".charCodeAt(0)] = \"G\";\n    cc[cc[\"g\"] = \"g\".charCodeAt(0)] = \"g\";\n    cc[cc[\"H\"] = \"H\".charCodeAt(0)] = \"H\";\n    cc[cc[\"h\"] = \"h\".charCodeAt(0)] = \"h\";\n    cc[cc[\"I\"] = \"I\".charCodeAt(0)] = \"I\";\n    cc[cc[\"i\"] = \"i\".charCodeAt(0)] = \"i\";\n    cc[cc[\"K\"] = \"K\".charCodeAt(0)] = \"K\";\n    cc[cc[\"k\"] = \"k\".charCodeAt(0)] = \"k\";\n    cc[cc[\"M\"] = \"M\".charCodeAt(0)] = \"M\";\n    cc[cc[\"m\"] = \"m\".charCodeAt(0)] = \"m\";\n    cc[cc[\"MINUS\"] = \"-\".charCodeAt(0)] = \"MINUS\";\n    cc[cc[\"N\"] = \"N\".charCodeAt(0)] = \"N\";\n    cc[cc[\"n\"] = \"n\".charCodeAt(0)] = \"n\";\n    cc[cc[\"NL\"] = \"\\n\".charCodeAt(0)] = \"NL\";\n    cc[cc[\"O\"] = \"O\".charCodeAt(0)] = \"O\";\n    cc[cc[\"o\"] = \"o\".charCodeAt(0)] = \"o\";\n    cc[cc[\"P\"] = \"P\".charCodeAt(0)] = \"P\";\n    cc[cc[\"p\"] = \"p\".charCodeAt(0)] = \"p\";\n    cc[cc[\"PLUS\"] = \"+\".charCodeAt(0)] = \"PLUS\";\n    cc[cc[\"R\"] = \"R\".charCodeAt(0)] = \"R\";\n    cc[cc[\"r\"] = \"r\".charCodeAt(0)] = \"r\";\n    cc[cc[\"S\"] = \"S\".charCodeAt(0)] = \"S\";\n    cc[cc[\"s\"] = \"s\".charCodeAt(0)] = \"s\";\n    cc[cc[\"SPACE\"] = \" \".charCodeAt(0)] = \"SPACE\";\n    cc[cc[\"TAB\"] = \"\\t\".charCodeAt(0)] = \"TAB\";\n})(cc || (cc = {}));\n(function(nacl) {\n    'use strict';\n    var u64 = function(h, l) {\n        this.hi = h | 0 >>> 0;\n        this.lo = l | 0 >>> 0;\n    };\n    var gf = function(init) {\n        var i, r = new Float64Array(16);\n        if (init) for(i = 0; i < init.length; i++)r[i] = init[i];\n        return r;\n    };\n    var randombytes = function() {\n        throw new Error('no PRNG');\n    };\n    var _0 = new Uint8Array(16);\n    var _9 = new Uint8Array(32);\n    _9[0] = 9;\n    var gf0 = gf(), gf1 = gf([\n        1\n    ]), _121665 = gf([\n        0xdb41,\n        1\n    ]), D = gf([\n        0x78a3,\n        0x1359,\n        0x4dca,\n        0x75eb,\n        0xd8ab,\n        0x4141,\n        0x0a4d,\n        0x0070,\n        0xe898,\n        0x7779,\n        0x4079,\n        0x8cc7,\n        0xfe73,\n        0x2b6f,\n        0x6cee,\n        0x5203\n    ]), D2 = gf([\n        0xf159,\n        0x26b2,\n        0x9b94,\n        0xebd6,\n        0xb156,\n        0x8283,\n        0x149a,\n        0x00e0,\n        0xd130,\n        0xeef3,\n        0x80f2,\n        0x198e,\n        0xfce7,\n        0x56df,\n        0xd9dc,\n        0x2406\n    ]), X = gf([\n        0xd51a,\n        0x8f25,\n        0x2d60,\n        0xc956,\n        0xa7b2,\n        0x9525,\n        0xc760,\n        0x692c,\n        0xdc5c,\n        0xfdd6,\n        0xe231,\n        0xc0a4,\n        0x53fe,\n        0xcd6e,\n        0x36d3,\n        0x2169\n    ]), Y = gf([\n        0x6658,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666,\n        0x6666\n    ]), I = gf([\n        0xa0b0,\n        0x4a0e,\n        0x1b27,\n        0xc4ee,\n        0xe478,\n        0xad2f,\n        0x1806,\n        0x2f43,\n        0xd7a7,\n        0x3dfb,\n        0x0099,\n        0x2b4d,\n        0xdf0b,\n        0x4fc1,\n        0x2480,\n        0x2b83\n    ]);\n    function L32(x, c) {\n        return x << c | x >>> 32 - c;\n    }\n    function ld32(x, i) {\n        var u = x[i + 3] & 0xff;\n        u = u << 8 | x[i + 2] & 0xff;\n        u = u << 8 | x[i + 1] & 0xff;\n        return u << 8 | x[i + 0] & 0xff;\n    }\n    function dl64(x, i) {\n        var h = x[i] << 24 | x[i + 1] << 16 | x[i + 2] << 8 | x[i + 3];\n        var l = x[i + 4] << 24 | x[i + 5] << 16 | x[i + 6] << 8 | x[i + 7];\n        return new u64(h, l);\n    }\n    function st32(x, j, u) {\n        var i;\n        for(i = 0; i < 4; i++){\n            x[j + i] = u & 255;\n            u >>>= 8;\n        }\n    }\n    function ts64(x, i, u) {\n        x[i] = u.hi >> 24 & 0xff;\n        x[i + 1] = u.hi >> 16 & 0xff;\n        x[i + 2] = u.hi >> 8 & 0xff;\n        x[i + 3] = u.hi & 0xff;\n        x[i + 4] = u.lo >> 24 & 0xff;\n        x[i + 5] = u.lo >> 16 & 0xff;\n        x[i + 6] = u.lo >> 8 & 0xff;\n        x[i + 7] = u.lo & 0xff;\n    }\n    function vn(x, xi, y, yi, n) {\n        var i, d = 0;\n        for(i = 0; i < n; i++)d |= x[xi + i] ^ y[yi + i];\n        return (1 & d - 1 >>> 8) - 1;\n    }\n    function crypto_verify_16(x, xi, y, yi) {\n        return vn(x, xi, y, yi, 16);\n    }\n    function crypto_verify_32(x, xi, y, yi) {\n        return vn(x, xi, y, yi, 32);\n    }\n    function core(out, inp, k, c, h) {\n        var w = new Uint32Array(16), x = new Uint32Array(16), y = new Uint32Array(16), t = new Uint32Array(4);\n        var i, j, m;\n        for(i = 0; i < 4; i++){\n            x[5 * i] = ld32(c, 4 * i);\n            x[1 + i] = ld32(k, 4 * i);\n            x[6 + i] = ld32(inp, 4 * i);\n            x[11 + i] = ld32(k, 16 + 4 * i);\n        }\n        for(i = 0; i < 16; i++)y[i] = x[i];\n        for(i = 0; i < 20; i++){\n            for(j = 0; j < 4; j++){\n                for(m = 0; m < 4; m++)t[m] = x[(5 * j + 4 * m) % 16];\n                t[1] ^= L32(t[0] + t[3] | 0, 7);\n                t[2] ^= L32(t[1] + t[0] | 0, 9);\n                t[3] ^= L32(t[2] + t[1] | 0, 13);\n                t[0] ^= L32(t[3] + t[2] | 0, 18);\n                for(m = 0; m < 4; m++)w[4 * j + (j + m) % 4] = t[m];\n            }\n            for(m = 0; m < 16; m++)x[m] = w[m];\n        }\n        if (h) {\n            for(i = 0; i < 16; i++)x[i] = x[i] + y[i] | 0;\n            for(i = 0; i < 4; i++){\n                x[5 * i] = x[5 * i] - ld32(c, 4 * i) | 0;\n                x[6 + i] = x[6 + i] - ld32(inp, 4 * i) | 0;\n            }\n            for(i = 0; i < 4; i++){\n                st32(out, 4 * i, x[5 * i]);\n                st32(out, 16 + 4 * i, x[6 + i]);\n            }\n        } else {\n            for(i = 0; i < 16; i++)st32(out, 4 * i, x[i] + y[i] | 0);\n        }\n    }\n    function crypto_core_salsa20(out, inp, k, c) {\n        core(out, inp, k, c, false);\n        return 0;\n    }\n    function crypto_core_hsalsa20(out, inp, k, c) {\n        core(out, inp, k, c, true);\n        return 0;\n    }\n    var sigma = new Uint8Array([\n        101,\n        120,\n        112,\n        97,\n        110,\n        100,\n        32,\n        51,\n        50,\n        45,\n        98,\n        121,\n        116,\n        101,\n        32,\n        107\n    ]);\n    function crypto_stream_salsa20_xor(c, cpos, m, mpos, b, n, k) {\n        var z = new Uint8Array(16), x = new Uint8Array(64);\n        var u, i;\n        if (!b) return 0;\n        for(i = 0; i < 16; i++)z[i] = 0;\n        for(i = 0; i < 8; i++)z[i] = n[i];\n        while(b >= 64){\n            crypto_core_salsa20(x, z, k, sigma);\n            for(i = 0; i < 64; i++)c[cpos + i] = (m ? m[mpos + i] : 0) ^ x[i];\n            u = 1;\n            for(i = 8; i < 16; i++){\n                u = u + (z[i] & 0xff) | 0;\n                z[i] = u & 0xff;\n                u >>>= 8;\n            }\n            b -= 64;\n            cpos += 64;\n            if (m) mpos += 64;\n        }\n        if (b > 0) {\n            crypto_core_salsa20(x, z, k, sigma);\n            for(i = 0; i < b; i++)c[cpos + i] = (m ? m[mpos + i] : 0) ^ x[i];\n        }\n        return 0;\n    }\n    function crypto_stream_salsa20(c, cpos, d, n, k) {\n        return crypto_stream_salsa20_xor(c, cpos, null, 0, d, n, k);\n    }\n    function crypto_stream(c, cpos, d, n, k) {\n        var s = new Uint8Array(32);\n        crypto_core_hsalsa20(s, n, k, sigma);\n        return crypto_stream_salsa20(c, cpos, d, n.subarray(16), s);\n    }\n    function crypto_stream_xor(c, cpos, m, mpos, d, n, k) {\n        var s = new Uint8Array(32);\n        crypto_core_hsalsa20(s, n, k, sigma);\n        return crypto_stream_salsa20_xor(c, cpos, m, mpos, d, n.subarray(16), s);\n    }\n    function add1305(h, c) {\n        var j, u = 0;\n        for(j = 0; j < 17; j++){\n            u = u + (h[j] + c[j] | 0) | 0;\n            h[j] = u & 255;\n            u >>>= 8;\n        }\n    }\n    var minusp = new Uint32Array([\n        5,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        252\n    ]);\n    function crypto_onetimeauth(out, outpos, m, mpos, n, k) {\n        var s, i, j, u;\n        var x = new Uint32Array(17), r = new Uint32Array(17), h = new Uint32Array(17), c = new Uint32Array(17), g = new Uint32Array(17);\n        for(j = 0; j < 17; j++)r[j] = h[j] = 0;\n        for(j = 0; j < 16; j++)r[j] = k[j];\n        r[3] &= 15;\n        r[4] &= 252;\n        r[7] &= 15;\n        r[8] &= 252;\n        r[11] &= 15;\n        r[12] &= 252;\n        r[15] &= 15;\n        while(n > 0){\n            for(j = 0; j < 17; j++)c[j] = 0;\n            for(j = 0; j < 16 && j < n; ++j)c[j] = m[mpos + j];\n            c[j] = 1;\n            mpos += j;\n            n -= j;\n            add1305(h, c);\n            for(i = 0; i < 17; i++){\n                x[i] = 0;\n                for(j = 0; j < 17; j++)x[i] = x[i] + h[j] * (j <= i ? r[i - j] : 320 * r[i + 17 - j] | 0) | 0 | 0;\n            }\n            for(i = 0; i < 17; i++)h[i] = x[i];\n            u = 0;\n            for(j = 0; j < 16; j++){\n                u = u + h[j] | 0;\n                h[j] = u & 255;\n                u >>>= 8;\n            }\n            u = u + h[16] | 0;\n            h[16] = u & 3;\n            u = 5 * (u >>> 2) | 0;\n            for(j = 0; j < 16; j++){\n                u = u + h[j] | 0;\n                h[j] = u & 255;\n                u >>>= 8;\n            }\n            u = u + h[16] | 0;\n            h[16] = u;\n        }\n        for(j = 0; j < 17; j++)g[j] = h[j];\n        add1305(h, minusp);\n        s = -(h[16] >>> 7) | 0;\n        for(j = 0; j < 17; j++)h[j] ^= s & (g[j] ^ h[j]);\n        for(j = 0; j < 16; j++)c[j] = k[j + 16];\n        c[16] = 0;\n        add1305(h, c);\n        for(j = 0; j < 16; j++)out[outpos + j] = h[j];\n        return 0;\n    }\n    function crypto_onetimeauth_verify(h, hpos, m, mpos, n, k) {\n        var x = new Uint8Array(16);\n        crypto_onetimeauth(x, 0, m, mpos, n, k);\n        return crypto_verify_16(h, hpos, x, 0);\n    }\n    function crypto_secretbox(c, m, d, n, k) {\n        var i;\n        if (d < 32) return -1;\n        crypto_stream_xor(c, 0, m, 0, d, n, k);\n        crypto_onetimeauth(c, 16, c, 32, d - 32, c);\n        for(i = 0; i < 16; i++)c[i] = 0;\n        return 0;\n    }\n    function crypto_secretbox_open(m, c, d, n, k) {\n        var i;\n        var x = new Uint8Array(32);\n        if (d < 32) return -1;\n        crypto_stream(x, 0, 32, n, k);\n        if (crypto_onetimeauth_verify(c, 16, c, 32, d - 32, x) !== 0) return -1;\n        crypto_stream_xor(m, 0, c, 0, d, n, k);\n        for(i = 0; i < 32; i++)m[i] = 0;\n        return 0;\n    }\n    function set25519(r, a) {\n        var i;\n        for(i = 0; i < 16; i++)r[i] = a[i] | 0;\n    }\n    function car25519(o) {\n        var c;\n        var i;\n        for(i = 0; i < 16; i++){\n            o[i] += 65536;\n            c = Math.floor(o[i] / 65536);\n            o[(i + 1) * (i < 15 ? 1 : 0)] += c - 1 + 37 * (c - 1) * (i === 15 ? 1 : 0);\n            o[i] -= c * 65536;\n        }\n    }\n    function sel25519(p, q, b) {\n        var t, c = ~(b - 1);\n        for(var i = 0; i < 16; i++){\n            t = c & (p[i] ^ q[i]);\n            p[i] ^= t;\n            q[i] ^= t;\n        }\n    }\n    function pack25519(o, n) {\n        var i, j, b;\n        var m = gf(), t = gf();\n        for(i = 0; i < 16; i++)t[i] = n[i];\n        car25519(t);\n        car25519(t);\n        car25519(t);\n        for(j = 0; j < 2; j++){\n            m[0] = t[0] - 0xffed;\n            for(i = 1; i < 15; i++){\n                m[i] = t[i] - 0xffff - (m[i - 1] >> 16 & 1);\n                m[i - 1] &= 0xffff;\n            }\n            m[15] = t[15] - 0x7fff - (m[14] >> 16 & 1);\n            b = m[15] >> 16 & 1;\n            m[14] &= 0xffff;\n            sel25519(t, m, 1 - b);\n        }\n        for(i = 0; i < 16; i++){\n            o[2 * i] = t[i] & 0xff;\n            o[2 * i + 1] = t[i] >> 8;\n        }\n    }\n    function neq25519(a, b) {\n        var c = new Uint8Array(32), d = new Uint8Array(32);\n        pack25519(c, a);\n        pack25519(d, b);\n        return crypto_verify_32(c, 0, d, 0);\n    }\n    function par25519(a) {\n        var d = new Uint8Array(32);\n        pack25519(d, a);\n        return d[0] & 1;\n    }\n    function unpack25519(o, n) {\n        var i;\n        for(i = 0; i < 16; i++)o[i] = n[2 * i] + (n[2 * i + 1] << 8);\n        o[15] &= 0x7fff;\n    }\n    function A(o, a, b) {\n        var i;\n        for(i = 0; i < 16; i++)o[i] = a[i] + b[i] | 0;\n    }\n    function Z(o, a, b) {\n        var i;\n        for(i = 0; i < 16; i++)o[i] = a[i] - b[i] | 0;\n    }\n    function M(o, a, b) {\n        var i, j, t = new Float64Array(31);\n        for(i = 0; i < 31; i++)t[i] = 0;\n        for(i = 0; i < 16; i++){\n            for(j = 0; j < 16; j++){\n                t[i + j] += a[i] * b[j];\n            }\n        }\n        for(i = 0; i < 15; i++){\n            t[i] += 38 * t[i + 16];\n        }\n        for(i = 0; i < 16; i++)o[i] = t[i];\n        car25519(o);\n        car25519(o);\n    }\n    function S(o, a) {\n        M(o, a, a);\n    }\n    function inv25519(o, i) {\n        var c = gf();\n        var a;\n        for(a = 0; a < 16; a++)c[a] = i[a];\n        for(a = 253; a >= 0; a--){\n            S(c, c);\n            if (a !== 2 && a !== 4) M(c, c, i);\n        }\n        for(a = 0; a < 16; a++)o[a] = c[a];\n    }\n    function pow2523(o, i) {\n        var c = gf();\n        var a;\n        for(a = 0; a < 16; a++)c[a] = i[a];\n        for(a = 250; a >= 0; a--){\n            S(c, c);\n            if (a !== 1) M(c, c, i);\n        }\n        for(a = 0; a < 16; a++)o[a] = c[a];\n    }\n    function crypto_scalarmult(q, n, p) {\n        var z = new Uint8Array(32);\n        var x = new Float64Array(80), r, i;\n        var a = gf(), b = gf(), c = gf(), d = gf(), e = gf(), f = gf();\n        for(i = 0; i < 31; i++)z[i] = n[i];\n        z[31] = n[31] & 127 | 64;\n        z[0] &= 248;\n        unpack25519(x, p);\n        for(i = 0; i < 16; i++){\n            b[i] = x[i];\n            d[i] = a[i] = c[i] = 0;\n        }\n        a[0] = d[0] = 1;\n        for(i = 254; i >= 0; --i){\n            r = z[i >>> 3] >>> (i & 7) & 1;\n            sel25519(a, b, r);\n            sel25519(c, d, r);\n            A(e, a, c);\n            Z(a, a, c);\n            A(c, b, d);\n            Z(b, b, d);\n            S(d, e);\n            S(f, a);\n            M(a, c, a);\n            M(c, b, e);\n            A(e, a, c);\n            Z(a, a, c);\n            S(b, a);\n            Z(c, d, f);\n            M(a, c, _121665);\n            A(a, a, d);\n            M(c, c, a);\n            M(a, d, f);\n            M(d, b, x);\n            S(b, e);\n            sel25519(a, b, r);\n            sel25519(c, d, r);\n        }\n        for(i = 0; i < 16; i++){\n            x[i + 16] = a[i];\n            x[i + 32] = c[i];\n            x[i + 48] = b[i];\n            x[i + 64] = d[i];\n        }\n        var x32 = x.subarray(32);\n        var x16 = x.subarray(16);\n        inv25519(x32, x32);\n        M(x16, x16, x32);\n        pack25519(q, x16);\n        return 0;\n    }\n    function crypto_scalarmult_base(q, n) {\n        return crypto_scalarmult(q, n, _9);\n    }\n    function crypto_box_keypair(y, x) {\n        randombytes(x, 32);\n        return crypto_scalarmult_base(y, x);\n    }\n    function crypto_box_beforenm(k, y, x) {\n        var s = new Uint8Array(32);\n        crypto_scalarmult(s, x, y);\n        return crypto_core_hsalsa20(k, _0, s, sigma);\n    }\n    var crypto_box_afternm = crypto_secretbox;\n    var crypto_box_open_afternm = crypto_secretbox_open;\n    function crypto_box(c, m, d, n, y, x) {\n        var k = new Uint8Array(32);\n        crypto_box_beforenm(k, y, x);\n        return crypto_box_afternm(c, m, d, n, k);\n    }\n    function crypto_box_open(m, c, d, n, y, x) {\n        var k = new Uint8Array(32);\n        crypto_box_beforenm(k, y, x);\n        return crypto_box_open_afternm(m, c, d, n, k);\n    }\n    function add64() {\n        var a = 0, b = 0, c = 0, d = 0, m16 = 65535, l, h, i;\n        for(i = 0; i < arguments.length; i++){\n            l = arguments[i].lo;\n            h = arguments[i].hi;\n            a += l & m16;\n            b += l >>> 16;\n            c += h & m16;\n            d += h >>> 16;\n        }\n        b += a >>> 16;\n        c += b >>> 16;\n        d += c >>> 16;\n        return new u64(c & m16 | d << 16, a & m16 | b << 16);\n    }\n    function shr64(x, c) {\n        return new u64(x.hi >>> c, x.lo >>> c | x.hi << 32 - c);\n    }\n    function xor64() {\n        var l = 0, h = 0, i;\n        for(i = 0; i < arguments.length; i++){\n            l ^= arguments[i].lo;\n            h ^= arguments[i].hi;\n        }\n        return new u64(h, l);\n    }\n    function R(x, c) {\n        var h, l, c1 = 32 - c;\n        if (c < 32) {\n            h = x.hi >>> c | x.lo << c1;\n            l = x.lo >>> c | x.hi << c1;\n        } else if (c < 64) {\n            h = x.lo >>> c | x.hi << c1;\n            l = x.hi >>> c | x.lo << c1;\n        }\n        return new u64(h, l);\n    }\n    function Ch(x, y, z) {\n        var h = x.hi & y.hi ^ ~x.hi & z.hi, l = x.lo & y.lo ^ ~x.lo & z.lo;\n        return new u64(h, l);\n    }\n    function Maj(x, y, z) {\n        var h = x.hi & y.hi ^ x.hi & z.hi ^ y.hi & z.hi, l = x.lo & y.lo ^ x.lo & z.lo ^ y.lo & z.lo;\n        return new u64(h, l);\n    }\n    function Sigma0(x) {\n        return xor64(R(x, 28), R(x, 34), R(x, 39));\n    }\n    function Sigma1(x) {\n        return xor64(R(x, 14), R(x, 18), R(x, 41));\n    }\n    function sigma0(x) {\n        return xor64(R(x, 1), R(x, 8), shr64(x, 7));\n    }\n    function sigma1(x) {\n        return xor64(R(x, 19), R(x, 61), shr64(x, 6));\n    }\n    var K = [\n        new u64(0x428a2f98, 0xd728ae22),\n        new u64(0x71374491, 0x23ef65cd),\n        new u64(0xb5c0fbcf, 0xec4d3b2f),\n        new u64(0xe9b5dba5, 0x8189dbbc),\n        new u64(0x3956c25b, 0xf348b538),\n        new u64(0x59f111f1, 0xb605d019),\n        new u64(0x923f82a4, 0xaf194f9b),\n        new u64(0xab1c5ed5, 0xda6d8118),\n        new u64(0xd807aa98, 0xa3030242),\n        new u64(0x12835b01, 0x45706fbe),\n        new u64(0x243185be, 0x4ee4b28c),\n        new u64(0x550c7dc3, 0xd5ffb4e2),\n        new u64(0x72be5d74, 0xf27b896f),\n        new u64(0x80deb1fe, 0x3b1696b1),\n        new u64(0x9bdc06a7, 0x25c71235),\n        new u64(0xc19bf174, 0xcf692694),\n        new u64(0xe49b69c1, 0x9ef14ad2),\n        new u64(0xefbe4786, 0x384f25e3),\n        new u64(0x0fc19dc6, 0x8b8cd5b5),\n        new u64(0x240ca1cc, 0x77ac9c65),\n        new u64(0x2de92c6f, 0x592b0275),\n        new u64(0x4a7484aa, 0x6ea6e483),\n        new u64(0x5cb0a9dc, 0xbd41fbd4),\n        new u64(0x76f988da, 0x831153b5),\n        new u64(0x983e5152, 0xee66dfab),\n        new u64(0xa831c66d, 0x2db43210),\n        new u64(0xb00327c8, 0x98fb213f),\n        new u64(0xbf597fc7, 0xbeef0ee4),\n        new u64(0xc6e00bf3, 0x3da88fc2),\n        new u64(0xd5a79147, 0x930aa725),\n        new u64(0x06ca6351, 0xe003826f),\n        new u64(0x14292967, 0x0a0e6e70),\n        new u64(0x27b70a85, 0x46d22ffc),\n        new u64(0x2e1b2138, 0x5c26c926),\n        new u64(0x4d2c6dfc, 0x5ac42aed),\n        new u64(0x53380d13, 0x9d95b3df),\n        new u64(0x650a7354, 0x8baf63de),\n        new u64(0x766a0abb, 0x3c77b2a8),\n        new u64(0x81c2c92e, 0x47edaee6),\n        new u64(0x92722c85, 0x1482353b),\n        new u64(0xa2bfe8a1, 0x4cf10364),\n        new u64(0xa81a664b, 0xbc423001),\n        new u64(0xc24b8b70, 0xd0f89791),\n        new u64(0xc76c51a3, 0x0654be30),\n        new u64(0xd192e819, 0xd6ef5218),\n        new u64(0xd6990624, 0x5565a910),\n        new u64(0xf40e3585, 0x5771202a),\n        new u64(0x106aa070, 0x32bbd1b8),\n        new u64(0x19a4c116, 0xb8d2d0c8),\n        new u64(0x1e376c08, 0x5141ab53),\n        new u64(0x2748774c, 0xdf8eeb99),\n        new u64(0x34b0bcb5, 0xe19b48a8),\n        new u64(0x391c0cb3, 0xc5c95a63),\n        new u64(0x4ed8aa4a, 0xe3418acb),\n        new u64(0x5b9cca4f, 0x7763e373),\n        new u64(0x682e6ff3, 0xd6b2b8a3),\n        new u64(0x748f82ee, 0x5defb2fc),\n        new u64(0x78a5636f, 0x43172f60),\n        new u64(0x84c87814, 0xa1f0ab72),\n        new u64(0x8cc70208, 0x1a6439ec),\n        new u64(0x90befffa, 0x23631e28),\n        new u64(0xa4506ceb, 0xde82bde9),\n        new u64(0xbef9a3f7, 0xb2c67915),\n        new u64(0xc67178f2, 0xe372532b),\n        new u64(0xca273ece, 0xea26619c),\n        new u64(0xd186b8c7, 0x21c0c207),\n        new u64(0xeada7dd6, 0xcde0eb1e),\n        new u64(0xf57d4f7f, 0xee6ed178),\n        new u64(0x06f067aa, 0x72176fba),\n        new u64(0x0a637dc5, 0xa2c898a6),\n        new u64(0x113f9804, 0xbef90dae),\n        new u64(0x1b710b35, 0x131c471b),\n        new u64(0x28db77f5, 0x23047d84),\n        new u64(0x32caab7b, 0x40c72493),\n        new u64(0x3c9ebe0a, 0x15c9bebc),\n        new u64(0x431d67c4, 0x9c100d4c),\n        new u64(0x4cc5d4be, 0xcb3e42b6),\n        new u64(0x597f299c, 0xfc657e2a),\n        new u64(0x5fcb6fab, 0x3ad6faec),\n        new u64(0x6c44198c, 0x4a475817)\n    ];\n    function crypto_hashblocks(x, m, n) {\n        var z = [], b = [], a = [], w = [], t, i, j;\n        for(i = 0; i < 8; i++)z[i] = a[i] = dl64(x, 8 * i);\n        var pos = 0;\n        while(n >= 128){\n            for(i = 0; i < 16; i++)w[i] = dl64(m, 8 * i + pos);\n            for(i = 0; i < 80; i++){\n                for(j = 0; j < 8; j++)b[j] = a[j];\n                t = add64(a[7], Sigma1(a[4]), Ch(a[4], a[5], a[6]), K[i], w[i % 16]);\n                b[7] = add64(t, Sigma0(a[0]), Maj(a[0], a[1], a[2]));\n                b[3] = add64(b[3], t);\n                for(j = 0; j < 8; j++)a[(j + 1) % 8] = b[j];\n                if (i % 16 === 15) {\n                    for(j = 0; j < 16; j++){\n                        w[j] = add64(w[j], w[(j + 9) % 16], sigma0(w[(j + 1) % 16]), sigma1(w[(j + 14) % 16]));\n                    }\n                }\n            }\n            for(i = 0; i < 8; i++){\n                a[i] = add64(a[i], z[i]);\n                z[i] = a[i];\n            }\n            pos += 128;\n            n -= 128;\n        }\n        for(i = 0; i < 8; i++)ts64(x, 8 * i, z[i]);\n        return n;\n    }\n    var iv = new Uint8Array([\n        0x6a,\n        0x09,\n        0xe6,\n        0x67,\n        0xf3,\n        0xbc,\n        0xc9,\n        0x08,\n        0xbb,\n        0x67,\n        0xae,\n        0x85,\n        0x84,\n        0xca,\n        0xa7,\n        0x3b,\n        0x3c,\n        0x6e,\n        0xf3,\n        0x72,\n        0xfe,\n        0x94,\n        0xf8,\n        0x2b,\n        0xa5,\n        0x4f,\n        0xf5,\n        0x3a,\n        0x5f,\n        0x1d,\n        0x36,\n        0xf1,\n        0x51,\n        0x0e,\n        0x52,\n        0x7f,\n        0xad,\n        0xe6,\n        0x82,\n        0xd1,\n        0x9b,\n        0x05,\n        0x68,\n        0x8c,\n        0x2b,\n        0x3e,\n        0x6c,\n        0x1f,\n        0x1f,\n        0x83,\n        0xd9,\n        0xab,\n        0xfb,\n        0x41,\n        0xbd,\n        0x6b,\n        0x5b,\n        0xe0,\n        0xcd,\n        0x19,\n        0x13,\n        0x7e,\n        0x21,\n        0x79\n    ]);\n    function crypto_hash(out, m, n) {\n        var h = new Uint8Array(64), x = new Uint8Array(256);\n        var i, b = n;\n        for(i = 0; i < 64; i++)h[i] = iv[i];\n        crypto_hashblocks(h, m, n);\n        n %= 128;\n        for(i = 0; i < 256; i++)x[i] = 0;\n        for(i = 0; i < n; i++)x[i] = m[b - n + i];\n        x[n] = 128;\n        n = 256 - 128 * (n < 112 ? 1 : 0);\n        x[n - 9] = 0;\n        ts64(x, n - 8, new u64(b / 0x20000000 | 0, b << 3));\n        crypto_hashblocks(h, x, n);\n        for(i = 0; i < 64; i++)out[i] = h[i];\n        return 0;\n    }\n    function add(p, q) {\n        var a = gf(), b = gf(), c = gf(), d = gf(), e = gf(), f = gf(), g = gf(), h = gf(), t = gf();\n        Z(a, p[1], p[0]);\n        Z(t, q[1], q[0]);\n        M(a, a, t);\n        A(b, p[0], p[1]);\n        A(t, q[0], q[1]);\n        M(b, b, t);\n        M(c, p[3], q[3]);\n        M(c, c, D2);\n        M(d, p[2], q[2]);\n        A(d, d, d);\n        Z(e, b, a);\n        Z(f, d, c);\n        A(g, d, c);\n        A(h, b, a);\n        M(p[0], e, f);\n        M(p[1], h, g);\n        M(p[2], g, f);\n        M(p[3], e, h);\n    }\n    function cswap(p, q, b) {\n        var i;\n        for(i = 0; i < 4; i++){\n            sel25519(p[i], q[i], b);\n        }\n    }\n    function pack(r, p) {\n        var tx = gf(), ty = gf(), zi = gf();\n        inv25519(zi, p[2]);\n        M(tx, p[0], zi);\n        M(ty, p[1], zi);\n        pack25519(r, ty);\n        r[31] ^= par25519(tx) << 7;\n    }\n    function scalarmult(p, q, s) {\n        var b, i;\n        set25519(p[0], gf0);\n        set25519(p[1], gf1);\n        set25519(p[2], gf1);\n        set25519(p[3], gf0);\n        for(i = 255; i >= 0; --i){\n            b = s[i / 8 | 0] >> (i & 7) & 1;\n            cswap(p, q, b);\n            add(q, p);\n            add(p, p);\n            cswap(p, q, b);\n        }\n    }\n    function scalarbase(p, s) {\n        var q = [\n            gf(),\n            gf(),\n            gf(),\n            gf()\n        ];\n        set25519(q[0], X);\n        set25519(q[1], Y);\n        set25519(q[2], gf1);\n        M(q[3], X, Y);\n        scalarmult(p, q, s);\n    }\n    function crypto_sign_keypair(pk, sk, seeded) {\n        var d = new Uint8Array(64);\n        var p = [\n            gf(),\n            gf(),\n            gf(),\n            gf()\n        ];\n        var i;\n        if (!seeded) randombytes(sk, 32);\n        crypto_hash(d, sk, 32);\n        d[0] &= 248;\n        d[31] &= 127;\n        d[31] |= 64;\n        scalarbase(p, d);\n        pack(pk, p);\n        for(i = 0; i < 32; i++)sk[i + 32] = pk[i];\n        return 0;\n    }\n    var L = new Float64Array([\n        0xed,\n        0xd3,\n        0xf5,\n        0x5c,\n        0x1a,\n        0x63,\n        0x12,\n        0x58,\n        0xd6,\n        0x9c,\n        0xf7,\n        0xa2,\n        0xde,\n        0xf9,\n        0xde,\n        0x14,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0x10\n    ]);\n    function modL(r, x) {\n        var carry, i, j, k;\n        for(i = 63; i >= 32; --i){\n            carry = 0;\n            for(j = i - 32, k = i - 12; j < k; ++j){\n                x[j] += carry - 16 * x[i] * L[j - (i - 32)];\n                carry = Math.floor((x[j] + 128) / 256);\n                x[j] -= carry * 256;\n            }\n            x[j] += carry;\n            x[i] = 0;\n        }\n        carry = 0;\n        for(j = 0; j < 32; j++){\n            x[j] += carry - (x[31] >> 4) * L[j];\n            carry = x[j] >> 8;\n            x[j] &= 255;\n        }\n        for(j = 0; j < 32; j++)x[j] -= carry * L[j];\n        for(i = 0; i < 32; i++){\n            x[i + 1] += x[i] >> 8;\n            r[i] = x[i] & 255;\n        }\n    }\n    function reduce(r) {\n        var x = new Float64Array(64), i;\n        for(i = 0; i < 64; i++)x[i] = r[i];\n        for(i = 0; i < 64; i++)r[i] = 0;\n        modL(r, x);\n    }\n    function crypto_sign(sm, m, n, sk) {\n        var d = new Uint8Array(64), h = new Uint8Array(64), r = new Uint8Array(64);\n        var i, j, x = new Float64Array(64);\n        var p = [\n            gf(),\n            gf(),\n            gf(),\n            gf()\n        ];\n        crypto_hash(d, sk, 32);\n        d[0] &= 248;\n        d[31] &= 127;\n        d[31] |= 64;\n        var smlen = n + 64;\n        for(i = 0; i < n; i++)sm[64 + i] = m[i];\n        for(i = 0; i < 32; i++)sm[32 + i] = d[32 + i];\n        crypto_hash(r, sm.subarray(32), n + 32);\n        reduce(r);\n        scalarbase(p, r);\n        pack(sm, p);\n        for(i = 32; i < 64; i++)sm[i] = sk[i];\n        crypto_hash(h, sm, n + 64);\n        reduce(h);\n        for(i = 0; i < 64; i++)x[i] = 0;\n        for(i = 0; i < 32; i++)x[i] = r[i];\n        for(i = 0; i < 32; i++){\n            for(j = 0; j < 32; j++){\n                x[i + j] += h[i] * d[j];\n            }\n        }\n        modL(sm.subarray(32), x);\n        return smlen;\n    }\n    function unpackneg(r, p) {\n        var t = gf(), chk = gf(), num = gf(), den = gf(), den2 = gf(), den4 = gf(), den6 = gf();\n        set25519(r[2], gf1);\n        unpack25519(r[1], p);\n        S(num, r[1]);\n        M(den, num, D);\n        Z(num, num, r[2]);\n        A(den, r[2], den);\n        S(den2, den);\n        S(den4, den2);\n        M(den6, den4, den2);\n        M(t, den6, num);\n        M(t, t, den);\n        pow2523(t, t);\n        M(t, t, num);\n        M(t, t, den);\n        M(t, t, den);\n        M(r[0], t, den);\n        S(chk, r[0]);\n        M(chk, chk, den);\n        if (neq25519(chk, num)) M(r[0], r[0], I);\n        S(chk, r[0]);\n        M(chk, chk, den);\n        if (neq25519(chk, num)) return -1;\n        if (par25519(r[0]) === p[31] >> 7) Z(r[0], gf0, r[0]);\n        M(r[3], r[0], r[1]);\n        return 0;\n    }\n    function crypto_sign_open(m, sm, n, pk) {\n        var i;\n        var t = new Uint8Array(32), h = new Uint8Array(64);\n        var p = [\n            gf(),\n            gf(),\n            gf(),\n            gf()\n        ], q = [\n            gf(),\n            gf(),\n            gf(),\n            gf()\n        ];\n        if (n < 64) return -1;\n        if (unpackneg(q, pk)) return -1;\n        for(i = 0; i < n; i++)m[i] = sm[i];\n        for(i = 0; i < 32; i++)m[i + 32] = pk[i];\n        crypto_hash(h, m, n);\n        reduce(h);\n        scalarmult(p, q, h);\n        scalarbase(q, sm.subarray(32));\n        add(p, q);\n        pack(t, p);\n        n -= 64;\n        if (crypto_verify_32(sm, 0, t, 0)) {\n            for(i = 0; i < n; i++)m[i] = 0;\n            return -1;\n        }\n        for(i = 0; i < n; i++)m[i] = sm[i + 64];\n        return n;\n    }\n    var crypto_secretbox_KEYBYTES = 32, crypto_secretbox_NONCEBYTES = 24, crypto_secretbox_ZEROBYTES = 32, crypto_secretbox_BOXZEROBYTES = 16, crypto_scalarmult_BYTES = 32, crypto_scalarmult_SCALARBYTES = 32, crypto_box_PUBLICKEYBYTES = 32, crypto_box_SECRETKEYBYTES = 32, crypto_box_BEFORENMBYTES = 32, crypto_box_NONCEBYTES = crypto_secretbox_NONCEBYTES, crypto_box_ZEROBYTES = crypto_secretbox_ZEROBYTES, crypto_box_BOXZEROBYTES = crypto_secretbox_BOXZEROBYTES, crypto_sign_BYTES = 64, crypto_sign_PUBLICKEYBYTES = 32, crypto_sign_SECRETKEYBYTES = 64, crypto_sign_SEEDBYTES = 32, crypto_hash_BYTES = 64;\n    nacl.lowlevel = {\n        crypto_core_hsalsa20: crypto_core_hsalsa20,\n        crypto_stream_xor: crypto_stream_xor,\n        crypto_stream: crypto_stream,\n        crypto_stream_salsa20_xor: crypto_stream_salsa20_xor,\n        crypto_stream_salsa20: crypto_stream_salsa20,\n        crypto_onetimeauth: crypto_onetimeauth,\n        crypto_onetimeauth_verify: crypto_onetimeauth_verify,\n        crypto_verify_16: crypto_verify_16,\n        crypto_verify_32: crypto_verify_32,\n        crypto_secretbox: crypto_secretbox,\n        crypto_secretbox_open: crypto_secretbox_open,\n        crypto_scalarmult: crypto_scalarmult,\n        crypto_scalarmult_base: crypto_scalarmult_base,\n        crypto_box_beforenm: crypto_box_beforenm,\n        crypto_box_afternm: crypto_box_afternm,\n        crypto_box: crypto_box,\n        crypto_box_open: crypto_box_open,\n        crypto_box_keypair: crypto_box_keypair,\n        crypto_hash: crypto_hash,\n        crypto_sign: crypto_sign,\n        crypto_sign_keypair: crypto_sign_keypair,\n        crypto_sign_open: crypto_sign_open,\n        crypto_secretbox_KEYBYTES: crypto_secretbox_KEYBYTES,\n        crypto_secretbox_NONCEBYTES: crypto_secretbox_NONCEBYTES,\n        crypto_secretbox_ZEROBYTES: crypto_secretbox_ZEROBYTES,\n        crypto_secretbox_BOXZEROBYTES: crypto_secretbox_BOXZEROBYTES,\n        crypto_scalarmult_BYTES: crypto_scalarmult_BYTES,\n        crypto_scalarmult_SCALARBYTES: crypto_scalarmult_SCALARBYTES,\n        crypto_box_PUBLICKEYBYTES: crypto_box_PUBLICKEYBYTES,\n        crypto_box_SECRETKEYBYTES: crypto_box_SECRETKEYBYTES,\n        crypto_box_BEFORENMBYTES: crypto_box_BEFORENMBYTES,\n        crypto_box_NONCEBYTES: crypto_box_NONCEBYTES,\n        crypto_box_ZEROBYTES: crypto_box_ZEROBYTES,\n        crypto_box_BOXZEROBYTES: crypto_box_BOXZEROBYTES,\n        crypto_sign_BYTES: crypto_sign_BYTES,\n        crypto_sign_PUBLICKEYBYTES: crypto_sign_PUBLICKEYBYTES,\n        crypto_sign_SECRETKEYBYTES: crypto_sign_SECRETKEYBYTES,\n        crypto_sign_SEEDBYTES: crypto_sign_SEEDBYTES,\n        crypto_hash_BYTES: crypto_hash_BYTES,\n        gf: gf,\n        D: D,\n        L: L,\n        pack25519: pack25519,\n        unpack25519: unpack25519,\n        M: M,\n        A: A,\n        S: S,\n        Z: Z,\n        pow2523: pow2523,\n        add: add,\n        set25519: set25519,\n        modL: modL,\n        scalarmult: scalarmult,\n        scalarbase: scalarbase\n    };\n    function checkLengths(k, n) {\n        if (k.length !== crypto_secretbox_KEYBYTES) throw new Error('bad key size');\n        if (n.length !== crypto_secretbox_NONCEBYTES) throw new Error('bad nonce size');\n    }\n    function checkBoxLengths(pk, sk) {\n        if (pk.length !== crypto_box_PUBLICKEYBYTES) throw new Error('bad public key size');\n        if (sk.length !== crypto_box_SECRETKEYBYTES) throw new Error('bad secret key size');\n    }\n    function checkArrayTypes() {\n        for(var i = 0; i < arguments.length; i++){\n            if (!(arguments[i] instanceof Uint8Array)) throw new TypeError('unexpected type, use Uint8Array');\n        }\n    }\n    function cleanup(arr) {\n        for(var i = 0; i < arr.length; i++)arr[i] = 0;\n    }\n    nacl.randomBytes = function(n) {\n        var b = new Uint8Array(n);\n        randombytes(b, n);\n        return b;\n    };\n    nacl.secretbox = function(msg, nonce, key) {\n        checkArrayTypes(msg, nonce, key);\n        checkLengths(key, nonce);\n        var m = new Uint8Array(crypto_secretbox_ZEROBYTES + msg.length);\n        var c = new Uint8Array(m.length);\n        for(var i = 0; i < msg.length; i++)m[i + crypto_secretbox_ZEROBYTES] = msg[i];\n        crypto_secretbox(c, m, m.length, nonce, key);\n        return c.subarray(crypto_secretbox_BOXZEROBYTES);\n    };\n    nacl.secretbox.open = function(box, nonce, key) {\n        checkArrayTypes(box, nonce, key);\n        checkLengths(key, nonce);\n        var c = new Uint8Array(crypto_secretbox_BOXZEROBYTES + box.length);\n        var m = new Uint8Array(c.length);\n        for(var i = 0; i < box.length; i++)c[i + crypto_secretbox_BOXZEROBYTES] = box[i];\n        if (c.length < 32) return null;\n        if (crypto_secretbox_open(m, c, c.length, nonce, key) !== 0) return null;\n        return m.subarray(crypto_secretbox_ZEROBYTES);\n    };\n    nacl.secretbox.keyLength = crypto_secretbox_KEYBYTES;\n    nacl.secretbox.nonceLength = crypto_secretbox_NONCEBYTES;\n    nacl.secretbox.overheadLength = crypto_secretbox_BOXZEROBYTES;\n    nacl.scalarMult = function(n, p) {\n        checkArrayTypes(n, p);\n        if (n.length !== crypto_scalarmult_SCALARBYTES) throw new Error('bad n size');\n        if (p.length !== crypto_scalarmult_BYTES) throw new Error('bad p size');\n        var q = new Uint8Array(crypto_scalarmult_BYTES);\n        crypto_scalarmult(q, n, p);\n        return q;\n    };\n    nacl.scalarMult.base = function(n) {\n        checkArrayTypes(n);\n        if (n.length !== crypto_scalarmult_SCALARBYTES) throw new Error('bad n size');\n        var q = new Uint8Array(crypto_scalarmult_BYTES);\n        crypto_scalarmult_base(q, n);\n        return q;\n    };\n    nacl.scalarMult.scalarLength = crypto_scalarmult_SCALARBYTES;\n    nacl.scalarMult.groupElementLength = crypto_scalarmult_BYTES;\n    nacl.box = function(msg, nonce, publicKey, secretKey) {\n        var k = nacl.box.before(publicKey, secretKey);\n        return nacl.secretbox(msg, nonce, k);\n    };\n    nacl.box.before = function(publicKey, secretKey) {\n        checkArrayTypes(publicKey, secretKey);\n        checkBoxLengths(publicKey, secretKey);\n        var k = new Uint8Array(crypto_box_BEFORENMBYTES);\n        crypto_box_beforenm(k, publicKey, secretKey);\n        return k;\n    };\n    nacl.box.after = nacl.secretbox;\n    nacl.box.open = function(msg, nonce, publicKey, secretKey) {\n        var k = nacl.box.before(publicKey, secretKey);\n        return nacl.secretbox.open(msg, nonce, k);\n    };\n    nacl.box.open.after = nacl.secretbox.open;\n    nacl.box.keyPair = function() {\n        var pk = new Uint8Array(crypto_box_PUBLICKEYBYTES);\n        var sk = new Uint8Array(crypto_box_SECRETKEYBYTES);\n        crypto_box_keypair(pk, sk);\n        return {\n            publicKey: pk,\n            secretKey: sk\n        };\n    };\n    nacl.box.keyPair.fromSecretKey = function(secretKey) {\n        checkArrayTypes(secretKey);\n        if (secretKey.length !== crypto_box_SECRETKEYBYTES) throw new Error('bad secret key size');\n        var pk = new Uint8Array(crypto_box_PUBLICKEYBYTES);\n        crypto_scalarmult_base(pk, secretKey);\n        return {\n            publicKey: pk,\n            secretKey: new Uint8Array(secretKey)\n        };\n    };\n    nacl.box.publicKeyLength = crypto_box_PUBLICKEYBYTES;\n    nacl.box.secretKeyLength = crypto_box_SECRETKEYBYTES;\n    nacl.box.sharedKeyLength = crypto_box_BEFORENMBYTES;\n    nacl.box.nonceLength = crypto_box_NONCEBYTES;\n    nacl.box.overheadLength = nacl.secretbox.overheadLength;\n    nacl.sign = function(msg, secretKey) {\n        checkArrayTypes(msg, secretKey);\n        if (secretKey.length !== crypto_sign_SECRETKEYBYTES) throw new Error('bad secret key size');\n        var signedMsg = new Uint8Array(crypto_sign_BYTES + msg.length);\n        crypto_sign(signedMsg, msg, msg.length, secretKey);\n        return signedMsg;\n    };\n    nacl.sign.open = function(signedMsg, publicKey) {\n        checkArrayTypes(signedMsg, publicKey);\n        if (publicKey.length !== crypto_sign_PUBLICKEYBYTES) throw new Error('bad public key size');\n        var tmp = new Uint8Array(signedMsg.length);\n        var mlen = crypto_sign_open(tmp, signedMsg, signedMsg.length, publicKey);\n        if (mlen < 0) return null;\n        var m = new Uint8Array(mlen);\n        for(var i = 0; i < m.length; i++)m[i] = tmp[i];\n        return m;\n    };\n    nacl.sign.detached = function(msg, secretKey) {\n        var signedMsg = nacl.sign(msg, secretKey);\n        var sig = new Uint8Array(crypto_sign_BYTES);\n        for(var i = 0; i < sig.length; i++)sig[i] = signedMsg[i];\n        return sig;\n    };\n    nacl.sign.detached.verify = function(msg, sig, publicKey) {\n        checkArrayTypes(msg, sig, publicKey);\n        if (sig.length !== crypto_sign_BYTES) throw new Error('bad signature size');\n        if (publicKey.length !== crypto_sign_PUBLICKEYBYTES) throw new Error('bad public key size');\n        var sm = new Uint8Array(crypto_sign_BYTES + msg.length);\n        var m = new Uint8Array(crypto_sign_BYTES + msg.length);\n        var i;\n        for(i = 0; i < crypto_sign_BYTES; i++)sm[i] = sig[i];\n        for(i = 0; i < msg.length; i++)sm[i + crypto_sign_BYTES] = msg[i];\n        return crypto_sign_open(m, sm, sm.length, publicKey) >= 0;\n    };\n    nacl.sign.keyPair = function() {\n        var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n        var sk = new Uint8Array(crypto_sign_SECRETKEYBYTES);\n        crypto_sign_keypair(pk, sk);\n        return {\n            publicKey: pk,\n            secretKey: sk\n        };\n    };\n    nacl.sign.keyPair.fromSecretKey = function(secretKey) {\n        checkArrayTypes(secretKey);\n        if (secretKey.length !== crypto_sign_SECRETKEYBYTES) throw new Error('bad secret key size');\n        var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n        for(var i = 0; i < pk.length; i++)pk[i] = secretKey[32 + i];\n        return {\n            publicKey: pk,\n            secretKey: new Uint8Array(secretKey)\n        };\n    };\n    nacl.sign.keyPair.fromSeed = function(seed) {\n        checkArrayTypes(seed);\n        if (seed.length !== crypto_sign_SEEDBYTES) throw new Error('bad seed size');\n        var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n        var sk = new Uint8Array(crypto_sign_SECRETKEYBYTES);\n        for(var i = 0; i < 32; i++)sk[i] = seed[i];\n        crypto_sign_keypair(pk, sk, true);\n        return {\n            publicKey: pk,\n            secretKey: sk\n        };\n    };\n    nacl.sign.publicKeyLength = crypto_sign_PUBLICKEYBYTES;\n    nacl.sign.secretKeyLength = crypto_sign_SECRETKEYBYTES;\n    nacl.sign.seedLength = crypto_sign_SEEDBYTES;\n    nacl.sign.signatureLength = crypto_sign_BYTES;\n    nacl.hash = function(msg) {\n        checkArrayTypes(msg);\n        var h = new Uint8Array(crypto_hash_BYTES);\n        crypto_hash(h, msg, msg.length);\n        return h;\n    };\n    nacl.hash.hashLength = crypto_hash_BYTES;\n    nacl.verify = function(x, y) {\n        checkArrayTypes(x, y);\n        if (x.length === 0 || y.length === 0) return false;\n        if (x.length !== y.length) return false;\n        return vn(x, 0, y, 0, x.length) === 0 ? true : false;\n    };\n    nacl.setPRNG = function(fn) {\n        randombytes = fn;\n    };\n    (function() {\n        var crypto1 = typeof globalThis !== 'undefined' ? globalThis.crypto || globalThis.msCrypto : null;\n        if (crypto1 && crypto1.getRandomValues) {\n            var QUOTA = 65536;\n            nacl.setPRNG(function(x, n) {\n                var i, v = new Uint8Array(n);\n                for(i = 0; i < n; i += QUOTA){\n                    crypto1.getRandomValues(v.subarray(i, i + Math.min(n - i, QUOTA)));\n                }\n                for(i = 0; i < n; i++)x[i] = v[i];\n                cleanup(v);\n            });\n        } else if (typeof require !== 'undefined') {\n            crypto1 = require('crypto');\n            if (crypto1 && crypto1.randomBytes) {\n                nacl.setPRNG(function(x, n) {\n                    var i, v = crypto1.randomBytes(n);\n                    for(i = 0; i < n; i++)x[i] = v[i];\n                    cleanup(v);\n                });\n            }\n        }\n    })();\n})(typeof module !== 'undefined' && module.exports ? module.exports : globalThis.nacl = globalThis.nacl || {});\nconst nacl = typeof module !== 'undefined' && module.exports ? module.exports : globalThis.nacl;\nconst denoHelper = {\n    fromSeed: nacl.sign.keyPair.fromSeed,\n    sign: nacl.sign.detached,\n    verify: nacl.sign.detached.verify,\n    randomBytes: nacl.randomBytes\n};\nlet helper;\nfunction setEd25519Helper(lib) {\n    helper = lib;\n}\nfunction getEd25519Helper() {\n    return helper;\n}\nconst crc16tab = new Uint16Array([\n    0x0000,\n    0x1021,\n    0x2042,\n    0x3063,\n    0x4084,\n    0x50a5,\n    0x60c6,\n    0x70e7,\n    0x8108,\n    0x9129,\n    0xa14a,\n    0xb16b,\n    0xc18c,\n    0xd1ad,\n    0xe1ce,\n    0xf1ef,\n    0x1231,\n    0x0210,\n    0x3273,\n    0x2252,\n    0x52b5,\n    0x4294,\n    0x72f7,\n    0x62d6,\n    0x9339,\n    0x8318,\n    0xb37b,\n    0xa35a,\n    0xd3bd,\n    0xc39c,\n    0xf3ff,\n    0xe3de,\n    0x2462,\n    0x3443,\n    0x0420,\n    0x1401,\n    0x64e6,\n    0x74c7,\n    0x44a4,\n    0x5485,\n    0xa56a,\n    0xb54b,\n    0x8528,\n    0x9509,\n    0xe5ee,\n    0xf5cf,\n    0xc5ac,\n    0xd58d,\n    0x3653,\n    0x2672,\n    0x1611,\n    0x0630,\n    0x76d7,\n    0x66f6,\n    0x5695,\n    0x46b4,\n    0xb75b,\n    0xa77a,\n    0x9719,\n    0x8738,\n    0xf7df,\n    0xe7fe,\n    0xd79d,\n    0xc7bc,\n    0x48c4,\n    0x58e5,\n    0x6886,\n    0x78a7,\n    0x0840,\n    0x1861,\n    0x2802,\n    0x3823,\n    0xc9cc,\n    0xd9ed,\n    0xe98e,\n    0xf9af,\n    0x8948,\n    0x9969,\n    0xa90a,\n    0xb92b,\n    0x5af5,\n    0x4ad4,\n    0x7ab7,\n    0x6a96,\n    0x1a71,\n    0x0a50,\n    0x3a33,\n    0x2a12,\n    0xdbfd,\n    0xcbdc,\n    0xfbbf,\n    0xeb9e,\n    0x9b79,\n    0x8b58,\n    0xbb3b,\n    0xab1a,\n    0x6ca6,\n    0x7c87,\n    0x4ce4,\n    0x5cc5,\n    0x2c22,\n    0x3c03,\n    0x0c60,\n    0x1c41,\n    0xedae,\n    0xfd8f,\n    0xcdec,\n    0xddcd,\n    0xad2a,\n    0xbd0b,\n    0x8d68,\n    0x9d49,\n    0x7e97,\n    0x6eb6,\n    0x5ed5,\n    0x4ef4,\n    0x3e13,\n    0x2e32,\n    0x1e51,\n    0x0e70,\n    0xff9f,\n    0xefbe,\n    0xdfdd,\n    0xcffc,\n    0xbf1b,\n    0xaf3a,\n    0x9f59,\n    0x8f78,\n    0x9188,\n    0x81a9,\n    0xb1ca,\n    0xa1eb,\n    0xd10c,\n    0xc12d,\n    0xf14e,\n    0xe16f,\n    0x1080,\n    0x00a1,\n    0x30c2,\n    0x20e3,\n    0x5004,\n    0x4025,\n    0x7046,\n    0x6067,\n    0x83b9,\n    0x9398,\n    0xa3fb,\n    0xb3da,\n    0xc33d,\n    0xd31c,\n    0xe37f,\n    0xf35e,\n    0x02b1,\n    0x1290,\n    0x22f3,\n    0x32d2,\n    0x4235,\n    0x5214,\n    0x6277,\n    0x7256,\n    0xb5ea,\n    0xa5cb,\n    0x95a8,\n    0x8589,\n    0xf56e,\n    0xe54f,\n    0xd52c,\n    0xc50d,\n    0x34e2,\n    0x24c3,\n    0x14a0,\n    0x0481,\n    0x7466,\n    0x6447,\n    0x5424,\n    0x4405,\n    0xa7db,\n    0xb7fa,\n    0x8799,\n    0x97b8,\n    0xe75f,\n    0xf77e,\n    0xc71d,\n    0xd73c,\n    0x26d3,\n    0x36f2,\n    0x0691,\n    0x16b0,\n    0x6657,\n    0x7676,\n    0x4615,\n    0x5634,\n    0xd94c,\n    0xc96d,\n    0xf90e,\n    0xe92f,\n    0x99c8,\n    0x89e9,\n    0xb98a,\n    0xa9ab,\n    0x5844,\n    0x4865,\n    0x7806,\n    0x6827,\n    0x18c0,\n    0x08e1,\n    0x3882,\n    0x28a3,\n    0xcb7d,\n    0xdb5c,\n    0xeb3f,\n    0xfb1e,\n    0x8bf9,\n    0x9bd8,\n    0xabbb,\n    0xbb9a,\n    0x4a75,\n    0x5a54,\n    0x6a37,\n    0x7a16,\n    0x0af1,\n    0x1ad0,\n    0x2ab3,\n    0x3a92,\n    0xfd2e,\n    0xed0f,\n    0xdd6c,\n    0xcd4d,\n    0xbdaa,\n    0xad8b,\n    0x9de8,\n    0x8dc9,\n    0x7c26,\n    0x6c07,\n    0x5c64,\n    0x4c45,\n    0x3ca2,\n    0x2c83,\n    0x1ce0,\n    0x0cc1,\n    0xef1f,\n    0xff3e,\n    0xcf5d,\n    0xdf7c,\n    0xaf9b,\n    0xbfba,\n    0x8fd9,\n    0x9ff8,\n    0x6e17,\n    0x7e36,\n    0x4e55,\n    0x5e74,\n    0x2e93,\n    0x3eb2,\n    0x0ed1,\n    0x1ef0\n]);\nclass crc16 {\n    static checksum(data) {\n        let crc = 0;\n        for(let i = 0; i < data.byteLength; i++){\n            let b = data[i];\n            crc = crc << 8 & 0xffff ^ crc16tab[(crc >> 8 ^ b) & 0x00FF];\n        }\n        return crc;\n    }\n    static validate(data, expected) {\n        let ba = crc16.checksum(data);\n        return ba == expected;\n    }\n}\nconst b32Alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567\";\nclass base32 {\n    static encode(src) {\n        let bits = 0;\n        let value = 0;\n        let a = new Uint8Array(src);\n        let buf = new Uint8Array(src.byteLength * 2);\n        let j = 0;\n        for(let i = 0; i < a.byteLength; i++){\n            value = value << 8 | a[i];\n            bits += 8;\n            while(bits >= 5){\n                let index = value >>> bits - 5 & 31;\n                buf[j++] = b32Alphabet.charAt(index).charCodeAt(0);\n                bits -= 5;\n            }\n        }\n        if (bits > 0) {\n            let index = value << 5 - bits & 31;\n            buf[j++] = b32Alphabet.charAt(index).charCodeAt(0);\n        }\n        return buf.slice(0, j);\n    }\n    static decode(src) {\n        let bits = 0;\n        let __byte = 0;\n        let j = 0;\n        let a = new Uint8Array(src);\n        let out = new Uint8Array(a.byteLength * 5 / 8 | 0);\n        for(let i = 0; i < a.byteLength; i++){\n            let v = String.fromCharCode(a[i]);\n            let vv = b32Alphabet.indexOf(v);\n            if (vv === -1) {\n                throw new Error(\"Illegal Base32 character: \" + a[i]);\n            }\n            __byte = __byte << 5 | vv;\n            bits += 5;\n            if (bits >= 8) {\n                out[j++] = __byte >>> bits - 8 & 255;\n                bits -= 8;\n            }\n        }\n        return out.slice(0, j);\n    }\n}\nclass NKeysError extends Error {\n    name;\n    code;\n    chainedError;\n    constructor(code, chainedError){\n        super(code);\n        this.name = \"NKeysError\";\n        this.code = code;\n        this.chainedError = chainedError;\n    }\n}\nfunction createOperator() {\n    return createPair(Prefix.Operator);\n}\nfunction createAccount() {\n    return createPair(Prefix.Account);\n}\nfunction createUser() {\n    return createPair(Prefix.User);\n}\nvar NKeysErrorCode;\n(function(NKeysErrorCode) {\n    NKeysErrorCode[\"InvalidPrefixByte\"] = \"nkeys: invalid prefix byte\";\n    NKeysErrorCode[\"InvalidKey\"] = \"nkeys: invalid key\";\n    NKeysErrorCode[\"InvalidPublicKey\"] = \"nkeys: invalid public key\";\n    NKeysErrorCode[\"InvalidSeedLen\"] = \"nkeys: invalid seed length\";\n    NKeysErrorCode[\"InvalidSeed\"] = \"nkeys: invalid seed\";\n    NKeysErrorCode[\"InvalidEncoding\"] = \"nkeys: invalid encoded key\";\n    NKeysErrorCode[\"InvalidSignature\"] = \"nkeys: signature verification failed\";\n    NKeysErrorCode[\"CannotSign\"] = \"nkeys: cannot sign, no private key available\";\n    NKeysErrorCode[\"PublicKeyOnly\"] = \"nkeys: no seed or private key available\";\n    NKeysErrorCode[\"InvalidChecksum\"] = \"nkeys: invalid checksum\";\n    NKeysErrorCode[\"SerializationError\"] = \"nkeys: serialization error\";\n    NKeysErrorCode[\"ApiError\"] = \"nkeys: api error\";\n    NKeysErrorCode[\"ClearedPair\"] = \"nkeys: pair is cleared\";\n})(NKeysErrorCode || (NKeysErrorCode = {}));\nvar Prefix;\n(function(Prefix) {\n    Prefix[Prefix[\"Seed\"] = 144] = \"Seed\";\n    Prefix[Prefix[\"Private\"] = 120] = \"Private\";\n    Prefix[Prefix[\"Operator\"] = 112] = \"Operator\";\n    Prefix[Prefix[\"Server\"] = 104] = \"Server\";\n    Prefix[Prefix[\"Cluster\"] = 16] = \"Cluster\";\n    Prefix[Prefix[\"Account\"] = 0] = \"Account\";\n    Prefix[Prefix[\"User\"] = 160] = \"User\";\n})(Prefix || (Prefix = {}));\nclass Prefixes {\n    static isValidPublicPrefix(prefix) {\n        return prefix == Prefix.Server || prefix == Prefix.Operator || prefix == Prefix.Cluster || prefix == Prefix.Account || prefix == Prefix.User;\n    }\n    static startsWithValidPrefix(s) {\n        let c = s[0];\n        return c == \"S\" || c == \"P\" || c == \"O\" || c == \"N\" || c == \"C\" || c == \"A\" || c == \"U\";\n    }\n    static isValidPrefix(prefix) {\n        let v = this.parsePrefix(prefix);\n        return v != -1;\n    }\n    static parsePrefix(v) {\n        switch(v){\n            case Prefix.Seed:\n                return Prefix.Seed;\n            case Prefix.Private:\n                return Prefix.Private;\n            case Prefix.Operator:\n                return Prefix.Operator;\n            case Prefix.Server:\n                return Prefix.Server;\n            case Prefix.Cluster:\n                return Prefix.Cluster;\n            case Prefix.Account:\n                return Prefix.Account;\n            case Prefix.User:\n                return Prefix.User;\n            default:\n                return -1;\n        }\n    }\n}\nclass Codec {\n    static encode(prefix, src) {\n        if (!src || !(src instanceof Uint8Array)) {\n            throw new NKeysError(NKeysErrorCode.SerializationError);\n        }\n        if (!Prefixes.isValidPrefix(prefix)) {\n            throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n        }\n        return Codec._encode(false, prefix, src);\n    }\n    static encodeSeed(role, src) {\n        if (!src) {\n            throw new NKeysError(NKeysErrorCode.ApiError);\n        }\n        if (!Prefixes.isValidPublicPrefix(role)) {\n            throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n        }\n        if (src.byteLength !== 32) {\n            throw new NKeysError(NKeysErrorCode.InvalidSeedLen);\n        }\n        return Codec._encode(true, role, src);\n    }\n    static decode(expected, src) {\n        if (!Prefixes.isValidPrefix(expected)) {\n            throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n        }\n        const raw = Codec._decode(src);\n        if (raw[0] !== expected) {\n            throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n        }\n        return raw.slice(1);\n    }\n    static decodeSeed(src) {\n        const raw = Codec._decode(src);\n        const prefix = Codec._decodePrefix(raw);\n        if (prefix[0] != Prefix.Seed) {\n            throw new NKeysError(NKeysErrorCode.InvalidSeed);\n        }\n        if (!Prefixes.isValidPublicPrefix(prefix[1])) {\n            throw new NKeysError(NKeysErrorCode.InvalidPrefixByte);\n        }\n        return {\n            buf: raw.slice(2),\n            prefix: prefix[1]\n        };\n    }\n    static _encode(seed, role, payload) {\n        const payloadOffset = seed ? 2 : 1;\n        const payloadLen = payload.byteLength;\n        const cap = payloadOffset + payloadLen + 2;\n        const checkOffset = payloadOffset + payloadLen;\n        const raw = new Uint8Array(cap);\n        if (seed) {\n            const encodedPrefix = Codec._encodePrefix(Prefix.Seed, role);\n            raw.set(encodedPrefix);\n        } else {\n            raw[0] = role;\n        }\n        raw.set(payload, payloadOffset);\n        const checksum = crc16.checksum(raw.slice(0, checkOffset));\n        const dv = new DataView(raw.buffer);\n        dv.setUint16(checkOffset, checksum, true);\n        return base32.encode(raw);\n    }\n    static _decode(src) {\n        if (src.byteLength < 4) {\n            throw new NKeysError(NKeysErrorCode.InvalidEncoding);\n        }\n        let raw;\n        try {\n            raw = base32.decode(src);\n        } catch (ex) {\n            throw new NKeysError(NKeysErrorCode.InvalidEncoding, ex);\n        }\n        const checkOffset = raw.byteLength - 2;\n        const dv = new DataView(raw.buffer);\n        const checksum = dv.getUint16(checkOffset, true);\n        const payload = raw.slice(0, checkOffset);\n        if (!crc16.validate(payload, checksum)) {\n            throw new NKeysError(NKeysErrorCode.InvalidChecksum);\n        }\n        return payload;\n    }\n    static _encodePrefix(kind, role) {\n        const b1 = kind | role >> 5;\n        const b2 = (role & 31) << 3;\n        return new Uint8Array([\n            b1,\n            b2\n        ]);\n    }\n    static _decodePrefix(raw) {\n        const b1 = raw[0] & 248;\n        const b2 = (raw[0] & 7) << 5 | (raw[1] & 248) >> 3;\n        return new Uint8Array([\n            b1,\n            b2\n        ]);\n    }\n}\nclass KP {\n    seed;\n    constructor(seed){\n        this.seed = seed;\n    }\n    getRawSeed() {\n        if (!this.seed) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        let sd = Codec.decodeSeed(this.seed);\n        return sd.buf;\n    }\n    getSeed() {\n        if (!this.seed) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        return this.seed;\n    }\n    getPublicKey() {\n        if (!this.seed) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        const sd = Codec.decodeSeed(this.seed);\n        const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n        const buf = Codec.encode(sd.prefix, kp.publicKey);\n        return new TextDecoder().decode(buf);\n    }\n    getPrivateKey() {\n        if (!this.seed) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n        return Codec.encode(Prefix.Private, kp.secretKey);\n    }\n    sign(input) {\n        if (!this.seed) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n        return getEd25519Helper().sign(input, kp.secretKey);\n    }\n    verify(input, sig) {\n        if (!this.seed) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        const kp = getEd25519Helper().fromSeed(this.getRawSeed());\n        return getEd25519Helper().verify(input, sig, kp.publicKey);\n    }\n    clear() {\n        if (!this.seed) {\n            return;\n        }\n        this.seed.fill(0);\n        this.seed = undefined;\n    }\n}\nfunction createPair(prefix) {\n    const rawSeed = getEd25519Helper().randomBytes(32);\n    let str = Codec.encodeSeed(prefix, new Uint8Array(rawSeed));\n    return new KP(str);\n}\nclass PublicKey {\n    publicKey;\n    constructor(publicKey){\n        this.publicKey = publicKey;\n    }\n    getPublicKey() {\n        if (!this.publicKey) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        return new TextDecoder().decode(this.publicKey);\n    }\n    getPrivateKey() {\n        if (!this.publicKey) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        throw new NKeysError(NKeysErrorCode.PublicKeyOnly);\n    }\n    getSeed() {\n        if (!this.publicKey) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        throw new NKeysError(NKeysErrorCode.PublicKeyOnly);\n    }\n    sign(_) {\n        if (!this.publicKey) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        throw new NKeysError(NKeysErrorCode.CannotSign);\n    }\n    verify(input, sig) {\n        if (!this.publicKey) {\n            throw new NKeysError(NKeysErrorCode.ClearedPair);\n        }\n        let buf = Codec._decode(this.publicKey);\n        return getEd25519Helper().verify(input, sig, buf.slice(1));\n    }\n    clear() {\n        if (!this.publicKey) {\n            return;\n        }\n        this.publicKey.fill(0);\n        this.publicKey = undefined;\n    }\n}\nfunction fromPublic(src) {\n    const ba = new TextEncoder().encode(src);\n    const raw = Codec._decode(ba);\n    const prefix = Prefixes.parsePrefix(raw[0]);\n    if (Prefixes.isValidPublicPrefix(prefix)) {\n        return new PublicKey(ba);\n    }\n    throw new NKeysError(NKeysErrorCode.InvalidPublicKey);\n}\nfunction fromSeed(src) {\n    Codec.decodeSeed(src);\n    return new KP(src);\n}\nfunction encode2(bytes) {\n    return btoa(String.fromCharCode(...bytes));\n}\nfunction decode2(b64str) {\n    const bin = atob(b64str);\n    const bytes = new Uint8Array(bin.length);\n    for(let i = 0; i < bin.length; i++){\n        bytes[i] = bin.charCodeAt(i);\n    }\n    return bytes;\n}\nsetEd25519Helper(denoHelper);\nconst mod = {\n    createAccount,\n    createOperator,\n    createPair,\n    createUser,\n    fromPublic,\n    fromSeed,\n    NKeysError,\n    NKeysErrorCode,\n    Prefix,\n    decode: decode2,\n    encode: encode2\n};\nfunction multiAuthenticator(authenticators) {\n    return (nonce)=>{\n        let auth = {};\n        authenticators.forEach((a)=>{\n            const args = a(nonce) || {};\n            auth = Object.assign(auth, args);\n        });\n        return auth;\n    };\n}\nfunction noAuthFn() {\n    return ()=>{\n        return;\n    };\n}\nfunction usernamePasswordAuthenticator(user, pass) {\n    return ()=>{\n        const u = typeof user === \"function\" ? user() : user;\n        const p = typeof pass === \"function\" ? pass() : pass;\n        return {\n            user: u,\n            pass: p\n        };\n    };\n}\nfunction tokenAuthenticator(token) {\n    return ()=>{\n        const auth_token = typeof token === \"function\" ? token() : token;\n        return {\n            auth_token\n        };\n    };\n}\nfunction nkeyAuthenticator(seed) {\n    return (nonce)=>{\n        const s = typeof seed === \"function\" ? seed() : seed;\n        const kp = s ? mod.fromSeed(s) : undefined;\n        const nkey = kp ? kp.getPublicKey() : \"\";\n        const challenge = TE.encode(nonce || \"\");\n        const sigBytes = kp !== undefined && nonce ? kp.sign(challenge) : undefined;\n        const sig = sigBytes ? mod.encode(sigBytes) : \"\";\n        return {\n            nkey,\n            sig\n        };\n    };\n}\nfunction jwtAuthenticator(ajwt, seed) {\n    return (nonce)=>{\n        const jwt = typeof ajwt === \"function\" ? ajwt() : ajwt;\n        const fn = nkeyAuthenticator(seed);\n        const { nkey, sig } = fn(nonce);\n        return {\n            jwt,\n            nkey,\n            sig\n        };\n    };\n}\nfunction credsAuthenticator(creds) {\n    const fn = typeof creds !== \"function\" ? ()=>creds : creds;\n    const parse = ()=>{\n        const CREDS = /\\s*(?:(?:[-]{3,}[^\\n]*[-]{3,}\\n)(.+)(?:\\n\\s*[-]{3,}[^\\n]*[-]{3,}\\n))/ig;\n        const s = TD.decode(fn());\n        let m = CREDS.exec(s);\n        if (!m) {\n            throw NatsError.errorForCode(ErrorCode.BadCreds);\n        }\n        const jwt = m[1].trim();\n        m = CREDS.exec(s);\n        if (!m) {\n            throw NatsError.errorForCode(ErrorCode.BadCreds);\n        }\n        if (!m) {\n            throw NatsError.errorForCode(ErrorCode.BadCreds);\n        }\n        const seed = TE.encode(m[1].trim());\n        return {\n            jwt,\n            seed\n        };\n    };\n    const jwtFn = ()=>{\n        const { jwt } = parse();\n        return jwt;\n    };\n    const nkeyFn = ()=>{\n        const { seed } = parse();\n        return seed;\n    };\n    return jwtAuthenticator(jwtFn, nkeyFn);\n}\nconst DEFAULT_PING_INTERVAL = 2 * 60 * 1000;\nconst DEFAULT_MAX_PING_OUT = 2;\nconst DEFAULT_RECONNECT_TIME_WAIT = 2 * 1000;\nfunction defaultOptions() {\n    return {\n        maxPingOut: 2,\n        maxReconnectAttempts: 10,\n        noRandomize: false,\n        pedantic: false,\n        pingInterval: DEFAULT_PING_INTERVAL,\n        reconnect: true,\n        reconnectJitter: 100,\n        reconnectJitterTLS: 1000,\n        reconnectTimeWait: DEFAULT_RECONNECT_TIME_WAIT,\n        tls: undefined,\n        verbose: false,\n        waitOnFirstConnect: false,\n        ignoreAuthErrorAbort: false\n    };\n}\nfunction buildAuthenticator(opts) {\n    const buf = [];\n    if (typeof opts.authenticator === \"function\") {\n        buf.push(opts.authenticator);\n    }\n    if (Array.isArray(opts.authenticator)) {\n        buf.push(...opts.authenticator);\n    }\n    if (opts.token) {\n        buf.push(tokenAuthenticator(opts.token));\n    }\n    if (opts.user) {\n        buf.push(usernamePasswordAuthenticator(opts.user, opts.pass));\n    }\n    return buf.length === 0 ? noAuthFn() : multiAuthenticator(buf);\n}\nfunction parseOptions(opts) {\n    const dhp = `${DEFAULT_HOST}:${defaultPort()}`;\n    opts = opts || {\n        servers: [\n            dhp\n        ]\n    };\n    opts.servers = opts.servers || [];\n    if (typeof opts.servers === \"string\") {\n        opts.servers = [\n            opts.servers\n        ];\n    }\n    if (opts.servers.length > 0 && opts.port) {\n        throw new NatsError(\"port and servers options are mutually exclusive\", ErrorCode.InvalidOption);\n    }\n    if (opts.servers.length === 0 && opts.port) {\n        opts.servers = [\n            `${DEFAULT_HOST}:${opts.port}`\n        ];\n    }\n    if (opts.servers && opts.servers.length === 0) {\n        opts.servers = [\n            dhp\n        ];\n    }\n    const options = extend(defaultOptions(), opts);\n    options.authenticator = buildAuthenticator(options);\n    [\n        \"reconnectDelayHandler\",\n        \"authenticator\"\n    ].forEach((n)=>{\n        if (options[n] && typeof options[n] !== \"function\") {\n            throw new NatsError(`${n} option should be a function`, ErrorCode.NotFunction);\n        }\n    });\n    if (!options.reconnectDelayHandler) {\n        options.reconnectDelayHandler = ()=>{\n            let extra = options.tls ? options.reconnectJitterTLS : options.reconnectJitter;\n            if (extra) {\n                extra++;\n                extra = Math.floor(Math.random() * extra);\n            }\n            return options.reconnectTimeWait + extra;\n        };\n    }\n    if (options.inboxPrefix) {\n        try {\n            createInbox(options.inboxPrefix);\n        } catch (err) {\n            throw new NatsError(err.message, ErrorCode.ApiError);\n        }\n    }\n    if (options.resolve === undefined) {\n        options.resolve = typeof getResolveFn() === \"function\";\n    }\n    if (options.resolve) {\n        if (typeof getResolveFn() !== \"function\") {\n            throw new NatsError(`'resolve' is not supported on this client`, ErrorCode.InvalidOption);\n        }\n    }\n    return options;\n}\nfunction checkOptions(info, options) {\n    const { proto, tls_required: tlsRequired, tls_available: tlsAvailable } = info;\n    if ((proto === undefined || proto < 1) && options.noEcho) {\n        throw new NatsError(\"noEcho\", ErrorCode.ServerOptionNotAvailable);\n    }\n    const tls = tlsRequired || tlsAvailable || false;\n    if (options.tls && !tls) {\n        throw new NatsError(\"tls\", ErrorCode.ServerOptionNotAvailable);\n    }\n}\nconst FLUSH_THRESHOLD = 1024 * 32;\nconst INFO = /^INFO\\s+([^\\r\\n]+)\\r\\n/i;\nconst PONG_CMD = encode(\"PONG\\r\\n\");\nconst PING_CMD = encode(\"PING\\r\\n\");\nclass Connect {\n    echo;\n    no_responders;\n    protocol;\n    verbose;\n    pedantic;\n    jwt;\n    nkey;\n    sig;\n    user;\n    pass;\n    auth_token;\n    tls_required;\n    name;\n    lang;\n    version;\n    headers;\n    constructor(transport, opts, nonce){\n        this.protocol = 1;\n        this.version = transport.version;\n        this.lang = transport.lang;\n        this.echo = opts.noEcho ? false : undefined;\n        this.verbose = opts.verbose;\n        this.pedantic = opts.pedantic;\n        this.tls_required = opts.tls ? true : undefined;\n        this.name = opts.name;\n        const creds = (opts && typeof opts.authenticator === \"function\" ? opts.authenticator(nonce) : {}) || {};\n        extend(this, creds);\n    }\n}\nclass SubscriptionImpl extends QueuedIteratorImpl {\n    sid;\n    queue;\n    draining;\n    max;\n    subject;\n    drained;\n    protocol;\n    timer;\n    info;\n    cleanupFn;\n    closed;\n    requestSubject;\n    constructor(protocol, subject, opts = {}){\n        super();\n        extend(this, opts);\n        this.protocol = protocol;\n        this.subject = subject;\n        this.draining = false;\n        this.noIterator = typeof opts.callback === \"function\";\n        this.closed = deferred();\n        const asyncTraces = !(protocol.options?.noAsyncTraces || false);\n        if (opts.timeout) {\n            this.timer = timeout(opts.timeout, asyncTraces);\n            this.timer.then(()=>{\n                this.timer = undefined;\n            }).catch((err)=>{\n                this.stop(err);\n                if (this.noIterator) {\n                    this.callback(err, {});\n                }\n            });\n        }\n        if (!this.noIterator) {\n            this.iterClosed.then(()=>{\n                this.closed.resolve();\n                this.unsubscribe();\n            });\n        }\n    }\n    setPrePostHandlers(opts) {\n        if (this.noIterator) {\n            const uc = this.callback;\n            const ingestion = opts.ingestionFilterFn ? opts.ingestionFilterFn : ()=>{\n                return {\n                    ingest: true,\n                    protocol: false\n                };\n            };\n            const filter = opts.protocolFilterFn ? opts.protocolFilterFn : ()=>{\n                return true;\n            };\n            const dispatched = opts.dispatchedFn ? opts.dispatchedFn : ()=>{};\n            this.callback = (err, msg)=>{\n                const { ingest } = ingestion(msg);\n                if (!ingest) {\n                    return;\n                }\n                if (filter(msg)) {\n                    uc(err, msg);\n                    dispatched(msg);\n                }\n            };\n        } else {\n            this.protocolFilterFn = opts.protocolFilterFn;\n            this.dispatchedFn = opts.dispatchedFn;\n        }\n    }\n    callback(err, msg) {\n        this.cancelTimeout();\n        err ? this.stop(err) : this.push(msg);\n    }\n    close() {\n        if (!this.isClosed()) {\n            this.cancelTimeout();\n            const fn = ()=>{\n                this.stop();\n                if (this.cleanupFn) {\n                    try {\n                        this.cleanupFn(this, this.info);\n                    } catch (_err) {}\n                }\n                this.closed.resolve();\n            };\n            if (this.noIterator) {\n                fn();\n            } else {\n                this.push(fn);\n            }\n        }\n    }\n    unsubscribe(max) {\n        this.protocol.unsubscribe(this, max);\n    }\n    cancelTimeout() {\n        if (this.timer) {\n            this.timer.cancel();\n            this.timer = undefined;\n        }\n    }\n    drain() {\n        if (this.protocol.isClosed()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n        }\n        if (this.isClosed()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.SubClosed));\n        }\n        if (!this.drained) {\n            this.draining = true;\n            this.protocol.unsub(this);\n            this.drained = this.protocol.flush(deferred()).then(()=>{\n                this.protocol.subscriptions.cancel(this);\n            }).catch(()=>{\n                this.protocol.subscriptions.cancel(this);\n            });\n        }\n        return this.drained;\n    }\n    isDraining() {\n        return this.draining;\n    }\n    isClosed() {\n        return this.done;\n    }\n    getSubject() {\n        return this.subject;\n    }\n    getMax() {\n        return this.max;\n    }\n    getID() {\n        return this.sid;\n    }\n}\nclass Subscriptions {\n    mux;\n    subs;\n    sidCounter;\n    constructor(){\n        this.sidCounter = 0;\n        this.mux = null;\n        this.subs = new Map();\n    }\n    size() {\n        return this.subs.size;\n    }\n    add(s) {\n        this.sidCounter++;\n        s.sid = this.sidCounter;\n        this.subs.set(s.sid, s);\n        return s;\n    }\n    setMux(s) {\n        this.mux = s;\n        return s;\n    }\n    getMux() {\n        return this.mux;\n    }\n    get(sid) {\n        return this.subs.get(sid);\n    }\n    resub(s) {\n        this.sidCounter++;\n        this.subs.delete(s.sid);\n        s.sid = this.sidCounter;\n        this.subs.set(s.sid, s);\n        return s;\n    }\n    all() {\n        return Array.from(this.subs.values());\n    }\n    cancel(s) {\n        if (s) {\n            s.close();\n            this.subs.delete(s.sid);\n        }\n    }\n    handleError(err) {\n        if (err && err.permissionContext) {\n            const ctx = err.permissionContext;\n            const subs = this.all();\n            let sub;\n            if (ctx.operation === \"subscription\") {\n                sub = subs.find((s)=>{\n                    return s.subject === ctx.subject && s.queue === ctx.queue;\n                });\n            }\n            if (ctx.operation === \"publish\") {\n                sub = subs.find((s)=>{\n                    return s.requestSubject === ctx.subject;\n                });\n            }\n            if (sub) {\n                sub.callback(err, {});\n                sub.close();\n                this.subs.delete(sub.sid);\n                return sub !== this.mux;\n            }\n        }\n        return false;\n    }\n    close() {\n        this.subs.forEach((sub)=>{\n            sub.close();\n        });\n    }\n}\nclass ProtocolHandler {\n    connected;\n    connectedOnce;\n    infoReceived;\n    info;\n    muxSubscriptions;\n    options;\n    outbound;\n    pongs;\n    subscriptions;\n    transport;\n    noMorePublishing;\n    connectError;\n    publisher;\n    _closed;\n    closed;\n    listeners;\n    heartbeats;\n    parser;\n    outMsgs;\n    inMsgs;\n    outBytes;\n    inBytes;\n    pendingLimit;\n    lastError;\n    abortReconnect;\n    whyClosed;\n    servers;\n    server;\n    features;\n    connectPromise;\n    constructor(options, publisher){\n        this._closed = false;\n        this.connected = false;\n        this.connectedOnce = false;\n        this.infoReceived = false;\n        this.noMorePublishing = false;\n        this.abortReconnect = false;\n        this.listeners = [];\n        this.pendingLimit = FLUSH_THRESHOLD;\n        this.outMsgs = 0;\n        this.inMsgs = 0;\n        this.outBytes = 0;\n        this.inBytes = 0;\n        this.options = options;\n        this.publisher = publisher;\n        this.subscriptions = new Subscriptions();\n        this.muxSubscriptions = new MuxSubscription();\n        this.outbound = new DataBuffer();\n        this.pongs = [];\n        this.whyClosed = \"\";\n        this.pendingLimit = options.pendingLimit || this.pendingLimit;\n        this.features = new Features({\n            major: 0,\n            minor: 0,\n            micro: 0\n        });\n        this.connectPromise = null;\n        const servers = typeof options.servers === \"string\" ? [\n            options.servers\n        ] : options.servers;\n        this.servers = new Servers(servers, {\n            randomize: !options.noRandomize\n        });\n        this.closed = deferred();\n        this.parser = new Parser(this);\n        this.heartbeats = new Heartbeat(this, this.options.pingInterval || DEFAULT_PING_INTERVAL, this.options.maxPingOut || DEFAULT_MAX_PING_OUT);\n    }\n    resetOutbound() {\n        this.outbound.reset();\n        const pongs = this.pongs;\n        this.pongs = [];\n        const err = NatsError.errorForCode(ErrorCode.Disconnect);\n        err.stack = \"\";\n        pongs.forEach((p)=>{\n            p.reject(err);\n        });\n        this.parser = new Parser(this);\n        this.infoReceived = false;\n    }\n    dispatchStatus(status) {\n        this.listeners.forEach((q)=>{\n            q.push(status);\n        });\n    }\n    status() {\n        const iter = new QueuedIteratorImpl();\n        this.listeners.push(iter);\n        return iter;\n    }\n    prepare() {\n        if (this.transport) {\n            this.transport.discard();\n        }\n        this.info = undefined;\n        this.resetOutbound();\n        const pong = deferred();\n        pong.catch(()=>{});\n        this.pongs.unshift(pong);\n        this.connectError = (err)=>{\n            pong.reject(err);\n        };\n        this.transport = newTransport();\n        this.transport.closed().then(async (_err)=>{\n            this.connected = false;\n            if (!this.isClosed()) {\n                await this.disconnected(this.transport.closeError || this.lastError);\n                return;\n            }\n        });\n        return pong;\n    }\n    disconnect() {\n        this.dispatchStatus({\n            type: DebugEvents.StaleConnection,\n            data: \"\"\n        });\n        this.transport.disconnect();\n    }\n    reconnect() {\n        if (this.connected) {\n            this.dispatchStatus({\n                type: DebugEvents.ClientInitiatedReconnect,\n                data: \"\"\n            });\n            this.transport.disconnect();\n        }\n        return Promise.resolve();\n    }\n    async disconnected(err) {\n        this.dispatchStatus({\n            type: Events.Disconnect,\n            data: this.servers.getCurrentServer().toString()\n        });\n        if (this.options.reconnect) {\n            await this.dialLoop().then(()=>{\n                this.dispatchStatus({\n                    type: Events.Reconnect,\n                    data: this.servers.getCurrentServer().toString()\n                });\n                if (this.lastError?.code === ErrorCode.AuthenticationExpired) {\n                    this.lastError = undefined;\n                }\n            }).catch((err)=>{\n                this._close(err);\n            });\n        } else {\n            await this._close(err);\n        }\n    }\n    async dial(srv) {\n        const pong = this.prepare();\n        let timer;\n        try {\n            timer = timeout(this.options.timeout || 20000);\n            const cp = this.transport.connect(srv, this.options);\n            await Promise.race([\n                cp,\n                timer\n            ]);\n            (async ()=>{\n                try {\n                    for await (const b of this.transport){\n                        this.parser.parse(b);\n                    }\n                } catch (err) {\n                    console.log(\"reader closed\", err);\n                }\n            })().then();\n        } catch (err) {\n            pong.reject(err);\n        }\n        try {\n            await Promise.race([\n                timer,\n                pong\n            ]);\n            if (timer) {\n                timer.cancel();\n            }\n            this.connected = true;\n            this.connectError = undefined;\n            this.sendSubscriptions();\n            this.connectedOnce = true;\n            this.server.didConnect = true;\n            this.server.reconnects = 0;\n            this.flushPending();\n            this.heartbeats.start();\n        } catch (err) {\n            if (timer) {\n                timer.cancel();\n            }\n            await this.transport.close(err);\n            throw err;\n        }\n    }\n    async _doDial(srv) {\n        const { resolve } = this.options;\n        const alts = await srv.resolve({\n            fn: getResolveFn(),\n            debug: this.options.debug,\n            randomize: !this.options.noRandomize,\n            resolve\n        });\n        let lastErr = null;\n        for (const a of alts){\n            try {\n                lastErr = null;\n                this.dispatchStatus({\n                    type: DebugEvents.Reconnecting,\n                    data: a.toString()\n                });\n                await this.dial(a);\n                return;\n            } catch (err) {\n                lastErr = err;\n            }\n        }\n        throw lastErr;\n    }\n    dialLoop() {\n        if (this.connectPromise === null) {\n            this.connectPromise = this.dodialLoop();\n            this.connectPromise.then(()=>{}).catch(()=>{}).finally(()=>{\n                this.connectPromise = null;\n            });\n        }\n        return this.connectPromise;\n    }\n    async dodialLoop() {\n        let lastError;\n        while(true){\n            if (this._closed) {\n                this.servers.clear();\n            }\n            const wait = this.options.reconnectDelayHandler ? this.options.reconnectDelayHandler() : DEFAULT_RECONNECT_TIME_WAIT;\n            let maxWait = wait;\n            const srv = this.selectServer();\n            if (!srv || this.abortReconnect) {\n                if (lastError) {\n                    throw lastError;\n                } else if (this.lastError) {\n                    throw this.lastError;\n                } else {\n                    throw NatsError.errorForCode(ErrorCode.ConnectionRefused);\n                }\n            }\n            const now = Date.now();\n            if (srv.lastConnect === 0 || srv.lastConnect + wait <= now) {\n                srv.lastConnect = Date.now();\n                try {\n                    await this._doDial(srv);\n                    break;\n                } catch (err) {\n                    lastError = err;\n                    if (!this.connectedOnce) {\n                        if (this.options.waitOnFirstConnect) {\n                            continue;\n                        }\n                        this.servers.removeCurrentServer();\n                    }\n                    srv.reconnects++;\n                    const mra = this.options.maxReconnectAttempts || 0;\n                    if (mra !== -1 && srv.reconnects >= mra) {\n                        this.servers.removeCurrentServer();\n                    }\n                }\n            } else {\n                maxWait = Math.min(maxWait, srv.lastConnect + wait - now);\n                await delay(maxWait);\n            }\n        }\n    }\n    static async connect(options, publisher) {\n        const h = new ProtocolHandler(options, publisher);\n        await h.dialLoop();\n        return h;\n    }\n    static toError(s) {\n        const t = s ? s.toLowerCase() : \"\";\n        if (t.indexOf(\"permissions violation\") !== -1) {\n            const err = new NatsError(s, ErrorCode.PermissionsViolation);\n            const m = s.match(/(Publish|Subscription) to \"(\\S+)\"/);\n            if (m) {\n                err.permissionContext = {\n                    operation: m[1].toLowerCase(),\n                    subject: m[2],\n                    queue: undefined\n                };\n                const qm = s.match(/using queue \"(\\S+)\"/);\n                if (qm) {\n                    err.permissionContext.queue = qm[1];\n                }\n            }\n            return err;\n        } else if (t.indexOf(\"authorization violation\") !== -1) {\n            return new NatsError(s, ErrorCode.AuthorizationViolation);\n        } else if (t.indexOf(\"user authentication expired\") !== -1) {\n            return new NatsError(s, ErrorCode.AuthenticationExpired);\n        } else if (t.indexOf(\"account authentication expired\") != -1) {\n            return new NatsError(s, ErrorCode.AccountExpired);\n        } else if (t.indexOf(\"authentication timeout\") !== -1) {\n            return new NatsError(s, ErrorCode.AuthenticationTimeout);\n        } else {\n            return new NatsError(s, ErrorCode.ProtocolError);\n        }\n    }\n    processMsg(msg, data) {\n        this.inMsgs++;\n        this.inBytes += data.length;\n        if (!this.subscriptions.sidCounter) {\n            return;\n        }\n        const sub = this.subscriptions.get(msg.sid);\n        if (!sub) {\n            return;\n        }\n        sub.received += 1;\n        if (sub.callback) {\n            sub.callback(null, new MsgImpl(msg, data, this));\n        }\n        if (sub.max !== undefined && sub.received >= sub.max) {\n            sub.unsubscribe();\n        }\n    }\n    processError(m) {\n        const s = decode(m);\n        const err = ProtocolHandler.toError(s);\n        const status = {\n            type: Events.Error,\n            data: err.code\n        };\n        if (err.isPermissionError()) {\n            let isMuxPermissionError = false;\n            if (err.permissionContext) {\n                status.permissionContext = err.permissionContext;\n                const mux = this.subscriptions.getMux();\n                isMuxPermissionError = mux?.subject === err.permissionContext.subject;\n            }\n            this.subscriptions.handleError(err);\n            this.muxSubscriptions.handleError(isMuxPermissionError, err);\n            if (isMuxPermissionError) {\n                this.subscriptions.setMux(null);\n            }\n        }\n        this.dispatchStatus(status);\n        this.handleError(err);\n    }\n    handleError(err) {\n        if (err.isAuthError()) {\n            this.handleAuthError(err);\n        } else if (err.isProtocolError()) {\n            this.lastError = err;\n        } else if (err.isAuthTimeout()) {\n            this.lastError = err;\n        }\n        if (!err.isPermissionError()) {\n            this.lastError = err;\n        }\n    }\n    handleAuthError(err) {\n        if (this.lastError && err.code === this.lastError.code && this.options.ignoreAuthErrorAbort === false) {\n            this.abortReconnect = true;\n        }\n        if (this.connectError) {\n            this.connectError(err);\n        } else {\n            this.disconnect();\n        }\n    }\n    processPing() {\n        this.transport.send(PONG_CMD);\n    }\n    processPong() {\n        const cb = this.pongs.shift();\n        if (cb) {\n            cb.resolve();\n        }\n    }\n    processInfo(m) {\n        const info = JSON.parse(decode(m));\n        this.info = info;\n        const updates = this.options && this.options.ignoreClusterUpdates ? undefined : this.servers.update(info, this.transport.isEncrypted());\n        if (!this.infoReceived) {\n            this.features.update(parseSemVer(info.version));\n            this.infoReceived = true;\n            if (this.transport.isEncrypted()) {\n                this.servers.updateTLSName();\n            }\n            const { version, lang } = this.transport;\n            try {\n                const c = new Connect({\n                    version,\n                    lang\n                }, this.options, info.nonce);\n                if (info.headers) {\n                    c.headers = true;\n                    c.no_responders = true;\n                }\n                const cs = JSON.stringify(c);\n                this.transport.send(encode(`CONNECT ${cs}${CR_LF}`));\n                this.transport.send(PING_CMD);\n            } catch (err) {\n                this._close(err);\n            }\n        }\n        if (updates) {\n            this.dispatchStatus({\n                type: Events.Update,\n                data: updates\n            });\n        }\n        const ldm = info.ldm !== undefined ? info.ldm : false;\n        if (ldm) {\n            this.dispatchStatus({\n                type: Events.LDM,\n                data: this.servers.getCurrentServer().toString()\n            });\n        }\n    }\n    push(e) {\n        switch(e.kind){\n            case Kind.MSG:\n                {\n                    const { msg, data } = e;\n                    this.processMsg(msg, data);\n                    break;\n                }\n            case Kind.OK:\n                break;\n            case Kind.ERR:\n                this.processError(e.data);\n                break;\n            case Kind.PING:\n                this.processPing();\n                break;\n            case Kind.PONG:\n                this.processPong();\n                break;\n            case Kind.INFO:\n                this.processInfo(e.data);\n                break;\n        }\n    }\n    sendCommand(cmd, ...payloads) {\n        const len = this.outbound.length();\n        let buf;\n        if (typeof cmd === \"string\") {\n            buf = encode(cmd);\n        } else {\n            buf = cmd;\n        }\n        this.outbound.fill(buf, ...payloads);\n        if (len === 0) {\n            queueMicrotask(()=>{\n                this.flushPending();\n            });\n        } else if (this.outbound.size() >= this.pendingLimit) {\n            this.flushPending();\n        }\n    }\n    publish(subject, payload = Empty, options) {\n        let data;\n        if (payload instanceof Uint8Array) {\n            data = payload;\n        } else if (typeof payload === \"string\") {\n            data = TE.encode(payload);\n        } else {\n            throw NatsError.errorForCode(ErrorCode.BadPayload);\n        }\n        let len = data.length;\n        options = options || {};\n        options.reply = options.reply || \"\";\n        let headers = Empty;\n        let hlen = 0;\n        if (options.headers) {\n            if (this.info && !this.info.headers) {\n                throw new NatsError(\"headers\", ErrorCode.ServerOptionNotAvailable);\n            }\n            const hdrs = options.headers;\n            headers = hdrs.encode();\n            hlen = headers.length;\n            len = data.length + hlen;\n        }\n        if (this.info && len > this.info.max_payload) {\n            throw NatsError.errorForCode(ErrorCode.MaxPayloadExceeded);\n        }\n        this.outBytes += len;\n        this.outMsgs++;\n        let proto;\n        if (options.headers) {\n            if (options.reply) {\n                proto = `HPUB ${subject} ${options.reply} ${hlen} ${len}\\r\\n`;\n            } else {\n                proto = `HPUB ${subject} ${hlen} ${len}\\r\\n`;\n            }\n            this.sendCommand(proto, headers, data, CRLF);\n        } else {\n            if (options.reply) {\n                proto = `PUB ${subject} ${options.reply} ${len}\\r\\n`;\n            } else {\n                proto = `PUB ${subject} ${len}\\r\\n`;\n            }\n            this.sendCommand(proto, data, CRLF);\n        }\n    }\n    request(r) {\n        this.initMux();\n        this.muxSubscriptions.add(r);\n        return r;\n    }\n    subscribe(s) {\n        this.subscriptions.add(s);\n        this._subunsub(s);\n        return s;\n    }\n    _sub(s) {\n        if (s.queue) {\n            this.sendCommand(`SUB ${s.subject} ${s.queue} ${s.sid}\\r\\n`);\n        } else {\n            this.sendCommand(`SUB ${s.subject} ${s.sid}\\r\\n`);\n        }\n    }\n    _subunsub(s) {\n        this._sub(s);\n        if (s.max) {\n            this.unsubscribe(s, s.max);\n        }\n        return s;\n    }\n    unsubscribe(s, max) {\n        this.unsub(s, max);\n        if (s.max === undefined || s.received >= s.max) {\n            this.subscriptions.cancel(s);\n        }\n    }\n    unsub(s, max) {\n        if (!s || this.isClosed()) {\n            return;\n        }\n        if (max) {\n            this.sendCommand(`UNSUB ${s.sid} ${max}\\r\\n`);\n        } else {\n            this.sendCommand(`UNSUB ${s.sid}\\r\\n`);\n        }\n        s.max = max;\n    }\n    resub(s, subject) {\n        if (!s || this.isClosed()) {\n            return;\n        }\n        this.unsub(s);\n        s.subject = subject;\n        this.subscriptions.resub(s);\n        this._sub(s);\n    }\n    flush(p) {\n        if (!p) {\n            p = deferred();\n        }\n        this.pongs.push(p);\n        this.outbound.fill(PING_CMD);\n        this.flushPending();\n        return p;\n    }\n    sendSubscriptions() {\n        const cmds = [];\n        this.subscriptions.all().forEach((s)=>{\n            const sub = s;\n            if (sub.queue) {\n                cmds.push(`SUB ${sub.subject} ${sub.queue} ${sub.sid}${CR_LF}`);\n            } else {\n                cmds.push(`SUB ${sub.subject} ${sub.sid}${CR_LF}`);\n            }\n        });\n        if (cmds.length) {\n            this.transport.send(encode(cmds.join(\"\")));\n        }\n    }\n    async _close(err) {\n        if (this._closed) {\n            return;\n        }\n        this.whyClosed = new Error(\"close trace\").stack || \"\";\n        this.heartbeats.cancel();\n        if (this.connectError) {\n            this.connectError(err);\n            this.connectError = undefined;\n        }\n        this.muxSubscriptions.close();\n        this.subscriptions.close();\n        this.listeners.forEach((l)=>{\n            l.stop();\n        });\n        this._closed = true;\n        await this.transport.close(err);\n        await this.closed.resolve(err);\n    }\n    close() {\n        return this._close();\n    }\n    isClosed() {\n        return this._closed;\n    }\n    drain() {\n        const subs = this.subscriptions.all();\n        const promises = [];\n        subs.forEach((sub)=>{\n            promises.push(sub.drain());\n        });\n        return Promise.all(promises).then(async ()=>{\n            this.noMorePublishing = true;\n            await this.flush();\n            return this.close();\n        }).catch(()=>{});\n    }\n    flushPending() {\n        if (!this.infoReceived || !this.connected) {\n            return;\n        }\n        if (this.outbound.size()) {\n            const d = this.outbound.drain();\n            this.transport.send(d);\n        }\n    }\n    initMux() {\n        const mux = this.subscriptions.getMux();\n        if (!mux) {\n            const inbox = this.muxSubscriptions.init(this.options.inboxPrefix);\n            const sub = new SubscriptionImpl(this, `${inbox}*`);\n            sub.callback = this.muxSubscriptions.dispatcher();\n            this.subscriptions.setMux(sub);\n            this.subscribe(sub);\n        }\n    }\n    selectServer() {\n        const server = this.servers.selectServer();\n        if (server === undefined) {\n            return undefined;\n        }\n        this.server = server;\n        return this.server;\n    }\n    getServer() {\n        return this.server;\n    }\n}\nconst ServiceApiPrefix = \"$SRV\";\nclass ServiceMsgImpl {\n    msg;\n    constructor(msg){\n        this.msg = msg;\n    }\n    get data() {\n        return this.msg.data;\n    }\n    get sid() {\n        return this.msg.sid;\n    }\n    get subject() {\n        return this.msg.subject;\n    }\n    get reply() {\n        return this.msg.reply || \"\";\n    }\n    get headers() {\n        return this.msg.headers;\n    }\n    respond(data, opts) {\n        return this.msg.respond(data, opts);\n    }\n    respondError(code, description, data, opts) {\n        opts = opts || {};\n        opts.headers = opts.headers || headers();\n        opts.headers?.set(ServiceErrorCodeHeader, `${code}`);\n        opts.headers?.set(ServiceErrorHeader, description);\n        return this.msg.respond(data, opts);\n    }\n    json(reviver) {\n        return this.msg.json(reviver);\n    }\n    string() {\n        return this.msg.string();\n    }\n}\nclass ServiceGroupImpl {\n    subject;\n    queue;\n    srv;\n    constructor(parent, name = \"\", queue = \"\"){\n        if (name !== \"\") {\n            validInternalToken(\"service group\", name);\n        }\n        let root = \"\";\n        if (parent instanceof ServiceImpl) {\n            this.srv = parent;\n            root = \"\";\n        } else if (parent instanceof ServiceGroupImpl) {\n            const sg = parent;\n            this.srv = sg.srv;\n            if (queue === \"\" && sg.queue !== \"\") {\n                queue = sg.queue;\n            }\n            root = sg.subject;\n        } else {\n            throw new Error(\"unknown ServiceGroup type\");\n        }\n        this.subject = this.calcSubject(root, name);\n        this.queue = queue;\n    }\n    calcSubject(root, name = \"\") {\n        if (name === \"\") {\n            return root;\n        }\n        return root !== \"\" ? `${root}.${name}` : name;\n    }\n    addEndpoint(name = \"\", opts) {\n        opts = opts || {\n            subject: name\n        };\n        const args = typeof opts === \"function\" ? {\n            handler: opts,\n            subject: name\n        } : opts;\n        validateName(\"endpoint\", name);\n        let { subject, handler, metadata, queue } = args;\n        subject = subject || name;\n        queue = queue || this.queue;\n        validSubjectName(\"endpoint subject\", subject);\n        subject = this.calcSubject(this.subject, subject);\n        const ne = {\n            name,\n            subject,\n            queue,\n            handler,\n            metadata\n        };\n        return this.srv._addEndpoint(ne);\n    }\n    addGroup(name = \"\", queue = \"\") {\n        return new ServiceGroupImpl(this, name, queue);\n    }\n}\nfunction validSubjectName(context, subj) {\n    if (subj === \"\") {\n        throw new Error(`${context} cannot be empty`);\n    }\n    if (subj.indexOf(\" \") !== -1) {\n        throw new Error(`${context} cannot contain spaces: '${subj}'`);\n    }\n    const tokens = subj.split(\".\");\n    tokens.forEach((v, idx)=>{\n        if (v === \">\" && idx !== tokens.length - 1) {\n            throw new Error(`${context} cannot have internal '>': '${subj}'`);\n        }\n    });\n}\nfunction validInternalToken(context, subj) {\n    if (subj.indexOf(\" \") !== -1) {\n        throw new Error(`${context} cannot contain spaces: '${subj}'`);\n    }\n    const tokens = subj.split(\".\");\n    tokens.forEach((v)=>{\n        if (v === \">\") {\n            throw new Error(`${context} name cannot contain internal '>': '${subj}'`);\n        }\n    });\n}\nclass ServiceImpl {\n    nc;\n    _id;\n    config;\n    handlers;\n    internal;\n    _stopped;\n    _done;\n    started;\n    static controlSubject(verb, name = \"\", id = \"\", prefix) {\n        const pre = prefix ?? ServiceApiPrefix;\n        if (name === \"\" && id === \"\") {\n            return `${pre}.${verb}`;\n        }\n        validateName(\"control subject name\", name);\n        if (id !== \"\") {\n            validateName(\"control subject id\", id);\n            return `${pre}.${verb}.${name}.${id}`;\n        }\n        return `${pre}.${verb}.${name}`;\n    }\n    constructor(nc, config = {\n        name: \"\",\n        version: \"\"\n    }){\n        this.nc = nc;\n        this.config = Object.assign({}, config);\n        if (!this.config.queue) {\n            this.config.queue = \"q\";\n        }\n        validateName(\"name\", this.config.name);\n        validateName(\"queue\", this.config.queue);\n        parseSemVer(this.config.version);\n        this._id = nuid.next();\n        this.internal = [];\n        this._done = deferred();\n        this._stopped = false;\n        this.handlers = [];\n        this.started = new Date().toISOString();\n        this.reset();\n        this.nc.closed().then(()=>{\n            this.close().catch();\n        }).catch((err)=>{\n            this.close(err).catch();\n        });\n    }\n    get subjects() {\n        return this.handlers.filter((s)=>{\n            return s.internal === false;\n        }).map((s)=>{\n            return s.subject;\n        });\n    }\n    get id() {\n        return this._id;\n    }\n    get name() {\n        return this.config.name;\n    }\n    get description() {\n        return this.config.description ?? \"\";\n    }\n    get version() {\n        return this.config.version;\n    }\n    get metadata() {\n        return this.config.metadata;\n    }\n    errorToHeader(err) {\n        const h = headers();\n        if (err instanceof ServiceError) {\n            const se = err;\n            h.set(ServiceErrorHeader, se.message);\n            h.set(ServiceErrorCodeHeader, `${se.code}`);\n        } else {\n            h.set(ServiceErrorHeader, err.message);\n            h.set(ServiceErrorCodeHeader, \"500\");\n        }\n        return h;\n    }\n    setupHandler(h, internal = false) {\n        const queue = internal ? \"\" : h.queue ? h.queue : this.config.queue;\n        const { name, subject, handler } = h;\n        const sv = h;\n        sv.internal = internal;\n        if (internal) {\n            this.internal.push(sv);\n        }\n        sv.stats = new NamedEndpointStatsImpl(name, subject, queue);\n        sv.queue = queue;\n        const callback = handler ? (err, msg)=>{\n            if (err) {\n                this.close(err);\n                return;\n            }\n            const start = Date.now();\n            try {\n                handler(err, new ServiceMsgImpl(msg));\n            } catch (err) {\n                sv.stats.countError(err);\n                msg?.respond(Empty, {\n                    headers: this.errorToHeader(err)\n                });\n            } finally{\n                sv.stats.countLatency(start);\n            }\n        } : undefined;\n        sv.sub = this.nc.subscribe(subject, {\n            callback,\n            queue\n        });\n        sv.sub.closed.then(()=>{\n            if (!this._stopped) {\n                this.close(new Error(`required subscription ${h.subject} stopped`)).catch();\n            }\n        }).catch((err)=>{\n            if (!this._stopped) {\n                const ne = new Error(`required subscription ${h.subject} errored: ${err.message}`);\n                ne.stack = err.stack;\n                this.close(ne).catch();\n            }\n        });\n        return sv;\n    }\n    info() {\n        return {\n            type: ServiceResponseType.INFO,\n            name: this.name,\n            id: this.id,\n            version: this.version,\n            description: this.description,\n            metadata: this.metadata,\n            endpoints: this.endpoints()\n        };\n    }\n    endpoints() {\n        return this.handlers.map((v)=>{\n            const { subject, metadata, name, queue } = v;\n            return {\n                subject,\n                metadata,\n                name,\n                queue_group: queue\n            };\n        });\n    }\n    async stats() {\n        const endpoints = [];\n        for (const h of this.handlers){\n            if (typeof this.config.statsHandler === \"function\") {\n                try {\n                    h.stats.data = await this.config.statsHandler(h);\n                } catch (err) {\n                    h.stats.countError(err);\n                }\n            }\n            endpoints.push(h.stats.stats(h.qi));\n        }\n        return {\n            type: ServiceResponseType.STATS,\n            name: this.name,\n            id: this.id,\n            version: this.version,\n            started: this.started,\n            metadata: this.metadata,\n            endpoints\n        };\n    }\n    addInternalHandler(verb, handler) {\n        const v = `${verb}`.toUpperCase();\n        this._doAddInternalHandler(`${v}-all`, verb, handler);\n        this._doAddInternalHandler(`${v}-kind`, verb, handler, this.name);\n        this._doAddInternalHandler(`${v}`, verb, handler, this.name, this.id);\n    }\n    _doAddInternalHandler(name, verb, handler, kind = \"\", id = \"\") {\n        const endpoint = {};\n        endpoint.name = name;\n        endpoint.subject = ServiceImpl.controlSubject(verb, kind, id);\n        endpoint.handler = handler;\n        this.setupHandler(endpoint, true);\n    }\n    start() {\n        const jc = JSONCodec();\n        const statsHandler = (err, msg)=>{\n            if (err) {\n                this.close(err);\n                return Promise.reject(err);\n            }\n            return this.stats().then((s)=>{\n                msg?.respond(jc.encode(s));\n                return Promise.resolve();\n            });\n        };\n        const infoHandler = (err, msg)=>{\n            if (err) {\n                this.close(err);\n                return Promise.reject(err);\n            }\n            msg?.respond(jc.encode(this.info()));\n            return Promise.resolve();\n        };\n        const ping = jc.encode(this.ping());\n        const pingHandler = (err, msg)=>{\n            if (err) {\n                this.close(err).then().catch();\n                return Promise.reject(err);\n            }\n            msg.respond(ping);\n            return Promise.resolve();\n        };\n        this.addInternalHandler(ServiceVerb.PING, pingHandler);\n        this.addInternalHandler(ServiceVerb.STATS, statsHandler);\n        this.addInternalHandler(ServiceVerb.INFO, infoHandler);\n        this.handlers.forEach((h)=>{\n            const { subject } = h;\n            if (typeof subject !== \"string\") {\n                return;\n            }\n            if (h.handler === null) {\n                return;\n            }\n            this.setupHandler(h);\n        });\n        return Promise.resolve(this);\n    }\n    close(err) {\n        if (this._stopped) {\n            return this._done;\n        }\n        this._stopped = true;\n        let buf = [];\n        if (!this.nc.isClosed()) {\n            buf = this.handlers.concat(this.internal).map((h)=>{\n                return h.sub.drain();\n            });\n        }\n        Promise.allSettled(buf).then(()=>{\n            this._done.resolve(err ? err : null);\n        });\n        return this._done;\n    }\n    get stopped() {\n        return this._done;\n    }\n    get isStopped() {\n        return this._stopped;\n    }\n    stop(err) {\n        return this.close(err);\n    }\n    ping() {\n        return {\n            type: ServiceResponseType.PING,\n            name: this.name,\n            id: this.id,\n            version: this.version,\n            metadata: this.metadata\n        };\n    }\n    reset() {\n        this.started = new Date().toISOString();\n        if (this.handlers) {\n            for (const h of this.handlers){\n                h.stats.reset(h.qi);\n            }\n        }\n    }\n    addGroup(name, queue) {\n        return new ServiceGroupImpl(this, name, queue);\n    }\n    addEndpoint(name, handler) {\n        const sg = new ServiceGroupImpl(this);\n        return sg.addEndpoint(name, handler);\n    }\n    _addEndpoint(e) {\n        const qi = new QueuedIteratorImpl();\n        qi.noIterator = typeof e.handler === \"function\";\n        if (!qi.noIterator) {\n            e.handler = (err, msg)=>{\n                err ? this.stop(err).catch() : qi.push(new ServiceMsgImpl(msg));\n            };\n            qi.iterClosed.then(()=>{\n                this.close().catch();\n            });\n        }\n        const ss = this.setupHandler(e, false);\n        ss.qi = qi;\n        this.handlers.push(ss);\n        return qi;\n    }\n}\nclass NamedEndpointStatsImpl {\n    name;\n    subject;\n    average_processing_time;\n    num_requests;\n    processing_time;\n    num_errors;\n    last_error;\n    data;\n    metadata;\n    queue;\n    constructor(name, subject, queue = \"\"){\n        this.name = name;\n        this.subject = subject;\n        this.average_processing_time = 0;\n        this.num_errors = 0;\n        this.num_requests = 0;\n        this.processing_time = 0;\n        this.queue = queue;\n    }\n    reset(qi) {\n        this.num_requests = 0;\n        this.processing_time = 0;\n        this.average_processing_time = 0;\n        this.num_errors = 0;\n        this.last_error = undefined;\n        this.data = undefined;\n        const qii = qi;\n        if (qii) {\n            qii.time = 0;\n            qii.processed = 0;\n        }\n    }\n    countLatency(start) {\n        this.num_requests++;\n        this.processing_time += nanos(Date.now() - start);\n        this.average_processing_time = Math.round(this.processing_time / this.num_requests);\n    }\n    countError(err) {\n        this.num_errors++;\n        this.last_error = err.message;\n    }\n    _stats() {\n        const { name, subject, average_processing_time, num_errors, num_requests, processing_time, last_error, data, queue } = this;\n        return {\n            name,\n            subject,\n            average_processing_time,\n            num_errors,\n            num_requests,\n            processing_time,\n            last_error,\n            data,\n            queue_group: queue\n        };\n    }\n    stats(qi) {\n        const qii = qi;\n        if (qii?.noIterator === false) {\n            this.processing_time = nanos(qii.time);\n            this.num_requests = qii.processed;\n            this.average_processing_time = this.processing_time > 0 && this.num_requests > 0 ? this.processing_time / this.num_requests : 0;\n        }\n        return this._stats();\n    }\n}\nclass ServiceClientImpl {\n    nc;\n    prefix;\n    opts;\n    constructor(nc, opts = {\n        strategy: RequestStrategy.JitterTimer,\n        maxWait: 2000\n    }, prefix){\n        this.nc = nc;\n        this.prefix = prefix;\n        this.opts = opts;\n    }\n    ping(name = \"\", id = \"\") {\n        return this.q(ServiceVerb.PING, name, id);\n    }\n    stats(name = \"\", id = \"\") {\n        return this.q(ServiceVerb.STATS, name, id);\n    }\n    info(name = \"\", id = \"\") {\n        return this.q(ServiceVerb.INFO, name, id);\n    }\n    async q(v, name = \"\", id = \"\") {\n        const iter = new QueuedIteratorImpl();\n        const jc = JSONCodec();\n        const subj = ServiceImpl.controlSubject(v, name, id, this.prefix);\n        const responses = await this.nc.requestMany(subj, Empty, this.opts);\n        (async ()=>{\n            for await (const m of responses){\n                try {\n                    const s = jc.decode(m.data);\n                    iter.push(s);\n                } catch (err) {\n                    iter.push(()=>{\n                        iter.stop(err);\n                    });\n                }\n            }\n            iter.push(()=>{\n                iter.stop();\n            });\n        })().catch((err)=>{\n            iter.stop(err);\n        });\n        return iter;\n    }\n}\nclass Metric {\n    name;\n    duration;\n    date;\n    payload;\n    msgs;\n    lang;\n    version;\n    bytes;\n    asyncRequests;\n    min;\n    max;\n    constructor(name, duration){\n        this.name = name;\n        this.duration = duration;\n        this.date = Date.now();\n        this.payload = 0;\n        this.msgs = 0;\n        this.bytes = 0;\n    }\n    toString() {\n        const sec = this.duration / 1000;\n        const mps = Math.round(this.msgs / sec);\n        const label = this.asyncRequests ? \"asyncRequests\" : \"\";\n        let minmax = \"\";\n        if (this.max) {\n            minmax = `${this.min}/${this.max}`;\n        }\n        return `${this.name}${label ? \" [asyncRequests]\" : \"\"} ${humanizeNumber(mps)} msgs/sec - [${sec.toFixed(2)} secs] ~ ${throughput(this.bytes, sec)} ${minmax}`;\n    }\n    toCsv() {\n        return `\"${this.name}\",${new Date(this.date).toISOString()},${this.lang},${this.version},${this.msgs},${this.payload},${this.bytes},${this.duration},${this.asyncRequests ? this.asyncRequests : false}\\n`;\n    }\n    static header() {\n        return `Test,Date,Lang,Version,Count,MsgPayload,Bytes,Millis,Async\\n`;\n    }\n}\nclass Bench {\n    nc;\n    callbacks;\n    msgs;\n    size;\n    subject;\n    asyncRequests;\n    pub;\n    sub;\n    req;\n    rep;\n    perf;\n    payload;\n    constructor(nc, opts = {\n        msgs: 100000,\n        size: 128,\n        subject: \"\",\n        asyncRequests: false,\n        pub: false,\n        sub: false,\n        req: false,\n        rep: false\n    }){\n        this.nc = nc;\n        this.callbacks = opts.callbacks || false;\n        this.msgs = opts.msgs || 0;\n        this.size = opts.size || 0;\n        this.subject = opts.subject || nuid.next();\n        this.asyncRequests = opts.asyncRequests || false;\n        this.pub = opts.pub || false;\n        this.sub = opts.sub || false;\n        this.req = opts.req || false;\n        this.rep = opts.rep || false;\n        this.perf = new Perf();\n        this.payload = this.size ? new Uint8Array(this.size) : Empty;\n        if (!this.pub && !this.sub && !this.req && !this.rep) {\n            throw new Error(\"no bench option selected\");\n        }\n    }\n    async run() {\n        this.nc.closed().then((err)=>{\n            if (err) {\n                throw new NatsError(`bench closed with an error: ${err.message}`, ErrorCode.Unknown, err);\n            }\n        });\n        if (this.callbacks) {\n            await this.runCallbacks();\n        } else {\n            await this.runAsync();\n        }\n        return this.processMetrics();\n    }\n    processMetrics() {\n        const nc = this.nc;\n        const { lang, version } = nc.protocol.transport;\n        if (this.pub && this.sub) {\n            this.perf.measure(\"pubsub\", \"pubStart\", \"subStop\");\n        }\n        if (this.req && this.rep) {\n            this.perf.measure(\"reqrep\", \"reqStart\", \"reqStop\");\n        }\n        const measures = this.perf.getEntries();\n        const pubsub = measures.find((m)=>m.name === \"pubsub\");\n        const reqrep = measures.find((m)=>m.name === \"reqrep\");\n        const req = measures.find((m)=>m.name === \"req\");\n        const rep = measures.find((m)=>m.name === \"rep\");\n        const pub = measures.find((m)=>m.name === \"pub\");\n        const sub = measures.find((m)=>m.name === \"sub\");\n        const stats = this.nc.stats();\n        const metrics = [];\n        if (pubsub) {\n            const { name, duration } = pubsub;\n            const m = new Metric(name, duration);\n            m.msgs = this.msgs * 2;\n            m.bytes = stats.inBytes + stats.outBytes;\n            m.lang = lang;\n            m.version = version;\n            m.payload = this.payload.length;\n            metrics.push(m);\n        }\n        if (reqrep) {\n            const { name, duration } = reqrep;\n            const m = new Metric(name, duration);\n            m.msgs = this.msgs * 2;\n            m.bytes = stats.inBytes + stats.outBytes;\n            m.lang = lang;\n            m.version = version;\n            m.payload = this.payload.length;\n            metrics.push(m);\n        }\n        if (pub) {\n            const { name, duration } = pub;\n            const m = new Metric(name, duration);\n            m.msgs = this.msgs;\n            m.bytes = stats.outBytes;\n            m.lang = lang;\n            m.version = version;\n            m.payload = this.payload.length;\n            metrics.push(m);\n        }\n        if (sub) {\n            const { name, duration } = sub;\n            const m = new Metric(name, duration);\n            m.msgs = this.msgs;\n            m.bytes = stats.inBytes;\n            m.lang = lang;\n            m.version = version;\n            m.payload = this.payload.length;\n            metrics.push(m);\n        }\n        if (rep) {\n            const { name, duration } = rep;\n            const m = new Metric(name, duration);\n            m.msgs = this.msgs;\n            m.bytes = stats.inBytes + stats.outBytes;\n            m.lang = lang;\n            m.version = version;\n            m.payload = this.payload.length;\n            metrics.push(m);\n        }\n        if (req) {\n            const { name, duration } = req;\n            const m = new Metric(name, duration);\n            m.msgs = this.msgs;\n            m.bytes = stats.inBytes + stats.outBytes;\n            m.lang = lang;\n            m.version = version;\n            m.payload = this.payload.length;\n            metrics.push(m);\n        }\n        return metrics;\n    }\n    async runCallbacks() {\n        const jobs = [];\n        if (this.sub) {\n            const d = deferred();\n            jobs.push(d);\n            let i = 0;\n            this.nc.subscribe(this.subject, {\n                max: this.msgs,\n                callback: ()=>{\n                    i++;\n                    if (i === 1) {\n                        this.perf.mark(\"subStart\");\n                    }\n                    if (i === this.msgs) {\n                        this.perf.mark(\"subStop\");\n                        this.perf.measure(\"sub\", \"subStart\", \"subStop\");\n                        d.resolve();\n                    }\n                }\n            });\n        }\n        if (this.rep) {\n            const d = deferred();\n            jobs.push(d);\n            let i = 0;\n            this.nc.subscribe(this.subject, {\n                max: this.msgs,\n                callback: (_, m)=>{\n                    m.respond(this.payload);\n                    i++;\n                    if (i === 1) {\n                        this.perf.mark(\"repStart\");\n                    }\n                    if (i === this.msgs) {\n                        this.perf.mark(\"repStop\");\n                        this.perf.measure(\"rep\", \"repStart\", \"repStop\");\n                        d.resolve();\n                    }\n                }\n            });\n        }\n        if (this.pub) {\n            const job = (async ()=>{\n                this.perf.mark(\"pubStart\");\n                for(let i = 0; i < this.msgs; i++){\n                    this.nc.publish(this.subject, this.payload);\n                }\n                await this.nc.flush();\n                this.perf.mark(\"pubStop\");\n                this.perf.measure(\"pub\", \"pubStart\", \"pubStop\");\n            })();\n            jobs.push(job);\n        }\n        if (this.req) {\n            const job = (async ()=>{\n                if (this.asyncRequests) {\n                    this.perf.mark(\"reqStart\");\n                    const a = [];\n                    for(let i = 0; i < this.msgs; i++){\n                        a.push(this.nc.request(this.subject, this.payload, {\n                            timeout: 20000\n                        }));\n                    }\n                    await Promise.all(a);\n                    this.perf.mark(\"reqStop\");\n                    this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n                } else {\n                    this.perf.mark(\"reqStart\");\n                    for(let i = 0; i < this.msgs; i++){\n                        await this.nc.request(this.subject);\n                    }\n                    this.perf.mark(\"reqStop\");\n                    this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n                }\n            })();\n            jobs.push(job);\n        }\n        await Promise.all(jobs);\n    }\n    async runAsync() {\n        const jobs = [];\n        if (this.rep) {\n            let first = false;\n            const sub = this.nc.subscribe(this.subject, {\n                max: this.msgs\n            });\n            const job = (async ()=>{\n                for await (const m of sub){\n                    if (!first) {\n                        this.perf.mark(\"repStart\");\n                        first = true;\n                    }\n                    m.respond(this.payload);\n                }\n                await this.nc.flush();\n                this.perf.mark(\"repStop\");\n                this.perf.measure(\"rep\", \"repStart\", \"repStop\");\n            })();\n            jobs.push(job);\n        }\n        if (this.sub) {\n            let first = false;\n            const sub = this.nc.subscribe(this.subject, {\n                max: this.msgs\n            });\n            const job = (async ()=>{\n                for await (const _m of sub){\n                    if (!first) {\n                        this.perf.mark(\"subStart\");\n                        first = true;\n                    }\n                }\n                this.perf.mark(\"subStop\");\n                this.perf.measure(\"sub\", \"subStart\", \"subStop\");\n            })();\n            jobs.push(job);\n        }\n        if (this.pub) {\n            const job = (async ()=>{\n                this.perf.mark(\"pubStart\");\n                for(let i = 0; i < this.msgs; i++){\n                    this.nc.publish(this.subject, this.payload);\n                }\n                await this.nc.flush();\n                this.perf.mark(\"pubStop\");\n                this.perf.measure(\"pub\", \"pubStart\", \"pubStop\");\n            })();\n            jobs.push(job);\n        }\n        if (this.req) {\n            const job = (async ()=>{\n                if (this.asyncRequests) {\n                    this.perf.mark(\"reqStart\");\n                    const a = [];\n                    for(let i = 0; i < this.msgs; i++){\n                        a.push(this.nc.request(this.subject, this.payload, {\n                            timeout: 20000\n                        }));\n                    }\n                    await Promise.all(a);\n                    this.perf.mark(\"reqStop\");\n                    this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n                } else {\n                    this.perf.mark(\"reqStart\");\n                    for(let i = 0; i < this.msgs; i++){\n                        await this.nc.request(this.subject);\n                    }\n                    this.perf.mark(\"reqStop\");\n                    this.perf.measure(\"req\", \"reqStart\", \"reqStop\");\n                }\n            })();\n            jobs.push(job);\n        }\n        await Promise.all(jobs);\n    }\n}\nfunction throughput(bytes, seconds) {\n    return `${humanizeBytes(bytes / seconds)}/sec`;\n}\nfunction humanizeBytes(bytes, si = false) {\n    const base = si ? 1000 : 1024;\n    const pre = si ? [\n        \"k\",\n        \"M\",\n        \"G\",\n        \"T\",\n        \"P\",\n        \"E\"\n    ] : [\n        \"K\",\n        \"M\",\n        \"G\",\n        \"T\",\n        \"P\",\n        \"E\"\n    ];\n    const post = si ? \"iB\" : \"B\";\n    if (bytes < base) {\n        return `${bytes.toFixed(2)} ${post}`;\n    }\n    const exp = parseInt(Math.log(bytes) / Math.log(base) + \"\");\n    const index = parseInt(exp - 1 + \"\");\n    return `${(bytes / Math.pow(base, exp)).toFixed(2)} ${pre[index]}${post}`;\n}\nfunction humanizeNumber(n) {\n    return n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\nexport { backoff as backoff, Bench as Bench, buildAuthenticator as buildAuthenticator, canonicalMIMEHeaderKey as canonicalMIMEHeaderKey, createInbox as createInbox, credsAuthenticator as credsAuthenticator, deadline as deadline, DebugEvents as DebugEvents, deferred as deferred, delay as delay, Empty as Empty, ErrorCode as ErrorCode, Events as Events, headers as headers, JSONCodec as JSONCodec, jwtAuthenticator as jwtAuthenticator, Match as Match, Metric as Metric, millis as millis, MsgHdrsImpl as MsgHdrsImpl, nanos as nanos, NatsError as NatsError, nkeyAuthenticator as nkeyAuthenticator, mod as nkeys, Nuid as Nuid, nuid as nuid, RequestStrategy as RequestStrategy, ServiceError as ServiceError, ServiceErrorCodeHeader as ServiceErrorCodeHeader, ServiceErrorHeader as ServiceErrorHeader, ServiceResponseType as ServiceResponseType, ServiceVerb as ServiceVerb, StringCodec as StringCodec, syncIterator as syncIterator, tokenAuthenticator as tokenAuthenticator, usernamePasswordAuthenticator as usernamePasswordAuthenticator };\nfunction NoopKvCodecs() {\n    return {\n        key: {\n            encode (k) {\n                return k;\n            },\n            decode (k) {\n                return k;\n            }\n        },\n        value: {\n            encode (v) {\n                return v;\n            },\n            decode (v) {\n                return v;\n            }\n        }\n    };\n}\nfunction defaultBucketOpts() {\n    return {\n        replicas: 1,\n        history: 1,\n        timeout: 2000,\n        max_bytes: -1,\n        maxValueSize: -1,\n        codec: NoopKvCodecs(),\n        storage: StorageType.File\n    };\n}\nconst kvOperationHdr = \"KV-Operation\";\nconst kvSubjectPrefix = \"$KV\";\nconst validKeyRe = /^[-/=.\\w]+$/;\nconst validSearchKey = /^[-/=.>*\\w]+$/;\nconst validBucketRe = /^[-\\w]+$/;\nfunction validateKey(k) {\n    if (k.startsWith(\".\") || k.endsWith(\".\") || !validKeyRe.test(k)) {\n        throw new Error(`invalid key: ${k}`);\n    }\n}\nfunction validateSearchKey(k) {\n    if (k.startsWith(\".\") || k.endsWith(\".\") || !validSearchKey.test(k)) {\n        throw new Error(`invalid key: ${k}`);\n    }\n}\nfunction hasWildcards(k) {\n    if (k.startsWith(\".\") || k.endsWith(\".\")) {\n        throw new Error(`invalid key: ${k}`);\n    }\n    const chunks = k.split(\".\");\n    let hasWildcards = false;\n    for(let i = 0; i < chunks.length; i++){\n        switch(chunks[i]){\n            case \"*\":\n                hasWildcards = true;\n                break;\n            case \">\":\n                if (i !== chunks.length - 1) {\n                    throw new Error(`invalid key: ${k}`);\n                }\n                hasWildcards = true;\n                break;\n            default:\n        }\n    }\n    return hasWildcards;\n}\nfunction validateBucket(name) {\n    if (!validBucketRe.test(name)) {\n        throw new Error(`invalid bucket name: ${name}`);\n    }\n}\nvar PubHeaders;\n(function(PubHeaders) {\n    PubHeaders[\"MsgIdHdr\"] = \"Nats-Msg-Id\";\n    PubHeaders[\"ExpectedStreamHdr\"] = \"Nats-Expected-Stream\";\n    PubHeaders[\"ExpectedLastSeqHdr\"] = \"Nats-Expected-Last-Sequence\";\n    PubHeaders[\"ExpectedLastMsgIdHdr\"] = \"Nats-Expected-Last-Msg-Id\";\n    PubHeaders[\"ExpectedLastSubjectSequenceHdr\"] = \"Nats-Expected-Last-Subject-Sequence\";\n})(PubHeaders || (PubHeaders = {}));\nclass Bucket {\n    js;\n    jsm;\n    stream;\n    bucket;\n    direct;\n    codec;\n    prefix;\n    editPrefix;\n    useJsPrefix;\n    _prefixLen;\n    constructor(bucket, js, jsm){\n        validateBucket(bucket);\n        this.js = js;\n        this.jsm = jsm;\n        this.bucket = bucket;\n        this.prefix = kvSubjectPrefix;\n        this.editPrefix = \"\";\n        this.useJsPrefix = false;\n        this._prefixLen = 0;\n    }\n    static async create(js, name, opts = {}) {\n        validateBucket(name);\n        const jsm = await js.jetstreamManager();\n        const bucket = new Bucket(name, js, jsm);\n        await bucket.init(opts);\n        return bucket;\n    }\n    static async bind(js, name, opts = {}) {\n        const jsm = await js.jetstreamManager();\n        const info = {\n            config: {\n                allow_direct: opts.allow_direct\n            }\n        };\n        validateBucket(name);\n        const bucket = new Bucket(name, js, jsm);\n        info.config.name = opts.streamName ?? bucket.bucketName();\n        Object.assign(bucket, info);\n        bucket.stream = info.config.name;\n        bucket.codec = opts.codec || NoopKvCodecs();\n        bucket.direct = info.config.allow_direct ?? false;\n        bucket.initializePrefixes(info);\n        return bucket;\n    }\n    async init(opts = {}) {\n        const bo = Object.assign(defaultBucketOpts(), opts);\n        this.codec = bo.codec;\n        const sc = {};\n        this.stream = sc.name = opts.streamName ?? this.bucketName();\n        sc.retention = RetentionPolicy.Limits;\n        sc.max_msgs_per_subject = bo.history;\n        if (bo.maxBucketSize) {\n            bo.max_bytes = bo.maxBucketSize;\n        }\n        if (bo.max_bytes) {\n            sc.max_bytes = bo.max_bytes;\n        }\n        sc.max_msg_size = bo.maxValueSize;\n        sc.storage = bo.storage;\n        const location = opts.placementCluster ?? \"\";\n        if (location) {\n            opts.placement = {};\n            opts.placement.cluster = location;\n            opts.placement.tags = [];\n        }\n        if (opts.placement) {\n            sc.placement = opts.placement;\n        }\n        if (opts.republish) {\n            sc.republish = opts.republish;\n        }\n        if (opts.description) {\n            sc.description = opts.description;\n        }\n        if (opts.mirror) {\n            const mirror = Object.assign({}, opts.mirror);\n            if (!mirror.name.startsWith(kvPrefix)) {\n                mirror.name = `${kvPrefix}${mirror.name}`;\n            }\n            sc.mirror = mirror;\n            sc.mirror_direct = true;\n        } else if (opts.sources) {\n            const sources = opts.sources.map((s)=>{\n                const c = Object.assign({}, s);\n                const srcBucketName = c.name.startsWith(kvPrefix) ? c.name.substring(kvPrefix.length) : c.name;\n                if (!c.name.startsWith(kvPrefix)) {\n                    c.name = `${kvPrefix}${c.name}`;\n                }\n                if (!s.external && srcBucketName !== this.bucket) {\n                    c.subject_transforms = [\n                        {\n                            src: `$KV.${srcBucketName}.>`,\n                            dest: `$KV.${this.bucket}.>`\n                        }\n                    ];\n                }\n                return c;\n            });\n            sc.sources = sources;\n            sc.subjects = [\n                this.subjectForBucket()\n            ];\n        } else {\n            sc.subjects = [\n                this.subjectForBucket()\n            ];\n        }\n        if (opts.metadata) {\n            sc.metadata = opts.metadata;\n        }\n        if (typeof opts.compression === \"boolean\") {\n            sc.compression = opts.compression ? StoreCompression.S2 : StoreCompression.None;\n        }\n        const nci = this.js.nc;\n        const have = nci.getServerVersion();\n        const discardNew = have ? compare(have, parseSemVer(\"2.7.2\")) >= 0 : false;\n        sc.discard = discardNew ? DiscardPolicy.New : DiscardPolicy.Old;\n        const { ok: direct, min } = nci.features.get(Feature.JS_ALLOW_DIRECT);\n        if (!direct && opts.allow_direct === true) {\n            const v = have ? `${have.major}.${have.minor}.${have.micro}` : \"unknown\";\n            return Promise.reject(new Error(`allow_direct is not available on server version ${v} - requires ${min}`));\n        }\n        opts.allow_direct = typeof opts.allow_direct === \"boolean\" ? opts.allow_direct : direct;\n        sc.allow_direct = opts.allow_direct;\n        this.direct = sc.allow_direct;\n        sc.num_replicas = bo.replicas;\n        if (bo.ttl) {\n            sc.max_age = nanos(bo.ttl);\n        }\n        sc.allow_rollup_hdrs = true;\n        let info;\n        try {\n            info = await this.jsm.streams.info(sc.name);\n            if (!info.config.allow_direct && this.direct === true) {\n                this.direct = false;\n            }\n        } catch (err) {\n            if (err.message === \"stream not found\") {\n                info = await this.jsm.streams.add(sc);\n            } else {\n                throw err;\n            }\n        }\n        this.initializePrefixes(info);\n    }\n    initializePrefixes(info) {\n        this._prefixLen = 0;\n        this.prefix = `$KV.${this.bucket}`;\n        this.useJsPrefix = this.js.apiPrefix !== \"$JS.API\";\n        const { mirror } = info.config;\n        if (mirror) {\n            let n = mirror.name;\n            if (n.startsWith(kvPrefix)) {\n                n = n.substring(kvPrefix.length);\n            }\n            if (mirror.external && mirror.external.api !== \"\") {\n                const mb = mirror.name.substring(kvPrefix.length);\n                this.useJsPrefix = false;\n                this.prefix = `$KV.${mb}`;\n                this.editPrefix = `${mirror.external.api}.$KV.${n}`;\n            } else {\n                this.editPrefix = this.prefix;\n            }\n        }\n    }\n    bucketName() {\n        return this.stream ?? `${kvPrefix}${this.bucket}`;\n    }\n    subjectForBucket() {\n        return `${this.prefix}.${this.bucket}.>`;\n    }\n    subjectForKey(k, edit = false) {\n        const builder = [];\n        if (edit) {\n            if (this.useJsPrefix) {\n                builder.push(this.js.apiPrefix);\n            }\n            if (this.editPrefix !== \"\") {\n                builder.push(this.editPrefix);\n            } else {\n                builder.push(this.prefix);\n            }\n        } else {\n            if (this.prefix) {\n                builder.push(this.prefix);\n            }\n        }\n        builder.push(k);\n        return builder.join(\".\");\n    }\n    fullKeyName(k) {\n        if (this.prefix !== \"\") {\n            return `${this.prefix}.${k}`;\n        }\n        return `${kvSubjectPrefix}.${this.bucket}.${k}`;\n    }\n    get prefixLen() {\n        if (this._prefixLen === 0) {\n            this._prefixLen = this.prefix.length + 1;\n        }\n        return this._prefixLen;\n    }\n    encodeKey(key) {\n        const chunks = [];\n        for (const t of key.split(\".\")){\n            switch(t){\n                case \">\":\n                case \"*\":\n                    chunks.push(t);\n                    break;\n                default:\n                    chunks.push(this.codec.key.encode(t));\n                    break;\n            }\n        }\n        return chunks.join(\".\");\n    }\n    decodeKey(ekey) {\n        const chunks = [];\n        for (const t of ekey.split(\".\")){\n            switch(t){\n                case \">\":\n                case \"*\":\n                    chunks.push(t);\n                    break;\n                default:\n                    chunks.push(this.codec.key.decode(t));\n                    break;\n            }\n        }\n        return chunks.join(\".\");\n    }\n    validateKey = validateKey;\n    validateSearchKey = validateSearchKey;\n    hasWildcards = hasWildcards;\n    close() {\n        return Promise.resolve();\n    }\n    dataLen(data, h) {\n        const slen = h ? h.get(JsHeaders.MessageSizeHdr) || \"\" : \"\";\n        if (slen !== \"\") {\n            return parseInt(slen, 10);\n        }\n        return data.length;\n    }\n    smToEntry(sm) {\n        return new KvStoredEntryImpl(this.bucket, this.prefixLen, sm);\n    }\n    jmToEntry(jm) {\n        const key = this.decodeKey(jm.subject.substring(this.prefixLen));\n        return new KvJsMsgEntryImpl(this.bucket, key, jm);\n    }\n    async create(k, data) {\n        let firstErr;\n        try {\n            const n = await this.put(k, data, {\n                previousSeq: 0\n            });\n            return Promise.resolve(n);\n        } catch (err) {\n            firstErr = err;\n            if (err?.api_error?.err_code !== 10071) {\n                return Promise.reject(err);\n            }\n        }\n        let rev = 0;\n        try {\n            const e = await this.get(k);\n            if (e?.operation === \"DEL\" || e?.operation === \"PURGE\") {\n                rev = e !== null ? e.revision : 0;\n                return this.update(k, data, rev);\n            } else {\n                return Promise.reject(firstErr);\n            }\n        } catch (err) {\n            return Promise.reject(err);\n        }\n    }\n    update(k, data, version) {\n        if (version <= 0) {\n            throw new Error(\"version must be greater than 0\");\n        }\n        return this.put(k, data, {\n            previousSeq: version\n        });\n    }\n    async put(k, data, opts = {}) {\n        const ek = this.encodeKey(k);\n        this.validateKey(ek);\n        const o = {};\n        if (opts.previousSeq !== undefined) {\n            const h = headers();\n            o.headers = h;\n            h.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${opts.previousSeq}`);\n        }\n        try {\n            const pa = await this.js.publish(this.subjectForKey(ek, true), data, o);\n            return pa.seq;\n        } catch (err) {\n            const ne = err;\n            if (ne.isJetStreamError()) {\n                ne.message = ne.api_error?.description;\n                ne.code = `${ne.api_error?.code}`;\n                return Promise.reject(ne);\n            }\n            return Promise.reject(err);\n        }\n    }\n    async get(k, opts) {\n        const ek = this.encodeKey(k);\n        this.validateKey(ek);\n        let arg = {\n            last_by_subj: this.subjectForKey(ek)\n        };\n        if (opts && opts.revision > 0) {\n            arg = {\n                seq: opts.revision\n            };\n        }\n        let sm;\n        try {\n            if (this.direct) {\n                const direct = this.jsm.direct;\n                sm = await direct.getMessage(this.bucketName(), arg);\n            } else {\n                sm = await this.jsm.streams.getMessage(this.bucketName(), arg);\n            }\n            const ke = this.smToEntry(sm);\n            if (ke.key !== ek) {\n                return null;\n            }\n            return ke;\n        } catch (err) {\n            if (err.code === ErrorCode.JetStream404NoMessages) {\n                return null;\n            }\n            throw err;\n        }\n    }\n    purge(k, opts) {\n        return this._deleteOrPurge(k, \"PURGE\", opts);\n    }\n    delete(k, opts) {\n        return this._deleteOrPurge(k, \"DEL\", opts);\n    }\n    async purgeDeletes(olderMillis = 30 * 60 * 1000) {\n        const done = deferred();\n        const buf = [];\n        const i = await this.watch({\n            key: \">\",\n            initializedFn: ()=>{\n                done.resolve();\n            }\n        });\n        (async ()=>{\n            for await (const e of i){\n                if (e.operation === \"DEL\" || e.operation === \"PURGE\") {\n                    buf.push(e);\n                }\n            }\n        })().then();\n        await done;\n        i.stop();\n        const min = Date.now() - olderMillis;\n        const proms = buf.map((e)=>{\n            const subj = this.subjectForKey(e.key);\n            if (e.created.getTime() >= min) {\n                return this.jsm.streams.purge(this.stream, {\n                    filter: subj,\n                    keep: 1\n                });\n            } else {\n                return this.jsm.streams.purge(this.stream, {\n                    filter: subj,\n                    keep: 0\n                });\n            }\n        });\n        const purged = await Promise.all(proms);\n        purged.unshift({\n            success: true,\n            purged: 0\n        });\n        return purged.reduce((pv, cv)=>{\n            pv.purged += cv.purged;\n            return pv;\n        });\n    }\n    async _deleteOrPurge(k, op, opts) {\n        if (!this.hasWildcards(k)) {\n            return this._doDeleteOrPurge(k, op, opts);\n        }\n        const iter = await this.keys(k);\n        const buf = [];\n        for await (const k of iter){\n            buf.push(this._doDeleteOrPurge(k, op));\n            if (buf.length === 100) {\n                await Promise.all(buf);\n                buf.length = 0;\n            }\n        }\n        if (buf.length > 0) {\n            await Promise.all(buf);\n        }\n    }\n    async _doDeleteOrPurge(k, op, opts) {\n        const ek = this.encodeKey(k);\n        this.validateKey(ek);\n        const h = headers();\n        h.set(kvOperationHdr, op);\n        if (op === \"PURGE\") {\n            h.set(JsHeaders.RollupHdr, JsHeaders.RollupValueSubject);\n        }\n        if (opts?.previousSeq) {\n            h.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${opts.previousSeq}`);\n        }\n        await this.js.publish(this.subjectForKey(ek, true), Empty, {\n            headers: h\n        });\n    }\n    _buildCC(k, content, opts = {}) {\n        const a = !Array.isArray(k) ? [\n            k\n        ] : k;\n        let filter_subjects = a.map((k)=>{\n            const ek = this.encodeKey(k);\n            this.validateSearchKey(k);\n            return this.fullKeyName(ek);\n        });\n        let deliver_policy = DeliverPolicy.LastPerSubject;\n        if (content === KvWatchInclude.AllHistory) {\n            deliver_policy = DeliverPolicy.All;\n        }\n        if (content === KvWatchInclude.UpdatesOnly) {\n            deliver_policy = DeliverPolicy.New;\n        }\n        let filter_subject = undefined;\n        if (filter_subjects.length === 1) {\n            filter_subject = filter_subjects[0];\n            filter_subjects = undefined;\n        }\n        return Object.assign({\n            deliver_policy,\n            \"ack_policy\": AckPolicy.None,\n            filter_subjects,\n            filter_subject,\n            \"flow_control\": true,\n            \"idle_heartbeat\": nanos(5 * 1000)\n        }, opts);\n    }\n    remove(k) {\n        return this.purge(k);\n    }\n    async history(opts = {}) {\n        const k = opts.key ?? \">\";\n        const qi = new QueuedIteratorImpl();\n        const co = {};\n        co.headers_only = opts.headers_only || false;\n        let fn;\n        fn = ()=>{\n            qi.stop();\n        };\n        let count = 0;\n        const cc = this._buildCC(k, KvWatchInclude.AllHistory, co);\n        const subj = cc.filter_subject;\n        const copts = consumerOpts(cc);\n        copts.bindStream(this.stream);\n        copts.orderedConsumer();\n        copts.callback((err, jm)=>{\n            if (err) {\n                qi.stop(err);\n                return;\n            }\n            if (jm) {\n                const e = this.jmToEntry(jm);\n                qi.push(e);\n                qi.received++;\n                if (fn && count > 0 && qi.received >= count || jm.info.pending === 0) {\n                    qi.push(fn);\n                    fn = undefined;\n                }\n            }\n        });\n        const sub = await this.js.subscribe(subj, copts);\n        if (fn) {\n            const { info: { last } } = sub;\n            const expect = last.num_pending + last.delivered.consumer_seq;\n            if (expect === 0 || qi.received >= expect) {\n                try {\n                    fn();\n                } catch (err) {\n                    qi.stop(err);\n                } finally{\n                    fn = undefined;\n                }\n            } else {\n                count = expect;\n            }\n        }\n        qi._data = sub;\n        qi.iterClosed.then(()=>{\n            sub.unsubscribe();\n        });\n        sub.closed.then(()=>{\n            qi.stop();\n        }).catch((err)=>{\n            qi.stop(err);\n        });\n        return qi;\n    }\n    canSetWatcherName() {\n        const jsi = this.js;\n        const nci = jsi.nc;\n        const { ok } = nci.features.get(Feature.JS_NEW_CONSUMER_CREATE_API);\n        return ok;\n    }\n    async watch(opts = {}) {\n        const k = opts.key ?? \">\";\n        const qi = new QueuedIteratorImpl();\n        const co = {};\n        co.headers_only = opts.headers_only || false;\n        let content = KvWatchInclude.LastValue;\n        if (opts.include === KvWatchInclude.AllHistory) {\n            content = KvWatchInclude.AllHistory;\n        } else if (opts.include === KvWatchInclude.UpdatesOnly) {\n            content = KvWatchInclude.UpdatesOnly;\n        }\n        const ignoreDeletes = opts.ignoreDeletes === true;\n        let fn = opts.initializedFn;\n        let count = 0;\n        const cc = this._buildCC(k, content, co);\n        const subj = cc.filter_subject;\n        const copts = consumerOpts(cc);\n        if (this.canSetWatcherName()) {\n            copts.consumerName(nuid.next());\n        }\n        copts.bindStream(this.stream);\n        if (opts.resumeFromRevision && opts.resumeFromRevision > 0) {\n            copts.startSequence(opts.resumeFromRevision);\n        }\n        copts.orderedConsumer();\n        copts.callback((err, jm)=>{\n            if (err) {\n                qi.stop(err);\n                return;\n            }\n            if (jm) {\n                const e = this.jmToEntry(jm);\n                if (ignoreDeletes && e.operation === \"DEL\") {\n                    return;\n                }\n                qi.push(e);\n                qi.received++;\n                if (fn && (count > 0 && qi.received >= count || jm.info.pending === 0)) {\n                    qi.push(fn);\n                    fn = undefined;\n                }\n            }\n        });\n        const sub = await this.js.subscribe(subj, copts);\n        if (fn) {\n            const { info: { last } } = sub;\n            const expect = last.num_pending + last.delivered.consumer_seq;\n            if (expect === 0 || qi.received >= expect) {\n                try {\n                    fn();\n                } catch (err) {\n                    qi.stop(err);\n                } finally{\n                    fn = undefined;\n                }\n            } else {\n                count = expect;\n            }\n        }\n        qi._data = sub;\n        qi.iterClosed.then(()=>{\n            sub.unsubscribe();\n        });\n        sub.closed.then(()=>{\n            qi.stop();\n        }).catch((err)=>{\n            qi.stop(err);\n        });\n        return qi;\n    }\n    async keys(k = \">\") {\n        const keys = new QueuedIteratorImpl();\n        const cc = this._buildCC(k, KvWatchInclude.LastValue, {\n            headers_only: true\n        });\n        const subj = Array.isArray(k) ? \">\" : cc.filter_subject;\n        const copts = consumerOpts(cc);\n        copts.bindStream(this.stream);\n        copts.orderedConsumer();\n        const sub = await this.js.subscribe(subj, copts);\n        (async ()=>{\n            for await (const jm of sub){\n                const op = jm.headers?.get(kvOperationHdr);\n                if (op !== \"DEL\" && op !== \"PURGE\") {\n                    const key = this.decodeKey(jm.subject.substring(this.prefixLen));\n                    keys.push(key);\n                }\n                if (jm.info.pending === 0) {\n                    sub.unsubscribe();\n                }\n            }\n        })().then(()=>{\n            keys.stop();\n        }).catch((err)=>{\n            keys.stop(err);\n        });\n        const si = sub;\n        if (si.info.last.num_pending === 0) {\n            sub.unsubscribe();\n        }\n        return keys;\n    }\n    purgeBucket(opts) {\n        return this.jsm.streams.purge(this.bucketName(), opts);\n    }\n    destroy() {\n        return this.jsm.streams.delete(this.bucketName());\n    }\n    async status() {\n        const nc = this.js.nc;\n        const cluster = nc.info?.cluster ?? \"\";\n        const bn = this.bucketName();\n        const si = await this.jsm.streams.info(bn);\n        return new KvStatusImpl(si, cluster);\n    }\n}\nclass KvStatusImpl {\n    si;\n    cluster;\n    constructor(si, cluster = \"\"){\n        this.si = si;\n        this.cluster = cluster;\n    }\n    get bucket() {\n        return this.si.config.name.startsWith(kvPrefix) ? this.si.config.name.substring(kvPrefix.length) : this.si.config.name;\n    }\n    get values() {\n        return this.si.state.messages;\n    }\n    get history() {\n        return this.si.config.max_msgs_per_subject;\n    }\n    get ttl() {\n        return millis(this.si.config.max_age);\n    }\n    get bucket_location() {\n        return this.cluster;\n    }\n    get backingStore() {\n        return this.si.config.storage;\n    }\n    get storage() {\n        return this.si.config.storage;\n    }\n    get replicas() {\n        return this.si.config.num_replicas;\n    }\n    get description() {\n        return this.si.config.description ?? \"\";\n    }\n    get maxBucketSize() {\n        return this.si.config.max_bytes;\n    }\n    get maxValueSize() {\n        return this.si.config.max_msg_size;\n    }\n    get max_bytes() {\n        return this.si.config.max_bytes;\n    }\n    get placement() {\n        return this.si.config.placement || {\n            cluster: \"\",\n            tags: []\n        };\n    }\n    get placementCluster() {\n        return this.si.config.placement?.cluster ?? \"\";\n    }\n    get republish() {\n        return this.si.config.republish ?? {\n            src: \"\",\n            dest: \"\"\n        };\n    }\n    get streamInfo() {\n        return this.si;\n    }\n    get size() {\n        return this.si.state.bytes;\n    }\n    get metadata() {\n        return this.si.config.metadata ?? {};\n    }\n    get compression() {\n        if (this.si.config.compression) {\n            return this.si.config.compression !== StoreCompression.None;\n        }\n        return false;\n    }\n}\nconst osPrefix = \"OBJ_\";\nconst digestType = \"SHA-256=\";\nfunction objectStoreStreamName(bucket) {\n    validateBucket(bucket);\n    return `${osPrefix}${bucket}`;\n}\nfunction objectStoreBucketName(stream) {\n    if (stream.startsWith(osPrefix)) {\n        return stream.substring(4);\n    }\n    return stream;\n}\nclass ObjectStoreStatusImpl {\n    si;\n    backingStore;\n    constructor(si){\n        this.si = si;\n        this.backingStore = \"JetStream\";\n    }\n    get bucket() {\n        return objectStoreBucketName(this.si.config.name);\n    }\n    get description() {\n        return this.si.config.description ?? \"\";\n    }\n    get ttl() {\n        return this.si.config.max_age;\n    }\n    get storage() {\n        return this.si.config.storage;\n    }\n    get replicas() {\n        return this.si.config.num_replicas;\n    }\n    get sealed() {\n        return this.si.config.sealed;\n    }\n    get size() {\n        return this.si.state.bytes;\n    }\n    get streamInfo() {\n        return this.si;\n    }\n    get metadata() {\n        return this.si.config.metadata;\n    }\n    get compression() {\n        if (this.si.config.compression) {\n            return this.si.config.compression !== StoreCompression.None;\n        }\n        return false;\n    }\n}\nfunction convertStreamSourceDomain(s) {\n    if (s === undefined) {\n        return undefined;\n    }\n    const { domain } = s;\n    if (domain === undefined) {\n        return s;\n    }\n    const copy = Object.assign({}, s);\n    delete copy.domain;\n    if (domain === \"\") {\n        return copy;\n    }\n    if (copy.external) {\n        throw new Error(\"domain and external are both set\");\n    }\n    copy.external = {\n        api: `$JS.${domain}.API`\n    };\n    return copy;\n}\nvar PullConsumerType;\n(function(PullConsumerType) {\n    PullConsumerType[PullConsumerType[\"Unset\"] = -1] = \"Unset\";\n    PullConsumerType[PullConsumerType[\"Consume\"] = 0] = \"Consume\";\n    PullConsumerType[PullConsumerType[\"Fetch\"] = 1] = \"Fetch\";\n})(PullConsumerType || (PullConsumerType = {}));\nvar ConsumerEvents;\n(function(ConsumerEvents) {\n    ConsumerEvents[\"HeartbeatsMissed\"] = \"heartbeats_missed\";\n    ConsumerEvents[\"ConsumerNotFound\"] = \"consumer_not_found\";\n    ConsumerEvents[\"StreamNotFound\"] = \"stream_not_found\";\n    ConsumerEvents[\"ConsumerDeleted\"] = \"consumer_deleted\";\n    ConsumerEvents[\"OrderedConsumerRecreated\"] = \"ordered_consumer_recreated\";\n})(ConsumerEvents || (ConsumerEvents = {}));\nvar ConsumerDebugEvents;\n(function(ConsumerDebugEvents) {\n    ConsumerDebugEvents[\"DebugEvent\"] = \"debug\";\n    ConsumerDebugEvents[\"Discard\"] = \"discard\";\n    ConsumerDebugEvents[\"Reset\"] = \"reset\";\n    ConsumerDebugEvents[\"Next\"] = \"next\";\n})(ConsumerDebugEvents || (ConsumerDebugEvents = {}));\nconst ACK = Uint8Array.of(43, 65, 67, 75);\nconst NAK = Uint8Array.of(45, 78, 65, 75);\nconst WPI = Uint8Array.of(43, 87, 80, 73);\nconst NXT = Uint8Array.of(43, 78, 88, 84);\nconst TERM = Uint8Array.of(43, 84, 69, 82, 77);\nconst SPACE = Uint8Array.of(32);\nfunction toJsMsg(m, ackTimeout = 5000) {\n    return new JsMsgImpl(m, ackTimeout);\n}\nclass PullConsumerMessagesImpl extends QueuedIteratorImpl {\n    consumer;\n    opts;\n    sub;\n    monitor;\n    pending;\n    inbox;\n    refilling;\n    pong;\n    callback;\n    timeout;\n    cleanupHandler;\n    listeners;\n    statusIterator;\n    forOrderedConsumer;\n    resetHandler;\n    abortOnMissingResource;\n    bind;\n    constructor(c, opts, refilling = false){\n        super();\n        this.consumer = c;\n        const copts = opts;\n        this.opts = this.parseOptions(opts, refilling);\n        this.callback = copts.callback || null;\n        this.noIterator = typeof this.callback === \"function\";\n        this.monitor = null;\n        this.pong = null;\n        this.pending = {\n            msgs: 0,\n            bytes: 0,\n            requests: 0\n        };\n        this.refilling = refilling;\n        this.timeout = null;\n        this.inbox = createInbox(c.api.nc.options.inboxPrefix);\n        this.listeners = [];\n        this.forOrderedConsumer = false;\n        this.abortOnMissingResource = copts.abort_on_missing_resource === true;\n        this.bind = copts.bind === true;\n        this.start();\n    }\n    start() {\n        const { max_messages, max_bytes, idle_heartbeat, threshold_bytes, threshold_messages } = this.opts;\n        this.closed().then((err)=>{\n            if (this.cleanupHandler) {\n                try {\n                    this.cleanupHandler(err);\n                } catch (_err) {}\n            }\n        });\n        const { sub } = this;\n        if (sub) {\n            sub.unsubscribe();\n        }\n        this.sub = this.consumer.api.nc.subscribe(this.inbox, {\n            callback: (err, msg)=>{\n                if (err) {\n                    this.stop(err);\n                    return;\n                }\n                this.monitor?.work();\n                const isProtocol = msg.subject === this.inbox;\n                if (isProtocol) {\n                    if (isHeartbeatMsg(msg)) {\n                        return;\n                    }\n                    const code = msg.headers?.code;\n                    const description = msg.headers?.description?.toLowerCase() || \"unknown\";\n                    const { msgsLeft, bytesLeft } = this.parseDiscard(msg.headers);\n                    if (msgsLeft > 0 || bytesLeft > 0) {\n                        this.pending.msgs -= msgsLeft;\n                        this.pending.bytes -= bytesLeft;\n                        this.pending.requests--;\n                        this.notify(ConsumerDebugEvents.Discard, {\n                            msgsLeft,\n                            bytesLeft\n                        });\n                    } else {\n                        if (code === 400) {\n                            this.stop(new NatsError(description, `${code}`));\n                            return;\n                        } else if (code === 409 && description === \"consumer deleted\") {\n                            this.notify(ConsumerEvents.ConsumerDeleted, `${code} ${description}`);\n                            if (!this.refilling || this.abortOnMissingResource) {\n                                const error = new NatsError(description, `${code}`);\n                                this.stop(error);\n                                return;\n                            }\n                        } else {\n                            this.notify(ConsumerDebugEvents.DebugEvent, `${code} ${description}`);\n                        }\n                    }\n                } else {\n                    this._push(toJsMsg(msg, this.consumer.api.timeout));\n                    this.received++;\n                    if (this.pending.msgs) {\n                        this.pending.msgs--;\n                    }\n                    if (this.pending.bytes) {\n                        this.pending.bytes -= msg.size();\n                    }\n                }\n                if (this.pending.msgs === 0 && this.pending.bytes === 0) {\n                    this.pending.requests = 0;\n                }\n                if (this.refilling) {\n                    if (max_messages && this.pending.msgs <= threshold_messages || max_bytes && this.pending.bytes <= threshold_bytes) {\n                        const batch = this.pullOptions();\n                        this.pull(batch);\n                    }\n                } else if (this.pending.requests === 0) {\n                    this._push(()=>{\n                        this.stop();\n                    });\n                }\n            }\n        });\n        this.sub.closed.then(()=>{\n            if (this.sub.draining) {\n                this._push(()=>{\n                    this.stop();\n                });\n            }\n        });\n        if (idle_heartbeat) {\n            this.monitor = new IdleHeartbeatMonitor(idle_heartbeat, (data)=>{\n                this.notify(ConsumerEvents.HeartbeatsMissed, data);\n                this.resetPending().then(()=>{}).catch(()=>{});\n                return false;\n            }, {\n                maxOut: 2\n            });\n        }\n        (async ()=>{\n            const status = this.consumer.api.nc.status();\n            this.statusIterator = status;\n            for await (const s of status){\n                switch(s.type){\n                    case Events.Disconnect:\n                        this.monitor?.cancel();\n                        break;\n                    case Events.Reconnect:\n                        this.resetPending().then((ok)=>{\n                            if (ok) {\n                                this.monitor?.restart();\n                            }\n                        }).catch(()=>{});\n                        break;\n                    default:\n                }\n            }\n        })();\n        this.pull(this.pullOptions());\n    }\n    _push(r) {\n        if (!this.callback) {\n            super.push(r);\n        } else {\n            const fn = typeof r === \"function\" ? r : null;\n            try {\n                if (!fn) {\n                    this.callback(r);\n                } else {\n                    fn();\n                }\n            } catch (err) {\n                this.stop(err);\n            }\n        }\n    }\n    notify(type, data) {\n        if (this.listeners.length > 0) {\n            (()=>{\n                this.listeners.forEach((l)=>{\n                    if (!l.done) {\n                        l.push({\n                            type,\n                            data\n                        });\n                    }\n                });\n            })();\n        }\n    }\n    resetPending() {\n        return this.bind ? this.resetPendingNoInfo() : this.resetPendingWithInfo();\n    }\n    resetPendingNoInfo() {\n        this.pending.msgs = 0;\n        this.pending.bytes = 0;\n        this.pending.requests = 0;\n        this.pull(this.pullOptions());\n        return Promise.resolve(true);\n    }\n    async resetPendingWithInfo() {\n        let notFound = 0;\n        let streamNotFound = 0;\n        const bo = backoff();\n        let attempt = 0;\n        while(true){\n            if (this.done) {\n                return false;\n            }\n            if (this.consumer.api.nc.isClosed()) {\n                console.error(\"aborting resetPending - connection is closed\");\n                return false;\n            }\n            try {\n                await this.consumer.info();\n                notFound = 0;\n                this.pending.msgs = 0;\n                this.pending.bytes = 0;\n                this.pending.requests = 0;\n                this.pull(this.pullOptions());\n                return true;\n            } catch (err) {\n                if (err.message === \"stream not found\") {\n                    streamNotFound++;\n                    this.notify(ConsumerEvents.StreamNotFound, streamNotFound);\n                    if (!this.refilling || this.abortOnMissingResource) {\n                        this.stop(err);\n                        return false;\n                    }\n                } else if (err.message === \"consumer not found\") {\n                    notFound++;\n                    this.notify(ConsumerEvents.ConsumerNotFound, notFound);\n                    if (this.resetHandler) {\n                        try {\n                            this.resetHandler();\n                        } catch (_) {}\n                    }\n                    if (!this.refilling || this.abortOnMissingResource) {\n                        this.stop(err);\n                        return false;\n                    }\n                    if (this.forOrderedConsumer) {\n                        return false;\n                    }\n                } else {\n                    notFound = 0;\n                    streamNotFound = 0;\n                }\n                const to = bo.backoff(attempt);\n                const de = delay(to);\n                await Promise.race([\n                    de,\n                    this.consumer.api.nc.closed()\n                ]);\n                de.cancel();\n                attempt++;\n            }\n        }\n    }\n    pull(opts) {\n        this.pending.bytes += opts.max_bytes ?? 0;\n        this.pending.msgs += opts.batch ?? 0;\n        this.pending.requests++;\n        const nc = this.consumer.api.nc;\n        this._push(()=>{\n            nc.publish(`${this.consumer.api.prefix}.CONSUMER.MSG.NEXT.${this.consumer.stream}.${this.consumer.name}`, this.consumer.api.jc.encode(opts), {\n                reply: this.inbox\n            });\n            this.notify(ConsumerDebugEvents.Next, opts);\n        });\n    }\n    pullOptions() {\n        const batch = this.opts.max_messages - this.pending.msgs;\n        const max_bytes = this.opts.max_bytes - this.pending.bytes;\n        const idle_heartbeat = nanos(this.opts.idle_heartbeat);\n        const expires = nanos(this.opts.expires);\n        return {\n            batch,\n            max_bytes,\n            idle_heartbeat,\n            expires\n        };\n    }\n    parseDiscard(headers) {\n        const discard = {\n            msgsLeft: 0,\n            bytesLeft: 0\n        };\n        const msgsLeft = headers?.get(JsHeaders.PendingMessagesHdr);\n        if (msgsLeft) {\n            discard.msgsLeft = parseInt(msgsLeft);\n        }\n        const bytesLeft = headers?.get(JsHeaders.PendingBytesHdr);\n        if (bytesLeft) {\n            discard.bytesLeft = parseInt(bytesLeft);\n        }\n        return discard;\n    }\n    trackTimeout(t) {\n        this.timeout = t;\n    }\n    close() {\n        this.stop();\n        return this.iterClosed;\n    }\n    closed() {\n        return this.iterClosed;\n    }\n    clearTimers() {\n        this.monitor?.cancel();\n        this.monitor = null;\n        this.timeout?.cancel();\n        this.timeout = null;\n    }\n    setCleanupHandler(fn) {\n        this.cleanupHandler = fn;\n    }\n    stop(err) {\n        if (this.done) {\n            return;\n        }\n        this.sub?.unsubscribe();\n        this.clearTimers();\n        this.statusIterator?.stop();\n        this._push(()=>{\n            super.stop(err);\n            this.listeners.forEach((n)=>{\n                n.stop();\n            });\n        });\n    }\n    parseOptions(opts, refilling = false) {\n        const args = opts || {};\n        args.max_messages = args.max_messages || 0;\n        args.max_bytes = args.max_bytes || 0;\n        if (args.max_messages !== 0 && args.max_bytes !== 0) {\n            throw new Error(`only specify one of max_messages or max_bytes`);\n        }\n        if (args.max_messages === 0) {\n            args.max_messages = 100;\n        }\n        args.expires = args.expires || 30_000;\n        if (args.expires < 1000) {\n            throw new Error(\"expires should be at least 1000ms\");\n        }\n        args.idle_heartbeat = args.idle_heartbeat || args.expires / 2;\n        args.idle_heartbeat = args.idle_heartbeat > 30_000 ? 30_000 : args.idle_heartbeat;\n        if (refilling) {\n            const minMsgs = Math.round(args.max_messages * .75) || 1;\n            args.threshold_messages = args.threshold_messages || minMsgs;\n            const minBytes = Math.round(args.max_bytes * .75) || 1;\n            args.threshold_bytes = args.threshold_bytes || minBytes;\n        }\n        return args;\n    }\n    status() {\n        const iter = new QueuedIteratorImpl();\n        this.listeners.push(iter);\n        return Promise.resolve(iter);\n    }\n}\nclass OrderedConsumerMessages extends QueuedIteratorImpl {\n    src;\n    listeners;\n    constructor(){\n        super();\n        this.listeners = [];\n    }\n    setSource(src) {\n        if (this.src) {\n            this.src.resetHandler = undefined;\n            this.src.setCleanupHandler();\n            this.src.stop();\n        }\n        this.src = src;\n        this.src.setCleanupHandler((err)=>{\n            this.stop(err || undefined);\n        });\n        (async ()=>{\n            const status = await this.src.status();\n            for await (const s of status){\n                this.notify(s.type, s.data);\n            }\n        })().catch(()=>{});\n    }\n    notify(type, data) {\n        if (this.listeners.length > 0) {\n            (()=>{\n                this.listeners.forEach((l)=>{\n                    if (!l.done) {\n                        l.push({\n                            type,\n                            data\n                        });\n                    }\n                });\n            })();\n        }\n    }\n    stop(err) {\n        if (this.done) {\n            return;\n        }\n        this.src?.stop(err);\n        super.stop(err);\n        this.listeners.forEach((n)=>{\n            n.stop();\n        });\n    }\n    close() {\n        this.stop();\n        return this.iterClosed;\n    }\n    closed() {\n        return this.iterClosed;\n    }\n    status() {\n        const iter = new QueuedIteratorImpl();\n        this.listeners.push(iter);\n        return Promise.resolve(iter);\n    }\n}\nclass PullConsumerImpl {\n    api;\n    _info;\n    stream;\n    name;\n    constructor(api, info){\n        this.api = api;\n        this._info = info;\n        this.stream = info.stream_name;\n        this.name = info.name;\n    }\n    consume(opts = {\n        max_messages: 100,\n        expires: 30_000\n    }) {\n        return Promise.resolve(new PullConsumerMessagesImpl(this, opts, true));\n    }\n    fetch(opts = {\n        max_messages: 100,\n        expires: 30_000\n    }) {\n        const m = new PullConsumerMessagesImpl(this, opts, false);\n        const to = Math.round(m.opts.expires * 1.05);\n        const timer = timeout(to);\n        m.closed().catch(()=>{}).finally(()=>{\n            timer.cancel();\n        });\n        timer.catch(()=>{\n            m.close().catch();\n        });\n        m.trackTimeout(timer);\n        return Promise.resolve(m);\n    }\n    next(opts = {\n        expires: 30_000\n    }) {\n        const d = deferred();\n        const fopts = opts;\n        fopts.max_messages = 1;\n        const iter = new PullConsumerMessagesImpl(this, fopts, false);\n        const to = Math.round(iter.opts.expires * 1.05);\n        if (to >= 60_000) {\n            (async ()=>{\n                for await (const s of (await iter.status())){\n                    if (s.type === ConsumerEvents.HeartbeatsMissed && s.data >= 2) {\n                        d.reject(new Error(\"consumer missed heartbeats\"));\n                        break;\n                    }\n                }\n            })().catch();\n        }\n        (async ()=>{\n            for await (const m of iter){\n                d.resolve(m);\n                break;\n            }\n        })().catch(()=>{});\n        const timer = timeout(to);\n        iter.closed().then((err)=>{\n            err ? d.reject(err) : d.resolve(null);\n        }).catch((err)=>{\n            d.reject(err);\n        }).finally(()=>{\n            timer.cancel();\n        });\n        timer.catch((_err)=>{\n            d.resolve(null);\n            iter.close().catch();\n        });\n        iter.trackTimeout(timer);\n        return d;\n    }\n    delete() {\n        const { stream_name, name } = this._info;\n        return this.api.delete(stream_name, name);\n    }\n    info(cached = false) {\n        if (cached) {\n            return Promise.resolve(this._info);\n        }\n        const { stream_name, name } = this._info;\n        return this.api.info(stream_name, name).then((ci)=>{\n            this._info = ci;\n            return this._info;\n        });\n    }\n}\nclass OrderedPullConsumerImpl {\n    api;\n    consumerOpts;\n    consumer;\n    opts;\n    cursor;\n    stream;\n    namePrefix;\n    serial;\n    currentConsumer;\n    userCallback;\n    iter;\n    type;\n    startSeq;\n    maxInitialReset;\n    constructor(api, stream, opts = {}){\n        this.api = api;\n        this.stream = stream;\n        this.cursor = {\n            stream_seq: 1,\n            deliver_seq: 0\n        };\n        this.namePrefix = nuid.next();\n        if (typeof opts.name_prefix === \"string\") {\n            minValidation(\"name_prefix\", opts.name_prefix);\n            this.namePrefix = opts.name_prefix + this.namePrefix;\n        }\n        this.serial = 0;\n        this.currentConsumer = null;\n        this.userCallback = null;\n        this.iter = null;\n        this.type = PullConsumerType.Unset;\n        this.consumerOpts = opts;\n        this.maxInitialReset = 30;\n        this.startSeq = this.consumerOpts.opt_start_seq || 0;\n        this.cursor.stream_seq = this.startSeq > 0 ? this.startSeq - 1 : 0;\n    }\n    getConsumerOpts(seq) {\n        this.serial++;\n        const name = `${this.namePrefix}_${this.serial}`;\n        seq = seq === 0 ? 1 : seq;\n        const config = {\n            name,\n            deliver_policy: DeliverPolicy.StartSequence,\n            opt_start_seq: seq,\n            ack_policy: AckPolicy.None,\n            inactive_threshold: nanos(5 * 60 * 1000),\n            num_replicas: 1\n        };\n        if (this.consumerOpts.headers_only === true) {\n            config.headers_only = true;\n        }\n        if (Array.isArray(this.consumerOpts.filterSubjects)) {\n            config.filter_subjects = this.consumerOpts.filterSubjects;\n        }\n        if (typeof this.consumerOpts.filterSubjects === \"string\") {\n            config.filter_subject = this.consumerOpts.filterSubjects;\n        }\n        if (this.consumerOpts.replay_policy) {\n            config.replay_policy = this.consumerOpts.replay_policy;\n        }\n        if (seq === this.startSeq + 1) {\n            config.deliver_policy = this.consumerOpts.deliver_policy || DeliverPolicy.StartSequence;\n            if (this.consumerOpts.deliver_policy === DeliverPolicy.LastPerSubject || this.consumerOpts.deliver_policy === DeliverPolicy.New || this.consumerOpts.deliver_policy === DeliverPolicy.Last) {\n                delete config.opt_start_seq;\n                config.deliver_policy = this.consumerOpts.deliver_policy;\n            }\n            if (config.deliver_policy === DeliverPolicy.LastPerSubject) {\n                if (typeof config.filter_subjects === \"undefined\" && typeof config.filter_subject === \"undefined\") {\n                    config.filter_subject = \">\";\n                }\n            }\n            if (this.consumerOpts.opt_start_time) {\n                delete config.opt_start_seq;\n                config.deliver_policy = DeliverPolicy.StartTime;\n                config.opt_start_time = this.consumerOpts.opt_start_time;\n            }\n            if (this.consumerOpts.inactive_threshold) {\n                config.inactive_threshold = nanos(this.consumerOpts.inactive_threshold);\n            }\n        }\n        return config;\n    }\n    async resetConsumer(seq = 0) {\n        const isNew = this.serial === 0;\n        this.consumer?.delete().catch(()=>{});\n        seq = seq === 0 ? 1 : seq;\n        this.cursor.deliver_seq = 0;\n        const config = this.getConsumerOpts(seq);\n        config.max_deliver = 1;\n        config.mem_storage = true;\n        const bo = backoff();\n        let ci;\n        for(let i = 0;; i++){\n            try {\n                ci = await this.api.add(this.stream, config);\n                this.iter?.notify(ConsumerEvents.OrderedConsumerRecreated, ci.name);\n                break;\n            } catch (err) {\n                if (err.message === \"stream not found\") {\n                    this.iter?.notify(ConsumerEvents.StreamNotFound, i);\n                    if (this.type === PullConsumerType.Fetch || this.opts.abort_on_missing_resource === true) {\n                        this.iter?.stop(err);\n                        return Promise.reject(err);\n                    }\n                }\n                if (isNew && i >= this.maxInitialReset) {\n                    throw err;\n                } else {\n                    await delay(bo.backoff(i + 1));\n                }\n            }\n        }\n        return ci;\n    }\n    internalHandler(serial) {\n        return (m)=>{\n            if (this.serial !== serial) {\n                return;\n            }\n            const dseq = m.info.deliverySequence;\n            if (dseq !== this.cursor.deliver_seq + 1) {\n                this.notifyOrderedResetAndReset();\n                return;\n            }\n            this.cursor.deliver_seq = dseq;\n            this.cursor.stream_seq = m.info.streamSequence;\n            if (this.userCallback) {\n                this.userCallback(m);\n            } else {\n                this.iter?.push(m);\n            }\n        };\n    }\n    async reset(opts = {\n        max_messages: 100,\n        expires: 30_000\n    }, info) {\n        info = info || {};\n        const fromFetch = info.fromFetch || false;\n        const orderedReset = info.orderedReset || false;\n        if (this.type === PullConsumerType.Fetch && orderedReset) {\n            this.iter?.src.stop();\n            await this.iter?.closed();\n            this.currentConsumer = null;\n            return;\n        }\n        if (this.currentConsumer === null || orderedReset) {\n            this.currentConsumer = await this.resetConsumer(this.cursor.stream_seq + 1);\n        }\n        if (this.iter === null || fromFetch) {\n            this.iter = new OrderedConsumerMessages();\n        }\n        this.consumer = new PullConsumerImpl(this.api, this.currentConsumer);\n        const copts = opts;\n        copts.callback = this.internalHandler(this.serial);\n        let msgs = null;\n        if (this.type === PullConsumerType.Fetch && fromFetch) {\n            msgs = await this.consumer.fetch(opts);\n        } else if (this.type === PullConsumerType.Consume) {\n            msgs = await this.consumer.consume(opts);\n        }\n        const msgsImpl = msgs;\n        msgsImpl.forOrderedConsumer = true;\n        msgsImpl.resetHandler = ()=>{\n            this.notifyOrderedResetAndReset();\n        };\n        this.iter.setSource(msgsImpl);\n    }\n    notifyOrderedResetAndReset() {\n        this.iter?.notify(ConsumerDebugEvents.Reset, \"\");\n        this.reset(this.opts, {\n            orderedReset: true\n        });\n    }\n    async consume(opts = {\n        max_messages: 100,\n        expires: 30_000\n    }) {\n        const copts = opts;\n        if (copts.bind) {\n            return Promise.reject(new Error(\"bind is not supported\"));\n        }\n        if (this.type === PullConsumerType.Fetch) {\n            return Promise.reject(new Error(\"ordered consumer initialized as fetch\"));\n        }\n        if (this.type === PullConsumerType.Consume) {\n            return Promise.reject(new Error(\"ordered consumer doesn't support concurrent consume\"));\n        }\n        const { callback } = opts;\n        if (callback) {\n            this.userCallback = callback;\n        }\n        this.type = PullConsumerType.Consume;\n        this.opts = opts;\n        await this.reset(opts);\n        return this.iter;\n    }\n    async fetch(opts = {\n        max_messages: 100,\n        expires: 30_000\n    }) {\n        const copts = opts;\n        if (copts.bind) {\n            return Promise.reject(new Error(\"bind is not supported\"));\n        }\n        if (this.type === PullConsumerType.Consume) {\n            return Promise.reject(new Error(\"ordered consumer already initialized as consume\"));\n        }\n        if (this.iter?.done === false) {\n            return Promise.reject(new Error(\"ordered consumer doesn't support concurrent fetch\"));\n        }\n        const { callback } = opts;\n        if (callback) {\n            this.userCallback = callback;\n        }\n        this.type = PullConsumerType.Fetch;\n        this.opts = opts;\n        await this.reset(opts, {\n            fromFetch: true\n        });\n        return this.iter;\n    }\n    async next(opts = {\n        expires: 30_000\n    }) {\n        const copts = opts;\n        if (copts.bind) {\n            return Promise.reject(new Error(\"bind is not supported\"));\n        }\n        copts.max_messages = 1;\n        const d = deferred();\n        copts.callback = (m)=>{\n            this.userCallback = null;\n            d.resolve(m);\n        };\n        const iter = await this.fetch(copts);\n        iter.iterClosed.then((err)=>{\n            if (err) {\n                d.reject(err);\n            }\n            d.resolve(null);\n        }).catch((err)=>{\n            d.reject(err);\n        });\n        return d;\n    }\n    delete() {\n        if (!this.currentConsumer) {\n            return Promise.resolve(false);\n        }\n        return this.api.delete(this.stream, this.currentConsumer.name).then((tf)=>{\n            return Promise.resolve(tf);\n        }).catch((err)=>{\n            return Promise.reject(err);\n        }).finally(()=>{\n            this.currentConsumer = null;\n        });\n    }\n    async info(cached) {\n        if (this.currentConsumer == null) {\n            this.currentConsumer = await this.resetConsumer(this.startSeq);\n            return Promise.resolve(this.currentConsumer);\n        }\n        if (cached && this.currentConsumer) {\n            return Promise.resolve(this.currentConsumer);\n        }\n        return this.api.info(this.stream, this.currentConsumer.name);\n    }\n}\nclass ConsumersImpl {\n    api;\n    notified;\n    constructor(api){\n        this.api = api;\n        this.notified = false;\n    }\n    checkVersion() {\n        const fv = this.api.nc.features.get(Feature.JS_SIMPLIFICATION);\n        if (!fv.ok) {\n            return Promise.reject(new Error(`consumers framework is only supported on servers ${fv.min} or better`));\n        }\n        return Promise.resolve();\n    }\n    getPullConsumerFor(ci) {\n        if (ci.config.deliver_subject !== undefined) {\n            throw new Error(\"push consumer not supported\");\n        }\n        return new PullConsumerImpl(this.api, ci);\n    }\n    async get(stream, name = {}) {\n        if (typeof name === \"object\") {\n            return this.ordered(stream, name);\n        }\n        await this.checkVersion();\n        return this.api.info(stream, name).then((ci)=>{\n            if (ci.config.deliver_subject !== undefined) {\n                return Promise.reject(new Error(\"push consumer not supported\"));\n            }\n            return new PullConsumerImpl(this.api, ci);\n        }).catch((err)=>{\n            return Promise.reject(err);\n        });\n    }\n    async ordered(stream, opts) {\n        await this.checkVersion();\n        const impl = this.api;\n        const sapi = new StreamAPIImpl(impl.nc, impl.opts);\n        return sapi.info(stream).then((_si)=>{\n            return Promise.resolve(new OrderedPullConsumerImpl(this.api, stream, opts));\n        }).catch((err)=>{\n            return Promise.reject(err);\n        });\n    }\n}\nclass StreamImpl {\n    api;\n    _info;\n    constructor(api, info){\n        this.api = api;\n        this._info = info;\n    }\n    get name() {\n        return this._info.config.name;\n    }\n    alternates() {\n        return this.info().then((si)=>{\n            return si.alternates ? si.alternates : [];\n        });\n    }\n    async best() {\n        await this.info();\n        if (this._info.alternates) {\n            const asi = await this.api.info(this._info.alternates[0].name);\n            return new StreamImpl(this.api, asi);\n        } else {\n            return this;\n        }\n    }\n    info(cached = false, opts) {\n        if (cached) {\n            return Promise.resolve(this._info);\n        }\n        return this.api.info(this.name, opts).then((si)=>{\n            this._info = si;\n            return this._info;\n        });\n    }\n    getConsumerFromInfo(ci) {\n        return new ConsumersImpl(new ConsumerAPIImpl(this.api.nc, this.api.opts)).getPullConsumerFor(ci);\n    }\n    getConsumer(name) {\n        return new ConsumersImpl(new ConsumerAPIImpl(this.api.nc, this.api.opts)).get(this.name, name);\n    }\n    getMessage(query) {\n        return this.api.getMessage(this.name, query);\n    }\n    deleteMessage(seq, erase) {\n        return this.api.deleteMessage(this.name, seq, erase);\n    }\n}\nclass StreamAPIImpl extends BaseApiClient {\n    constructor(nc, opts){\n        super(nc, opts);\n    }\n    checkStreamConfigVersions(cfg) {\n        const nci = this.nc;\n        if (cfg.metadata) {\n            const { min, ok } = nci.features.get(Feature.JS_STREAM_CONSUMER_METADATA);\n            if (!ok) {\n                throw new Error(`stream 'metadata' requires server ${min}`);\n            }\n        }\n        if (cfg.first_seq) {\n            const { min, ok } = nci.features.get(Feature.JS_STREAM_FIRST_SEQ);\n            if (!ok) {\n                throw new Error(`stream 'first_seq' requires server ${min}`);\n            }\n        }\n        if (cfg.subject_transform) {\n            const { min, ok } = nci.features.get(Feature.JS_STREAM_SUBJECT_TRANSFORM);\n            if (!ok) {\n                throw new Error(`stream 'subject_transform' requires server ${min}`);\n            }\n        }\n        if (cfg.compression) {\n            const { min, ok } = nci.features.get(Feature.JS_STREAM_COMPRESSION);\n            if (!ok) {\n                throw new Error(`stream 'compression' requires server ${min}`);\n            }\n        }\n        if (cfg.consumer_limits) {\n            const { min, ok } = nci.features.get(Feature.JS_DEFAULT_CONSUMER_LIMITS);\n            if (!ok) {\n                throw new Error(`stream 'consumer_limits' requires server ${min}`);\n            }\n        }\n        function validateStreamSource(context, src) {\n            const count = src?.subject_transforms?.length || 0;\n            if (count > 0) {\n                const { min, ok } = nci.features.get(Feature.JS_STREAM_SOURCE_SUBJECT_TRANSFORM);\n                if (!ok) {\n                    throw new Error(`${context} 'subject_transforms' requires server ${min}`);\n                }\n            }\n        }\n        if (cfg.sources) {\n            cfg.sources.forEach((src)=>{\n                validateStreamSource(\"stream sources\", src);\n            });\n        }\n        if (cfg.mirror) {\n            validateStreamSource(\"stream mirror\", cfg.mirror);\n        }\n    }\n    async add(cfg = {}) {\n        this.checkStreamConfigVersions(cfg);\n        validateStreamName(cfg.name);\n        cfg.mirror = convertStreamSourceDomain(cfg.mirror);\n        cfg.sources = cfg.sources?.map(convertStreamSourceDomain);\n        const r = await this._request(`${this.prefix}.STREAM.CREATE.${cfg.name}`, cfg);\n        const si = r;\n        this._fixInfo(si);\n        return si;\n    }\n    async delete(stream) {\n        validateStreamName(stream);\n        const r = await this._request(`${this.prefix}.STREAM.DELETE.${stream}`);\n        const cr = r;\n        return cr.success;\n    }\n    async update(name, cfg = {}) {\n        if (typeof name === \"object\") {\n            const sc = name;\n            name = sc.name;\n            cfg = sc;\n            console.trace(`\\u001B[33m >> streams.update(config: StreamConfig) api changed to streams.update(name: string, config: StreamUpdateConfig) - this shim will be removed - update your code.  \\u001B[0m`);\n        }\n        this.checkStreamConfigVersions(cfg);\n        validateStreamName(name);\n        const old = await this.info(name);\n        const update = Object.assign(old.config, cfg);\n        update.mirror = convertStreamSourceDomain(update.mirror);\n        update.sources = update.sources?.map(convertStreamSourceDomain);\n        const r = await this._request(`${this.prefix}.STREAM.UPDATE.${name}`, update);\n        const si = r;\n        this._fixInfo(si);\n        return si;\n    }\n    async info(name, data) {\n        validateStreamName(name);\n        const subj = `${this.prefix}.STREAM.INFO.${name}`;\n        const r = await this._request(subj, data);\n        let si = r;\n        let { total, limit } = si;\n        let have = si.state.subjects ? Object.getOwnPropertyNames(si.state.subjects).length : 1;\n        if (total && total > have) {\n            const infos = [\n                si\n            ];\n            const paged = data || {};\n            let i = 0;\n            while(total > have){\n                i++;\n                paged.offset = limit * i;\n                const r = await this._request(subj, paged);\n                total = r.total;\n                infos.push(r);\n                const count = Object.getOwnPropertyNames(r.state.subjects).length;\n                have += count;\n                if (count < limit) {\n                    break;\n                }\n            }\n            let subjects = {};\n            for(let i = 0; i < infos.length; i++){\n                si = infos[i];\n                if (si.state.subjects) {\n                    subjects = Object.assign(subjects, si.state.subjects);\n                }\n            }\n            si.offset = 0;\n            si.total = 0;\n            si.limit = 0;\n            si.state.subjects = subjects;\n        }\n        this._fixInfo(si);\n        return si;\n    }\n    list(subject = \"\") {\n        const payload = subject?.length ? {\n            subject\n        } : {};\n        const listerFilter = (v)=>{\n            const slr = v;\n            slr.streams.forEach((si)=>{\n                this._fixInfo(si);\n            });\n            return slr.streams;\n        };\n        const subj = `${this.prefix}.STREAM.LIST`;\n        return new ListerImpl(subj, listerFilter, this, payload);\n    }\n    _fixInfo(si) {\n        si.config.sealed = si.config.sealed || false;\n        si.config.deny_delete = si.config.deny_delete || false;\n        si.config.deny_purge = si.config.deny_purge || false;\n        si.config.allow_rollup_hdrs = si.config.allow_rollup_hdrs || false;\n    }\n    async purge(name, opts) {\n        if (opts) {\n            const { keep, seq } = opts;\n            if (typeof keep === \"number\" && typeof seq === \"number\") {\n                throw new Error(\"can specify one of keep or seq\");\n            }\n        }\n        validateStreamName(name);\n        const v = await this._request(`${this.prefix}.STREAM.PURGE.${name}`, opts);\n        return v;\n    }\n    async deleteMessage(stream, seq, erase = true) {\n        validateStreamName(stream);\n        const dr = {\n            seq\n        };\n        if (!erase) {\n            dr.no_erase = true;\n        }\n        const r = await this._request(`${this.prefix}.STREAM.MSG.DELETE.${stream}`, dr);\n        const cr = r;\n        return cr.success;\n    }\n    async getMessage(stream, query) {\n        validateStreamName(stream);\n        const r = await this._request(`${this.prefix}.STREAM.MSG.GET.${stream}`, query);\n        const sm = r;\n        return new StoredMsgImpl(sm);\n    }\n    find(subject) {\n        return this.findStream(subject);\n    }\n    listKvs() {\n        const filter = (v)=>{\n            const slr = v;\n            const kvStreams = slr.streams.filter((v)=>{\n                return v.config.name.startsWith(kvPrefix);\n            });\n            kvStreams.forEach((si)=>{\n                this._fixInfo(si);\n            });\n            let cluster = \"\";\n            if (kvStreams.length) {\n                cluster = this.nc.info?.cluster ?? \"\";\n            }\n            const status = kvStreams.map((si)=>{\n                return new KvStatusImpl(si, cluster);\n            });\n            return status;\n        };\n        const subj = `${this.prefix}.STREAM.LIST`;\n        return new ListerImpl(subj, filter, this);\n    }\n    listObjectStores() {\n        const filter = (v)=>{\n            const slr = v;\n            const objStreams = slr.streams.filter((v)=>{\n                return v.config.name.startsWith(osPrefix);\n            });\n            objStreams.forEach((si)=>{\n                this._fixInfo(si);\n            });\n            const status = objStreams.map((si)=>{\n                return new ObjectStoreStatusImpl(si);\n            });\n            return status;\n        };\n        const subj = `${this.prefix}.STREAM.LIST`;\n        return new ListerImpl(subj, filter, this);\n    }\n    names(subject = \"\") {\n        const payload = subject?.length ? {\n            subject\n        } : {};\n        const listerFilter = (v)=>{\n            const sr = v;\n            return sr.streams;\n        };\n        const subj = `${this.prefix}.STREAM.NAMES`;\n        return new ListerImpl(subj, listerFilter, this, payload);\n    }\n    async get(name) {\n        const si = await this.info(name);\n        return Promise.resolve(new StreamImpl(this, si));\n    }\n}\nclass DirectStreamAPIImpl extends BaseApiClient {\n    constructor(nc, opts){\n        super(nc, opts);\n    }\n    async getMessage(stream, query) {\n        validateStreamName(stream);\n        let qq = query;\n        const { last_by_subj } = qq;\n        if (last_by_subj) {\n            qq = null;\n        }\n        const payload = qq ? this.jc.encode(qq) : Empty;\n        const pre = this.opts.apiPrefix || \"$JS.API\";\n        const subj = last_by_subj ? `${pre}.DIRECT.GET.${stream}.${last_by_subj}` : `${pre}.DIRECT.GET.${stream}`;\n        const r = await this.nc.request(subj, payload);\n        const err = checkJsError(r);\n        if (err) {\n            return Promise.reject(err);\n        }\n        const dm = new DirectMsgImpl(r);\n        return Promise.resolve(dm);\n    }\n    async getBatch(stream, opts) {\n        validateStreamName(stream);\n        const pre = this.opts.apiPrefix || \"$JS.API\";\n        const subj = `${pre}.DIRECT.GET.${stream}`;\n        if (!Array.isArray(opts.multi_last) || opts.multi_last.length === 0) {\n            return Promise.reject(\"multi_last is required\");\n        }\n        const payload = JSON.stringify(opts, (key, value)=>{\n            if (key === \"up_to_time\" && value instanceof Date) {\n                return value.toISOString();\n            }\n            return value;\n        });\n        const iter = new QueuedIteratorImpl();\n        const raw = await this.nc.requestMany(subj, payload, {\n            strategy: RequestStrategy.SentinelMsg\n        });\n        (async ()=>{\n            let gotFirst = false;\n            let badServer = false;\n            let badRequest;\n            for await (const m of raw){\n                if (!gotFirst) {\n                    gotFirst = true;\n                    const code = m.headers?.code || 0;\n                    if (code !== 0 && code < 200 || code > 299) {\n                        badRequest = m.headers?.description.toLowerCase();\n                        break;\n                    }\n                    const v = m.headers?.get(\"Nats-Num-Pending\");\n                    if (v === \"\") {\n                        badServer = true;\n                        break;\n                    }\n                }\n                if (m.data.length === 0) {\n                    break;\n                }\n                iter.push(new DirectMsgImpl(m));\n            }\n            iter.push(()=>{\n                if (badServer) {\n                    throw new Error(\"batch direct get not supported by the server\");\n                }\n                if (badRequest) {\n                    throw new Error(`bad request: ${badRequest}`);\n                }\n                iter.stop();\n            });\n        })();\n        return Promise.resolve(iter);\n    }\n}\nclass DirectMsgImpl {\n    data;\n    header;\n    static jc;\n    constructor(m){\n        if (!m.headers) {\n            throw new Error(\"headers expected\");\n        }\n        this.data = m.data;\n        this.header = m.headers;\n    }\n    get subject() {\n        return this.header.last(DirectMsgHeaders.Subject);\n    }\n    get seq() {\n        const v = this.header.last(DirectMsgHeaders.Sequence);\n        return typeof v === \"string\" ? parseInt(v) : 0;\n    }\n    get time() {\n        return new Date(Date.parse(this.timestamp));\n    }\n    get timestamp() {\n        return this.header.last(DirectMsgHeaders.TimeStamp);\n    }\n    get stream() {\n        return this.header.last(DirectMsgHeaders.Stream);\n    }\n    json(reviver) {\n        return JSONCodec(reviver).decode(this.data);\n    }\n    string() {\n        return TD.decode(this.data);\n    }\n}\nclass JetStreamManagerImpl extends BaseApiClient {\n    streams;\n    consumers;\n    direct;\n    constructor(nc, opts){\n        super(nc, opts);\n        this.streams = new StreamAPIImpl(nc, opts);\n        this.consumers = new ConsumerAPIImpl(nc, opts);\n        this.direct = new DirectStreamAPIImpl(nc, opts);\n    }\n    async getAccountInfo() {\n        const r = await this._request(`${this.prefix}.INFO`);\n        return r;\n    }\n    jetstream() {\n        return this.nc.jetstream(this.getOptions());\n    }\n    advisories() {\n        const iter = new QueuedIteratorImpl();\n        this.nc.subscribe(`$JS.EVENT.ADVISORY.>`, {\n            callback: (err, msg)=>{\n                if (err) {\n                    throw err;\n                }\n                try {\n                    const d = this.parseJsResponse(msg);\n                    const chunks = d.type.split(\".\");\n                    const kind = chunks[chunks.length - 1];\n                    iter.push({\n                        kind: kind,\n                        data: d\n                    });\n                } catch (err) {\n                    iter.stop(err);\n                }\n            }\n        });\n        return iter;\n    }\n}\nclass StoredMsgImpl {\n    _header;\n    smr;\n    static jc;\n    constructor(smr){\n        this.smr = smr;\n    }\n    get subject() {\n        return this.smr.message.subject;\n    }\n    get seq() {\n        return this.smr.message.seq;\n    }\n    get timestamp() {\n        return this.smr.message.time;\n    }\n    get time() {\n        return new Date(Date.parse(this.timestamp));\n    }\n    get data() {\n        return this.smr.message.data ? this._parse(this.smr.message.data) : Empty;\n    }\n    get header() {\n        if (!this._header) {\n            if (this.smr.message.hdrs) {\n                const hd = this._parse(this.smr.message.hdrs);\n                this._header = MsgHdrsImpl.decode(hd);\n            } else {\n                this._header = headers();\n            }\n        }\n        return this._header;\n    }\n    _parse(s) {\n        const bs = atob(s);\n        const len = bs.length;\n        const bytes = new Uint8Array(len);\n        for(let i = 0; i < len; i++){\n            bytes[i] = bs.charCodeAt(i);\n        }\n        return bytes;\n    }\n    json(reviver) {\n        return JSONCodec(reviver).decode(this.data);\n    }\n    string() {\n        return TD.decode(this.data);\n    }\n}\nclass StreamsImpl {\n    api;\n    constructor(api){\n        this.api = api;\n    }\n    get(stream) {\n        return this.api.info(stream).then((si)=>{\n            return new StreamImpl(this.api, si);\n        });\n    }\n}\nclass ObjectInfoImpl {\n    info;\n    hdrs;\n    constructor(oi){\n        this.info = oi;\n    }\n    get name() {\n        return this.info.name;\n    }\n    get description() {\n        return this.info.description ?? \"\";\n    }\n    get headers() {\n        if (!this.hdrs) {\n            this.hdrs = MsgHdrsImpl.fromRecord(this.info.headers || {});\n        }\n        return this.hdrs;\n    }\n    get options() {\n        return this.info.options;\n    }\n    get bucket() {\n        return this.info.bucket;\n    }\n    get chunks() {\n        return this.info.chunks;\n    }\n    get deleted() {\n        return this.info.deleted ?? false;\n    }\n    get digest() {\n        return this.info.digest;\n    }\n    get mtime() {\n        return this.info.mtime;\n    }\n    get nuid() {\n        return this.info.nuid;\n    }\n    get size() {\n        return this.info.size;\n    }\n    get revision() {\n        return this.info.revision;\n    }\n    get metadata() {\n        return this.info.metadata || {};\n    }\n    isLink() {\n        return this.info.options?.link !== undefined && this.info.options?.link !== null;\n    }\n}\nfunction toServerObjectStoreMeta(meta) {\n    const v = {\n        name: meta.name,\n        description: meta.description ?? \"\",\n        options: meta.options,\n        metadata: meta.metadata\n    };\n    if (meta.headers) {\n        const mhi = meta.headers;\n        v.headers = mhi.toRecord();\n    }\n    return v;\n}\nfunction emptyReadableStream() {\n    return new ReadableStream({\n        pull (c) {\n            c.enqueue(new Uint8Array(0));\n            c.close();\n        }\n    });\n}\nclass ObjectStoreImpl {\n    jsm;\n    js;\n    stream;\n    name;\n    constructor(name, jsm, js){\n        this.name = name;\n        this.jsm = jsm;\n        this.js = js;\n    }\n    _checkNotEmpty(name) {\n        if (!name || name.length === 0) {\n            return {\n                name,\n                error: new Error(\"name cannot be empty\")\n            };\n        }\n        return {\n            name\n        };\n    }\n    async info(name) {\n        const info = await this.rawInfo(name);\n        return info ? new ObjectInfoImpl(info) : null;\n    }\n    async list() {\n        const buf = [];\n        const iter = await this.watch({\n            ignoreDeletes: true,\n            includeHistory: true\n        });\n        for await (const info of iter){\n            if (info === null) {\n                break;\n            }\n            buf.push(info);\n        }\n        return Promise.resolve(buf);\n    }\n    async rawInfo(name) {\n        const { name: obj, error } = this._checkNotEmpty(name);\n        if (error) {\n            return Promise.reject(error);\n        }\n        const meta = this._metaSubject(obj);\n        try {\n            const m = await this.jsm.streams.getMessage(this.stream, {\n                last_by_subj: meta\n            });\n            const jc = JSONCodec();\n            const soi = jc.decode(m.data);\n            soi.revision = m.seq;\n            return soi;\n        } catch (err) {\n            if (err.code === \"404\") {\n                return null;\n            }\n            return Promise.reject(err);\n        }\n    }\n    async _si(opts) {\n        try {\n            return await this.jsm.streams.info(this.stream, opts);\n        } catch (err) {\n            const nerr = err;\n            if (nerr.code === \"404\") {\n                return null;\n            }\n            return Promise.reject(err);\n        }\n    }\n    async seal() {\n        let info = await this._si();\n        if (info === null) {\n            return Promise.reject(new Error(\"object store not found\"));\n        }\n        info.config.sealed = true;\n        info = await this.jsm.streams.update(this.stream, info.config);\n        return Promise.resolve(new ObjectStoreStatusImpl(info));\n    }\n    async status(opts) {\n        const info = await this._si(opts);\n        if (info === null) {\n            return Promise.reject(new Error(\"object store not found\"));\n        }\n        return Promise.resolve(new ObjectStoreStatusImpl(info));\n    }\n    destroy() {\n        return this.jsm.streams.delete(this.stream);\n    }\n    async _put(meta, rs, opts) {\n        const jsopts = this.js.getOptions();\n        opts = opts || {\n            timeout: jsopts.timeout\n        };\n        opts.timeout = opts.timeout || jsopts.timeout;\n        opts.previousRevision = opts.previousRevision ?? undefined;\n        const { timeout, previousRevision } = opts;\n        const si = this.js.nc.info;\n        const maxPayload = si?.max_payload || 1024;\n        meta = meta || {};\n        meta.options = meta.options || {};\n        let maxChunk = meta.options?.max_chunk_size || 128 * 1024;\n        maxChunk = maxChunk > maxPayload ? maxPayload : maxChunk;\n        meta.options.max_chunk_size = maxChunk;\n        const old = await this.info(meta.name);\n        const { name: n, error } = this._checkNotEmpty(meta.name);\n        if (error) {\n            return Promise.reject(error);\n        }\n        const id = nuid.next();\n        const chunkSubj = this._chunkSubject(id);\n        const metaSubj = this._metaSubject(n);\n        const info = Object.assign({\n            bucket: this.name,\n            nuid: id,\n            size: 0,\n            chunks: 0\n        }, toServerObjectStoreMeta(meta));\n        const d = deferred();\n        const proms = [];\n        const db = new DataBuffer();\n        try {\n            const reader = rs ? rs.getReader() : null;\n            const sha = new SHA256();\n            while(true){\n                const { done, value } = reader ? await reader.read() : {\n                    done: true,\n                    value: undefined\n                };\n                if (done) {\n                    if (db.size() > 0) {\n                        const payload = db.drain();\n                        sha.update(payload);\n                        info.chunks++;\n                        info.size += payload.length;\n                        proms.push(this.js.publish(chunkSubj, payload, {\n                            timeout\n                        }));\n                    }\n                    await Promise.all(proms);\n                    proms.length = 0;\n                    info.mtime = new Date().toISOString();\n                    const digest = sha.digest(\"base64\");\n                    const pad = digest.length % 3;\n                    const padding = pad > 0 ? \"=\".repeat(pad) : \"\";\n                    info.digest = `${digestType}${digest}${padding}`;\n                    info.deleted = false;\n                    const h = headers();\n                    if (typeof previousRevision === \"number\") {\n                        h.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${previousRevision}`);\n                    }\n                    h.set(JsHeaders.RollupHdr, JsHeaders.RollupValueSubject);\n                    const pa = await this.js.publish(metaSubj, JSONCodec().encode(info), {\n                        headers: h,\n                        timeout\n                    });\n                    info.revision = pa.seq;\n                    if (old) {\n                        try {\n                            await this.jsm.streams.purge(this.stream, {\n                                filter: `$O.${this.name}.C.${old.nuid}`\n                            });\n                        } catch (_err) {}\n                    }\n                    d.resolve(new ObjectInfoImpl(info));\n                    break;\n                }\n                if (value) {\n                    db.fill(value);\n                    while(db.size() > maxChunk){\n                        info.chunks++;\n                        info.size += maxChunk;\n                        const payload = db.drain(meta.options.max_chunk_size);\n                        sha.update(payload);\n                        proms.push(this.js.publish(chunkSubj, payload, {\n                            timeout\n                        }));\n                    }\n                }\n            }\n        } catch (err) {\n            await this.jsm.streams.purge(this.stream, {\n                filter: chunkSubj\n            });\n            d.reject(err);\n        }\n        return d;\n    }\n    putBlob(meta, data, opts) {\n        function readableStreamFrom(data) {\n            return new ReadableStream({\n                pull (controller) {\n                    controller.enqueue(data);\n                    controller.close();\n                }\n            });\n        }\n        if (data === null) {\n            data = new Uint8Array(0);\n        }\n        return this.put(meta, readableStreamFrom(data), opts);\n    }\n    put(meta, rs, opts) {\n        if (meta?.options?.link) {\n            return Promise.reject(new Error(\"link cannot be set when putting the object in bucket\"));\n        }\n        return this._put(meta, rs, opts);\n    }\n    async getBlob(name) {\n        async function fromReadableStream(rs) {\n            const buf = new DataBuffer();\n            const reader = rs.getReader();\n            while(true){\n                const { done, value } = await reader.read();\n                if (done) {\n                    return buf.drain();\n                }\n                if (value && value.length) {\n                    buf.fill(value);\n                }\n            }\n        }\n        const r = await this.get(name);\n        if (r === null) {\n            return Promise.resolve(null);\n        }\n        const vs = await Promise.all([\n            r.error,\n            fromReadableStream(r.data)\n        ]);\n        if (vs[0]) {\n            return Promise.reject(vs[0]);\n        } else {\n            return Promise.resolve(vs[1]);\n        }\n    }\n    async get(name) {\n        const info = await this.rawInfo(name);\n        if (info === null) {\n            return Promise.resolve(null);\n        }\n        if (info.deleted) {\n            return Promise.resolve(null);\n        }\n        if (info.options && info.options.link) {\n            const ln = info.options.link.name || \"\";\n            if (ln === \"\") {\n                throw new Error(\"link is a bucket\");\n            }\n            const os = info.options.link.bucket !== this.name ? await ObjectStoreImpl.create(this.js, info.options.link.bucket) : this;\n            return os.get(ln);\n        }\n        const d = deferred();\n        const r = {\n            info: new ObjectInfoImpl(info),\n            error: d\n        };\n        if (info.size === 0) {\n            r.data = emptyReadableStream();\n            d.resolve(null);\n            return Promise.resolve(r);\n        }\n        let controller;\n        const oc = consumerOpts();\n        oc.orderedConsumer();\n        const sha = new SHA256();\n        const subj = `$O.${this.name}.C.${info.nuid}`;\n        const sub = await this.js.subscribe(subj, oc);\n        (async ()=>{\n            for await (const jm of sub){\n                if (jm.data.length > 0) {\n                    sha.update(jm.data);\n                    controller.enqueue(jm.data);\n                }\n                if (jm.info.pending === 0) {\n                    const hash = sha.digest(\"base64\");\n                    const pad = hash.length % 3;\n                    const padding = pad > 0 ? \"=\".repeat(pad) : \"\";\n                    const digest = `${digestType}${hash}${padding}`;\n                    if (digest !== info.digest) {\n                        controller.error(new Error(`received a corrupt object, digests do not match received: ${info.digest} calculated ${digest}`));\n                    } else {\n                        controller.close();\n                    }\n                    sub.unsubscribe();\n                }\n            }\n        })().then(()=>{\n            d.resolve();\n        }).catch((err)=>{\n            controller.error(err);\n            d.reject(err);\n        });\n        r.data = new ReadableStream({\n            start (c) {\n                controller = c;\n            },\n            cancel () {\n                sub.unsubscribe();\n            }\n        });\n        return r;\n    }\n    linkStore(name, bucket) {\n        if (!(bucket instanceof ObjectStoreImpl)) {\n            return Promise.reject(\"bucket required\");\n        }\n        const osi = bucket;\n        const { name: n, error } = this._checkNotEmpty(name);\n        if (error) {\n            return Promise.reject(error);\n        }\n        const meta = {\n            name: n,\n            options: {\n                link: {\n                    bucket: osi.name\n                }\n            }\n        };\n        return this._put(meta, null);\n    }\n    async link(name, info) {\n        const { name: n, error } = this._checkNotEmpty(name);\n        if (error) {\n            return Promise.reject(error);\n        }\n        if (info.deleted) {\n            return Promise.reject(new Error(\"src object is deleted\"));\n        }\n        if (info.isLink()) {\n            return Promise.reject(new Error(\"src object is a link\"));\n        }\n        const dest = await this.rawInfo(name);\n        if (dest !== null && !dest.deleted) {\n            return Promise.reject(new Error(\"an object already exists with that name\"));\n        }\n        const link = {\n            bucket: info.bucket,\n            name: info.name\n        };\n        const mm = {\n            name: n,\n            bucket: info.bucket,\n            options: {\n                link: link\n            }\n        };\n        await this.js.publish(this._metaSubject(name), JSON.stringify(mm));\n        const i = await this.info(name);\n        return Promise.resolve(i);\n    }\n    async delete(name) {\n        const info = await this.rawInfo(name);\n        if (info === null) {\n            return Promise.resolve({\n                purged: 0,\n                success: false\n            });\n        }\n        info.deleted = true;\n        info.size = 0;\n        info.chunks = 0;\n        info.digest = \"\";\n        const jc = JSONCodec();\n        const h = headers();\n        h.set(JsHeaders.RollupHdr, JsHeaders.RollupValueSubject);\n        await this.js.publish(this._metaSubject(info.name), jc.encode(info), {\n            headers: h\n        });\n        return this.jsm.streams.purge(this.stream, {\n            filter: this._chunkSubject(info.nuid)\n        });\n    }\n    async update(name, meta = {}) {\n        const info = await this.rawInfo(name);\n        if (info === null) {\n            return Promise.reject(new Error(\"object not found\"));\n        }\n        if (info.deleted) {\n            return Promise.reject(new Error(\"cannot update meta for a deleted object\"));\n        }\n        meta.name = meta.name ?? info.name;\n        const { name: n, error } = this._checkNotEmpty(meta.name);\n        if (error) {\n            return Promise.reject(error);\n        }\n        if (name !== meta.name) {\n            const i = await this.info(meta.name);\n            if (i && !i.deleted) {\n                return Promise.reject(new Error(\"an object already exists with that name\"));\n            }\n        }\n        meta.name = n;\n        const ii = Object.assign({}, info, toServerObjectStoreMeta(meta));\n        const ack = await this.js.publish(this._metaSubject(ii.name), JSON.stringify(ii));\n        if (name !== meta.name) {\n            await this.jsm.streams.purge(this.stream, {\n                filter: this._metaSubject(name)\n            });\n        }\n        return Promise.resolve(ack);\n    }\n    async watch(opts = {}) {\n        opts.includeHistory = opts.includeHistory ?? false;\n        opts.ignoreDeletes = opts.ignoreDeletes ?? false;\n        let initialized = false;\n        const qi = new QueuedIteratorImpl();\n        const subj = this._metaSubjectAll();\n        try {\n            await this.jsm.streams.getMessage(this.stream, {\n                last_by_subj: subj\n            });\n        } catch (err) {\n            if (err.code === \"404\") {\n                qi.push(null);\n                initialized = true;\n            } else {\n                qi.stop(err);\n            }\n        }\n        const jc = JSONCodec();\n        const copts = consumerOpts();\n        copts.orderedConsumer();\n        if (opts.includeHistory) {\n            copts.deliverLastPerSubject();\n        } else {\n            initialized = true;\n            copts.deliverNew();\n        }\n        copts.callback((err, jm)=>{\n            if (err) {\n                qi.stop(err);\n                return;\n            }\n            if (jm !== null) {\n                const oi = jc.decode(jm.data);\n                if (oi.deleted && opts.ignoreDeletes === true) {} else {\n                    qi.push(oi);\n                }\n                if (jm.info?.pending === 0 && !initialized) {\n                    initialized = true;\n                    qi.push(null);\n                }\n            }\n        });\n        const sub = await this.js.subscribe(subj, copts);\n        qi._data = sub;\n        qi.iterClosed.then(()=>{\n            sub.unsubscribe();\n        });\n        sub.closed.then(()=>{\n            qi.stop();\n        }).catch((err)=>{\n            qi.stop(err);\n        });\n        return qi;\n    }\n    _chunkSubject(id) {\n        return `$O.${this.name}.C.${id}`;\n    }\n    _metaSubject(n) {\n        return `$O.${this.name}.M.${Base64UrlPaddedCodec.encode(n)}`;\n    }\n    _metaSubjectAll() {\n        return `$O.${this.name}.M.>`;\n    }\n    async init(opts = {}) {\n        try {\n            this.stream = objectStoreStreamName(this.name);\n        } catch (err) {\n            return Promise.reject(err);\n        }\n        const max_age = opts?.ttl || 0;\n        delete opts.ttl;\n        const sc = Object.assign({\n            max_age\n        }, opts);\n        sc.name = this.stream;\n        sc.num_replicas = opts.replicas ?? 1;\n        sc.allow_direct = true;\n        sc.allow_rollup_hdrs = true;\n        sc.discard = DiscardPolicy.New;\n        sc.subjects = [\n            `$O.${this.name}.C.>`,\n            `$O.${this.name}.M.>`\n        ];\n        if (opts.placement) {\n            sc.placement = opts.placement;\n        }\n        if (opts.metadata) {\n            sc.metadata = opts.metadata;\n        }\n        if (typeof opts.compression === \"boolean\") {\n            sc.compression = opts.compression ? StoreCompression.S2 : StoreCompression.None;\n        }\n        try {\n            await this.jsm.streams.info(sc.name);\n        } catch (err) {\n            if (err.message === \"stream not found\") {\n                await this.jsm.streams.add(sc);\n            }\n        }\n    }\n    static async create(js, name, opts = {}) {\n        const jsm = await js.jetstreamManager();\n        const os = new ObjectStoreImpl(name, jsm, js);\n        await os.init(opts);\n        return Promise.resolve(os);\n    }\n}\nclass ViewsImpl {\n    js;\n    constructor(js){\n        this.js = js;\n    }\n    kv(name, opts = {}) {\n        const jsi = this.js;\n        const { ok, min } = jsi.nc.features.get(Feature.JS_KV);\n        if (!ok) {\n            return Promise.reject(new Error(`kv is only supported on servers ${min} or better`));\n        }\n        if (opts.bindOnly) {\n            return Bucket.bind(this.js, name, opts);\n        }\n        return Bucket.create(this.js, name, opts);\n    }\n    os(name, opts = {}) {\n        if (typeof crypto?.subtle?.digest !== \"function\") {\n            return Promise.reject(new Error(\"objectstore: unable to calculate hashes - crypto.subtle.digest with sha256 support is required\"));\n        }\n        const jsi = this.js;\n        const { ok, min } = jsi.nc.features.get(Feature.JS_OBJECTSTORE);\n        if (!ok) {\n            return Promise.reject(new Error(`objectstore is only supported on servers ${min} or better`));\n        }\n        return ObjectStoreImpl.create(this.js, name, opts);\n    }\n}\nclass JetStreamClientImpl extends BaseApiClient {\n    consumers;\n    streams;\n    consumerAPI;\n    streamAPI;\n    constructor(nc, opts){\n        super(nc, opts);\n        this.consumerAPI = new ConsumerAPIImpl(nc, opts);\n        this.streamAPI = new StreamAPIImpl(nc, opts);\n        this.consumers = new ConsumersImpl(this.consumerAPI);\n        this.streams = new StreamsImpl(this.streamAPI);\n    }\n    jetstreamManager(checkAPI) {\n        if (checkAPI === undefined) {\n            checkAPI = this.opts.checkAPI;\n        }\n        const opts = Object.assign({}, this.opts, {\n            checkAPI\n        });\n        return this.nc.jetstreamManager(opts);\n    }\n    get apiPrefix() {\n        return this.prefix;\n    }\n    get views() {\n        return new ViewsImpl(this);\n    }\n    async publish(subj, data = Empty, opts) {\n        opts = opts || {};\n        opts.expect = opts.expect || {};\n        const mh = opts?.headers || headers();\n        if (opts) {\n            if (opts.msgID) {\n                mh.set(PubHeaders.MsgIdHdr, opts.msgID);\n            }\n            if (opts.expect.lastMsgID) {\n                mh.set(PubHeaders.ExpectedLastMsgIdHdr, opts.expect.lastMsgID);\n            }\n            if (opts.expect.streamName) {\n                mh.set(PubHeaders.ExpectedStreamHdr, opts.expect.streamName);\n            }\n            if (typeof opts.expect.lastSequence === \"number\") {\n                mh.set(PubHeaders.ExpectedLastSeqHdr, `${opts.expect.lastSequence}`);\n            }\n            if (typeof opts.expect.lastSubjectSequence === \"number\") {\n                mh.set(PubHeaders.ExpectedLastSubjectSequenceHdr, `${opts.expect.lastSubjectSequence}`);\n            }\n        }\n        const to = opts.timeout || this.timeout;\n        const ro = {};\n        if (to) {\n            ro.timeout = to;\n        }\n        if (opts) {\n            ro.headers = mh;\n        }\n        let { retries, retry_delay } = opts;\n        retries = retries || 1;\n        retry_delay = retry_delay || 250;\n        let r;\n        for(let i = 0; i < retries; i++){\n            try {\n                r = await this.nc.request(subj, data, ro);\n                break;\n            } catch (err) {\n                const ne = err;\n                if (ne.code === \"503\" && i + 1 < retries) {\n                    await delay(retry_delay);\n                } else {\n                    throw err;\n                }\n            }\n        }\n        const pa = this.parseJsResponse(r);\n        if (pa.stream === \"\") {\n            throw NatsError.errorForCode(ErrorCode.JetStreamInvalidAck);\n        }\n        pa.duplicate = pa.duplicate ? pa.duplicate : false;\n        return pa;\n    }\n    async pull(stream, durable, expires = 0) {\n        validateStreamName(stream);\n        validateDurableName(durable);\n        let timeout = this.timeout;\n        if (expires > timeout) {\n            timeout = expires;\n        }\n        expires = expires < 0 ? 0 : nanos(expires);\n        const pullOpts = {\n            batch: 1,\n            no_wait: expires === 0,\n            expires\n        };\n        const msg = await this.nc.request(`${this.prefix}.CONSUMER.MSG.NEXT.${stream}.${durable}`, this.jc.encode(pullOpts), {\n            noMux: true,\n            timeout\n        });\n        const err = checkJsError(msg);\n        if (err) {\n            throw err;\n        }\n        return toJsMsg(msg, this.timeout);\n    }\n    fetch(stream, durable, opts = {}) {\n        validateStreamName(stream);\n        validateDurableName(durable);\n        let timer = null;\n        const trackBytes = (opts.max_bytes ?? 0) > 0;\n        let receivedBytes = 0;\n        const max_bytes = trackBytes ? opts.max_bytes : 0;\n        let monitor = null;\n        const args = {};\n        args.batch = opts.batch || 1;\n        if (max_bytes) {\n            const fv = this.nc.features.get(Feature.JS_PULL_MAX_BYTES);\n            if (!fv.ok) {\n                throw new Error(`max_bytes is only supported on servers ${fv.min} or better`);\n            }\n            args.max_bytes = max_bytes;\n        }\n        args.no_wait = opts.no_wait || false;\n        if (args.no_wait && args.expires) {\n            args.expires = 0;\n        }\n        const expires = opts.expires || 0;\n        if (expires) {\n            args.expires = nanos(expires);\n        }\n        if (expires === 0 && args.no_wait === false) {\n            throw new Error(\"expires or no_wait is required\");\n        }\n        const hb = opts.idle_heartbeat || 0;\n        if (hb) {\n            args.idle_heartbeat = nanos(hb);\n            if (opts.delay_heartbeat === true) {\n                args.idle_heartbeat = nanos(hb * 4);\n            }\n        }\n        const qi = new QueuedIteratorImpl();\n        const wants = args.batch;\n        let received = 0;\n        qi.protocolFilterFn = (jm, _ingest = false)=>{\n            const jsmi = jm;\n            if (isHeartbeatMsg(jsmi.msg)) {\n                monitor?.work();\n                return false;\n            }\n            return true;\n        };\n        qi.dispatchedFn = (m)=>{\n            if (m) {\n                if (trackBytes) {\n                    receivedBytes += m.data.length;\n                }\n                received++;\n                if (timer && m.info.pending === 0) {\n                    return;\n                }\n                if (qi.getPending() === 1 && m.info.pending === 0 || wants === received || max_bytes > 0 && receivedBytes >= max_bytes) {\n                    qi.stop();\n                }\n            }\n        };\n        const inbox = createInbox(this.nc.options.inboxPrefix);\n        const sub = this.nc.subscribe(inbox, {\n            max: opts.batch,\n            callback: (err, msg)=>{\n                if (err === null) {\n                    err = checkJsError(msg);\n                }\n                if (err !== null) {\n                    if (timer) {\n                        timer.cancel();\n                        timer = null;\n                    }\n                    if (isNatsError(err)) {\n                        qi.stop(hideNonTerminalJsErrors(err) === null ? undefined : err);\n                    } else {\n                        qi.stop(err);\n                    }\n                } else {\n                    monitor?.work();\n                    qi.received++;\n                    qi.push(toJsMsg(msg, this.timeout));\n                }\n            }\n        });\n        if (expires) {\n            timer = timeout(expires);\n            timer.catch(()=>{\n                if (!sub.isClosed()) {\n                    sub.drain().catch(()=>{});\n                    timer = null;\n                }\n                if (monitor) {\n                    monitor.cancel();\n                }\n            });\n        }\n        (async ()=>{\n            try {\n                if (hb) {\n                    monitor = new IdleHeartbeatMonitor(hb, (v)=>{\n                        qi.push(()=>{\n                            qi.err = new NatsError(`${Js409Errors.IdleHeartbeatMissed}: ${v}`, ErrorCode.JetStreamIdleHeartBeat);\n                        });\n                        return true;\n                    });\n                }\n            } catch (_err) {}\n            await sub.closed;\n            if (timer !== null) {\n                timer.cancel();\n                timer = null;\n            }\n            if (monitor) {\n                monitor.cancel();\n            }\n            qi.stop();\n        })().catch();\n        this.nc.publish(`${this.prefix}.CONSUMER.MSG.NEXT.${stream}.${durable}`, this.jc.encode(args), {\n            reply: inbox\n        });\n        return qi;\n    }\n    async pullSubscribe(subject, opts = consumerOpts()) {\n        const cso = await this._processOptions(subject, opts);\n        if (cso.ordered) {\n            throw new Error(\"pull subscribers cannot be be ordered\");\n        }\n        if (cso.config.deliver_subject) {\n            throw new Error(\"consumer info specifies deliver_subject - pull consumers cannot have deliver_subject set\");\n        }\n        const ackPolicy = cso.config.ack_policy;\n        if (ackPolicy === AckPolicy.None || ackPolicy === AckPolicy.All) {\n            throw new Error(\"ack policy for pull consumers must be explicit\");\n        }\n        const so = this._buildTypedSubscriptionOpts(cso);\n        const sub = new JetStreamPullSubscriptionImpl(this, cso.deliver, so);\n        sub.info = cso;\n        try {\n            await this._maybeCreateConsumer(cso);\n        } catch (err) {\n            sub.unsubscribe();\n            throw err;\n        }\n        return sub;\n    }\n    async subscribe(subject, opts = consumerOpts()) {\n        const cso = await this._processOptions(subject, opts);\n        if (!cso.isBind && !cso.config.deliver_subject) {\n            throw new Error(\"push consumer requires deliver_subject\");\n        }\n        const so = this._buildTypedSubscriptionOpts(cso);\n        const sub = new JetStreamSubscriptionImpl(this, cso.deliver, so);\n        sub.info = cso;\n        try {\n            await this._maybeCreateConsumer(cso);\n        } catch (err) {\n            sub.unsubscribe();\n            throw err;\n        }\n        sub._maybeSetupHbMonitoring();\n        return sub;\n    }\n    async _processOptions(subject, opts = consumerOpts()) {\n        const jsi = isConsumerOptsBuilder(opts) ? opts.getOpts() : opts;\n        jsi.isBind = isConsumerOptsBuilder(opts) ? opts.isBind : false;\n        jsi.flow_control = {\n            heartbeat_count: 0,\n            fc_count: 0,\n            consumer_restarts: 0\n        };\n        if (jsi.ordered) {\n            jsi.ordered_consumer_sequence = {\n                stream_seq: 0,\n                delivery_seq: 0\n            };\n            if (jsi.config.ack_policy !== AckPolicy.NotSet && jsi.config.ack_policy !== AckPolicy.None) {\n                throw new NatsError(\"ordered consumer: ack_policy can only be set to 'none'\", ErrorCode.ApiError);\n            }\n            if (jsi.config.durable_name && jsi.config.durable_name.length > 0) {\n                throw new NatsError(\"ordered consumer: durable_name cannot be set\", ErrorCode.ApiError);\n            }\n            if (jsi.config.deliver_subject && jsi.config.deliver_subject.length > 0) {\n                throw new NatsError(\"ordered consumer: deliver_subject cannot be set\", ErrorCode.ApiError);\n            }\n            if (jsi.config.max_deliver !== undefined && jsi.config.max_deliver > 1) {\n                throw new NatsError(\"ordered consumer: max_deliver cannot be set\", ErrorCode.ApiError);\n            }\n            if (jsi.config.deliver_group && jsi.config.deliver_group.length > 0) {\n                throw new NatsError(\"ordered consumer: deliver_group cannot be set\", ErrorCode.ApiError);\n            }\n            jsi.config.deliver_subject = createInbox(this.nc.options.inboxPrefix);\n            jsi.config.ack_policy = AckPolicy.None;\n            jsi.config.max_deliver = 1;\n            jsi.config.flow_control = true;\n            jsi.config.idle_heartbeat = jsi.config.idle_heartbeat || nanos(5000);\n            jsi.config.ack_wait = nanos(22 * 60 * 60 * 1000);\n            jsi.config.mem_storage = true;\n            jsi.config.num_replicas = 1;\n        }\n        if (jsi.config.ack_policy === AckPolicy.NotSet) {\n            jsi.config.ack_policy = AckPolicy.All;\n        }\n        jsi.api = this;\n        jsi.config = jsi.config || {};\n        jsi.stream = jsi.stream ? jsi.stream : await this.findStream(subject);\n        jsi.attached = false;\n        if (jsi.config.durable_name) {\n            try {\n                const info = await this.consumerAPI.info(jsi.stream, jsi.config.durable_name);\n                if (info) {\n                    if (info.config.filter_subject && info.config.filter_subject !== subject) {\n                        throw new Error(\"subject does not match consumer\");\n                    }\n                    const qn = jsi.config.deliver_group ?? \"\";\n                    if (qn === \"\" && info.push_bound === true) {\n                        throw new Error(`duplicate subscription`);\n                    }\n                    const rqn = info.config.deliver_group ?? \"\";\n                    if (qn !== rqn) {\n                        if (rqn === \"\") {\n                            throw new Error(`durable requires no queue group`);\n                        } else {\n                            throw new Error(`durable requires queue group '${rqn}'`);\n                        }\n                    }\n                    jsi.last = info;\n                    jsi.config = info.config;\n                    jsi.attached = true;\n                    if (!jsi.config.durable_name) {\n                        jsi.name = info.name;\n                    }\n                }\n            } catch (err) {\n                if (err.code !== \"404\") {\n                    throw err;\n                }\n            }\n        }\n        if (!jsi.attached && jsi.config.filter_subject === undefined && jsi.config.filter_subjects === undefined) {\n            jsi.config.filter_subject = subject;\n        }\n        jsi.deliver = jsi.config.deliver_subject || createInbox(this.nc.options.inboxPrefix);\n        return jsi;\n    }\n    _buildTypedSubscriptionOpts(jsi) {\n        const so = {};\n        so.adapter = msgAdapter(jsi.callbackFn === undefined, this.timeout);\n        so.ingestionFilterFn = JetStreamClientImpl.ingestionFn(jsi.ordered);\n        so.protocolFilterFn = (jm, ingest = false)=>{\n            const jsmi = jm;\n            if (isFlowControlMsg(jsmi.msg)) {\n                if (!ingest) {\n                    jsmi.msg.respond();\n                }\n                return false;\n            }\n            return true;\n        };\n        if (!jsi.mack && jsi.config.ack_policy !== AckPolicy.None) {\n            so.dispatchedFn = autoAckJsMsg;\n        }\n        if (jsi.callbackFn) {\n            so.callback = jsi.callbackFn;\n        }\n        so.max = jsi.max || 0;\n        so.queue = jsi.queue;\n        return so;\n    }\n    async _maybeCreateConsumer(jsi) {\n        if (jsi.attached) {\n            return;\n        }\n        if (jsi.isBind) {\n            throw new Error(`unable to bind - durable consumer ${jsi.config.durable_name} doesn't exist in ${jsi.stream}`);\n        }\n        jsi.config = Object.assign({\n            deliver_policy: DeliverPolicy.All,\n            ack_policy: AckPolicy.Explicit,\n            ack_wait: nanos(30 * 1000),\n            replay_policy: ReplayPolicy.Instant\n        }, jsi.config);\n        const ci = await this.consumerAPI.add(jsi.stream, jsi.config);\n        if (Array.isArray(jsi.config.filter_subjects && !Array.isArray(ci.config.filter_subjects))) {\n            throw new Error(`jetstream server doesn't support consumers with multiple filter subjects`);\n        }\n        jsi.name = ci.name;\n        jsi.config = ci.config;\n        jsi.last = ci;\n    }\n    static ingestionFn(ordered) {\n        return (jm, ctx)=>{\n            const jsub = ctx;\n            if (!jm) return {\n                ingest: false,\n                protocol: false\n            };\n            const jmi = jm;\n            if (!checkJsError(jmi.msg)) {\n                jsub.monitor?.work();\n            }\n            if (isHeartbeatMsg(jmi.msg)) {\n                const ingest = ordered ? jsub._checkHbOrderConsumer(jmi.msg) : true;\n                if (!ordered) {\n                    jsub.info.flow_control.heartbeat_count++;\n                }\n                return {\n                    ingest,\n                    protocol: true\n                };\n            } else if (isFlowControlMsg(jmi.msg)) {\n                jsub.info.flow_control.fc_count++;\n                return {\n                    ingest: true,\n                    protocol: true\n                };\n            }\n            const ingest = ordered ? jsub._checkOrderedConsumer(jm) : true;\n            return {\n                ingest,\n                protocol: false\n            };\n        };\n    }\n}\nclass NatsConnectionImpl {\n    options;\n    protocol;\n    draining;\n    listeners;\n    _services;\n    constructor(opts){\n        this.draining = false;\n        this.options = parseOptions(opts);\n        this.listeners = [];\n    }\n    static connect(opts = {}) {\n        return new Promise((resolve, reject)=>{\n            const nc = new NatsConnectionImpl(opts);\n            ProtocolHandler.connect(nc.options, nc).then((ph)=>{\n                nc.protocol = ph;\n                (async function() {\n                    for await (const s of ph.status()){\n                        nc.listeners.forEach((l)=>{\n                            l.push(s);\n                        });\n                    }\n                })();\n                resolve(nc);\n            }).catch((err)=>{\n                reject(err);\n            });\n        });\n    }\n    closed() {\n        return this.protocol.closed;\n    }\n    async close() {\n        await this.protocol.close();\n    }\n    _check(subject, sub, pub) {\n        if (this.isClosed()) {\n            throw NatsError.errorForCode(ErrorCode.ConnectionClosed);\n        }\n        if (sub && this.isDraining()) {\n            throw NatsError.errorForCode(ErrorCode.ConnectionDraining);\n        }\n        if (pub && this.protocol.noMorePublishing) {\n            throw NatsError.errorForCode(ErrorCode.ConnectionDraining);\n        }\n        subject = subject || \"\";\n        if (subject.length === 0) {\n            throw NatsError.errorForCode(ErrorCode.BadSubject);\n        }\n    }\n    publish(subject, data, options) {\n        this._check(subject, false, true);\n        this.protocol.publish(subject, data, options);\n    }\n    publishMessage(msg) {\n        return this.publish(msg.subject, msg.data, {\n            reply: msg.reply,\n            headers: msg.headers\n        });\n    }\n    respondMessage(msg) {\n        if (msg.reply) {\n            this.publish(msg.reply, msg.data, {\n                reply: msg.reply,\n                headers: msg.headers\n            });\n            return true;\n        }\n        return false;\n    }\n    subscribe(subject, opts = {}) {\n        this._check(subject, true, false);\n        const sub = new SubscriptionImpl(this.protocol, subject, opts);\n        this.protocol.subscribe(sub);\n        return sub;\n    }\n    _resub(s, subject, max) {\n        this._check(subject, true, false);\n        const si = s;\n        si.max = max;\n        if (max) {\n            si.max = max + si.received;\n        }\n        this.protocol.resub(si, subject);\n    }\n    requestMany(subject, data = Empty, opts = {\n        maxWait: 1000,\n        maxMessages: -1\n    }) {\n        const asyncTraces = !(this.protocol.options.noAsyncTraces || false);\n        try {\n            this._check(subject, true, true);\n        } catch (err) {\n            return Promise.reject(err);\n        }\n        opts.strategy = opts.strategy || RequestStrategy.Timer;\n        opts.maxWait = opts.maxWait || 1000;\n        if (opts.maxWait < 1) {\n            return Promise.reject(new NatsError(\"timeout\", ErrorCode.InvalidOption));\n        }\n        const qi = new QueuedIteratorImpl();\n        function stop(err) {\n            qi.push(()=>{\n                qi.stop(err);\n            });\n        }\n        function callback(err, msg) {\n            if (err || msg === null) {\n                stop(err === null ? undefined : err);\n            } else {\n                qi.push(msg);\n            }\n        }\n        if (opts.noMux) {\n            const stack = asyncTraces ? new Error().stack : null;\n            let max = typeof opts.maxMessages === \"number\" && opts.maxMessages > 0 ? opts.maxMessages : -1;\n            const sub = this.subscribe(createInbox(this.options.inboxPrefix), {\n                callback: (err, msg)=>{\n                    if (msg?.data?.length === 0 && msg?.headers?.status === ErrorCode.NoResponders) {\n                        err = NatsError.errorForCode(ErrorCode.NoResponders);\n                    }\n                    if (err) {\n                        if (stack) {\n                            err.stack += `\\n\\n${stack}`;\n                        }\n                        cancel(err);\n                        return;\n                    }\n                    callback(null, msg);\n                    if (opts.strategy === RequestStrategy.Count) {\n                        max--;\n                        if (max === 0) {\n                            cancel();\n                        }\n                    }\n                    if (opts.strategy === RequestStrategy.JitterTimer) {\n                        clearTimers();\n                        timer = setTimeout(()=>{\n                            cancel();\n                        }, 300);\n                    }\n                    if (opts.strategy === RequestStrategy.SentinelMsg) {\n                        if (msg && msg.data.length === 0) {\n                            cancel();\n                        }\n                    }\n                }\n            });\n            sub.requestSubject = subject;\n            sub.closed.then(()=>{\n                stop();\n            }).catch((err)=>{\n                qi.stop(err);\n            });\n            const cancel = (err)=>{\n                if (err) {\n                    qi.push(()=>{\n                        throw err;\n                    });\n                }\n                clearTimers();\n                sub.drain().then(()=>{\n                    stop();\n                }).catch((_err)=>{\n                    stop();\n                });\n            };\n            qi.iterClosed.then(()=>{\n                clearTimers();\n                sub?.unsubscribe();\n            }).catch((_err)=>{\n                clearTimers();\n                sub?.unsubscribe();\n            });\n            try {\n                this.publish(subject, data, {\n                    reply: sub.getSubject()\n                });\n            } catch (err) {\n                cancel(err);\n            }\n            let timer = setTimeout(()=>{\n                cancel();\n            }, opts.maxWait);\n            const clearTimers = ()=>{\n                if (timer) {\n                    clearTimeout(timer);\n                }\n            };\n        } else {\n            const rmo = opts;\n            rmo.callback = callback;\n            qi.iterClosed.then(()=>{\n                r.cancel();\n            }).catch((err)=>{\n                r.cancel(err);\n            });\n            const r = new RequestMany(this.protocol.muxSubscriptions, subject, rmo);\n            this.protocol.request(r);\n            try {\n                this.publish(subject, data, {\n                    reply: `${this.protocol.muxSubscriptions.baseInbox}${r.token}`,\n                    headers: opts.headers\n                });\n            } catch (err) {\n                r.cancel(err);\n            }\n        }\n        return Promise.resolve(qi);\n    }\n    request(subject, data, opts = {\n        timeout: 1000,\n        noMux: false\n    }) {\n        try {\n            this._check(subject, true, true);\n        } catch (err) {\n            return Promise.reject(err);\n        }\n        const asyncTraces = !(this.protocol.options.noAsyncTraces || false);\n        opts.timeout = opts.timeout || 1000;\n        if (opts.timeout < 1) {\n            return Promise.reject(new NatsError(\"timeout\", ErrorCode.InvalidOption));\n        }\n        if (!opts.noMux && opts.reply) {\n            return Promise.reject(new NatsError(\"reply can only be used with noMux\", ErrorCode.InvalidOption));\n        }\n        if (opts.noMux) {\n            const inbox = opts.reply ? opts.reply : createInbox(this.options.inboxPrefix);\n            const d = deferred();\n            const errCtx = asyncTraces ? new Error() : null;\n            const sub = this.subscribe(inbox, {\n                max: 1,\n                timeout: opts.timeout,\n                callback: (err, msg)=>{\n                    if (err) {\n                        if (errCtx && err.code !== ErrorCode.Timeout) {\n                            err.stack += `\\n\\n${errCtx.stack}`;\n                        }\n                        sub.unsubscribe();\n                        d.reject(err);\n                    } else {\n                        err = isRequestError(msg);\n                        if (err) {\n                            if (errCtx) {\n                                err.stack += `\\n\\n${errCtx.stack}`;\n                            }\n                            d.reject(err);\n                        } else {\n                            d.resolve(msg);\n                        }\n                    }\n                }\n            });\n            sub.requestSubject = subject;\n            this.protocol.publish(subject, data, {\n                reply: inbox,\n                headers: opts.headers\n            });\n            return d;\n        } else {\n            const r = new RequestOne(this.protocol.muxSubscriptions, subject, opts, asyncTraces);\n            this.protocol.request(r);\n            try {\n                this.publish(subject, data, {\n                    reply: `${this.protocol.muxSubscriptions.baseInbox}${r.token}`,\n                    headers: opts.headers\n                });\n            } catch (err) {\n                r.cancel(err);\n            }\n            const p = Promise.race([\n                r.timer,\n                r.deferred\n            ]);\n            p.catch(()=>{\n                r.cancel();\n            });\n            return p;\n        }\n    }\n    flush() {\n        if (this.isClosed()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n        }\n        return this.protocol.flush();\n    }\n    drain() {\n        if (this.isClosed()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n        }\n        if (this.isDraining()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionDraining));\n        }\n        this.draining = true;\n        return this.protocol.drain();\n    }\n    isClosed() {\n        return this.protocol.isClosed();\n    }\n    isDraining() {\n        return this.draining;\n    }\n    getServer() {\n        const srv = this.protocol.getServer();\n        return srv ? srv.listen : \"\";\n    }\n    status() {\n        const iter = new QueuedIteratorImpl();\n        iter.iterClosed.then(()=>{\n            const idx = this.listeners.indexOf(iter);\n            this.listeners.splice(idx, 1);\n        });\n        this.listeners.push(iter);\n        return iter;\n    }\n    get info() {\n        return this.protocol.isClosed() ? undefined : this.protocol.info;\n    }\n    async context() {\n        const r = await this.request(`$SYS.REQ.USER.INFO`);\n        return r.json((key, value)=>{\n            if (key === \"time\") {\n                return new Date(Date.parse(value));\n            }\n            return value;\n        });\n    }\n    stats() {\n        return {\n            inBytes: this.protocol.inBytes,\n            outBytes: this.protocol.outBytes,\n            inMsgs: this.protocol.inMsgs,\n            outMsgs: this.protocol.outMsgs\n        };\n    }\n    async jetstreamManager(opts = {}) {\n        const adm = new JetStreamManagerImpl(this, opts);\n        if (opts.checkAPI !== false) {\n            try {\n                await adm.getAccountInfo();\n            } catch (err) {\n                const ne = err;\n                if (ne.code === ErrorCode.NoResponders) {\n                    ne.code = ErrorCode.JetStreamNotEnabled;\n                }\n                throw ne;\n            }\n        }\n        return adm;\n    }\n    jetstream(opts = {}) {\n        return new JetStreamClientImpl(this, opts);\n    }\n    getServerVersion() {\n        const info = this.info;\n        return info ? parseSemVer(info.version) : undefined;\n    }\n    async rtt() {\n        if (!this.protocol._closed && !this.protocol.connected) {\n            throw NatsError.errorForCode(ErrorCode.Disconnect);\n        }\n        const start = Date.now();\n        await this.flush();\n        return Date.now() - start;\n    }\n    get features() {\n        return this.protocol.features;\n    }\n    get services() {\n        if (!this._services) {\n            this._services = new ServicesFactory(this);\n        }\n        return this._services;\n    }\n    reconnect() {\n        if (this.isClosed()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionClosed));\n        }\n        if (this.isDraining()) {\n            return Promise.reject(NatsError.errorForCode(ErrorCode.ConnectionDraining));\n        }\n        return this.protocol.reconnect();\n    }\n}\nclass ServicesFactory {\n    nc;\n    constructor(nc){\n        this.nc = nc;\n    }\n    add(config) {\n        try {\n            const s = new ServiceImpl(this.nc, config);\n            return s.start();\n        } catch (err) {\n            return Promise.reject(err);\n        }\n    }\n    client(opts, prefix) {\n        return new ServiceClientImpl(this.nc, opts, prefix);\n    }\n}\nclass KvStoredEntryImpl {\n    bucket;\n    sm;\n    prefixLen;\n    constructor(bucket, prefixLen, sm){\n        this.bucket = bucket;\n        this.prefixLen = prefixLen;\n        this.sm = sm;\n    }\n    get key() {\n        return this.sm.subject.substring(this.prefixLen);\n    }\n    get value() {\n        return this.sm.data;\n    }\n    get delta() {\n        return 0;\n    }\n    get created() {\n        return this.sm.time;\n    }\n    get revision() {\n        return this.sm.seq;\n    }\n    get operation() {\n        return this.sm.header.get(kvOperationHdr) || \"PUT\";\n    }\n    get length() {\n        const slen = this.sm.header.get(JsHeaders.MessageSizeHdr) || \"\";\n        if (slen !== \"\") {\n            return parseInt(slen, 10);\n        }\n        return this.sm.data.length;\n    }\n    json() {\n        return this.sm.json();\n    }\n    string() {\n        return this.sm.string();\n    }\n}\nclass KvJsMsgEntryImpl {\n    bucket;\n    key;\n    sm;\n    constructor(bucket, key, sm){\n        this.bucket = bucket;\n        this.key = key;\n        this.sm = sm;\n    }\n    get value() {\n        return this.sm.data;\n    }\n    get created() {\n        return new Date(millis(this.sm.info.timestampNanos));\n    }\n    get revision() {\n        return this.sm.seq;\n    }\n    get operation() {\n        return this.sm.headers?.get(kvOperationHdr) || \"PUT\";\n    }\n    get delta() {\n        return this.sm.info.pending;\n    }\n    get length() {\n        const slen = this.sm.headers?.get(JsHeaders.MessageSizeHdr) || \"\";\n        if (slen !== \"\") {\n            return parseInt(slen, 10);\n        }\n        return this.sm.data.length;\n    }\n    json() {\n        return this.sm.json();\n    }\n    string() {\n        return this.sm.string();\n    }\n}\nclass JetStreamSubscriptionImpl extends TypedSubscription {\n    js;\n    monitor;\n    constructor(js, subject, opts){\n        super(js.nc, subject, opts);\n        this.js = js;\n        this.monitor = null;\n        this.sub.closed.then(()=>{\n            if (this.monitor) {\n                this.monitor.cancel();\n            }\n        });\n    }\n    set info(info) {\n        this.sub.info = info;\n    }\n    get info() {\n        return this.sub.info;\n    }\n    _resetOrderedConsumer(sseq) {\n        if (this.info === null || this.sub.isClosed()) {\n            return;\n        }\n        const newDeliver = createInbox(this.js.nc.options.inboxPrefix);\n        const nci = this.js.nc;\n        nci._resub(this.sub, newDeliver);\n        const info = this.info;\n        info.config.name = nuid.next();\n        info.ordered_consumer_sequence.delivery_seq = 0;\n        info.flow_control.heartbeat_count = 0;\n        info.flow_control.fc_count = 0;\n        info.flow_control.consumer_restarts++;\n        info.deliver = newDeliver;\n        info.config.deliver_subject = newDeliver;\n        info.config.deliver_policy = DeliverPolicy.StartSequence;\n        info.config.opt_start_seq = sseq;\n        const req = {};\n        req.stream_name = this.info.stream;\n        req.config = info.config;\n        const subj = `${info.api.prefix}.CONSUMER.CREATE.${info.stream}`;\n        this.js._request(subj, req, {\n            retries: -1\n        }).then((v)=>{\n            const ci = v;\n            const jinfo = this.sub.info;\n            jinfo.last = ci;\n            this.info.config = ci.config;\n            this.info.name = ci.name;\n        }).catch((err)=>{\n            const nerr = new NatsError(`unable to recreate ordered consumer ${info.stream} at seq ${sseq}`, ErrorCode.RequestError, err);\n            this.sub.callback(nerr, {});\n        });\n    }\n    _maybeSetupHbMonitoring() {\n        const ns = this.info?.config?.idle_heartbeat || 0;\n        if (ns) {\n            this._setupHbMonitoring(millis(ns));\n        }\n    }\n    _setupHbMonitoring(millis, cancelAfter = 0) {\n        const opts = {\n            cancelAfter: 0,\n            maxOut: 2\n        };\n        if (cancelAfter) {\n            opts.cancelAfter = cancelAfter;\n        }\n        const sub = this.sub;\n        const handler = (v)=>{\n            const msg = newJsErrorMsg(409, `${Js409Errors.IdleHeartbeatMissed}: ${v}`, this.sub.subject);\n            const ordered = this.info?.ordered;\n            if (!ordered) {\n                this.sub.callback(null, msg);\n            } else {\n                if (!this.js.nc.protocol.connected) {\n                    return false;\n                }\n                const seq = this.info?.ordered_consumer_sequence?.stream_seq || 0;\n                this._resetOrderedConsumer(seq + 1);\n                this.monitor?.restart();\n                return false;\n            }\n            return !sub.noIterator;\n        };\n        this.monitor = new IdleHeartbeatMonitor(millis, handler, opts);\n    }\n    _checkHbOrderConsumer(msg) {\n        const rm = msg.headers.get(JsHeaders.ConsumerStalledHdr);\n        if (rm !== \"\") {\n            const nci = this.js.nc;\n            nci.publish(rm);\n        }\n        const lastDelivered = parseInt(msg.headers.get(JsHeaders.LastConsumerSeqHdr), 10);\n        const ordered = this.info.ordered_consumer_sequence;\n        this.info.flow_control.heartbeat_count++;\n        if (lastDelivered !== ordered.delivery_seq) {\n            this._resetOrderedConsumer(ordered.stream_seq + 1);\n        }\n        return false;\n    }\n    _checkOrderedConsumer(jm) {\n        const ordered = this.info.ordered_consumer_sequence;\n        const sseq = jm.info.streamSequence;\n        const dseq = jm.info.deliverySequence;\n        if (dseq != ordered.delivery_seq + 1) {\n            this._resetOrderedConsumer(ordered.stream_seq + 1);\n            return false;\n        }\n        ordered.delivery_seq = dseq;\n        ordered.stream_seq = sseq;\n        return true;\n    }\n    async destroy() {\n        if (!this.isClosed()) {\n            await this.drain();\n        }\n        const jinfo = this.sub.info;\n        const name = jinfo.config.durable_name || jinfo.name;\n        const subj = `${jinfo.api.prefix}.CONSUMER.DELETE.${jinfo.stream}.${name}`;\n        await jinfo.api._request(subj);\n    }\n    async consumerInfo() {\n        const jinfo = this.sub.info;\n        const name = jinfo.config.durable_name || jinfo.name;\n        const subj = `${jinfo.api.prefix}.CONSUMER.INFO.${jinfo.stream}.${name}`;\n        const ci = await jinfo.api._request(subj);\n        jinfo.last = ci;\n        return ci;\n    }\n}\nclass JetStreamPullSubscriptionImpl extends JetStreamSubscriptionImpl {\n    constructor(js, subject, opts){\n        super(js, subject, opts);\n    }\n    pull(opts = {\n        batch: 1\n    }) {\n        const { stream, config, name } = this.sub.info;\n        const consumer = config.durable_name ?? name;\n        const args = {};\n        args.batch = opts.batch || 1;\n        args.no_wait = opts.no_wait || false;\n        if ((opts.max_bytes ?? 0) > 0) {\n            const fv = this.js.nc.features.get(Feature.JS_PULL_MAX_BYTES);\n            if (!fv.ok) {\n                throw new Error(`max_bytes is only supported on servers ${fv.min} or better`);\n            }\n            args.max_bytes = opts.max_bytes;\n        }\n        let expires = 0;\n        if (opts.expires && opts.expires > 0) {\n            expires = opts.expires;\n            args.expires = nanos(expires);\n        }\n        let hb = 0;\n        if (opts.idle_heartbeat && opts.idle_heartbeat > 0) {\n            hb = opts.idle_heartbeat;\n            args.idle_heartbeat = nanos(hb);\n        }\n        if (hb && expires === 0) {\n            throw new Error(\"idle_heartbeat requires expires\");\n        }\n        if (hb > expires) {\n            throw new Error(\"expires must be greater than idle_heartbeat\");\n        }\n        if (this.info) {\n            if (this.monitor) {\n                this.monitor.cancel();\n            }\n            if (expires && hb) {\n                if (!this.monitor) {\n                    this._setupHbMonitoring(hb, expires);\n                } else {\n                    this.monitor._change(hb, expires);\n                }\n            }\n            const api = this.info.api;\n            const subj = `${api.prefix}.CONSUMER.MSG.NEXT.${stream}.${consumer}`;\n            const reply = this.sub.subject;\n            api.nc.publish(subj, api.jc.encode(args), {\n                reply: reply\n            });\n        }\n    }\n}\nfunction msgAdapter(iterator, ackTimeout) {\n    if (iterator) {\n        return iterMsgAdapter(ackTimeout);\n    } else {\n        return cbMsgAdapter(ackTimeout);\n    }\n}\nfunction cbMsgAdapter(ackTimeout) {\n    return (err, msg)=>{\n        if (err) {\n            return [\n                err,\n                null\n            ];\n        }\n        err = checkJsError(msg);\n        if (err) {\n            return [\n                err,\n                null\n            ];\n        }\n        return [\n            null,\n            toJsMsg(msg, ackTimeout)\n        ];\n    };\n}\nfunction iterMsgAdapter(ackTimeout) {\n    return (err, msg)=>{\n        if (err) {\n            return [\n                err,\n                null\n            ];\n        }\n        const ne = checkJsError(msg);\n        if (ne !== null) {\n            return [\n                hideNonTerminalJsErrors(ne),\n                null\n            ];\n        }\n        return [\n            null,\n            toJsMsg(msg, ackTimeout)\n        ];\n    };\n}\nfunction hideNonTerminalJsErrors(ne) {\n    if (ne !== null) {\n        switch(ne.code){\n            case ErrorCode.JetStream404NoMessages:\n            case ErrorCode.JetStream408RequestTimeout:\n                return null;\n            case ErrorCode.JetStream409:\n                if (isTerminal409(ne)) {\n                    return ne;\n                }\n                return null;\n            default:\n                return ne;\n        }\n    }\n    return null;\n}\nfunction autoAckJsMsg(data) {\n    if (data) {\n        data.ack();\n    }\n}\nfunction parseInfo(s) {\n    const tokens = s.split(\".\");\n    if (tokens.length === 9) {\n        tokens.splice(2, 0, \"_\", \"\");\n    }\n    if (tokens.length < 11 || tokens[0] !== \"$JS\" || tokens[1] !== \"ACK\") {\n        throw new Error(`not js message`);\n    }\n    const di = {};\n    di.domain = tokens[2] === \"_\" ? \"\" : tokens[2];\n    di.account_hash = tokens[3];\n    di.stream = tokens[4];\n    di.consumer = tokens[5];\n    di.deliveryCount = parseInt(tokens[6], 10);\n    di.redeliveryCount = di.deliveryCount;\n    di.redelivered = di.deliveryCount > 1;\n    di.streamSequence = parseInt(tokens[7], 10);\n    di.deliverySequence = parseInt(tokens[8], 10);\n    di.timestampNanos = parseInt(tokens[9], 10);\n    di.pending = parseInt(tokens[10], 10);\n    return di;\n}\nclass JsMsgImpl {\n    msg;\n    di;\n    didAck;\n    timeout;\n    constructor(msg, timeout){\n        this.msg = msg;\n        this.didAck = false;\n        this.timeout = timeout;\n    }\n    get subject() {\n        return this.msg.subject;\n    }\n    get sid() {\n        return this.msg.sid;\n    }\n    get data() {\n        return this.msg.data;\n    }\n    get headers() {\n        return this.msg.headers;\n    }\n    get info() {\n        if (!this.di) {\n            this.di = parseInfo(this.reply);\n        }\n        return this.di;\n    }\n    get redelivered() {\n        return this.info.deliveryCount > 1;\n    }\n    get reply() {\n        return this.msg.reply || \"\";\n    }\n    get seq() {\n        return this.info.streamSequence;\n    }\n    doAck(payload) {\n        if (!this.didAck) {\n            this.didAck = !this.isWIP(payload);\n            this.msg.respond(payload);\n        }\n    }\n    isWIP(p) {\n        return p.length === 4 && p[0] === WPI[0] && p[1] === WPI[1] && p[2] === WPI[2] && p[3] === WPI[3];\n    }\n    async ackAck(opts) {\n        opts = opts || {};\n        opts.timeout = opts.timeout || this.timeout;\n        const d = deferred();\n        if (!this.didAck) {\n            this.didAck = true;\n            if (this.msg.reply) {\n                const mi = this.msg;\n                const proto = mi.publisher;\n                const trace = !(proto.options?.noAsyncTraces || false);\n                const r = new RequestOne(proto.muxSubscriptions, this.msg.reply, {\n                    timeout: opts.timeout\n                }, trace);\n                proto.request(r);\n                try {\n                    proto.publish(this.msg.reply, ACK, {\n                        reply: `${proto.muxSubscriptions.baseInbox}${r.token}`\n                    });\n                } catch (err) {\n                    r.cancel(err);\n                }\n                try {\n                    await Promise.race([\n                        r.timer,\n                        r.deferred\n                    ]);\n                    d.resolve(true);\n                } catch (err) {\n                    r.cancel(err);\n                    d.reject(err);\n                }\n            } else {\n                d.resolve(false);\n            }\n        } else {\n            d.resolve(false);\n        }\n        return d;\n    }\n    ack() {\n        this.doAck(ACK);\n    }\n    nak(millis) {\n        let payload = NAK;\n        if (millis) {\n            payload = StringCodec().encode(`-NAK ${JSON.stringify({\n                delay: nanos(millis)\n            })}`);\n        }\n        this.doAck(payload);\n    }\n    working() {\n        this.doAck(WPI);\n    }\n    next(subj, opts = {\n        batch: 1\n    }) {\n        const args = {};\n        args.batch = opts.batch || 1;\n        args.no_wait = opts.no_wait || false;\n        if (opts.expires && opts.expires > 0) {\n            args.expires = nanos(opts.expires);\n        }\n        const data = JSONCodec().encode(args);\n        const payload = DataBuffer.concat(NXT, SPACE, data);\n        const reqOpts = subj ? {\n            reply: subj\n        } : undefined;\n        this.msg.respond(payload, reqOpts);\n    }\n    term(reason = \"\") {\n        let term = TERM;\n        if (reason?.length > 0) {\n            term = StringCodec().encode(`+TERM ${reason}`);\n        }\n        this.doAck(term);\n    }\n    json() {\n        return this.msg.json();\n    }\n    string() {\n        return this.msg.string();\n    }\n}\nexport { checkJsError as checkJsError, isFlowControlMsg as isFlowControlMsg, isHeartbeatMsg as isHeartbeatMsg };\nexport { AckPolicy as AckPolicy, AdvisoryKind as AdvisoryKind, ConsumerDebugEvents as ConsumerDebugEvents, ConsumerEvents as ConsumerEvents, DeliverPolicy as DeliverPolicy, DirectMsgHeaders as DirectMsgHeaders, DiscardPolicy as DiscardPolicy, JsHeaders as JsHeaders, KvWatchInclude as KvWatchInclude, ReplayPolicy as ReplayPolicy, RepublishHeaders as RepublishHeaders, RetentionPolicy as RetentionPolicy, StorageType as StorageType, StoreCompression as StoreCompression };\nexport { consumerOpts as consumerOpts };\nconst VERSION = \"1.30.0\";\nconst LANG = \"nats.ws\";\nclass WsTransport {\n    version;\n    lang;\n    closeError;\n    connected;\n    done;\n    socket;\n    options;\n    socketClosed;\n    encrypted;\n    peeked;\n    yields;\n    signal;\n    closedNotification;\n    constructor(){\n        this.version = VERSION;\n        this.lang = LANG;\n        this.connected = false;\n        this.done = false;\n        this.socketClosed = false;\n        this.encrypted = false;\n        this.peeked = false;\n        this.yields = [];\n        this.signal = deferred();\n        this.closedNotification = deferred();\n    }\n    async connect(server, options) {\n        const connected = false;\n        const connLock = deferred();\n        if (options.tls) {\n            connLock.reject(new NatsError(\"tls\", ErrorCode.InvalidOption));\n            return connLock;\n        }\n        this.options = options;\n        const u = server.src;\n        if (options.wsFactory) {\n            const { socket, encrypted } = await options.wsFactory(server.src, options);\n            this.socket = socket;\n            this.encrypted = encrypted;\n        } else {\n            this.encrypted = u.indexOf(\"wss://\") === 0;\n            this.socket = new WebSocket(u);\n        }\n        this.socket.binaryType = \"arraybuffer\";\n        this.socket.onopen = ()=>{\n            if (this.isDiscarded()) {\n                return;\n            }\n        };\n        this.socket.onmessage = (me)=>{\n            if (this.isDiscarded()) {\n                return;\n            }\n            this.yields.push(new Uint8Array(me.data));\n            if (this.peeked) {\n                this.signal.resolve();\n                return;\n            }\n            const t = DataBuffer.concat(...this.yields);\n            const pm = extractProtocolMessage(t);\n            if (pm !== \"\") {\n                const m = INFO.exec(pm);\n                if (!m) {\n                    if (options.debug) {\n                        console.error(\"!!!\", render(t));\n                    }\n                    connLock.reject(new Error(\"unexpected response from server\"));\n                    return;\n                }\n                try {\n                    const info = JSON.parse(m[1]);\n                    checkOptions(info, this.options);\n                    this.peeked = true;\n                    this.connected = true;\n                    this.signal.resolve();\n                    connLock.resolve();\n                } catch (err) {\n                    connLock.reject(err);\n                    return;\n                }\n            }\n        };\n        this.socket.onclose = (evt)=>{\n            if (this.isDiscarded()) {\n                return;\n            }\n            this.socketClosed = true;\n            let reason;\n            if (this.done) return;\n            if (!evt.wasClean) {\n                reason = new Error(evt.reason);\n            }\n            this._closed(reason);\n        };\n        this.socket.onerror = (e)=>{\n            if (this.isDiscarded()) {\n                return;\n            }\n            const evt = e;\n            const err = new NatsError(evt.message, ErrorCode.Unknown, new Error(evt.error));\n            if (!connected) {\n                connLock.reject(err);\n            } else {\n                this._closed(err);\n            }\n        };\n        return connLock;\n    }\n    disconnect() {\n        this._closed(undefined, true);\n    }\n    async _closed(err, internal = true) {\n        if (this.isDiscarded()) {\n            return;\n        }\n        if (!this.connected) return;\n        if (this.done) return;\n        this.closeError = err;\n        if (!err) {\n            while(!this.socketClosed && this.socket.bufferedAmount > 0){\n                await delay(100);\n            }\n        }\n        this.done = true;\n        try {\n            this.socket.close(err ? 1002 : 1000, err ? err.message : undefined);\n        } catch (err) {}\n        if (internal) {\n            this.closedNotification.resolve(err);\n        }\n    }\n    get isClosed() {\n        return this.done;\n    }\n    [Symbol.asyncIterator]() {\n        return this.iterate();\n    }\n    async *iterate() {\n        while(true){\n            if (this.isDiscarded()) {\n                return;\n            }\n            if (this.yields.length === 0) {\n                await this.signal;\n            }\n            const yields = this.yields;\n            this.yields = [];\n            for(let i = 0; i < yields.length; i++){\n                if (this.options.debug) {\n                    console.info(`> ${render(yields[i])}`);\n                }\n                yield yields[i];\n            }\n            if (this.done) {\n                break;\n            } else if (this.yields.length === 0) {\n                yields.length = 0;\n                this.yields = yields;\n                this.signal = deferred();\n            }\n        }\n    }\n    isEncrypted() {\n        return this.connected && this.encrypted;\n    }\n    send(frame) {\n        if (this.isDiscarded()) {\n            return;\n        }\n        try {\n            this.socket.send(frame.buffer);\n            if (this.options.debug) {\n                console.info(`< ${render(frame)}`);\n            }\n            return;\n        } catch (err) {\n            if (this.options.debug) {\n                console.error(`!!! ${render(frame)}: ${err}`);\n            }\n        }\n    }\n    close(err) {\n        return this._closed(err, false);\n    }\n    closed() {\n        return this.closedNotification;\n    }\n    isDiscarded() {\n        if (this.done) {\n            this.discard();\n            return true;\n        }\n        return false;\n    }\n    discard() {\n        this.done = true;\n        try {\n            this.socket?.close();\n        } catch (_err) {}\n    }\n}\nfunction wsUrlParseFn(u, encrypted) {\n    const ut = /^(.*:\\/\\/)(.*)/;\n    if (!ut.test(u)) {\n        if (typeof encrypted === \"boolean\") {\n            u = `${encrypted === true ? \"https\" : \"http\"}://${u}`;\n        } else {\n            u = `https://${u}`;\n        }\n    }\n    let url = new URL(u);\n    const srcProto = url.protocol.toLowerCase();\n    if (srcProto === \"ws:\") {\n        encrypted = false;\n    }\n    if (srcProto === \"wss:\") {\n        encrypted = true;\n    }\n    if (srcProto !== \"https:\" && srcProto !== \"http\") {\n        u = u.replace(/^(.*:\\/\\/)(.*)/gm, \"$2\");\n        url = new URL(`http://${u}`);\n    }\n    let protocol;\n    let port;\n    const host = url.hostname;\n    const path = url.pathname;\n    const search = url.search || \"\";\n    switch(srcProto){\n        case \"http:\":\n        case \"ws:\":\n        case \"nats:\":\n            port = url.port || \"80\";\n            protocol = \"ws:\";\n            break;\n        case \"https:\":\n        case \"wss:\":\n        case \"tls:\":\n            port = url.port || \"443\";\n            protocol = \"wss:\";\n            break;\n        default:\n            port = url.port || encrypted === true ? \"443\" : \"80\";\n            protocol = encrypted === true ? \"wss:\" : \"ws:\";\n            break;\n    }\n    return `${protocol}//${host}:${port}${path}${search}`;\n}\nfunction connect(opts = {}) {\n    setTransportFactory({\n        defaultPort: 443,\n        urlParseFn: wsUrlParseFn,\n        factory: ()=>{\n            return new WsTransport();\n        }\n    });\n    return NatsConnectionImpl.connect(opts);\n}\nexport { connect as connect };\n"],"mappings":"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AAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAACvuB,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EACrCuuB,EAAE,CAACA,EAAE,CAAC,OAAO,CAAC,GAAG,GAAG,CAACv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AAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,EAC/B,IAAIA,GAAG,CAAC,UAAU,EAAE,UA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AAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,M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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}